---
title: 【Multiwfn】CDA分析
typora-root-url: 【Multiwfn】CDA分析
mathjax: true
date: 2022-08-22 15:28:44
updated:
tags: [Multiwfn, CDA, CT]
categories: [计算化学, 软件]
description: CDA分析
---

http://sobereva.com/166

[广义化的电荷分解分析(GCDA)方法 (hanspub.org)](https://pdf.hanspub.org/JAPC20150400000_68741604.pdf)

电荷分解分析(Charge decomposition analysis, CDA)是基于片段轨道的概念提出的一种将分子片段之间电荷转移分解为轨道的贡献，从而能更深入了解电荷转移本质的方法。

# 原理



- d (Donation)表现的是片段 A 向片段 B 贡献的电子量。它体现的是片段 A 的占据轨道与片段 B 的空轨道的混合。
- b (Back-donation)表现的是片段 B 向片段 A 反馈的电子量。它由片段 B 的占据轨道与片段 A 的空轨道混合而产生。
- d-b可以认为是经由复合物轨道两个片段间的净转移量。
- b+d ，其数值越大说明两个片段间相互作用程度越大，轨道混合越显著。
- r (Charge polarization)表现的是占据轨道的电荷极化，称为电荷极化项。
  - r>0，说明由于第 i 个复合物轨道，两个片段的电子在片段重叠区域的分布量增加，此时两个片段的占据轨道以相位相同方式混合，起到成键效应；
  - r<0，表明两个片段的电子在重叠区域分布量减少，此时两个片段的占据轨道间必以相位相反方式混合，对片段间成键起到破坏作用，即反键效应。
  - 总和值 r 一般为负值，因为占据轨道间的总相互作用是以交换互斥为主导的，是不利于成键的。

# 步骤

## 准备文件

Gaussian提供复合物和各个片段的单点任务的fch文件。注意事项：

- 坐标必须都用笛卡尔坐标，而且片段的定义顺序，片段内原子顺序、原子坐标必须和复合物中的完全一致。
- 片段不需要单独优化。
- 为了避免Gaussian自动将坐标调整到标准朝向而使得坐标无法相互对应，要使用`nosymm`关键词
- 不要用弥散函数
- 重原子使用赝势基组可能会出现基函数数目不符的问题，可以使用`5d`关键词。
- 如果用后HF方法计算，应当再加上density关键词，并且此时只能用Gaussian输出文件作为输入。对于闭壳层，pop=full应当改为pop=NO；对于开壳层，应改为pop=NOAB。这样才能让自然轨道信息代替HF轨道信息出现在Gaussian输出文件中。
- 以开壳层方式做 CDA/GCDA 计算时需要考虑自旋翻转问题。
- 片段的参考状态的选择应当尽量接近复合物状态的电子结构。

## 例子

### 总体步骤

```
examples\CDA\COBH3\COBH3.fch  //复合物的Gaussian输出文件
16   //进入CDA模块
2  //定义两个片段
examples\CDA\COBH3\CO.fch  //片段1的Gaussian输出文件
examples\CDA\COBH3\BH3.fch  //片段2的Gaussian输出文件
```

### 结果分析

**CDA数据：**

```
    Orb.      Occ.          d           b        d - b          r
       1    2.000000   -0.000004   -0.000000   -0.000004   -0.000001
       2    2.000000    0.001119   -0.000023    0.001141    0.000326
       3    2.000000   -0.000002   -0.000471    0.000469    0.000313
       4    2.000000   -0.013250   -0.000704   -0.012546   -0.005676
       5    2.000000    0.041648   -0.003309    0.044957    0.232262
       6    2.000000    0.037385   -0.020136    0.057521    0.212422
       7    2.000000   -0.000543    0.000647   -0.001190    0.022166
       8    2.000000   -0.000543    0.000647   -0.001190    0.022166
       9    2.000000    0.171353    0.026952    0.144401   -0.741381
      10    2.000000   -0.000569    0.043713   -0.044281   -0.038916
      11    2.000000   -0.000569    0.043713   -0.044282   -0.038916
      12    0.000000    0.000000    0.000000    0.000000    0.000000
      13    0.000000    0.000000    0.000000    0.000000    0.000000
      14    0.000000    0.000000    0.000000    0.000000    0.000000
      15    0.000000    0.000000    0.000000    0.000000    0.000000
  ......
 -------------------------------------------------------------------
 Sum:      22.000000    0.236023    0.091027    0.144996   -0.335233
```

- Orb.就是复合物轨道的编号，Occ.是其占据数。
- 前三个复合物轨道的d、b、r项都接近于0，表明它们对于片段间的相互作用没什么用处，这是因为它们分别是O、C、B的**内核轨道**，基本不会参与成键。
- 所有的**虚轨道**的d、b、r项都为，因为它们的占据数都为0。
  - 只有对于自然轨道，对应于LUMO及更高阶的复合物轨道由于仍有少量电子占据，其d、b、r项才不是精确为0，但由于自然轨道序号是按照占据数由高到低排的，超过LUMO+5的话由于占据数往往已经很低了，d、b、r项已很小，所以Multiwfn中LUMO+5以上的轨道都不会输出。

- 复合物轨道9的d是最大的，因此表明这个轨道对于CO向BH3的电子转移有最主要的贡献。通过形成这个复合物轨道，CO向BH3贡献了0.171个电子，而BH3向CO反馈了0.0269个电子，故净转移可以估算为0.144（即d-b项）。
- BH3对CO反馈电子主要是来自于复合物轨道10和11，它们是简并的轨道，b的数值一致，为0.0437。
- r(9)非常负，这说明复合物轨道9的形成使得CO和BH3的占据的片段轨道的电子很大程度上从二者的交叠区域移走，从而降低了电子互斥，从下面的它的轨道波函数图形中也可见在交叠区域有个明显的节点。
- r(5)和r(6)都是不小的正值，因此它们的形成导致占据片段轨道的电子向交叠区域转移了不少，可以认为体现了片段间成键轨道的特征，从下面的等值面图形中也可看到这两个复合物轨道都较好地覆盖了片段间成键区域，故有利于成键。

![img](http://sobereva.com/usr/uploads/image/20150610/20150610061643_74552.png)

------

**ECDA数据：**

```
   Contribution to all occupied complex orbital:
Occupied, virtual orbitals of fragment  1:     680.4194%         8.0593%
Occupied, virtual orbitals of fragment  2:     390.3988%        21.1226%
  Contribution to all virtual complex orbital:
Occupied, virtual orbitals of fragment  1:      19.5806%      2291.9407%
Occupied, virtual orbitals of fragment  2:       9.6012%      1678.8774%
PL( 1) + CT( 1-> 2) =    0.3916      PL( 1) + CT( 2-> 1) =    0.1612
PL( 2) + CT( 1-> 2) =    0.4225      PL( 2) + CT( 2-> 1) =    0.1920
The net electrons obtained by frag. 2 = CT( 1-> 2) - CT( 2-> 1) =    0.2304
```

- 一般来说只需要关注最后一行数据，它表明了从片段1向片段2总共净转移了多少电子，此例即0.2304。
  - 这个数据和CDA的d-b项会有一定出入，因为二者计算方法没有明显关联。ECDA给出的总的净转移量更可靠。

------

通过**菜单**可以进一步观看复合物轨道的具体成分，比如选`2`再输入9。

```
  Occupation number of orbital     9 of the complex:  2.00000000
 Orbital     7 of fragment  1, Occ: 2.00000    Contribution:   25.8560%
 Orbital    13 of fragment  1, Occ: 0.00000    Contribution:    1.0798%
 Orbital     2 of fragment  2, Occ: 2.00000    Contribution:   57.2921%
 Orbital     5 of fragment  2, Occ: 0.00000    Contribution:   14.5640%
```

- 从数据中可见，复合物轨道9主体是BH3的轨道2，达57.3%。
- 之所以此复合物轨道会导致CO向BH3转移那么多电子，显然是因为CO的占据轨道7与BH3的虚轨道5相混合。
- r(9)很负，是因为CO的占据轨道7与BH3的占据轨道2间的互斥作用所致。
- 可以进一步结合轨道图形来看：
  - 左边是CO的占据轨道7（展现较明显C的孤对电子特征），右边是BH3的虚轨道5，从形状上看二者比较匹配，因此容易混合，并且混合后会导致不少电子转移。
   ![img](http://sobereva.com/usr/uploads/image/20150610/20150610061657_41127.png)

------

**将某个复合物轨道的d,b,r值分解为片段轨道对的贡献：**

- 对复合物轨道9进行分解。输入`0`返回上一级菜单，选选项`6`，然后输入`9`，然后输入0.005，这样对复合物轨道9的d,b,r项任意之一贡献大于0.005的片段轨道对就会被输出出来。

  ```
  FragA Orb(Occ.)  FragB Orb(Occ.)      d           b        d - b          r
      4( 2.0000)       2( 2.0000)    0.000000    0.000000    0.000000   -0.009969
      7( 2.0000)       1( 2.0000)    0.000000    0.000000    0.000000   -0.005759
      7( 2.0000)       2( 2.0000)    0.000000    0.000000    0.000000   -0.723845
      7( 2.0000)       5( 0.0000)    0.176503    0.000000    0.176503    0.000000
      7( 2.0000)       8( 0.0000)    0.006221    0.000000    0.006221    0.000000
      7( 2.0000)      11( 0.0000)    0.005846    0.000000    0.005846    0.000000
      7( 2.0000)      12( 0.0000)   -0.023941    0.000000   -0.023941    0.000000
     13( 0.0000)       2( 2.0000)    0.000000    0.021958   -0.021958    0.000000
  ```

- 很清晰地可以看到CO的7号轨道与BH3的5号轨道相互作用导致电子向BH3转移了0.176，这正是9号复合物轨道d项达到0.171的主要因素。

------

**绘制轨道相互作用图**

- 输入`0`回到上一级菜单，然后选`5`进入绘制轨道相互作用图的菜单中。

- 选`3`，输入-30,10把相互作用图能量下限和上限分别设为-30和10eV。
- 选`1`，轨道相互作用图立刻会显示。