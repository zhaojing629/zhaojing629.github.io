---
title: 【Multiwfn】AIM分析
typora-root-url: 【Multiwfn】AIM分析
mathjax: true
date: 2021-03-02 15:28:44
updated:
tags: [AIM, 键级, 电荷]
categories: [计算化学, Multiwfn]
description: AIM分析
---







# 操作步骤

加载.fch文件后的总体步骤：

```
17 //盆分析
1  //生成盆并寻找吸引子
1  //用电子密度划分盆
2  //中等质量格点
7  //用混合格点积分AIM盆
2  //对边界进行精确修正
1  //积分电子密度，得到AIM电荷
4 //计算DI和LI
```

## 生成盆

以HCN为例：

1. `17`：盆分析

2. `1`：生成盆并寻找吸引子

   - 如果内存中已经有格点数据可以直接用，如果没有按下一步选择一个是空间函数

3. `1`：让Multiwfn计算电子密度格点数据，用来得到它的盆和吸引子

4. `2`：中等质量格点，也就是格点间距为0.1Bohr<a id="生成"></a>

   - 计算结束后有可能会出现：在某些情况下，在系统之外的区域，一些人为的或物理上无意义的吸引物被放置。这些吸引子具有非常低的功能值，因此被称为”无关紧要“的吸引子，相比之下，其他吸引子可以被称为“重要”吸引子。不重要吸引子的存在是因为在相应的区域内函数值很小，因此函数的行为不是很确定，即使是很小的函数值波动或微不足道的数值扰动都足以产生新的吸引子。当检测到的时候，会提示你处理它们：
     - `1`：什么都不做，不删除这些吸引子
     - `2`：删除这些吸引子，并且相应的格点设置为未赋值的格点
     - `3`：删除这些吸引子，同时分配相应的格点到最近的重要的吸引子（推荐）
   - 吸引子的坐标以及吸引子位置上的函数值：
     - 吸引子编号=盆编号，但是不等同于原子编号

   ```
   	Attractor       X,Y,Z coordinate (Angstrom)                Value
         1   -0.02645886   -0.02645886   -1.52058663          0.33959944
         2    0.02645886    0.02645886   -0.51514986         49.48609717
         3   -0.02645886   -0.02645886    0.64904009         76.55832377
   ```

## 观看盆和吸引子

选`0`来可视化刚找出来的吸引子和生成的盆。

- 紫色的文字对应吸引子的标号。
- 每个吸引子用绿色小球表示（位于原子核处的吸引子得取消选择show molecule选项才能看到）
- 界面右下角是盆列表，一个盆对应一个吸引子，盆的编号和吸引子编号是一致的，选择哪个盆就会显示出哪个盆。位于盆边界的格点通过绿球显示，使得盆的轮廓被勾勒出来。
- 选show basin interior让盆内部也显示
- 盆只显示处于电子密度0.001 a.u.等值面内部区域的部分：在图形界面上方选择Set basin drawing method→rho>0.001 region only

盆列表中的Unas和Boun：

- 这两类格点一般没有什么物理意义，对分析结果影响甚微，通常出现在离体系较远的地方，在上一步计算结束的时候也会有输出这些点的数量，如果是0，可视化的时候什么也不会出现

```
The number of unassigned grids:           0
The number of grids travelled to box boundary:           0
```

- "Unas"（意指Unassigned）是产生盆过程中由于某些数值算法原因没有成功被指认所属吸引子的格点
- "Boun"（意指travelled to box boundary）是指产生盆的过程中按照梯度最大方向移动但是最终移动到格点数据范围边界的点。
- 如果为了节省计算时间，没有让格点数据范围囊括整个分子而是只囊括了局部区域，那么可以得到只位于局部区域的盆，与此同时"Boun"类型的点会大量出现，依然无视它即可。

## 积分盆

### 使用均匀格点

这种积分方式可以用于任何函数：

1. 在生成盆之后，选择`2 Integrate real space functions in the basins`做盆积分

2. `1`：积电子密度：

   - 前面已经生成过电子密度格点数据，可以选择`0 The values of the grid data stored in memory`

3. 输出的每个盆的积分值还有盆的体积：

   - 盆体积对于当前体系没什么意义，因为三个盆的总和就是整个格点数据空间范围，故格点数据空间范围取得越大盆的体积就越大。

   ```
   #Basin        Integral(a.u.)      Volume(a.u.^3)
         1          0.7356142812        441.70000000
         2          5.3511710147        566.31900000
         3          7.9020060745        830.25600000
   Sum of above values:         13.98879137
   ```

   - 可以通过`Sum of above values`看积分精度，一般这样不会很理想，因为电子密度在重原子的原子核附近衰减速度较快，用均匀格点对这部分没法积分得很准。

### 使用混合格点积分（更精确）

只能积分AIM盆：

1. 在生成盆之后，选择`7`：混合格点进行积分

2. `1`：原子中心+均匀格点，忽略边界修正（<a href="#精度">并不精确</a>）。

3. `1`：电子密度

4. 输出盆中的电子布居数、盆体积、密度＞0.001的体积、分子的范德华体积

   ```
   Total result:
     #Basin        Integral(a.u.)      Vol(Bohr^3)    Vol(rho>0.001)
         1          0.7356461193         441.700          34.884
         2          5.3552270393         566.319         102.832
         3          7.9086504198         830.256         134.228
   Sum of above integrals:         13.99952358
   Sum of basin volumes (rho>0.001):     271.944 Bohr^3
   ```

   - 还输出了归一化因子、每个原子的AIM电荷，以及原子体积
     - 因为数值积分有误差，根据总电子数重新校正盆布居数（乘以归一化因子）得到AIM电荷
     - Volume等同于上面的Vol(rho>0.001)，代表的是盆中电子密度大于0.001的体积，按照Bader对范德华表面的定义，这相当于分子范德华表面内原子所占的体积，是有确切物理意义的，可认为是原子的尺寸。

   ```
   Normalization factor of the integral of electron density is    0.999966
   The atomic charges after normalization and atomic volumes:
        1 (C )    Charge:    0.644591     Volume:   102.832 Bohr^3
        2 (N )    Charge:   -0.908920     Volume:   134.228 Bohr^3
        3 (H )    Charge:    0.264329     Volume:    34.884 Bohr^3
   ```

### 提升精度

<a id="精度"></a>实际上这样原子盆的积分值并非很精确，对应的AIM电荷也不是非常精确。为了得到更准确的积分结果，还得对盆边界进一步修正，因此第二部中可以选择（精度有所提升，但会更耗时得多）：

- `2`：原子中心+均匀格点，精确优化边界
- `3`：

- 这三种模式的精度、耗时、内存消耗量：

  ```
  Accuracy: 2>=3>>1     Time spent: 2>3>>1     Memory requirement: 3>2=1
  ```

果想进一步提升精度，可以在生成盆的时候<a href="#生成">用更好的格点</a>，比如High quality grid，乃至Lunatic quality grid。然而，对于大体系，High quality grid已经很耗时、很占内存了。

## 分析定域化指数(LI)和离域化指数(DI)

- 选择功能`4`，Multiwfn就会输出盆之间的DI矩阵和盆内的LI值：

  ```
  ************ Total delocalization index matrix ************
              1             2             3
      1    0.97290584    0.90037924    0.07252660
      2    0.90037924    3.49303265    2.59265341
      3    0.07252660    2.59265341    2.66518001
  
  Total localization index:
      1:  0.259     2:  3.496     3:  6.658
  ```

- 还同时输出了行和列序号对应于原子序号的DI矩阵和LI值。

  ```
   ************** Total delocalization index matrix (atom index) **************
  ```

各个含义：

- 键级：DI就是一种共价键级的衡量标准，随着键的极性的增强DI值一般会降低。
  - 比如DI(2,3)=2.593，表明2号盆（C的AIM原子空间）和3号盆（N的AIM原子空间）之间平均来说共享了2.593个电子，这和HCN中C与N的形式键级3.0挺接近。

- DI矩阵的对角元是相应的列（或行）的矩阵元的加和，对于闭壳层体系，DI矩阵的对角元便是原子价。
  - 此体系N原子的原子价是2.66。
- LI与原子布居数的差值就是从原子盆中离域到别处去的电子数
  - 1号盆（H的AIM原子空间）的定域化指数为0.259，说明平均有0.259个电子定域在这个盆内，这个数值远小于此盆内电子布居数，表明在HCN体系内，电子很容易从H的AIM空间中离域出去，外界的电子也容易离域进来，换句话说，盆内外的电子容易相互交换。

