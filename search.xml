<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>CSS语法</title>
    <url>/2020/12/27/CSS%E8%AF%AD%E6%B3%95/</url>
    <content><![CDATA[<h1 id="CSS语法"><a href="#CSS语法" class="headerlink" title="CSS语法"></a>CSS语法</h1><p><img src="image-20201227135429409.png" alt=""></p>
<ul>
<li><p>CSS 规则由两个主要的部分构成：选择器，以及一条或多条声明</p>
</li>
<li><p>每条声明由一个属性和一个值组成。</p>
</li>
<li><p>属性和值被冒号分开。不要在属性值与单位之间留有空格</p>
</li>
<li><p>CSS声明总是以;结束，声明以大括号{}括起来:</p>
</li>
<li><p>为了让CSS可读性更强，可以每行只描述一个属性</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">p</span><br><span class="line">&#123;</span><br><span class="line">    color:red;</span><br><span class="line">    text-align:center;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>CSS注释以 /<em> 开始, 以 </em>/ 结束</p>
</li>
</ul>
<h1 id="CSS创建"><a href="#CSS创建" class="headerlink" title="CSS创建"></a>CSS创建</h1><ul>
<li>插入样式表的方法有三种，最好的方式是通过外部引用CSS文件</li>
<li>优先级别：内联样式Inline style &gt; （内部样式）Internal style sheet &gt;（外部样式）External style sheet &gt; 浏览器默认样式</li>
</ul>
<h2 id="外部样式表"><a href="#外部样式表" class="headerlink" title="外部样式表"></a>外部样式表</h2><ul>
<li><p>浏览器会从文件 mystyle.css 中读到样式声明，并根据它来格式文档。</p>
<ul>
<li><code>rel</code>即relationship，表明链接的文档是一个<code>styleshhet</code></li>
<li><code>href</code>是路径</li>
</ul>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span> <span class="attr">href</span>=<span class="string">&quot;mystyle.css&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>外部样式表可以在任何文本编辑器中进行编辑。</p>
</li>
<li><p>文件不能包含任何的 html 标签。</p>
</li>
<li><p>样式表应该以 .css 扩展名进行保存。</p>
</li>
</ul>
<h2 id="内部样式表"><a href="#内部样式表" class="headerlink" title="内部样式表"></a>内部样式表</h2><ul>
<li><p>当单个文档需要特殊的样式时，就应该使用内部样式表。</p>
</li>
<li><p>在HTML文档头部 <code>&lt;head&gt;</code> 区域使用<code>&lt;style&gt;</code> 元素 来包含CSS</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span>&gt;</span></span><br><span class="line"><span class="css"><span class="selector-tag">body</span> &#123;<span class="attribute">background-color</span>:yellow;&#125;</span></span><br><span class="line"><span class="css"><span class="selector-tag">p</span> &#123;<span class="attribute">color</span>:blue;&#125;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="内联式"><a href="#内联式" class="headerlink" title="内联式"></a>内联式</h2><ul>
<li><p>当特殊的样式需要应用到个别元素时，就可以使用内联样式。 使用内联样式的方法是在相关的标签中使用”style” 属性。使用”style” 属性可以包含任何 CSS 属性。</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">style</span>=<span class="string">&quot;color:sienna;margin-left:20px&quot;</span>&gt;</span>这是一个段落。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h1 id="id和class"><a href="#id和class" class="headerlink" title="id和class"></a>id和class</h1><ul>
<li>id不能重复，class可以重复，两者的命名都不能用数字开头</li>
<li>class的样式需要用.开头，id的样式需要用#开头</li>
</ul>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">#para1</span><br><span class="line">&#123;</span><br><span class="line">    text-align:center;</span><br><span class="line">    color:red;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.center &#123;text-align:center;&#125;</span><br></pre></td></tr></table></figure>
<h1 id="CSS尺寸"><a href="#CSS尺寸" class="headerlink" title="CSS尺寸"></a>CSS尺寸</h1><p>属性有：</p>
<ul>
<li>height：设置元素的高度。</li>
<li>line-height：设置行高。</li>
<li>max-height：设置元素的最大高度。</li>
<li>max-width：设置元素的最大宽度。</li>
<li>min-height：设置元素的最小高度。</li>
<li>min-width：设置元素的最小宽度。</li>
<li>width：设置元素的宽度。</li>
</ul>
<p>值的形式有:</p>
<ul>
<li>像素为单位：px</li>
<li>百分比为单位： %</li>
<li><p>以em为单位，默认1em=16px，类似于百分比</p>
</li>
<li><p>值默认为<code>auto</code>，也可以选择<code>inherit</code>，表示从从父元素继承属性的值。</p>
</li>
</ul>
<h1 id="CSS颜色"><a href="#CSS颜色" class="headerlink" title="CSS颜色"></a>CSS颜色</h1><ul>
<li><p>16进制：如果形式是aabbcc，可以简写为abc</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">style</span>=<span class="string">&quot;background-color:#FFFF00&quot;</span>&gt;</span></span><br><span class="line">16进制设置的颜色</span><br><span class="line"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>rgb：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">style</span>=<span class="string">&quot;background-color:rgb(255,255,0)&quot;</span>&gt;</span></span><br><span class="line">RGB设置的颜色</span><br><span class="line"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>名称：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">style</span>=<span class="string">&quot;background-color:yellow&quot;</span>&gt;</span></span><br><span class="line">颜色名称设置的颜色</span><br><span class="line"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h1 id="CSS文本"><a href="#CSS文本" class="headerlink" title="CSS文本"></a>CSS文本</h1><h2 id="字体"><a href="#字体" class="headerlink" title="字体"></a>字体</h2><ul>
<li><p>font-family 属性设置文本的字体系列。应该设置几个字体名称作为一种”后备”机制，如果浏览器不支持第一种字体，他将尝试下一种字体。</p>
</li>
<li><p>如果字体系列的名称超过一个字，它必须用引号，如Font Family：”宋体”。</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">p&#123;font-family:&quot;Times New Roman&quot;, Times, serif;&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="文本修饰"><a href="#文本修饰" class="headerlink" title="文本修饰"></a>文本修饰</h2><p>属性为<code>text-decoration</code>，值：</p>
<ul>
<li><p><code>overline</code>：上划线</p>
</li>
<li><p><code>underline</code>：下划线</p>
</li>
<li><code>line-through</code>：删除线</li>
</ul>
<h2 id="间距"><a href="#间距" class="headerlink" title="间距"></a>间距</h2><ul>
<li>行间距：<code>line-height</code></li>
<li>字距：<code>letter-spacing</code></li>
<li>单词之间的距离：<code>word-spacing</code></li>
</ul>
<h2 id="对齐方式"><a href="#对齐方式" class="headerlink" title="对齐方式"></a>对齐方式</h2><p>属性为<code>text-align</code>：</p>
<ul>
<li><code>center</code>：局中</li>
<li><code>left</code>：左对齐</li>
<li><code>right</code>：右对齐</li>
<li><code>justify</code>：每一行被展开为宽度相等，左，右外边距是对齐</li>
</ul>
<h2 id="文本转换"><a href="#文本转换" class="headerlink" title="文本转换"></a>文本转换</h2><p><code>text-transform</code>：</p>
<ul>
<li><code>uppercase</code>：大写</li>
<li><code>lowercase</code>：小写</li>
<li><code>capitalize</code>：每个单词的首字母大写。</li>
</ul>
<h2 id="文本缩进"><a href="#文本缩进" class="headerlink" title="文本缩进"></a>文本缩进</h2><p>指定文本的第一行的缩进：</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">p</span> &#123;<span class="attribute">text-indent</span>:<span class="number">50px</span>;&#125;</span><br></pre></td></tr></table></figure>
<h2 id="文本方向"><a href="#文本方向" class="headerlink" title="文本方向"></a>文本方向</h2><p><code>direction</code>：</p>
<ul>
<li><code>rtl</code>：从右到左</li>
</ul>
<h2 id="禁用自动换行"><a href="#禁用自动换行" class="headerlink" title="禁用自动换行"></a>禁用自动换行</h2><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">p</span> &#123;<span class="attribute">white-space</span>:nowrap;&#125;</span><br></pre></td></tr></table></figure>
<h2 id="图片与文字的对齐"><a href="#图片与文字的对齐" class="headerlink" title="图片与文字的对齐"></a>图片与文字的对齐</h2><p><code>vertical-align</code>:</p>
<ul>
<li><code>text-top</code>：顶端对齐</li>
<li><code>text-bottom</code>：底端对齐</li>
</ul>
<h2 id="文本阴影"><a href="#文本阴影" class="headerlink" title="文本阴影"></a>文本阴影</h2><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">h1</span> &#123;<span class="attribute">text-shadow</span>:<span class="number">2px</span> <span class="number">2px</span> <span class="number">#FF0000</span>;&#125;</span><br></pre></td></tr></table></figure>
<h1 id="CSS背景"><a href="#CSS背景" class="headerlink" title="CSS背景"></a>CSS背景</h1><h2 id="背景颜色"><a href="#背景颜色" class="headerlink" title="背景颜色"></a>背景颜色</h2><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">body</span> &#123;<span class="attribute">background-color</span>:<span class="number">#b0c4de</span>;&#125;</span><br></pre></td></tr></table></figure>
<h2 id="背景图像"><a href="#背景图像" class="headerlink" title="背景图像"></a>背景图像</h2><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">body</span> &#123;<span class="attribute">background-image</span>:<span class="built_in">url</span>(<span class="string">&#x27;paper.gif&#x27;</span>);&#125;</span><br></pre></td></tr></table></figure>
<h3 id="平铺"><a href="#平铺" class="headerlink" title="平铺"></a>平铺</h3><ul>
<li>属性为<code>background-repeat</code>，默认情况下，背景图像进行平铺重复显示，以覆盖整个元素实体：<ul>
<li><code>no-repeat</code>：不平铺</li>
<li><code>repeat-x</code>：水平平铺</li>
<li><code>repeat-y</code>：垂直平铺</li>
</ul>
</li>
</ul>
<h3 id="定位"><a href="#定位" class="headerlink" title="定位"></a>定位</h3><ul>
<li>属性为<code>background-position</code>:<ul>
<li>用坐标的形式：<code>50px 50px</code></li>
<li>直接用方向：<code>right top</code></li>
<li>居中：<code>center</code>，x居中可以用<code>0 center</code>，反之<code>center 0</code></li>
</ul>
</li>
</ul>
<h3 id="大小"><a href="#大小" class="headerlink" title="大小"></a>大小</h3><p>属性为<code>background-size</code>，可以设置长宽，也可以使用%缩放，不能简写</p>
<h3 id="简写"><a href="#简写" class="headerlink" title="简写"></a>简写</h3><p>当使用简写属性时，属性值的顺序为：</p>
<ul>
<li><p>background-color</p>
</li>
<li><p>background-image</p>
</li>
<li><p>background-repeat</p>
</li>
<li><p>background-attachment</p>
</li>
<li><p>background-position</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">body</span> &#123;<span class="attribute">background</span>:<span class="number">#ffffff</span> <span class="built_in">url</span>(<span class="string">&#x27;img_tree.png&#x27;</span>) no-repeat right top;&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h1 id="CSS边框"><a href="#CSS边框" class="headerlink" title="CSS边框"></a>CSS边框</h1><h2 id="样式"><a href="#样式" class="headerlink" title="样式"></a>样式</h2><p>属性为<code>border-style</code>：</p>
<ul>
<li><code>solid</code>：实线边框</li>
<li><code>dashed</code>：虚线边框</li>
<li><code>dotted</code>：点线边框</li>
<li><code>double</code>：两个边框。 两个边框的宽度和 border-width 的值相同</li>
<li><code>groove</code>、<code>ridge</code>、<code>inset</code>、<code>outset</code>：3D沟槽边框、脊边框、嵌入边框、突出边框。效果取决于边框的颜色值</li>
</ul>
<p>值的数目：</p>
<ul>
<li>一个：所有</li>
<li>两个：上下，左右</li>
<li>三个：上，左右，下</li>
<li>四个：上，右，下，左</li>
</ul>
<h2 id="边框宽度"><a href="#边框宽度" class="headerlink" title="边框宽度"></a>边框宽度</h2><p>属性<code>border-width</code>：</p>
<ul>
<li>可以指定长度值，比如 2px 或 0.1em(单位为 px, pt, cm, em 等)，</li>
<li>使用 3 个关键字之一，它们分别是 thick 、medium（默认值） 和 thin。</li>
</ul>
<h2 id="边框颜色"><a href="#边框颜色" class="headerlink" title="边框颜色"></a>边框颜色</h2><p><code>border-color</code>属性，单独使用是不起作用的，必须得先使用border-style来设置边框样式。</p>
<h2 id="单独设置各边"><a href="#单独设置各边" class="headerlink" title="单独设置各边"></a>单独设置各边</h2><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">p</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="attribute">border-top-style</span>:dotted;</span><br><span class="line">    <span class="attribute">border-right-style</span>:solid;</span><br><span class="line">    <span class="attribute">border-bottom-style</span>:dotted;</span><br><span class="line">    <span class="attribute">border-left-style</span>:solid;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="简写属性"><a href="#简写属性" class="headerlink" title="简写属性"></a>简写属性</h2><p>简写：</p>
<ul>
<li>border-width</li>
<li>border-style (required)</li>
<li>border-color</li>
</ul>
<figure class="highlight scss"><table><tr><td class="code"><pre><span class="line"><span class="attribute">border</span>:<span class="number">5px</span> solid red;</span><br></pre></td></tr></table></figure>
<p>如果只需要一边，则使用<code>border-left</code>、<code>border-right</code>等即可</p>
<h1 id="CSS-显示-display"><a href="#CSS-显示-display" class="headerlink" title="CSS 显示 display"></a>CSS 显示 display</h1><h2 id="更改元素属性"><a href="#更改元素属性" class="headerlink" title="更改元素属性"></a>更改元素属性</h2><p>可以通过<code>display</code>属性来改变改变一个元素显示：</p>
<ul>
<li><code>block</code>（块状）</li>
<li><code>inline</code>（行内）</li>
<li><code>inline-block</code>（行内块状）</li>
</ul>
<h2 id="隐藏"><a href="#隐藏" class="headerlink" title="隐藏"></a>隐藏</h2><ul>
<li><p><code>display:none</code>：可以隐藏某个元素，且隐藏的元素不会占用任何空间</p>
</li>
<li><p><code>visibility:hidden</code>：可以隐藏某个元素，但隐藏的元素仍需占用与未隐藏之前一样的空间。也就是说，该元素虽然被隐藏了，但仍然会影响布局。</p>
</li>
</ul>
<h1 id="CSS-浮动-float"><a href="#CSS-浮动-float" class="headerlink" title="CSS 浮动 float"></a>CSS 浮动 float</h1><p>一个浮动元素会尽量向左或向右移动，直到它的外边缘碰到包含框或另一个浮动框的边框为止。</p>
<h1 id="CSS边距-填充"><a href="#CSS边距-填充" class="headerlink" title="CSS边距/填充"></a>CSS边距/填充</h1><h2 id="边距"><a href="#边距" class="headerlink" title="边距"></a>边距</h2><p>定义元素周围的空间</p>
<figure class="highlight scss"><table><tr><td class="code"><pre><span class="line"><span class="attribute">margin-top</span>:<span class="number">100px</span>;</span><br><span class="line"><span class="attribute">margin-bottom</span>:<span class="number">100px</span>;</span><br><span class="line"><span class="attribute">margin-right</span>:<span class="number">50px</span>;</span><br><span class="line"><span class="attribute">margin-left</span>:<span class="number">50px</span>;</span><br></pre></td></tr></table></figure>
<h2 id="简写-1"><a href="#简写-1" class="headerlink" title="简写"></a>简写</h2><ul>
<li><code>margin:25px 50px 75px 100px;</code>分别是上，右，下，左</li>
<li><code>margin:25px 50px 75px;</code>分别是上，左右，下</li>
<li><code>margin:25px 50px;</code>分别是上下、左右</li>
<li><code>margin:25px;</code>所有边距</li>
</ul>
<p>可以利用<code>margin:0 auto;</code>将元素居中。</p>
<h2 id="填充"><a href="#填充" class="headerlink" title="填充"></a>填充</h2><p>上下左右的内边距，同<code>margin</code>一样：</p>
<figure class="highlight scss"><table><tr><td class="code"><pre><span class="line"><span class="attribute">padding-top</span>:<span class="number">25px</span>;</span><br><span class="line"><span class="attribute">padding-bottom</span>:<span class="number">25px</span>;</span><br><span class="line"><span class="attribute">padding-right</span>:<span class="number">50px</span>;</span><br><span class="line"><span class="attribute">padding-left</span>:<span class="number">50px</span>;</span><br></pre></td></tr></table></figure>
<ul>
<li>会影响元素的宽和高</li>
</ul>
]]></content>
      <categories>
        <category>网站</category>
      </categories>
      <tags>
        <tag>html</tag>
        <tag>CSS</tag>
      </tags>
  </entry>
  <entry>
    <title>【Linux】MobaXterm快捷方式</title>
    <url>/2020/02/10/MobaXterm%E5%BF%AB%E6%8D%B7%E6%96%B9%E5%BC%8F/</url>
    <content><![CDATA[<blockquote>
<p>标记：</p>
<p><del>已经熟练掌握的</del></p>
<p><strong>经常用到的</strong></p>
</blockquote>
<h1 id="文本处理"><a href="#文本处理" class="headerlink" title="文本处理"></a>文本处理</h1><ul>
<li>Ctrl+U   删除光标到行首</li>
<li>Ctrl+K   删除光标到行尾</li>
<li>Ctrl+W  剪切到当前单词开头</li>
<li><strong>Alt+D   剪切到当前单词词尾</strong></li>
<li><del>Ctrl+D   删除光标所在字符=Delete</del></li>
<li><del>Ctrl+H   删除光标前的字符=Backspace</del></li>
<li>Ctrl+Y   粘贴最后一次被删除的单词</li>
<li>Ctrl+7   恢复刚刚的内容</li>
<li>Ctrl+(X U)    撤销刚才的操作 </li>
<li>Ctrl+V   插入特殊字符,如Ctrl+(V Tab)加入Tab字符键</li>
<li><del>Shift+Insert 粘贴</del></li>
<li>鼠标中间滑轮 粘贴</li>
</ul>
<h1 id="交换"><a href="#交换" class="headerlink" title="交换"></a>交换</h1><ul>
<li>Ctrl+T   交换光标位置前的两个字符</li>
<li>Alt+T   颠倒光标相邻单词的位置=Esc+T</li>
</ul>
<h1 id="大小写"><a href="#大小写" class="headerlink" title="大小写"></a>大小写</h1><ul>
<li>Alt+C   将光标所在字符到词尾改为首字母大写</li>
<li>Alt+U   将光标所在字符到词尾转化为大写</li>
<li>Alt+L    将光标所在字符到词尾转化为小写</li>
</ul>
<h1 id="光标移动"><a href="#光标移动" class="headerlink" title="光标移动"></a>光标移动</h1><ul>
<li><del>Ctrl+A   光标移动到行首=home</del></li>
<li><del>Ctrl+E   光标移动到行尾=end</del></li>
<li>Alt+B   移到前一个单词首=ctrl+←</li>
<li>Alt+F    移到后一个单词尾=ctrl+→</li>
<li><del>Ctrl+F   向前一格=←</del></li>
<li><del>Ctrl+B   向后一格=→</del></li>
<li>Esc+B   移动到当前单词的开头</li>
<li>Esc+F   移动到当前单词的结尾</li>
<li>Ctrl+X X 在光标和行首切换</li>
</ul>
<h1 id="翻页"><a href="#翻页" class="headerlink" title="翻页"></a>翻页</h1><ul>
<li>Shift+UpArrow    向上滚屏</li>
<li>Shift+DownArrow  向下滚屏</li>
<li>Shift+PageUp 向上翻页</li>
<li>Shift+PageDown  向下翻页</li>
<li>Ctrl+L   清屏</li>
</ul>
<h1 id="命令相关"><a href="#命令相关" class="headerlink" title="命令相关"></a>命令相关</h1><ul>
<li>!!       执行上一条命令</li>
<li>!?String?     执行含有String字符串的最新命令</li>
<li>!$      以上一条命令的参数做为其参数\</li>
<li><del>Ctrl+C   取消当前行命令</del></li>
<li>Ctrl+P   显示上一条命令=↑</li>
<li>Ctrl+N   显示下一条命令=↓</li>
<li><del><strong>Ctrl+R   查找历史命令/继续向上检索</strong></del></li>
<li><del>Ctrl+O   =Enter</del></li>
<li><del>tab tab=esc esc esc=ctrl+I I  显示所有支持的命令</del></li>
<li>Alt+Shift+,   历史命令第一项</li>
</ul>
<h1 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h1><ul>
<li><del>Ctrl+M  最小化窗口</del></li>
</ul>
]]></content>
      <categories>
        <category>系统</category>
      </categories>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title>NBO</title>
    <url>/2020/11/27/NBO/</url>
    <content><![CDATA[<h1 id="运行方式"><a href="#运行方式" class="headerlink" title="运行方式"></a>运行方式</h1><h2 id="在Gaussian软件中运行"><a href="#在Gaussian软件中运行" class="headerlink" title="在Gaussian软件中运行"></a>在Gaussian软件中运行</h2><h3 id="Gaussian内置的NBO3-1"><a href="#Gaussian内置的NBO3-1" class="headerlink" title="Gaussian内置的NBO3.1"></a>Gaussian内置的NBO3.1</h3><p>在高斯关键词部分写入：</p>
<ul>
<li><code>pop=NPA</code>：做Natural Population Analysis （NPA）分析</li>
<li><code>pop=NBO</code>：做NPA和NBO分析</li>
<li><code>pop=saveNBOs</code>：在<code>pop=NBO</code>的基础上保存NBO轨道到chk文件中观看</li>
<li><code>pop=saveNLMOs</code>：在<code>pop=NBO</code>的基础上做NLMO分析，并且将NLMO轨道保存到chk文件中</li>
<li><code>pop=NCS</code>：结合<code>NMR</code>关键词，输出各个NLMO对磁屏蔽的贡献</li>
<li><code>pop=NBODel</code>：做NBO deletion分析</li>
<li><code>pop=NBOread</code>：代表从输出文件末尾倒数第二行（倒数第一行是空行）的<code>$NBO</code>与<code>$END</code>之间读取NBO的关键词：<ul>
<li>空的：默认做NBO和NPA分析</li>
<li><code>bndidx</code>：做键级分析</li>
<li><code>archive</code>：结合<code>File=</code>产生.47文件，包含坐标、基函数定义、轨道系数、密度矩阵、一些单电子积分。.47可以做作为NBO的输入文件。</li>
<li><code>plot file=AAA</code>：产生NBO plot文件，输出的文件前缀是AAA</li>
</ul>
</li>
</ul>
<h3 id="Gaussian结合更高版本的NBO"><a href="#Gaussian结合更高版本的NBO" class="headerlink" title="Gaussian结合更高版本的NBO"></a>Gaussian结合更高版本的NBO</h3><ul>
<li>Linux下：<ol>
<li>将Linux版NBO6压缩包解压到某目录XXX下</li>
<li>在~/.bashrc文件中加入<code>export PATH=$PATH:XXX/bin</code></li>
<li>将XXX/bin/gaunbo6中的setenv GAUNBO后面的内容改成g09nbo或g16nbo；将setenv BINDIR后面的内容改为XXX/bin目录</li>
<li>重新进入终端即可。</li>
</ol>
</li>
<li>然后直接在Gaussian输入文件中使用诸如<code>Pop=NPA6</code>，<code>Pop=NBO6</code>， <code>Pop=NBO6Read</code>和<code>Pop=NBO6Delete</code>，<code>pop=(nbo6,savenlmos)</code>，<code>pop=(nbo6,savenbos)</code>等关键词调用（如果是NBO7，将6改成7即可）</li>
</ul>
<h3 id="常用"><a href="#常用" class="headerlink" title="常用"></a>常用</h3><ul>
<li><p>计算NBO中的WBI键级，产生输出文件，计算AdNDP所需要的log文件，保存NLMO轨道：</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line"><span class="comment"># pop(nbo6read,savenlmos)</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$NBO</span> bndidx archive DMNAO AONAO <span class="attribute">File</span>=XXX  <span class="variable">$END</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>计算AdNDP所需要的log文件：</p>
<figure class="highlight autoit"><table><tr><td class="code"><pre><span class="line"><span class="meta">#pop=nbo6read</span></span><br><span class="line"></span><br><span class="line"> $NBO DMNAO AONAO $END</span><br></pre></td></tr></table></figure>
</li>
<li><p>保存NLMO轨道:</p>
<figure class="highlight lisp"><table><tr><td class="code"><pre><span class="line"># pop=(<span class="name">nbo6</span>,savenlmos)</span><br></pre></td></tr></table></figure>
</li>
<li><p>PIO中需要的：</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line"><span class="comment">#pop=nbo6read</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$NBO</span> <span class="attribute">AONAO</span>=W49 <span class="attribute">FNAO</span>=W49 <span class="attribute">DMNAO</span>=W49 SKIPBO <span class="attribute">file</span>=UCCe@C72_b3lyp_pio_C2_0_res  <span class="variable">$END</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="orca中的NBO"><a href="#orca中的NBO" class="headerlink" title="orca中的NBO"></a>orca中的NBO</h2><ul>
<li><p>修改环境变量，即在~/.bashrc中加入</p>
<figure class="highlight awk"><table><tr><td class="code"><pre><span class="line">export GENEXE XXX<span class="regexp">/bin/g</span>ennbo.i4.exe</span><br><span class="line">export NBOEXE XXX<span class="regexp">/bin/</span>nbo6.i4.exe</span><br></pre></td></tr></table></figure>
</li>
<li><p>在ORCA的输入文件中写入<code>NBO</code>关键词，ORCA会调用BO6做NPA和NBO分析</p>
<ul>
<li><p>可以通过<code>%nbo</code>进一步控制</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">%nbo</span><br><span class="line"><span class="attribute">NBOKEYLIST</span>=<span class="string">&quot;<span class="variable">$NBO</span>... <span class="variable">$END</span>&quot;</span></span><br><span class="line"><span class="attribute">DELKEYLIST</span>=<span class="string">&quot;<span class="variable">$DEL</span>... <span class="variable">$END</span>&quot;</span></span><br><span class="line"><span class="attribute">COREKEYLIST</span>=<span class="string">&quot;<span class="variable">$CORE</span>... <span class="variable">$END</span>&quot;</span></span><br><span class="line"><span class="attribute">NRTSTRKEYLIST</span>=<span class="string">&quot;<span class="variable">$NRTSTR</span>... <span class="variable">$END</span>&quot;</span></span><br><span class="line">end</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>会产生.47文件，产生的.nbo文件实际上是.gbw文件，可以转换成molden文件观看轨道。</p>
</li>
</ul>
<h2 id="ADF中的NBO"><a href="#ADF中的NBO" class="headerlink" title="ADF中的NBO"></a>ADF中的NBO</h2><p>直接在windows下：</p>
<ul>
<li>优化好的结构，再算single point，注意此时<code>Fronzen Core</code>要设置为<code>none</code></li>
<li>Properties→Localized Orbitals,NBO中勾选Perform NBO analysis，Locailized orbitals中选择Boys-Foseter</li>
<li>Deltals →Accuracy中勾选Full Fock matrics的Always，提交计算即可</li>
<li>如果需要可视化轨道，则在输出中Select Field 选择NBOs即可查看各个NBO轨道的空间分布</li>
</ul>
<h2 id="通过gennbo直接调用程序"><a href="#通过gennbo直接调用程序" class="headerlink" title="通过gennbo直接调用程序"></a>通过gennbo直接调用程序</h2><ul>
<li>将gennbo所在的目录XXX/nbo6/添加到环境变量</li>
<li>通过在Gaussian产生的.47文件第二行的<code>$NBO</code>与<code>$END</code>之间插入关键词，通过<code>gennbo AAAA.47</code>即可进行计算，输出结果会输出AAAA.nbo中。</li>
</ul>
<h2 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h2><h3 id="密度矩阵"><a href="#密度矩阵" class="headerlink" title="密度矩阵"></a>密度矩阵</h3><p>NBO程序做的各种分析主要都是基于密度矩阵。在Gaussian中使用后HF方法或者使用CIS、TDDFT计算激发态时，计算时一定要<code>density</code>关键词</p>
<ul>
<li>后HF方法传递给NBO模块当前级别的密度矩阵。如果不写<code>density</code>关键词，则传递给NBO模块的是HF级别的密度矩阵，分析结果也因此是HF级别的。</li>
<li>计算激发态传递给NBO模块的才是用root指定的激发态的密度矩阵，从而分析的是激发态特征。如果不写<code>density</code>，则CIS、TDDFT任务会把参考态（即基态的HF、DFT波函数）的密度矩阵传递给NBO模块，因此分析结果也是基态的。</li>
</ul>
<h3 id="计算级别"><a href="#计算级别" class="headerlink" title="计算级别"></a>计算级别</h3><ul>
<li>用弥散函数对NBO的分析没有不良影响，也没有改进。</li>
</ul>
<h3 id="几何优化时"><a href="#几何优化时" class="headerlink" title="几何优化时"></a>几何优化时</h3><ul>
<li>在Gaussian中，如果opt和NBO分析的关键词同时存在，会先对初始结构进行一次NBO分析，再对最终结构进行一次NBO分析</li>
<li>如果希望在几何优化，势能面扫描和IRC等多步任务中每一步都调用NBO，需要使用关键词<code>pop(always,nbo6)</code></li>
</ul>
<h1 id="各种关键词和功能"><a href="#各种关键词和功能" class="headerlink" title="各种关键词和功能"></a>各种关键词和功能</h1><h2 id="内存MEMORY"><a href="#内存MEMORY" class="headerlink" title="内存MEMORY"></a>内存<code>MEMORY</code></h2><p>按字、兆、兆字节或千兆字节分配动态内存，比如分配1G的内存可以用：</p>
<figure class="highlight ini"><table><tr><td class="code"><pre><span class="line"><span class="attr">MEMORY</span>=<span class="number">134217728</span></span><br><span class="line"><span class="attr">MEMORY</span>=<span class="number">134</span>mw</span><br><span class="line"><span class="attr">MEMORY</span>=<span class="number">1024</span>mb</span><br><span class="line"><span class="attr">MEMORY</span>=<span class="number">1</span>gb</span><br></pre></td></tr></table></figure>
<h2 id="键级分析bndidx"><a href="#键级分析bndidx" class="headerlink" title="键级分析bndidx"></a>键级分析<code>bndidx</code></h2><ul>
<li>用了bndidx关键词后，NBO程序会进行键级分析，输出三种键级矩阵，包括：<ul>
<li><code>Wiberg bond index matrix in the NAO basis</code>，这是三种键级中唯一推荐的键级。</li>
<li><code>Atom-atom overlap-weighted NAO bond order</code>，缺乏依据，实际结果又差，所以不要使用。</li>
<li>MO bond order毫无意义</li>
</ul>
</li>
</ul>
<h2 id="绘图plot"><a href="#绘图plot" class="headerlink" title="绘图plot"></a>绘图<code>plot</code></h2><figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line"><span class="variable">$NBO</span> plot <span class="attribute">file</span>=XXXXX <span class="variable">$END</span></span><br></pre></td></tr></table></figure>
<ul>
<li>运行后就会有一批NBO plot文件*.31、*.32 … *.41在c:\ltwd下面生成:<ul>
<li><em>.31文件储存的是基函数信息，\</em>.41是密度矩阵信息，对绘制轨道没直接用处。</li>
<li>*.32（PNAO）、*.33（NAO）、*.34（PNHO）、*.35（NHO）、*.36（PNBO）、*.37（NBO）、*.38（PNLMO）、*.39（NLMO）、*.40（MO）分别储存了相应的展开系数信息</li>
</ul>
</li>
<li>通过Multiwfn载入<em>.31文件后，再输入\</em>.32~*.40文件中的一个绘制相应的轨道。</li>
</ul>
<h2 id="自然共振理论分析NRT"><a href="#自然共振理论分析NRT" class="headerlink" title="自然共振理论分析NRT"></a>自然共振理论分析<code>NRT</code></h2><h3 id="输入"><a href="#输入" class="headerlink" title="输入"></a>输入</h3><p>两种关键词指定</p>
<ul>
<li>在.47文件中<code>$NBO</code>和<code>$END</code>之间写上<code>NRT</code>关键词即可</li>
<li><code>NRTCML</code>或<code>NRTCML=n</code>：把所有贡献大于1%或n%的共振结构式一起输出到FIlename-nrt.cml中,可以直接用<strong>MarvinView观看</strong>。<ul>
<li>注意，MarvinView中应选择View→Implicit→Hydrogens→Off，否则会自动显示一些不该存在的氢。</li>
</ul>
</li>
</ul>
<p>其他<code>$NBO</code>和<code>$END</code>之间的关键词：</p>
<ul>
<li><code>NRTLST=n</code>：将权重大于<code>n</code>的结构输出在<code>$NRTSTR</code>部分。默认情况下仅打印参考结果。</li>
<li><code>NRT &lt;atom-1 atom-2 ... atom-n&gt;</code>：在NRT关键词后面的尖括号里写上共振分析要考虑的原子范围即可进行<strong>局部的NRT分析</strong>。</li>
<li><code>NRTFDM</code>：指定全密度矩阵计算多参考NRT。默认是关闭的，如果NBO检测到需要会提示，所以一般不用开。</li>
</ul>
<p>其他模块：</p>
<p>NBO轨道自动搜索结果随结构变化不是连续的，对于通过NRT考察化学过程电子结构的变化，为了满足分析数据的连贯性有意义，需要指定<code>NRTSTR</code>。</p>
<p>比如化学反应可以视为体系的电子结构是从反应物的Lewis结构平滑过渡到产物Lewis结构的。对过渡态结构，以及IRC路径上一系列点做NRT分析，应当在输入文件里通过$<code>NRTSTR</code>字段直接给出反应物和产物的Lewis结构定义作为参考结构，而不能让NBO自动判断，否则IRC上一系列点的NRT分析结果会突变（比如参考Lewis结构权重的变化曲线）。</p>
<ul>
<li><p><code>$NRTSTR……$END</code>：在输入文件里指定了<code>$NRTSTR</code>字段，则NRT分析时会直接利用这些参考Lewis结构，而不会尝试自动搜索和判断。格式和<code>$CHOOSE</code>基本相同：</p>
<ul>
<li><p>第一行是<code>$NRTSTR</code>，最后一行是<code>$END</code>。注意开壳层要分别指定α和β电子，用<code>$NRTSTRA</code>和<code>$NRTSTRB</code>代替<code>$NRTSTR</code></p>
</li>
<li><p>中间是用<code>STRUCTURE</code>或者<code>STR</code>和<code>END</code>封装的，用<code>LONE</code>和<code>BOND</code>指定每个共振结构的所有价电子孤对和键的完整说明（注意忽略内层轨道），不像<code>$CHOOSE</code>支持<code>CBOND</code></p>
</li>
<li><p>最好放在<code>$NBO</code>、<code>$CORE</code>、<code>$CHOOSE</code>模块之后，<code>$DEL</code>模块之前NRTSTR，而且对于开壳层，不能同时存在<code>$CHOOSE</code>和<code>$NRTSTR</code></p>
</li>
<li><p>eg.</p>
<p><img src="image-20201130224813391.png" alt=""></p>
</li>
</ul>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">$NRTSTR</span><br><span class="line">	STR1 ! C1 anion center</span><br><span class="line">		LONE <span class="number">1</span> <span class="number">1</span> END</span><br><span class="line">		BOND S <span class="number">1</span> <span class="number">2</span> S <span class="number">1</span> <span class="number">4</span> S <span class="number">1</span> <span class="number">5</span> D <span class="number">2</span> <span class="number">3</span> S <span class="number">2</span> <span class="number">6</span> S <span class="number">3</span> <span class="number">7</span> S <span class="number">3</span> <span class="number">8</span> END</span><br><span class="line">	END</span><br><span class="line">	STR2 ! C3 anion center</span><br><span class="line">		LONE <span class="number">3</span> <span class="number">1</span> END</span><br><span class="line">		BOND D <span class="number">1</span> <span class="number">2</span> S <span class="number">1</span> <span class="number">4</span> S <span class="number">1</span> <span class="number">5</span> S <span class="number">2</span> <span class="number">3</span> S <span class="number">2</span> <span class="number">6</span> S <span class="number">3</span> <span class="number">7</span> S <span class="number">3</span> <span class="number">8</span> END</span><br><span class="line">	END</span><br><span class="line">$END</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="输出例子"><a href="#输出例子" class="headerlink" title="输出例子"></a>输出例子</h3><h4 id="烯丙基自由基开壳层计算出的alpha电子"><a href="#烯丙基自由基开壳层计算出的alpha电子" class="headerlink" title="烯丙基自由基开壳层计算出的alpha电子"></a>烯丙基自由基开壳层计算出的alpha电子</h4><p><img src="image-20201130221142052.png" style="zoom:50%;" /></p>
<ul>
<li>第3行和第4行表示最多允许的参考Lewis结构和全部Lewis结构的数目</li>
<li>第5行当前任务需要多少内存</li>
<li>第10~12行表示当前体系共发现3个参考Lewis结构（有一定的多中心离域性，因此一种结构无法描述）</li>
<li>第13~15行：<ul>
<li><code>rho*</code>表示主导的参考Lewis结构的non-Lewis电子为0.04795</li>
<li><code>f(w)</code>表示基于这个参考Lewis结构再考虑其它二级Lewis结构后对体系的描述比起只考虑当前一种Lewis结构时的改进。越接近1改进越大（共振效应越显著），越接近0改进越小。</li>
</ul>
</li>
<li>第17行中：<ul>
<li><code>D(W)</code>只考虑这三种参考Lewis结构并变分优化其系数后剩下的残值。越小说明靠这些参考Lewis结构就越已经足够描述实际电子结构了</li>
<li><code>F(W)</code>：在参考Lewis结构基础上再考虑其它二级Lewis结构后对体系电子结构描述的改进程度</li>
</ul>
</li>
</ul>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">NATURAL</span> RESONANCE THEORY ANALYSIS, alpha spin:</span><br><span class="line"></span><br><span class="line"><span class="attribute">Maximum</span> reference structures : <span class="number">20</span></span><br><span class="line"><span class="attribute">Maximum</span> resonance structures : <span class="number">5000</span></span><br><span class="line"><span class="attribute">Memory</span> requirements : <span class="number">89064896</span> words of <span class="number">99790766</span> available</span><br><span class="line"></span><br><span class="line"><span class="attribute">7</span> candidate reference structure(s) calculated by SR LEWIS</span><br><span class="line"><span class="attribute">0</span> candidate reference structure(s) added by SR HBRES</span><br><span class="line"><span class="attribute">Initial</span> loops searched <span class="number">9</span> bonding pattern(s); <span class="number">3</span> were retained</span><br><span class="line"><span class="attribute">Delocalization</span> list threshold set to <span class="number">0</span>.<span class="number">50</span> kcal/mol for reference <span class="number">1</span></span><br><span class="line"><span class="attribute">Delocalization</span> list threshold set to <span class="number">0</span>.<span class="number">50</span> kcal/mol for reference <span class="number">2</span></span><br><span class="line"><span class="attribute">Delocalization</span> list threshold set to <span class="number">0</span>.<span class="number">50</span> kcal/mol for reference <span class="number">3</span></span><br><span class="line"><span class="attribute">Reference</span>   <span class="number">1</span>:  rho*=<span class="number">0</span>.<span class="number">17534</span>, f(w)=<span class="number">0</span>.<span class="number">96619</span> converged after  <span class="number">22</span> iterations</span><br><span class="line"><span class="attribute">Reference</span>   <span class="number">2</span>:  rho*=<span class="number">0</span>.<span class="number">17534</span>, f(w)=<span class="number">0</span>.<span class="number">96619</span> converged after  <span class="number">22</span> iterations</span><br><span class="line"><span class="attribute">Reference</span>   <span class="number">3</span>:  rho*=<span class="number">0</span>.<span class="number">31532</span>, f(w)=<span class="number">0</span>.<span class="number">98329</span> converged after  <span class="number">22</span> iterations</span><br><span class="line"><span class="attribute">Multi</span>-ref( <span class="number">3</span>):  D(W)=<span class="number">0</span>.<span class="number">10221</span>, F(W)=<span class="number">0</span>.<span class="number">00000</span> converged after <span class="number">117</span> iterations</span><br><span class="line"><span class="attribute">1</span> reference structure has low weight (&lt;<span class="number">35</span>.<span class="number">0</span>% of <span class="number">41</span>.<span class="number">1</span>%); discarded</span><br><span class="line"><span class="attribute">Multi</span>-ref( <span class="number">2</span>):  D(W)=<span class="number">0</span>.<span class="number">10221</span>, F(W)=<span class="number">0</span>.<span class="number">00000</span> converged after   <span class="number">1</span> iterations</span><br></pre></td></tr></table></figure>
<ul>
<li>对这三种参考Lewis式通过严格变分得到的权重</li>
</ul>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">                                               fractional accuracy f(w)</span><br><span class="line">                 non-Lewis             -------------------------------------</span><br><span class="line"> Ref     Wgt      density      d(<span class="number">0</span>)      all NBOs     val+core     valence</span><br><span class="line">----------------------------------------------------------------------------</span><br><span class="line">  <span class="number">1</span>    <span class="number">0.50000</span>    <span class="number">0.17534</span>    <span class="number">0.02667</span>     <span class="number">0.96619</span>      <span class="number">0.97754</span>      <span class="number">0.97754</span></span><br><span class="line">  <span class="number">2</span>    <span class="number">0.50000</span>    <span class="number">0.17534</span>    <span class="number">0.02667</span>     <span class="number">0.96619</span>      <span class="number">0.97754</span>      <span class="number">0.97754</span></span><br></pre></td></tr></table></figure>
<ul>
<li>主导的参考Lewis结构对应的拓扑矩阵：<ul>
<li>非对角元是原子间形式键级</li>
<li>对角元是原子上的孤对电子数</li>
</ul>
</li>
</ul>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">TOPO matrix for the leading resonance structure:</span></span><br><span class="line"></span><br><span class="line">    <span class="string">Atom</span>  <span class="number">1</span>   <span class="number">2</span>   <span class="number">3</span>   <span class="number">4</span>   <span class="number">5</span>   <span class="number">6</span>   <span class="number">7</span>   <span class="number">8</span></span><br><span class="line">    <span class="string">----</span> <span class="string">---</span> <span class="string">---</span> <span class="string">---</span> <span class="string">---</span> <span class="string">---</span> <span class="string">---</span> <span class="string">---</span> <span class="string">---</span></span><br><span class="line">  <span class="number">1</span><span class="string">.</span>  <span class="string">C</span>   <span class="number">1</span>   <span class="number">1</span>   <span class="number">0</span>   <span class="number">1</span>   <span class="number">1</span>   <span class="number">0</span>   <span class="number">0</span>   <span class="number">0</span></span><br><span class="line">  <span class="number">2</span><span class="string">.</span>  <span class="string">C</span>   <span class="number">1</span>   <span class="number">0</span>   <span class="number">2</span>   <span class="number">0</span>   <span class="number">0</span>   <span class="number">1</span>   <span class="number">0</span>   <span class="number">0</span></span><br><span class="line">  <span class="number">3</span><span class="string">.</span>  <span class="string">C</span>   <span class="number">0</span>   <span class="number">2</span>   <span class="number">0</span>   <span class="number">0</span>   <span class="number">0</span>   <span class="number">0</span>   <span class="number">1</span>   <span class="number">1</span></span><br><span class="line">  <span class="number">4</span><span class="string">.</span>  <span class="string">H</span>   <span class="number">1</span>   <span class="number">0</span>   <span class="number">0</span>   <span class="number">0</span>   <span class="number">0</span>   <span class="number">0</span>   <span class="number">0</span>   <span class="number">0</span></span><br><span class="line">  <span class="number">5</span><span class="string">.</span>  <span class="string">H</span>   <span class="number">1</span>   <span class="number">0</span>   <span class="number">0</span>   <span class="number">0</span>   <span class="number">0</span>   <span class="number">0</span>   <span class="number">0</span>   <span class="number">0</span></span><br><span class="line">  <span class="number">6</span><span class="string">.</span>  <span class="string">H</span>   <span class="number">0</span>   <span class="number">1</span>   <span class="number">0</span>   <span class="number">0</span>   <span class="number">0</span>   <span class="number">0</span>   <span class="number">0</span>   <span class="number">0</span></span><br><span class="line">  <span class="number">7</span><span class="string">.</span>  <span class="string">H</span>   <span class="number">0</span>   <span class="number">0</span>   <span class="number">1</span>   <span class="number">0</span>   <span class="number">0</span>   <span class="number">0</span>   <span class="number">0</span>   <span class="number">0</span></span><br><span class="line">  <span class="number">8</span><span class="string">.</span>  <span class="string">H</span>   <span class="number">0</span>   <span class="number">0</span>   <span class="number">1</span>   <span class="number">0</span>   <span class="number">0</span>   <span class="number">0</span>   <span class="number">0</span>   <span class="number">0</span></span><br></pre></td></tr></table></figure>
<ul>
<li>第一列中有星号的是参考Lewis结构，权重非常小的Lewis结构直接合并显示其权重总和</li>
<li>第二列是各个Lewis结构的最终的权重</li>
<li>相对于主导的参考Lewis结构的拓扑关系的变化<ul>
<li>没加括号的是增加的项</li>
<li>有括号的是程除的项</li>
<li>单个原于的项是指给其增加一个或去掉一个电子</li>
</ul>
</li>
</ul>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">        Resonance</span><br><span class="line">   RS   Weight(%)                  Added(Removed)</span><br><span class="line">---------------------------------------------------------------------------</span><br><span class="line">   <span class="number">1</span>*     <span class="number">48.55</span></span><br><span class="line">   <span class="number">2</span>*     <span class="number">48.55</span>    C  <span class="number">1</span>- C  <span class="number">2</span>, ( C  <span class="number">2</span>- C  <span class="number">3</span>), ( C  <span class="number">1</span>),  C  <span class="number">3</span></span><br><span class="line">   <span class="number">3</span>       <span class="number">0.19</span>    C  <span class="number">1</span>- C  <span class="number">2</span>, ( C  <span class="number">1</span>- H  <span class="number">4</span>), ( C  <span class="number">2</span>- C  <span class="number">3</span>),  C  <span class="number">3</span></span><br><span class="line">   <span class="number">4</span>       <span class="number">0.19</span>   ( C  <span class="number">1</span>- C  <span class="number">2</span>),  C  <span class="number">2</span>- C  <span class="number">3</span>, ( C  <span class="number">3</span>- H  <span class="number">8</span>),  C  <span class="number">1</span></span><br><span class="line">   <span class="number">5</span>       <span class="number">0.19</span>    C  <span class="number">1</span>- C  <span class="number">2</span>,  C  <span class="number">1</span>- C  <span class="number">2</span>, ( C  <span class="number">1</span>- H  <span class="number">4</span>), ( C  <span class="number">2</span>- C  <span class="number">3</span>),</span><br><span class="line">                  ( C  <span class="number">2</span>- C  <span class="number">3</span>), ( C  <span class="number">1</span>),  C  <span class="number">3</span>,  C  <span class="number">3</span></span><br><span class="line">   <span class="number">6</span>       <span class="number">0.19</span>   ( C  <span class="number">3</span>- H  <span class="number">8</span>),  C  <span class="number">3</span></span><br><span class="line">   <span class="number">7</span>       <span class="number">0.19</span>    C  <span class="number">1</span>- C  <span class="number">2</span>, ( C  <span class="number">1</span>- H  <span class="number">5</span>), ( C  <span class="number">2</span>- H  <span class="number">6</span>),  H  <span class="number">5</span></span><br><span class="line">   <span class="number">8</span>       <span class="number">0.19</span>    C  <span class="number">2</span>- C  <span class="number">3</span>, ( C  <span class="number">2</span>- H  <span class="number">6</span>), ( C  <span class="number">3</span>- H  <span class="number">7</span>),  H  <span class="number">7</span></span><br><span class="line">   <span class="number">9</span>       <span class="number">0.19</span>    C  <span class="number">1</span>- C  <span class="number">2</span>,  C  <span class="number">1</span>- C  <span class="number">2</span>, ( C  <span class="number">1</span>- H  <span class="number">5</span>), ( C  <span class="number">2</span>- C  <span class="number">3</span>),</span><br><span class="line">                  ( C  <span class="number">2</span>- H  <span class="number">6</span>), ( C  <span class="number">1</span>),  C  <span class="number">3</span>,  H  <span class="number">5</span></span><br><span class="line">  <span class="number">10</span>       <span class="number">0.19</span>    C  <span class="number">1</span>- C  <span class="number">2</span>, ( C  <span class="number">2</span>- H  <span class="number">6</span>), ( C  <span class="number">3</span>- H  <span class="number">7</span>), ( C  <span class="number">1</span>),</span><br><span class="line">                   C  <span class="number">3</span>,  H  <span class="number">7</span></span><br><span class="line">  <span class="number">11</span>       <span class="number">0.19</span>    C  <span class="number">1</span>- C  <span class="number">2</span>, ( C  <span class="number">1</span>- H  <span class="number">5</span>), ( C  <span class="number">2</span>- H  <span class="number">6</span>),  H  <span class="number">6</span></span><br><span class="line">  <span class="number">12</span>       <span class="number">0.19</span>    C  <span class="number">2</span>- C  <span class="number">3</span>, ( C  <span class="number">2</span>- H  <span class="number">6</span>), ( C  <span class="number">3</span>- H  <span class="number">7</span>),  H  <span class="number">6</span></span><br><span class="line">  <span class="number">13</span>       <span class="number">0.19</span>    C  <span class="number">1</span>- C  <span class="number">2</span>,  C  <span class="number">1</span>- C  <span class="number">2</span>, ( C  <span class="number">1</span>- H  <span class="number">5</span>), ( C  <span class="number">2</span>- C  <span class="number">3</span>),</span><br><span class="line">                  ( C  <span class="number">2</span>- H  <span class="number">6</span>), ( C  <span class="number">1</span>),  C  <span class="number">3</span>,  H  <span class="number">6</span></span><br><span class="line">  <span class="number">14</span>       <span class="number">0.19</span>    C  <span class="number">1</span>- C  <span class="number">2</span>, ( C  <span class="number">2</span>- H  <span class="number">6</span>), ( C  <span class="number">3</span>- H  <span class="number">7</span>), ( C  <span class="number">1</span>),</span><br><span class="line">                   C  <span class="number">3</span>,  H  <span class="number">6</span></span><br><span class="line">  <span class="number">15</span>       <span class="number">0.10</span>   ( C  <span class="number">1</span>- C  <span class="number">2</span>),  C  <span class="number">2</span>- C  <span class="number">3</span>, ( C  <span class="number">3</span>- H  <span class="number">8</span>),  H  <span class="number">8</span></span><br><span class="line">  <span class="number">16</span>       <span class="number">0.10</span>    C  <span class="number">1</span>- C  <span class="number">2</span>, ( C  <span class="number">1</span>- H  <span class="number">4</span>), ( C  <span class="number">2</span>- C  <span class="number">3</span>),  H  <span class="number">4</span></span><br><span class="line">  <span class="number">17</span>       <span class="number">0.10</span>   ( C  <span class="number">3</span>- H  <span class="number">8</span>), ( C  <span class="number">1</span>),  C  <span class="number">3</span>,  H  <span class="number">8</span></span><br><span class="line">  <span class="number">18</span>       <span class="number">0.10</span>    C  <span class="number">1</span>- C  <span class="number">2</span>,  C  <span class="number">1</span>- C  <span class="number">2</span>, ( C  <span class="number">1</span>- H  <span class="number">4</span>), ( C  <span class="number">2</span>- C  <span class="number">3</span>),</span><br><span class="line">                  ( C  <span class="number">2</span>- C  <span class="number">3</span>), ( C  <span class="number">1</span>),  C  <span class="number">3</span>,  H  <span class="number">4</span></span><br><span class="line">  <span class="number">19</span><span class="number">-26</span>    <span class="number">0.22</span></span><br><span class="line">---------------------------------------------------------------------------</span><br><span class="line">         <span class="number">100.00</span>   * Total *                [* = <span class="built_in">ref</span>erence structure]</span><br></pre></td></tr></table></figure>
<ul>
<li>对角元代表平均携带的孤对电子数</li>
<li>非对角元代表两个原子之间的NRT键级、共价和离子的贡献。（由于只有一个自旋的结果，大约是期望值的一半）</li>
</ul>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">Natural Bond Order:</span>  <span class="string">(total/covalent/ionic)</span></span><br><span class="line"></span><br><span class="line">    <span class="string">Atom</span>       <span class="number">1</span>      <span class="number">2</span>      <span class="number">3</span>      <span class="number">4</span>      <span class="number">5</span>      <span class="number">6</span>      <span class="number">7</span>      <span class="number">8</span></span><br><span class="line">    <span class="string">----</span>   <span class="string">------</span> <span class="string">------</span> <span class="string">------</span> <span class="string">------</span> <span class="string">------</span> <span class="string">------</span> <span class="string">------</span> <span class="string">------</span></span><br><span class="line">  <span class="number">1</span><span class="string">.</span>  <span class="string">C</span>  <span class="string">t</span> <span class="number">0.2523</span> <span class="number">0.7529</span> <span class="number">0.0000</span> <span class="number">0.4970</span> <span class="number">0.4962</span> <span class="number">0.0000</span> <span class="number">0.0000</span> <span class="number">0.0000</span></span><br><span class="line">         <span class="string">c</span>   <span class="string">---</span>  <span class="number">0.5616</span> <span class="number">0.0000</span> <span class="number">0.3795</span> <span class="number">0.3817</span> <span class="number">0.0000</span> <span class="number">0.0000</span> <span class="number">0.0000</span></span><br><span class="line">         <span class="string">i</span>   <span class="string">---</span>  <span class="number">0.1912</span> <span class="number">0.0000</span> <span class="number">0.1176</span> <span class="number">0.1145</span> <span class="number">0.0000</span> <span class="number">0.0000</span> <span class="number">0.0000</span></span><br><span class="line"></span><br><span class="line">  <span class="number">2</span><span class="string">.</span>  <span class="string">C</span>  <span class="string">t</span> <span class="number">0.7529</span> <span class="number">0.0011</span> <span class="number">0.7529</span> <span class="number">0.0000</span> <span class="number">0.0000</span> <span class="number">0.4921</span> <span class="number">0.0000</span> <span class="number">0.0000</span></span><br><span class="line">         <span class="string">c</span> <span class="number">0.5616</span>   <span class="string">---</span>  <span class="number">0.5616</span> <span class="number">0.0000</span> <span class="number">0.0000</span> <span class="number">0.3986</span> <span class="number">0.0000</span> <span class="number">0.0000</span></span><br><span class="line">         <span class="string">i</span> <span class="number">0.1912</span>   <span class="string">---</span>  <span class="number">0.1912</span> <span class="number">0.0000</span> <span class="number">0.0000</span> <span class="number">0.0935</span> <span class="number">0.0000</span> <span class="number">0.0000</span></span><br><span class="line"></span><br><span class="line">  <span class="number">3</span><span class="string">.</span>  <span class="string">C</span>  <span class="string">t</span> <span class="number">0.0000</span> <span class="number">0.7529</span> <span class="number">0.2523</span> <span class="number">0.0000</span> <span class="number">0.0000</span> <span class="number">0.0000</span> <span class="number">0.4962</span> <span class="number">0.4970</span></span><br><span class="line">         <span class="string">c</span> <span class="number">0.0000</span> <span class="number">0.5616</span>   <span class="string">---</span>  <span class="number">0.0000</span> <span class="number">0.0000</span> <span class="number">0.0000</span> <span class="number">0.3817</span> <span class="number">0.3795</span></span><br><span class="line">         <span class="string">i</span> <span class="number">0.0000</span> <span class="number">0.1912</span>   <span class="string">---</span>  <span class="number">0.0000</span> <span class="number">0.0000</span> <span class="number">0.0000</span> <span class="number">0.1145</span> <span class="number">0.1176</span></span><br><span class="line"></span><br><span class="line">  <span class="number">4</span><span class="string">.</span>  <span class="string">H</span>  <span class="string">t</span> <span class="number">0.4970</span> <span class="number">0.0000</span> <span class="number">0.0000</span> <span class="number">0.0010</span> <span class="number">0.0000</span> <span class="number">0.0000</span> <span class="number">0.0000</span> <span class="number">0.0000</span></span><br><span class="line">         <span class="string">c</span> <span class="number">0.3795</span> <span class="number">0.0000</span> <span class="number">0.0000</span>   <span class="string">---</span>  <span class="number">0.0000</span> <span class="number">0.0000</span> <span class="number">0.0000</span> <span class="number">0.0000</span></span><br><span class="line">         <span class="string">i</span> <span class="number">0.1176</span> <span class="number">0.0000</span> <span class="number">0.0000</span>   <span class="string">---</span>  <span class="number">0.0000</span> <span class="number">0.0000</span> <span class="number">0.0000</span> <span class="number">0.0000</span></span><br><span class="line"></span><br><span class="line">  <span class="number">5</span><span class="string">.</span>  <span class="string">H</span>  <span class="string">t</span> <span class="number">0.4962</span> <span class="number">0.0000</span> <span class="number">0.0000</span> <span class="number">0.0000</span> <span class="number">0.0019</span> <span class="number">0.0000</span> <span class="number">0.0000</span> <span class="number">0.0000</span></span><br><span class="line">         <span class="string">c</span> <span class="number">0.3817</span> <span class="number">0.0000</span> <span class="number">0.0000</span> <span class="number">0.0000</span>   <span class="string">---</span>  <span class="number">0.0000</span> <span class="number">0.0000</span> <span class="number">0.0000</span></span><br><span class="line">         <span class="string">i</span> <span class="number">0.1145</span> <span class="number">0.0000</span> <span class="number">0.0000</span> <span class="number">0.0000</span>   <span class="string">---</span>  <span class="number">0.0000</span> <span class="number">0.0000</span> <span class="number">0.0000</span></span><br><span class="line"></span><br><span class="line">  <span class="number">6</span><span class="string">.</span>  <span class="string">H</span>  <span class="string">t</span> <span class="number">0.0000</span> <span class="number">0.4921</span> <span class="number">0.0000</span> <span class="number">0.0000</span> <span class="number">0.0000</span> <span class="number">0.0041</span> <span class="number">0.0000</span> <span class="number">0.0000</span></span><br><span class="line">         <span class="string">c</span> <span class="number">0.0000</span> <span class="number">0.3986</span> <span class="number">0.0000</span> <span class="number">0.0000</span> <span class="number">0.0000</span>   <span class="string">---</span>  <span class="number">0.0000</span> <span class="number">0.0000</span></span><br><span class="line">         <span class="string">i</span> <span class="number">0.0000</span> <span class="number">0.0935</span> <span class="number">0.0000</span> <span class="number">0.0000</span> <span class="number">0.0000</span>   <span class="string">---</span>  <span class="number">0.0000</span> <span class="number">0.0000</span></span><br><span class="line"></span><br><span class="line">  <span class="number">7</span><span class="string">.</span>  <span class="string">H</span>  <span class="string">t</span> <span class="number">0.0000</span> <span class="number">0.0000</span> <span class="number">0.4962</span> <span class="number">0.0000</span> <span class="number">0.0000</span> <span class="number">0.0000</span> <span class="number">0.0019</span> <span class="number">0.0000</span></span><br><span class="line">         <span class="string">c</span> <span class="number">0.0000</span> <span class="number">0.0000</span> <span class="number">0.3817</span> <span class="number">0.0000</span> <span class="number">0.0000</span> <span class="number">0.0000</span>   <span class="string">---</span>  <span class="number">0.0000</span></span><br><span class="line">         <span class="string">i</span> <span class="number">0.0000</span> <span class="number">0.0000</span> <span class="number">0.1145</span> <span class="number">0.0000</span> <span class="number">0.0000</span> <span class="number">0.0000</span>   <span class="string">---</span>  <span class="number">0.0000</span></span><br><span class="line"></span><br><span class="line">  <span class="number">8</span><span class="string">.</span>  <span class="string">H</span>  <span class="string">t</span> <span class="number">0.0000</span> <span class="number">0.0000</span> <span class="number">0.4970</span> <span class="number">0.0000</span> <span class="number">0.0000</span> <span class="number">0.0000</span> <span class="number">0.0000</span> <span class="number">0.0010</span></span><br><span class="line">         <span class="string">c</span> <span class="number">0.0000</span> <span class="number">0.0000</span> <span class="number">0.3795</span> <span class="number">0.0000</span> <span class="number">0.0000</span> <span class="number">0.0000</span> <span class="number">0.0000</span>   <span class="string">---</span></span><br><span class="line">         <span class="string">i</span> <span class="number">0.0000</span> <span class="number">0.0000</span> <span class="number">0.1176</span> <span class="number">0.0000</span> <span class="number">0.0000</span> <span class="number">0.0000</span> <span class="number">0.0000</span>   <span class="string">---</span></span><br></pre></td></tr></table></figure>
<ul>
<li>每个原子的自然原子价（体现成键的数目），以及共价和离子的贡献量</li>
</ul>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">Natural Atomic Valencies:</span></span><br><span class="line"></span><br><span class="line">                     <span class="string">Co-</span>    <span class="string">Electro-</span></span><br><span class="line">    <span class="string">Atom</span>  <span class="string">Valency</span>  <span class="string">Valency</span>  <span class="string">Valency</span></span><br><span class="line">    <span class="string">----</span>  <span class="string">-------</span>  <span class="string">-------</span>  <span class="string">-------</span></span><br><span class="line">  <span class="number">1</span><span class="string">.</span>  <span class="string">C</span>    <span class="number">1.7461</span>   <span class="number">1.3228</span>   <span class="number">0.4233</span></span><br><span class="line">  <span class="number">2</span><span class="string">.</span>  <span class="string">C</span>    <span class="number">1.9978</span>   <span class="number">1.5218</span>   <span class="number">0.4760</span></span><br><span class="line">  <span class="number">3</span><span class="string">.</span>  <span class="string">C</span>    <span class="number">1.7461</span>   <span class="number">1.3228</span>   <span class="number">0.4233</span></span><br><span class="line">  <span class="number">4</span><span class="string">.</span>  <span class="string">H</span>    <span class="number">0.4970</span>   <span class="number">0.3795</span>   <span class="number">0.1176</span></span><br><span class="line">  <span class="number">5</span><span class="string">.</span>  <span class="string">H</span>    <span class="number">0.4962</span>   <span class="number">0.3817</span>   <span class="number">0.1145</span></span><br><span class="line">  <span class="number">6</span><span class="string">.</span>  <span class="string">H</span>    <span class="number">0.4921</span>   <span class="number">0.3986</span>   <span class="number">0.0935</span></span><br><span class="line">  <span class="number">7</span><span class="string">.</span>  <span class="string">H</span>    <span class="number">0.4962</span>   <span class="number">0.3817</span>   <span class="number">0.1145</span></span><br><span class="line">  <span class="number">8</span><span class="string">.</span>  <span class="string">H</span>    <span class="number">0.4970</span>   <span class="number">0.3795</span>   <span class="number">0.1176</span></span><br></pre></td></tr></table></figure>
<ul>
<li>最后以SNRTSTR字段的格式输出各个参考Lewis结构的表示。</li>
</ul>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">$NRTSTRA</span><br><span class="line">  STR        ! Wgt = <span class="number">48.55</span>%</span><br><span class="line">    LONE <span class="number">1</span> <span class="number">1</span> END</span><br><span class="line">    BOND S <span class="number">1</span> <span class="number">2</span> S <span class="number">1</span> <span class="number">4</span> S <span class="number">1</span> <span class="number">5</span> D <span class="number">2</span> <span class="number">3</span> S <span class="number">2</span> <span class="number">6</span> S <span class="number">3</span> <span class="number">7</span> S <span class="number">3</span> <span class="number">8</span> END</span><br><span class="line">  END</span><br><span class="line">  STR        ! Wgt = <span class="number">48.55</span>%</span><br><span class="line">    LONE <span class="number">3</span> <span class="number">1</span> END</span><br><span class="line">    BOND D <span class="number">1</span> <span class="number">2</span> S <span class="number">1</span> <span class="number">4</span> S <span class="number">1</span> <span class="number">5</span> S <span class="number">2</span> <span class="number">3</span> S <span class="number">2</span> <span class="number">6</span> S <span class="number">3</span> <span class="number">7</span> S <span class="number">3</span> <span class="number">8</span> END</span><br><span class="line">  END</span><br><span class="line">$END</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>计算化学</category>
        <category>软件</category>
      </categories>
      <tags>
        <tag>NBO</tag>
        <tag>键级</tag>
      </tags>
  </entry>
  <entry>
    <title>PIO</title>
    <url>/2021/08/23/PIO/</url>
    <content><![CDATA[<h1 id="代码位置"><a href="#代码位置" class="headerlink" title="代码位置"></a>代码位置</h1><p><a href="https://github.com/jxzhangcc/PIO">https://github.com/jxzhangcc/PIO</a></p>
<h1 id="使用步骤"><a href="#使用步骤" class="headerlink" title="使用步骤"></a>使用步骤</h1><h2 id="Gaussian计算部分"><a href="#Gaussian计算部分" class="headerlink" title="Gaussian计算部分"></a>Gaussian计算部分</h2><ol>
<li><p>在高斯关键词部分加入pop=nbo6read</p>
<ul>
<li>nboread调用的是高斯自带的NBO3，要用NBO6得到.49，否则格式会有问题。格式修改见<a href="https://mp.weixin.qq.com/s?__biz=MzU5NDYxNjc5Ng==&amp;mid=2247485938&amp;idx=1&amp;sn=addcb81d6a9caed028a9ab86e336847d&amp;chksm=fe7fc141c9084857858ebeb9988bd73c70fd631f354a53aeb7768fcd4c6df9f890de7539d583&amp;mpshare=1&amp;scene=1&amp;srcid=&amp;sharer_sharetime=1589122912458&amp;sharer_shareid=f14b465eb222f6bb34657e2c0fafe383&amp;key=64daf1adc09d7c6ecdf51441f0e0e0081ff30416a8c76cafc75ab07809a89ccb0e3a0fde164cf3daa101192f723f9349e88e6622f494e3da3870bf9eaebe22bf9583324d7112cf0072a7c78f482c98d9&amp;ascene=1&amp;uin=MTY5ODAzMzEyNQ%3D%3D&amp;devicetype=Windows+10+x64&amp;version=62090070&amp;lang=zh_CN&amp;exportkey=AdPzWFyVBDaa5HawSncSSzA%3D&amp;pass_ticket=CJnCOXQ4GY3GwKDSPl0mmbvH12dznP%2F%2Bj30sXI1%2BLh1L4wzPIu4fEYHNwnZHTc2M">博文</a>。</li>
</ul>
</li>
<li><p>在高斯输入文件的最后一行加入：</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line"><span class="variable">$NBO</span> <span class="attribute">AONAO</span>=W49 <span class="attribute">FNAO</span>=W49 <span class="attribute">DMNAO</span>=W49 SKIPBO <span class="attribute">file</span>=XXX  <span class="variable">$END</span></span><br></pre></td></tr></table></figure>
<ul>
<li>中XXX应与之后生成的 .fchk 文件名一致</li>
<li>PIO_v3可能会报错，需要49文件的名字为大写的</li>
</ul>
</li>
<li><p>通过formchk将chk转换成fchk</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">formchk</span> <span class="selector-tag">xxx</span><span class="selector-class">.chk</span> <span class="selector-tag">xxx</span><span class="selector-class">.fchk</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="pio部分"><a href="#pio部分" class="headerlink" title="pio部分"></a>pio部分</h2><ol>
<li><p>此时应当有 .fchk 文件以及 NBO 生成的 .49 文件</p>
</li>
<li><p>pio命令一般在在/home/scicons/bin下，将其添加至环境变量即可。此时执行</p>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">pio</span>  <span class="variable">$&#123;FILENAME&#125;</span>.fchk &#123;碎片<span class="number">1</span> 的原子序号&#125; &#123;碎片<span class="number">2</span> 的原子序号&#125; </span><br></pre></td></tr></table></figure>
<ul>
<li>碎片可以是<code>xx-xx</code>这样的格式</li>
</ul>
</li>
<li><p>如果报错，看体系是否是开壳层的，如果是开壳层，需要对.49文件进行一点修改</p>
<ul>
<li><p>开壳层，通过一下命令检查，会出现SPIN出现的行数，会发现默认顺序是aabb，正确的顺序应该是abab</p>
<figure class="highlight gradle"><table><tr><td class="code"><pre><span class="line"><span class="keyword">grep</span> -n <span class="string">&#x27;SPIN&#x27;</span> XXX.<span class="number">49</span></span><br></pre></td></tr></table></figure>
<p><img src="clipboard.png" alt="img"></p>
<p><img src="166a906be971e8d3d3b304cee0da821.png" alt="img" style="zoom: 50%;" /></p>
<p><img src="ffc0c86714dea564d2a80ceeec2bfc1.png" alt="img" style="zoom:50%;" /></p>
<p><img src="a91083a05da311f08735a5273b29fd7.png" alt="img" style="zoom:54%;" /></p>
<p><img src="0178a4c2a265eed33bf7da46e8737d8.png" alt="img" style="zoom:54%;" /></p>
<ul>
<li><p>在NAO密度矩阵部分只有alpha，结束之后紧跟的是NAO的Fock矩阵，而第一个beta实际上是NAO密度矩阵的部分，将这部分移动到alpha密度矩阵的后面即可。</p>
</li>
<li><p>利用vim命令进行调换即可，调换方法：</p>
<figure class="highlight vala"><table><tr><td class="code"><pre><span class="line"><span class="meta">#先删除第一个beta部分</span></span><br><span class="line">:<span class="number">129075</span>,<span class="number">154831</span>d</span><br><span class="line"><span class="meta">#光标停在第一个alpha最后一行，直接p即可</span></span><br><span class="line">p</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
</li>
</ol>
<h2 id="结果分析部分"><a href="#结果分析部分" class="headerlink" title="结果分析部分"></a>结果分析部分</h2><ul>
<li>pio对结果在生成的txt文件中，pio对的轨道在pio.fchk文件中，而PIMOs的记过在pimo.fchk中</li>
<li>pio_v3还有raw文件，pio_v4已经删除</li>
<li>轨道如果通过pio_v4分析得到，用Multiwfn或者Jmol打开转换得到的molden文件，能量都是0，要避免可以用pio_v3</li>
</ul>
<h1 id="Windows下运行"><a href="#Windows下运行" class="headerlink" title="Windows下运行"></a>Windows下运行</h1><ul>
<li><p>需要下载python2和anaconda配置python2的运行环境</p>
</li>
<li><p>打开Anaconda的命令行，输入</p>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">conda</span> activate py<span class="number">27</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>执行命令：</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">python</span> <span class="selector-tag">PIO</span><span class="selector-class">.py</span> <span class="selector-tag">FILENAME</span><span class="selector-class">.FChk</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>输入原子：</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span><span class="number">-5</span>,<span class="number">8</span>,<span class="number">13</span> <span class="number">6</span><span class="number">-7</span>,<span class="number">9</span><span class="number">-12</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
]]></content>
      <categories>
        <category>计算化学</category>
        <category>软件</category>
      </categories>
      <tags>
        <tag>PIO</tag>
      </tags>
  </entry>
  <entry>
    <title>【ADF】03.精度控制</title>
    <url>/2021/12/06/%E3%80%90ADF%E3%80%9103.%E7%B2%BE%E5%BA%A6%E6%8E%A7%E5%88%B6/</url>
    <content><![CDATA[<h1 id="NumericalQuality"><a href="#NumericalQuality" class="headerlink" title="NumericalQuality"></a><code>NumericalQuality</code></h1><ul>
<li>设置ADF计算的质量，包括BeckeGrid（数值积分）和 ZlmFit（密度拟合）。</li>
<li>选项有<code>Basic</code>、<code>Normal</code>（默认）、<code>Good</code>、<code>VeryGood</code>、<code>Excellent</code></li>
</ul>
<h1 id="BeckeGrid数值积分"><a href="#BeckeGrid数值积分" class="headerlink" title="BeckeGrid数值积分"></a><code>BeckeGrid</code>数值积分</h1><p>数值积分格点的选项。</p>
<figure class="highlight coq"><table><tr><td class="code"><pre><span class="line">BECKEGRID</span><br><span class="line">  Quality [basic|<span class="type">normal</span>|<span class="type">good</span>|<span class="type">verygood</span>|<span class="type">excellent</span>]</span><br><span class="line">  &#123;QualityPerRegion</span><br><span class="line">     Region myregion</span><br><span class="line">     Quality &#123;Basic|<span class="type">Normal</span>|<span class="type">Good</span>|<span class="type">VeryGood</span>|<span class="type">Excellent</span>&#125;</span><br><span class="line">  <span class="keyword">End</span>&#125;</span><br><span class="line">  &#123;qpnear qpnear&#125;</span><br><span class="line">  &#123;RadialGridBoost boost&#125;</span><br><span class="line"><span class="keyword">End</span></span><br></pre></td></tr></table></figure>
<ul>
<li><p><code>Quality</code>：选项有<code>auto</code>（默认）、<code>Basic</code>、<code>Normal</code>、<code>Good</code>、<code>VeryGood</code>、<code>Excellent</code>。会覆盖<code>NumericalQuality</code>中的设置。</p>
</li>
<li><p><code>QualityPerRegion</code>：设置特定区域的原子的积分格点质量。</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">BeckeGrid</span><br><span class="line">  QualityPerRegion <span class="attribute">Region</span>=Accurate <span class="attribute">Quality</span>=Good</span><br><span class="line">  QualityPerRegion <span class="attribute">Region</span>=Far      <span class="attribute">Quality</span>=Basic</span><br><span class="line">End</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>qpnear</code>：默认为<code>4</code>Å。当在输入文件中指定了点电荷时，ADF 仅围绕那些接近原子的点电荷生成网格。<code>qpnear</code>指定的是最近的距离。</p>
</li>
<li><p><code>RadialGridBoost</code>：默认为<code>1.0</code>。增加径向积分点的数量。一些 XC 泛函需要非常精确的径向积分网格，因此 ADF 会自动将径向网格提升 3 倍用于一些数值敏感泛函。</p>
</li>
</ul>
<h1 id="ZLMFIT密度拟合"><a href="#ZLMFIT密度拟合" class="headerlink" title="ZLMFIT密度拟合"></a><code>ZLMFIT</code>密度拟合</h1><p>总电子密度被分成原子密度（以类似于为贝克网格划分体积的方式）。然后通过径向样条函数和实球谐函数 (Zlm) 的组合来近似这些原子密度。</p>
<figure class="highlight coq"><table><tr><td class="code"><pre><span class="line">ZLMFIT</span><br><span class="line"> Quality &#123;basic|<span class="type">normal</span>|<span class="type">good</span>|<span class="type">verygood</span>|<span class="type">excellent</span>&#125;</span><br><span class="line"> &#123;QualityPerRegion</span><br><span class="line">    Region myregion</span><br><span class="line">    Quality &#123;Basic|<span class="type">Normal</span>|<span class="type">Good</span>|<span class="type">VeryGood</span>|<span class="type">Excellent</span>&#125;</span><br><span class="line"> <span class="keyword">End</span>&#125;</span><br><span class="line"><span class="keyword">End</span></span><br></pre></td></tr></table></figure>
<ul>
<li><p><code>Quality</code>：选项有<code>auto</code>（默认）、<code>Basic</code>、<code>Normal</code>、<code>Good</code>、<code>VeryGood</code>、<code>Excellent</code>。会覆盖<code>NumericalQuality</code>中的设置。</p>
</li>
<li><p><code>QualityPerRegion</code>：设置特定区域的原子的 Zlm Fit 质量。</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">ZlmFit</span><br><span class="line">   QualityPerRegion <span class="attribute">Region</span>=Accurate <span class="attribute">Quality</span>=Good</span><br><span class="line">   QualityPerRegion <span class="attribute">Region</span>=Far      <span class="attribute">Quality</span>=Basic</span><br><span class="line">End</span><br></pre></td></tr></table></figure>
</li>
</ul>
]]></content>
      <categories>
        <category>计算化学</category>
        <category>软件</category>
      </categories>
      <tags>
        <tag>AMS</tag>
        <tag>ADF</tag>
        <tag>精度</tag>
      </tags>
  </entry>
  <entry>
    <title>【ADF】02.EDA-NOCV</title>
    <url>/2020/02/07/%E3%80%90ADF%E3%80%9102.EDA-NOCV/</url>
    <content><![CDATA[<h1 id="输入文件"><a href="#输入文件" class="headerlink" title="输入文件"></a>输入文件</h1><h2 id="碎片"><a href="#碎片" class="headerlink" title="碎片"></a>碎片</h2><ul>
<li><p>根据体系，指定电荷和自选多重度，确定碎片是闭壳层还是开壳层</p>
<ul>
<li>要根据整体分子的CMO中，相应轨道的成分，来指定碎片的占据方式</li>
</ul>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">charge <span class="number">0</span> <span class="number">-3</span></span><br><span class="line">unrestricted</span><br></pre></td></tr></table></figure>
</li>
<li><p>可以根据整体分子的对称性指定碎片的对称性</p>
<ul>
<li>过渡金属配合物设置对称性的注意事项：<ul>
<li>金属原子设置为原点，如果是金属团簇，则原点设置在金属团簇的中心，高对称轴设置为z轴（例如金属原子参与成键的是d、f轨道，但是分子却具有C<sub>3</sub>、C<sub>5</sub>、C<sub>7</sub>……这样的奇数的转动对称，这样设置是必须的)。设置方法是在图形界面中Edit→Align→（设置xy平面或者设置z轴），再通过Edit→Set Origin设置原点，最后可以通过View→Axes观看坐标轴来确认。</li>
<li>近似对称结构，金属碎片需要设置与对称结构相同的点群，例如Oh群八羰基配合物，其中一个羰基被替换为其他结构，金属原子仍然需要设置为Oh群</li>
<li>NOCV不支持点群，EDA支持，因此虽然NOCV分析默认会做EDA分析，但是建议分别都做一个，便于分析不同对称性的碎片轨道的共价作用  </li>
</ul>
</li>
</ul>
</li>
<li><p>有时候默认计算得到的结果可能导致分数占据、占据的轨道不正确、碎片的自旋不匹配等，尤其是金属原子作为一个碎片，需要注意其电子占据方式、自旋多重度，此时需要根据碎片的闭壳层/开壳层、对称性和占据，通过<code>IRREPOCCUPATIONS</code>来指定其占据方式，也可以在整体分子中通过<code>FRAGOCCUPATIONS</code>指定。<br>eg. 开壳层的β电子指定：    </p>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">IRREPOCCUPATIONS</span></span><br><span class="line"><span class="attribute">sigma</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span>//<span class="number">1</span> <span class="number">1</span> <span class="number">0</span></span><br><span class="line"><span class="attribute">pi</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span>//<span class="number">2</span> <span class="number">0</span> <span class="number">0</span></span><br><span class="line"><span class="attribute">end</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="整体分子"><a href="#整体分子" class="headerlink" title="整体分子"></a>整体分子</h2><ol>
<li><p>碎片数不局限，在分子坐标后面跟上<code>f=name</code>，然后在<code>Fragments</code>中指定碎片的t21文件，比如：</p>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">ATOMS</span></span><br><span class="line"><span class="attribute">1</span> H       <span class="number">0</span>.<span class="number">000000000010</span>      -<span class="number">0</span>.<span class="number">000000000016</span>       <span class="number">1</span>.<span class="number">080824461000</span>  f=f<span class="number">1</span> </span><br><span class="line"><span class="attribute">2</span> C      -<span class="number">0</span>.<span class="number">000000000012</span>       <span class="number">0</span>.<span class="number">000000000015</span>       <span class="number">0</span>.<span class="number">036537953000</span>  f=f<span class="number">2</span></span><br><span class="line"><span class="attribute">3</span> N       <span class="number">0</span>.<span class="number">000000000002</span>       <span class="number">0</span>.<span class="number">000000000002</span>      -<span class="number">1</span>.<span class="number">117362414000</span>  f=f<span class="number">2</span></span><br><span class="line"><span class="attribute">END</span> </span><br><span class="line"></span><br><span class="line"><span class="attribute">Fragments</span></span><br><span class="line">    <span class="attribute">f1</span> H.t<span class="number">21</span> </span><br><span class="line">    <span class="attribute">f2</span> CN.t<span class="number">21</span> </span><br><span class="line"><span class="attribute">end</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>占据方式的指定：</p>
<ol>
<li><p>如果碎片已经指定了占据，则不需要再指定；</p>
</li>
<li><p>如果碎片已经指定且是开壳层，需要加上<code>UnrestrictedFragments</code>关键词；</p>
</li>
<li><p>如果碎片没有指定，又需要指定，则使用<code>FRAGOCCUPATIONS</code>按如下指定：</p>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">FRAGOCCUPATIONS</span></span><br><span class="line"><span class="attribute">f1</span></span><br><span class="line"><span class="attribute">sigma</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span>//<span class="number">1</span> <span class="number">1</span> <span class="number">0</span></span><br><span class="line"><span class="attribute">pi</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span>//<span class="number">2</span> <span class="number">0</span> <span class="number">0</span></span><br><span class="line"><span class="attribute">SUBEND</span></span><br><span class="line"><span class="attribute">f2</span></span><br><span class="line"><span class="attribute">sigma</span> <span class="number">7</span> <span class="number">1</span> <span class="number">0</span>//<span class="number">7</span> <span class="number">0</span> <span class="number">0</span></span><br><span class="line"><span class="attribute">pi</span> <span class="number">8</span> <span class="number">2</span> <span class="number">0</span>//<span class="number">8</span> <span class="number">0</span> <span class="number">0</span></span><br><span class="line"><span class="attribute">delta</span> <span class="number">2</span> <span class="number">0</span>//<span class="number">2</span> <span class="number">0</span></span><br><span class="line"><span class="attribute">SUBEND</span></span><br><span class="line"><span class="attribute">END</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
</li>
</ol>
<ol>
<li><p>整体分子的计算不能使用对称性，需要用<code>symmetry nosym</code></p>
</li>
<li><p>需要使用<code>ETSNOCV</code>和<code>PRINT &#123;ETSLOWDIN | ETSLOWDIN-Unrestricted&#125;</code>关键词：</p>
<ul>
<li><code>ETSNOCV</code>指定打印NOCV相关信息的阈值：<ul>
<li><code>RHOKMIN</code>各个SFO对每个变形密度贡献进行总体分析的阈值</li>
<li><code>EKMIN</code>轨道相互作用能量贡献的阈值</li>
<li><code>ENOCV</code>NOCV特征值的阈值<br>当三个关键词都省略时，只分析NOCV特征值绝对值≥0.05的</li>
</ul>
</li>
<li><code>PRINT &#123;ETSLOWDIN | ETSLOWDIN-Unrestricted&#125;</code>中：<ul>
<li>如果计算的是闭壳层碎片，使用<code>PRINT ETSLOWDIN</code>，输出的是总形变密度</li>
<li>如果计算的是开壳层碎片，使用<code>PRINT ETSLOWDIN-Unrestricted</code>，输出的是α和β两组NOCV   <figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line">ETSNOCV</span><br><span class="line">   &#123;RHOKMIN rhokmin&#125;</span><br><span class="line">   &#123;EKMIN ekmin&#125;</span><br><span class="line">   &#123;ENOCV enocv&#125;</span><br><span class="line">End</span><br><span class="line"><span class="section">PRINT</span> &#123;<span class="attribute">ETSLOWDIN</span> | ETSLOWDIN-Unrestricted&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
</li>
<li><p>还可以根据需要使用<code>PRINT NOCVHirshfeld</code>来区分片段间还是片段内的NOCV，输出文件会打印每个NOCV的$\int{\Delta \rho} = -\Delta Q$值到ETS-NOCV末尾的“Hirshfeld partitioning” ：</p>
<ul>
<li>片段间NOCV具有非零积分Hirshfeld$\Delta Q$值，并且对应于片段之间的电荷转移</li>
<li>片段内NOCV具有小的$\Delta Q$值，并且对应于片段的极化。</li>
</ul>
</li>
</ol>
<h2 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h2><h3 id="HCN拆分成H-和CN-闭壳层分析"><a href="#HCN拆分成H-和CN-闭壳层分析" class="headerlink" title="HCN拆分成H+和CN-闭壳层分析"></a>HCN拆分成H<sup>+</sup>和CN<sup>-</sup>闭壳层分析</h3><p>H<sup>+</sup></p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">……</span><br><span class="line">ATOMS</span><br><span class="line"><span class="number">1</span> H       <span class="number">0.000000000010</span>      <span class="number">-0.000000000016</span>       <span class="number">1.080824461000</span>    </span><br><span class="line">END</span><br><span class="line"></span><br><span class="line">SYMMETRY NOSYM</span><br><span class="line"></span><br><span class="line">CHARGE <span class="number">1.0</span></span><br><span class="line"></span><br><span class="line">……</span><br></pre></td></tr></table></figure>
<p>CN<sup>-</sup></p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">……</span><br><span class="line">ATOMS</span><br><span class="line"><span class="number">1</span> N       <span class="number">0.000000000002</span>       <span class="number">0.000000000002</span>      <span class="number">-1.117362414000</span>    </span><br><span class="line"><span class="number">2</span> C      <span class="number">-0.000000000012</span>       <span class="number">0.000000000015</span>       <span class="number">0.036537953000</span>    </span><br><span class="line">END</span><br><span class="line"></span><br><span class="line">SYMMETRY NOSYM</span><br><span class="line"></span><br><span class="line">CHARGE <span class="number">-1.0</span></span><br><span class="line">……</span><br></pre></td></tr></table></figure>
<p>HCN</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">……</span><br><span class="line">ATOMS</span><br><span class="line"><span class="number">1</span> H       <span class="number">0.000000000010</span>      <span class="number">-0.000000000016</span>       <span class="number">1.080824461000</span>  f=f1 </span><br><span class="line"><span class="number">2</span> C      <span class="number">-0.000000000012</span>       <span class="number">0.000000000015</span>       <span class="number">0.036537953000</span>  f=f2</span><br><span class="line"><span class="number">3</span> N       <span class="number">0.000000000002</span>       <span class="number">0.000000000002</span>      <span class="number">-1.117362414000</span>  f=f2</span><br><span class="line">END</span><br><span class="line"></span><br><span class="line">SYMMETRY NOSYM</span><br><span class="line"></span><br><span class="line">FRAGOCCUPATIONS</span><br><span class="line">Region_1</span><br><span class="line">A <span class="number">0</span><span class="comment">//0</span></span><br><span class="line">SUBEND</span><br><span class="line">Region_2</span><br><span class="line">A <span class="number">5</span><span class="comment">//5</span></span><br><span class="line">SUBEND</span><br><span class="line">END</span><br><span class="line"></span><br><span class="line">Fragments</span><br><span class="line">    f1 H.t21 </span><br><span class="line">    f2 CN.t21 </span><br><span class="line">end</span><br><span class="line"></span><br><span class="line">ETSNOCV</span><br><span class="line">PRINT ETSLOWDIN-UNRESTRICTED</span><br><span class="line">……</span><br></pre></td></tr></table></figure>
<p>输出结果中，为α和β两组NOCV</p>
<h3 id="HCN拆分成H和CN开壳层分析"><a href="#HCN拆分成H和CN开壳层分析" class="headerlink" title="HCN拆分成H和CN开壳层分析"></a>HCN拆分成H和CN开壳层分析</h3><p>H</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">……</span><br><span class="line">ATOMS</span><br><span class="line"><span class="number">1</span> H       <span class="number">0.000000000013</span>      <span class="number">-0.000000000021</span>       <span class="number">2.374453386206</span>    </span><br><span class="line">END</span><br><span class="line"></span><br><span class="line">SYMMETRY NOSYM</span><br><span class="line">……</span><br></pre></td></tr></table></figure>
<p>CN</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">……</span><br><span class="line">ATOMS</span><br><span class="line"><span class="number">1</span> N       <span class="number">0.000000000004</span>      <span class="number">-0.000000000003</span>       <span class="number">0.176266511365</span>    </span><br><span class="line"><span class="number">2</span> C      <span class="number">-0.000000000009</span>       <span class="number">0.000000000010</span>       <span class="number">1.330166878460</span>    </span><br><span class="line">END</span><br><span class="line"></span><br><span class="line">SYMMETRY NOSYM</span><br><span class="line">……</span><br></pre></td></tr></table></figure>
<p>HCN</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">……</span><br><span class="line">ATOMS</span><br><span class="line"><span class="number">1</span> H       <span class="number">0.000000000013</span>      <span class="number">-0.000000000021</span>       <span class="number">2.374453386206</span>  f=f1</span><br><span class="line"><span class="number">2</span> C      <span class="number">-0.000000000009</span>       <span class="number">0.000000000010</span>       <span class="number">1.330166878460</span>  f=f2 </span><br><span class="line"><span class="number">3</span> N       <span class="number">0.000000000004</span>      <span class="number">-0.000000000003</span>       <span class="number">0.176266511365</span>  f=f2</span><br><span class="line">END</span><br><span class="line"></span><br><span class="line">SYMMETRY NOSYM</span><br><span class="line"></span><br><span class="line">FRAGOCCUPATIONS</span><br><span class="line">Region_1</span><br><span class="line">A <span class="number">1</span><span class="comment">//0</span></span><br><span class="line">SUBEND</span><br><span class="line">Region_2</span><br><span class="line">A <span class="number">4</span><span class="comment">//5</span></span><br><span class="line">SUBEND</span><br><span class="line">END</span><br><span class="line"></span><br><span class="line">Fragments</span><br><span class="line">    f1 H.t21 </span><br><span class="line">    f2 CN.t21 </span><br><span class="line">end</span><br><span class="line">ETSNOCV</span><br><span class="line"></span><br><span class="line">PRINT ETSLOWDIN-UNRESTRICTED</span><br><span class="line">……</span><br></pre></td></tr></table></figure>
<h1 id="EDA分解结果"><a href="#EDA分解结果" class="headerlink" title="EDA分解结果"></a>EDA分解结果</h1><ul>
<li><font color=red>总的能量</font><script type="math/tex">ΔE_{total}＝ΔE_{elstat}＋ΔE_{Pauli}＋ΔE_{orb}+ΔE_{prep}+(ΔE_{disp})</script> 分为以下几项：<ul>
<li>泡利排斥$ΔE_{Pauli}$：两个片段占据轨道之间的排斥作用，会导致能量升高（＞0），电子和电子之间的泡利排斥大概在1玻尔的范围内。</li>
<li>静电吸引$ΔE_{elstat}$：分子中片段局部位置不是电中心，会存在简单的的 静电相互作用能，会让能量降低（＜0）</li>
<li>轨道作用$ΔE_{orb}$：本质是共价作用（电子的共享）（＜0）<ul>
<li>一个片段占据轨道另一个片段空轨道之间的“电子转移”，能量降低</li>
<li>一个片段自身占据轨道与空轨道的电子转移，能量降低</li>
</ul>
</li>
<li>$ΔE_{prep}$：准备能，片段从它的自由状态（孤立存在的时候，能量最低点），能量升高，变形为在分子中的形状，这个过程所增加的能量，该项非负</li>
<li>色散作用$ΔE_{disp}$：在使用色散修正泛函的话才存在</li>
</ul>
</li>
<li>ADF的结果中包含的依次是<script type="math/tex">ΔE_{Pauli}+ΔE_{elstat}+ΔE_{orb}=ΔE_{int}</script><br><img src="1.png" style="zoom:80%;" /></li>
<li>键能有两种：<ul>
<li>一种直接是$ΔE_{int}$</li>
<li>一种是在<script type="math/tex">ΔE_{int}</script>的基础上加上准备能<script type="math/tex">ΔE_{prep}</script>，计算方法是将片段，分别进行能量最小化，之后的能量降低量之和，即准备能（＞0）</li>
</ul>
</li>
</ul>
<h1 id="NOCV结果"><a href="#NOCV结果" class="headerlink" title="NOCV结果"></a>NOCV结果</h1><h2 id="轨道相互作用能"><a href="#轨道相互作用能" class="headerlink" title="轨道相互作用能"></a>轨道相互作用能</h2><p>轨道相互作用能的贡献根据闭壳层（只有一组）和开壳层（分为α和β两组）的结果列出：<br><figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">================</span><br><span class="line">Alpha resolution</span><br><span class="line">================</span><br><span class="line"> </span><br><span class="line"><span class="number">1.</span> Eigenvalue pairs <span class="keyword">from</span> diagonalization of DeltaP expressed <span class="keyword">in</span> Lowdin - alpha:</span><br><span class="line">   <span class="number">1</span>  <span class="number">-0.56641</span>   <span class="number">31</span>   <span class="number">0.56641</span></span><br><span class="line">   <span class="number">2</span>  <span class="number">-0.12938</span>   <span class="number">30</span>   <span class="number">0.12938</span></span><br><span class="line">   <span class="number">3</span>  <span class="number">-0.06636</span>   <span class="number">29</span>   <span class="number">0.06636</span></span><br><span class="line">   <span class="number">4</span>  <span class="number">-0.06636</span>   <span class="number">28</span>   <span class="number">0.06636</span></span><br><span class="line"><span class="number">2.</span> Orbital Interaction Energy Contributions <span class="keyword">from</span> each NOCV pair - alpha(<span class="keyword">in</span> a.u.)</span><br><span class="line">  <span class="number">1</span>  <span class="number">-0.17666</span></span><br><span class="line">  <span class="number">2</span>  <span class="number">-0.01565</span></span><br><span class="line">  <span class="number">3</span>  <span class="number">-0.00352</span></span><br><span class="line">  <span class="number">4</span>  <span class="number">-0.00352</span></span><br><span class="line"><span class="number">3.</span> Orbital Interaction Energy Contributions <span class="keyword">from</span> each NOCV pair - alpha(<span class="keyword">in</span> kcal/mol)</span><br><span class="line">  <span class="number">1</span><span class="number">-110.85632</span></span><br><span class="line">  <span class="number">2</span>  <span class="number">-9.81984</span></span><br><span class="line">  <span class="number">3</span>  <span class="number">-2.21067</span></span><br><span class="line">  <span class="number">4</span>  <span class="number">-2.21067</span></span><br><span class="line">Total sum [alpha]:  <span class="number">-125.507539810232</span>  </span><br></pre></td></tr></table></figure></p>
<ol>
<li>本征值，按本征值的绝对值的大小列出，也即贡献的大小</li>
<li>与本征值对应的轨道的能量，单位是Hatree</li>
<li>与本征值对应的轨道的能量，单位是kcal/mol</li>
</ol>
<h2 id="电子转移"><a href="#电子转移" class="headerlink" title="电子转移"></a>电子转移</h2><ul>
<li>每个本征值的NOCV，电子在片段轨道之间，是如何在SFO碎片轨道中转移的：<ul>
<li>比如本征值为±0.56641的NOCV中，1、7号SFO分别失去0.61238、0.04257个电子，10、2号SFO得到0.62190、0.01341个电子    </li>
<li>SFO轨道可以在out文件中的<code>S F O s</code>模块查看，也可以通过图形界面查看 （通过SCM→View→Add Isosurface:with phase→Select Field→SFOs选择对应的SFO编号，查看其空间分布形状）<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">=============================================================</span><br><span class="line"> SFO decomposition of alpha Delta rho k (major contributions):</span><br><span class="line"> =============================================================</span><br><span class="line">  </span><br><span class="line"> Threshold <span class="keyword">for</span> a NOCVs energy (<span class="keyword">in</span> kcal/mol) <span class="keyword">is</span>   <span class="number">2.00000000000000</span>     </span><br><span class="line"> Threshold <span class="keyword">for</span> an individual SFO contribution <span class="keyword">is</span>  <span class="number">1.000000000000000E-002</span></span><br><span class="line"></span><br><span class="line">   <span class="number">1</span>   NOCV eigenvalues:  <span class="number">-0.56641</span>   <span class="number">0.56641</span></span><br><span class="line">       Corresponding Delta E k:<span class="number">-110.85632</span>  (kcal/mol)</span><br><span class="line">       <span class="number">10</span>   SFO contribution:   <span class="number">0.62190</span></span><br><span class="line">        <span class="number">1</span>   SFO contribution:  <span class="number">-0.61238</span></span><br><span class="line">        <span class="number">7</span>   SFO contribution:  <span class="number">-0.04257</span></span><br><span class="line">        <span class="number">2</span>   SFO contribution:   <span class="number">0.01341</span></span><br><span class="line">       Sum <span class="keyword">from</span> all SFOs:   <span class="number">-0.79216E-02</span></span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li>通过SCM→View→Add→Isosurface:with phase→Select Field→NOCV Orbitals选择±本征值查看成键前后分子轨道的图像：<ul>
<li>选择本征值为负的，表示轨道相互作用前分子轨道的图像</li>
<li>选择本征值为正的，表示轨道相互作用后分子轨道的图像</li>
</ul>
</li>
<li>通过SCM→View→Add→Isosurface:with phase→Select Field→NOCV def Density选对应的本征值观看轨道图像显示成键时的电子转移：<ul>
<li>红色区域，代表这个区域失去了电子</li>
<li>蓝色区域，代表这个区域得到了电子<br>由于电子得失比较少，因此等值面的大小需要改到0.005左右。</li>
</ul>
</li>
<li>NOCV def Densities，是“正本征值NOCV orbital的模方” - “负本征值NOCV orbital的模方”：<ul>
<li>负本征值NOCV Orbital实际上一部分是占据电子的，另一部分是不占据电子的</li>
<li>正本征值NOCV Orbital则是形成化学键，整个轨道上都占了电子的<br>因此NOCV def Densities表示电子的流向，负值表示失去电子，正值表示得到电子。只有NOCV def Density能够可靠地、直观地、明确无误地表征成键作用，文献中一般也只讨论NOCV def Density。</li>
</ul>
</li>
<li>开壳层体系中NOCV def Density会分成α和β两组，如果需要看整体的，则需要Fields→Calculated，在Select Fields中选择配对的α和β轨道，中间的符号换成+，然后在SCM→View→Add→Isosurface:with phase→Select Field选择C-1。</li>
</ul>
]]></content>
      <categories>
        <category>计算化学</category>
        <category>软件</category>
      </categories>
      <tags>
        <tag>ADF</tag>
        <tag>能量分解</tag>
      </tags>
  </entry>
  <entry>
    <title>【AMS】01.基本输入结构</title>
    <url>/2021/05/11/%E3%80%90AMS%E3%80%9101.%E5%9F%BA%E6%9C%AC%E8%BE%93%E5%85%A5%E7%BB%93%E6%9E%84/</url>
    <content><![CDATA[<h1 id="主要结构"><a href="#主要结构" class="headerlink" title="主要结构"></a>主要结构</h1><ul>
<li><code>System</code>，<code>Task</code>和<code>Engine</code>是必须的，其他比如<code>Properties</code>是可选的</li>
</ul>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line"><span class="variable">$AMSBIN</span>/ams -n 8 &lt;&lt; eor 1&gt;<span class="variable">$&#123;0/run/out&#125;</span> 2&gt;<span class="variable">$&#123;0/run/err&#125;</span></span><br><span class="line"></span><br><span class="line">System</span><br><span class="line">	Atoms</span><br><span class="line">		F         0.000000    0.000000    0.760010</span><br><span class="line">		F         0.000000    0.000000   -0.760010</span><br><span class="line">End</span><br><span class="line">charge 0 </span><br><span class="line">End</span><br><span class="line"></span><br><span class="line">Task GeometryOptimization</span><br><span class="line"></span><br><span class="line">Engine ADF</span><br><span class="line">	TITLE UueFn</span><br><span class="line">	basis</span><br><span class="line">	<span class="built_in">	type </span>TZ2P</span><br><span class="line">		core None</span><br><span class="line">		CreateOutput <span class="literal">Yes</span></span><br><span class="line">	end</span><br><span class="line">	xc</span><br><span class="line">		gga PBE </span><br><span class="line">	end</span><br><span class="line">	relativity</span><br><span class="line">		level spin-orbit</span><br><span class="line">		formalism ZORA</span><br><span class="line">	end</span><br><span class="line">EndEngine</span><br></pre></td></tr></table></figure>
<h2 id="System"><a href="#System" class="headerlink" title="System"></a>System</h2><ul>
<li>单位默认都是 <code>Angstrom</code>，如果需要更改，可以在将<code>header</code>部分更改为<code>[Bohr]</code></li>
</ul>
<figure class="highlight properties"><table><tr><td class="code"><pre><span class="line"><span class="attr">System</span> <span class="string">header</span></span><br><span class="line">   <span class="attr">Atoms</span> <span class="string">header</span></span><br><span class="line">      <span class="attr">...</span></span><br><span class="line">   <span class="attr">End</span></span><br><span class="line">   <span class="attr">Lattice</span> <span class="string">header</span></span><br><span class="line">      <span class="attr">...</span></span><br><span class="line">   <span class="attr">End</span></span><br><span class="line">   <span class="attr">FractionalCoords</span> <span class="string">Yes/No</span></span><br><span class="line">   <span class="attr">AllowCloseAtoms</span> <span class="string">Yes/No</span></span><br><span class="line">   <span class="attr">GeometryFile</span> <span class="string">string</span></span><br><span class="line">   <span class="attr">Symmetrize</span> <span class="string">Yes/No</span></span><br><span class="line">   <span class="attr">LatticeStrain</span> <span class="string">float_list</span></span><br><span class="line">   <span class="attr">SuperCell</span> <span class="string">integer_list</span></span><br><span class="line">   <span class="attr">Charge</span> <span class="string">float</span></span><br><span class="line">   <span class="attr">BondOrders</span></span><br><span class="line">      <span class="attr">...</span></span><br><span class="line">   <span class="attr">End</span></span><br><span class="line">   <span class="attr">...</span></span><br><span class="line"><span class="attr">End</span></span><br></pre></td></tr></table></figure>
<ul>
<li><strong><code>Atoms</code>：指定原子类型和坐标</strong><ul>
<li>如果需要给坐标分区，可以在每个原子坐标最后面添加<code>region=name1</code>，<code>region=name2</code>……，一个原子可以在多个区域中，此时命名用<code>,</code>分隔<code>region=name1，name2</code></li>
<li>可以更改原子的质量成为同位素(in Dalton) ，在每个原子坐标最后面添加<code>mass=number</code>即可</li>
</ul>
</li>
<li><code>Lattice</code>：指定最多三个晶格向量</li>
<li><code>FractionalCoords</code>：原子块中的原子坐标是否以晶格向量的分数坐标给出，默认为<code>No</code>。</li>
<li><code>GeometryFile</code>：从.xyz文件中读取几何</li>
<li><code>Symmetrize</code>：是否使输入结构对称，这也会将结构旋转转换为标准方向。默认为<code>No</code>。</li>
<li><strong><code>Charge</code>：指定非周期体系的电荷，默认为<code>0.0</code></strong></li>
<li><code>BondOrders</code>：指定原子和原子之间的键级，一般不需要。</li>
</ul>
<p>除了通过<code>System</code>指定系统，还可以用<code>Load System</code>读取<code>.rkf</code>文件中的之前的系统：</p>
<figure class="highlight delphi"><table><tr><td class="code"><pre><span class="line">LoadSystem header</span><br><span class="line">   <span class="keyword">File</span> <span class="keyword">string</span></span><br><span class="line">   Section <span class="keyword">string</span></span><br><span class="line"><span class="keyword">End</span></span><br></pre></td></tr></table></figure>
<ul>
<li><code>Section</code>：默认是<code>Molecule</code></li>
</ul>
<h3 id="指定均匀电场或多极电荷"><a href="#指定均匀电场或多极电荷" class="headerlink" title="指定均匀电场或多极电荷"></a>指定均匀电场或多极电荷</h3><ul>
<li><p>均匀电场</p>
<figure class="highlight gauss"><table><tr><td class="code"><pre><span class="line"><span class="keyword">System</span></span><br><span class="line">   ElectrostaticEmbedding</span><br><span class="line">      ElectricField ex ey ez</span><br><span class="line">   <span class="keyword">End</span></span><br><span class="line"><span class="keyword">End</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>点电荷和多极电荷：</p>
<figure class="highlight sas"><table><tr><td class="code"><pre><span class="line">System</span><br><span class="line">   ElectrostaticEmbedding</span><br><span class="line">      MultipolePotential</span><br><span class="line">         ChargeModel Point</span><br><span class="line">         Coordinates</span><br><span class="line">            <span class="meta">x</span> y z   q   py pz px</span><br><span class="line">            <span class="meta">x</span> y z   q   py pz px</span><br><span class="line">            ...</span><br><span class="line">         <span class="meta">End</span></span><br><span class="line">      <span class="meta">End</span></span><br><span class="line">   <span class="meta">End</span></span><br><span class="line"><span class="meta">End</span></span><br></pre></td></tr></table></figure>
<ul>
<li><code>ChargeModel</code>：多极子可以由一个点（在其位置具有奇异势能）或球形高斯分布<code>`Gaussian</code>来表示。默认是<code>Point</code>。</li>
<li><code>ChargeWidth</code>：默认是<code>-1.0</code>a.u.。高斯电荷模型的宽度。</li>
<li><code>Coordinates</code>：格式为<code>x y z q</code>或者<code>x y z q µx µy µz</code>。x、y、z 是以 Å 为单位的坐标，q 是电荷（以电荷的原子单位表示），μx、μy、μz 是（可选）偶极矩分量（以原子单位表示，即 e*Bohr）。</li>
</ul>
</li>
</ul>
<h2 id="Task"><a href="#Task" class="headerlink" title="Task"></a>Task</h2><ul>
<li><p>Task的可选参数有：</p>
<figure class="highlight coq"><table><tr><td class="code"><pre><span class="line">Task [SinglePoint | <span class="type">GeometryOptimization</span> | <span class="type">TransitionStateSearch</span> | <span class="type">IRC</span> | <span class="type">PESScan</span> | <span class="type">NEB</span> | <span class="type">VibrationalAnalysis</span> | <span class="type">MolecularDynamics</span> | <span class="type">GCMC</span>]</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="Properties"><a href="#Properties" class="headerlink" title="Properties"></a>Properties</h2><figure class="highlight gams"><table><tr><td class="code"><pre><span class="line">Properties</span><br><span class="line">   BondOrders <span class="keyword">Yes</span>/<span class="keyword">No</span></span><br><span class="line">   Charges <span class="keyword">Yes</span>/<span class="keyword">No</span></span><br><span class="line">   DipoleGradients <span class="keyword">Yes</span>/<span class="keyword">No</span></span><br><span class="line">   DipoleMoment <span class="keyword">Yes</span>/<span class="keyword">No</span></span><br><span class="line">   ElasticTensor <span class="keyword">Yes</span>/<span class="keyword">No</span></span><br><span class="line">   Gradients <span class="keyword">Yes</span>/<span class="keyword">No</span></span><br><span class="line">   Hessian <span class="keyword">Yes</span>/<span class="keyword">No</span></span><br><span class="line">   Molecules <span class="keyword">Yes</span>/<span class="keyword">No</span></span><br><span class="line">   NormalModes <span class="keyword">Yes</span>/<span class="keyword">No</span></span><br><span class="line">   Other <span class="keyword">Yes</span>/<span class="keyword">No</span></span><br><span class="line">   PESPointCharacter <span class="keyword">Yes</span>/<span class="keyword">No</span></span><br><span class="line">   Phonons <span class="keyword">Yes</span>/<span class="keyword">No</span></span><br><span class="line">   Polarizability <span class="keyword">Yes</span>/<span class="keyword">No</span></span><br><span class="line">   Raman <span class="keyword">Yes</span>/<span class="keyword">No</span></span><br><span class="line">   SelectedRegionForHessian string</span><br><span class="line">   StressTensor <span class="keyword">Yes</span>/<span class="keyword">No</span></span><br><span class="line">   VCD <span class="keyword">Yes</span>/<span class="keyword">No</span></span><br><span class="line">   VROA <span class="keyword">Yes</span>/<span class="keyword">No</span></span><br><span class="line">End</span><br></pre></td></tr></table></figure>
<h1 id="Engine-ADF"><a href="#Engine-ADF" class="headerlink" title="Engine ADF"></a>Engine ADF</h1><h2 id="基组"><a href="#基组" class="headerlink" title="基组"></a>基组</h2><figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">Basis</span><br><span class="line">  <span class="built_in"> Type </span>[<span class="built_in">..</span>.]</span><br><span class="line">   Core [None | Small | Large]</span><br><span class="line">   CreateOutput <span class="literal">Yes</span>/<span class="literal">No</span></span><br><span class="line">   Path string</span><br><span class="line">   PerAtomType</span><br><span class="line">      Core [None | Small | Large]</span><br><span class="line">      File stringS</span><br><span class="line">      Symbol string</span><br><span class="line">     <span class="built_in"> Type </span>[<span class="built_in">..</span>.]</span><br><span class="line">   End</span><br><span class="line">   PerRegion</span><br><span class="line">      Core [None | Small | Large]</span><br><span class="line">      Region string</span><br><span class="line">     <span class="built_in"> Type </span>[<span class="built_in">..</span>.]</span><br><span class="line">   End</span><br><span class="line">   FitType [<span class="built_in">..</span>.]</span><br><span class="line">End</span><br></pre></td></tr></table></figure>
<ul>
<li><code>Type</code>：默认<code>DZ</code>，还有一系列：[SZ, DZ, DZP, TZP, TZ2P, QZ4P, TZ2P-J, QZ4P-J, AUG/ASZ, AUG/ADZ, AUG/ADZP, AUG/ATZP, AUG/ATZ2P, ET/ET-pVQZ, ET/ET-QZ3P, ET/ET-QZ3P-1DIFFUSE, ET/ET-QZ3P-2DIFFUSE, ET/ET-QZ3P-3DIFFUSE, POLTDDFT/DZ, POLTDDFT/DZP, POLTDDFT/TZP, POLTDDFT/TZ2P]</li>
<li><code>Core</code>：默认<code>Large</code>，还可以选择<code>None</code>, <code>Small</code>, <code>Large</code></li>
<li><code>CreateOutput</code>：默认为<code>No</code>。如果为<code>true</code>，原子创建运行的输出将打印到标准输出。如果为<code>false</code>，它将被保存到CreateAtoms.out文件中。</li>
<li><code>Path</code>：默认为<code>$AMSRESOURCES/ADF</code>，ADF只在该文件夹中寻找合适的基组</li>
<li><p><code>PerAtomType</code>：为一类原子指定基组</p>
<ul>
<li><code>File</code>：指定基组的位置，可以是相对于<code>$AMSRESOURCES/ADF</code>的相对位置，也可以是绝对位置</li>
<li><code>Symbol</code>：定义基组的符号</li>
</ul>
</li>
<li><p><code>PerRegion</code>：为一个区域的原子指定基组</p>
<ul>
<li><code>Region</code>：指定基组的区域，可以用逻辑运算符，比如<code>R1+R2</code></li>
</ul>
</li>
</ul>
<h2 id="泛函"><a href="#泛函" class="headerlink" title="泛函"></a>泛函</h2><figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">XC</span><br><span class="line">  &#123;LDA LDA &#123;Stoll&#125;&#125;</span><br><span class="line">  &#123;GGA GGA&#125;</span><br><span class="line">  &#123;MetaGGA metagga&#125;</span><br><span class="line">  &#123;Model MODELPOT [IP]&#125;</span><br><span class="line">  &#123;HartreeFock&#125;</span><br><span class="line">  &#123;OEP fitmethod &#123;approximation&#125;&#125;</span><br><span class="line">  &#123;HYBRID hybrid &#123;<span class="attribute">HF</span>=HFpart&#125;&#125;</span><br><span class="line">  &#123;MetaHYBRID metahybrid&#125;</span><br><span class="line">  &#123;DOUBLEHYBRID doublehybrid&#125;</span><br><span class="line">  &#123;RPA&#125;</span><br><span class="line">  &#123;XCFUN&#125;</span><br><span class="line">  &#123;RANGESEP &#123;<span class="attribute">GAMMA</span>=X&#125; &#123;<span class="attribute">ALPHA</span>=a&#125; &#123;<span class="attribute">BETA</span>=b&#125;&#125;</span><br><span class="line">  (LibXC functional&#125;</span><br><span class="line">  &#123;DISPERSION [s6scaling] [<span class="attribute">RSCALE</span>=r0scaling] [Grimme3] [BJDAMP] [<span class="attribute">PAR1</span>=par1]  [<span class="attribute">PAR2</span>=par2]  [<span class="attribute">PAR3</span>=par3]  [<span class="attribute">PAR4</span>=par4] &#125;</span><br><span class="line">  &#123;Dispersion Grimme4 &#123;<span class="attribute">s6</span>=...&#125; &#123;<span class="attribute">s8</span>=...&#125; &#123;<span class="attribute">a1</span>=...&#125; &#123;<span class="attribute">a2</span>=...&#125;&#125;</span><br><span class="line">  &#123;DISPERSION dDsC&#125;</span><br><span class="line">  &#123;DISPERSION UFF&#125;</span><br><span class="line">end</span><br></pre></td></tr></table></figure>
<h2 id="相对论"><a href="#相对论" class="headerlink" title="相对论"></a>相对论</h2><p>2020版本开始默认使用标量相对论效应：</p>
<figure class="highlight coq"><table><tr><td class="code"><pre><span class="line">Relativity</span><br><span class="line">   Formalism [Pauli | <span class="type">ZORA</span> | <span class="type">X2C</span> | <span class="type">RA</span>-X2C]</span><br><span class="line">   Level [None | <span class="type">A</span> | <span class="type">Spin</span>-Orbit]</span><br><span class="line">   Potential [MAPA | <span class="type">SAPA</span>]</span><br><span class="line">   SpinOrbitMagnetization [NonCollinear | <span class="type">Collinear</span> | <span class="type">CollinearX</span> | <span class="type">CollinearY</span> | <span class="type">CollinearZ</span>]</span><br><span class="line"><span class="keyword">End</span></span><br></pre></td></tr></table></figure>
<ul>
<li><code>Formalism</code>：如果<code>level</code>里是<code>None</code>，则不需要考虑所选择的形式。<ul>
<li><code>Pauli</code>：泡利哈密顿函数</li>
<li><code>ZORA</code>：零阶正则近似哈密顿量。默认。</li>
<li><code>X2C</code>：四分量狄拉克方程到二分量狄拉克方程的精确变换，是Dyall修正的Dirac方程。</li>
<li><code>RA-X2C</code>：四分量狄拉克方程到二分量狄拉克方程的精确变换，是修正狄拉克方程的正规方法。</li>
</ul>
</li>
<li><code>Level</code>：<ul>
<li><code>None</code>：非相对论。哈密顿量也就是Kohn-Sham方程的形式。</li>
<li><code>Scalar</code>：标量相对论，成本较低。默认。</li>
<li><code>Spin-Orbit</code>：旋轨耦合，最好的理论水平，比普通计算昂贵（4-8倍）</li>
</ul>
</li>
<li><code>Potential</code>：<ul>
<li><code>MAPA</code>：默认。the Minumium of neutral Atomical potential Approximation 中性原子势近似值的最小值。MAPA优于SAPA的优点是可以降低ZORA的规格依赖性。 除了电子密度非常接近重核外，几乎所有特性的ZORA规范依赖性都很小。 非常接近重核的电子密度可用于解释Mossbauer光谱中的异构体位移。</li>
<li><code>SAPA</code>：the Sum of neutral Atomical potential Approximation 中性原子势近似值之和。</li>
</ul>
</li>
<li><code>SpinOrbitMagnetization</code>：只与自旋轨道耦合相关，而且在<code>unrestricted</code>下使用。在不受限制的计算中，大多数XC泛函都有自旋极化作为一种成分。通常，自旋量子化轴的方向是任意的，可以方便地选择为z轴。然而，在自旋轨道计算中，方向很重要，将磁化矢量的z分量放入XC函数中是任意的。<ul>
<li><code>NonCollinear</code>：可以将磁化矢量的大小插入XC函数中。 这称为非共线方法。</li>
<li><code>CollinearX</code>，<code>CollinearY</code>，<code>CollinearZ</code>：使用x，y或z分量作为XC函数的自旋极化。默认为z。</li>
<li>：<code>Collinear</code>：同<code>CollinearZ</code></li>
</ul>
</li>
</ul>
<blockquote>
<p>2019版及之前的输入格式为：</p>
<figure class="highlight dust"><table><tr><td class="code"><pre><span class="line"><span class="xml">RELATIVISTIC </span><span class="template-variable">&#123;level&#125;</span><span class="xml"> </span><span class="template-variable">&#123;formalism&#125;</span><span class="xml"> </span><span class="template-variable">&#123;potential&#125;</span></span><br></pre></td></tr></table></figure>
<ul>
<li><blockquote>
<p>Scalar级别为：<code>RELATIVISTIC Scalar ZORA</code></p>
</blockquote>
</li>
<li><p>SpinOrbit级别为：<code>RELATIVISTIC spinorbit ZORA</code></p>
<ul>
<li>注意此时：unrestricted不再适用，解决办法删掉unrestricted或加上collinear/nocollinear，以及nosym关键词</li>
<li>并且不能同时计算解析freq</li>
</ul>
</li>
</ul>
</blockquote>
]]></content>
      <categories>
        <category>计算化学</category>
        <category>AMS</category>
      </categories>
      <tags>
        <tag>输入</tag>
      </tags>
  </entry>
  <entry>
    <title>【AMS】02.几何优化</title>
    <url>/2019/09/23/%E3%80%90AMS%E3%80%9102.%E5%87%A0%E4%BD%95%E4%BC%98%E5%8C%96/</url>
    <content><![CDATA[<h1 id="GeometryOptimization"><a href="#GeometryOptimization" class="headerlink" title="GeometryOptimization"></a><code>GeometryOptimization</code></h1><p>配置几何优化和过渡状态搜索的详细信息。</p>
<figure class="highlight pgsql"><table><tr><td class="code"><pre><span class="line">Task GeometryOptimization</span><br><span class="line"></span><br><span class="line">GeometryOptimization</span><br><span class="line">   Convergence</span><br><span class="line">      Energy <span class="type">float</span></span><br><span class="line">      Gradients <span class="type">float</span></span><br><span class="line">      Step <span class="type">float</span></span><br><span class="line">      StressEnergyPerAtom <span class="type">float</span></span><br><span class="line">   <span class="keyword">End</span></span><br><span class="line">   MaxIterations <span class="type">integer</span></span><br><span class="line">   CalcPropertiesOnlyIfConverged Yes/<span class="keyword">No</span></span><br><span class="line">   OptimizeLattice Yes/<span class="keyword">No</span></span><br><span class="line">   KeepIntermediateResults Yes/<span class="keyword">No</span></span><br><span class="line">   PretendConverged Yes/<span class="keyword">No</span></span><br><span class="line"><span class="keyword">End</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>20版以前的为：</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">GEOMETRY</span><br><span class="line">	Converge &#123;<span class="attribute">E</span>=TolE&#125; &#123;<span class="attribute">Grad</span>=TolG&#125; &#123;<span class="attribute">Rad</span>=TolR&#125; &#123;<span class="attribute">Angle</span>=TolA&#125;</span><br><span class="line">	Iterations Niter</span><br><span class="line">	Inithess inithessian.file</span><br><span class="line">	Hessupd HessUpdate</span><br><span class="line">	Optim &#123;Delocal / Cartesian / Internal&#125; &#123;All / Selected&#125;</span><br><span class="line">	GEigenvalueThreshold threshold</span><br><span class="line">	Branch &#123;New / Old&#125;</span><br><span class="line">	<span class="keyword">Step</span> &#123;<span class="attribute">Rad</span>=MaxRadStep&#125; &#123;<span class="attribute">Angle</span>=MaxAngleStep&#125; &#123;<span class="attribute">TrustRadius</span>=MaxRadius&#125;</span><br><span class="line">	DIIS &#123;<span class="attribute">N</span>=NVect&#125; &#123;<span class="attribute">CYC</span>=Ncyc&#125;</span><br><span class="line">	Externprogram externprog.exe <span class="attribute">coord</span>=coords.inp <span class="attribute">energy</span>=energy.out <span class="attribute">grad</span>=grads.out</span><br><span class="line">End</span><br></pre></td></tr></table></figure>
</blockquote>
<h2 id="Convergence"><a href="#Convergence" class="headerlink" title="Convergence"></a><code>Convergence</code></h2><p>收敛部分的设置：</p>
<ul>
<li><code>Energy</code>：能量变化，默认是<code>1e-05</code>Hartree。</li>
<li><code>Gradients</code>：核梯度的阈值，默认是<code>0.001</code>Hartree/Angstrom</li>
<li><code>Step</code>：收敛几何允许的最大笛卡尔步长，默认是<code>0.01</code>Angstrom</li>
<li><code>StressEnergyPerAtom</code>：优化晶格向量时使用的阈值，默认是<code>0.0005</code>Hartree</li>
</ul>
<p>收敛判定（如果最大梯度和均方根梯度比收敛准则小10倍，则忽略最后两条）</p>
<ul>
<li>当前几何结构和上一个几何步骤的键能之间的差异小于<code>Energy</code></li>
<li>最大笛卡尔核梯度小于<code>Gradients</code></li>
<li>笛卡尔核梯度的均方根(RMS)小于2/3<code>Gradients</code></li>
<li>最大笛卡尔步长小于<code>Step</code></li>
<li>笛卡尔阶跃的均方根(RMS)小于2/3<code>Step</code></li>
</ul>
<p>优化过程会不断地计算不同的分子结构，直到找到最低能量的结构为止。收敛标准得到5个T表示五个收敛标准都达到。其中第二个标准最重要，一般也是最后一个达到的，第二个标准是势能面的梯度最大值。这个标准非常严格，对于大量过渡金属参与的化学反应，过渡态搜索，有可能达不到这样严格的标准，一般到0.003左右也可以认为收敛了，可以将对应的分子结构拿来使用。</p>
<blockquote>
<p>2020版以前为总能量、梯度，笛卡尔步长，键角，默认为：</p>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">GEOMETRY</span></span><br><span class="line"><span class="attribute">Converge</span> <span class="number">1</span>e-<span class="number">3</span> <span class="number">1</span>e-<span class="number">3</span> <span class="number">1</span>e-<span class="number">2</span> <span class="number">0</span>.<span class="number">5</span></span><br><span class="line"><span class="attribute">end</span></span><br></pre></td></tr></table></figure>
</blockquote>
<h2 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h2><ul>
<li><code>MaxIterations</code>：允许收敛到所需结构的最大几何迭代次数。默认是max(30，<script type="math/tex">2 \times N_{free}</script>)，<script type="math/tex">N_{free}</script>是指自由度的数目，接近于3*原子数。</li>
<li><code>CalcPropertiesOnlyIfConverged</code>：默认为<code>Yes</code>，当几何优化（过渡态搜索）收敛时，才计算相应的性质，比如频率，声子等，若为<code>False</code>，不收敛也可以计算。</li>
<li><code>PretendConverged</code>：默认为<code>No</code>，当几何优化不收敛会报错。如果改成<code>True</code>，只会出现一个警告，并且表明几何优化是收敛的，在一些脚本编写中有用。</li>
</ul>
<h2 id="优化方法Method"><a href="#优化方法Method" class="headerlink" title="优化方法Method"></a>优化方法<code>Method</code></h2><ul>
<li><p><code>Method</code>：默认为<code>auto</code>，根据系统大小和支持的优化选项自动选择合适的方法。选项有</p>
<ul>
<li><code>Quasi-Newton</code></li>
<li><code>SCMGO</code></li>
<li><code>FIRE</code></li>
<li><code>L-BFGS</code></li>
<li><code>ConjugateGradients</code></li>
</ul>
</li>
<li><p><code>CoordinateType</code>：默认是<code>auto</code>，自动为给定的方法选择最合适的方法。准牛顿法和SCMGO方法将使用<code>Delocalized</code>，所有其他方法将使用<code>Cartesian</code>。</p>
</li>
<li><p>使用拟牛顿法或 SCMGO 方法优化系统时<span id="初始Hessian">初始模型 Hessian </span>的选项<code>InitialHessian</code>：</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">GeometryOptimization</span><br><span class="line">   InitialHessian</span><br><span class="line">      File string</span><br><span class="line">     <span class="built_in"> Type </span>[Auto | UnitMatrix | Swart | FromFile | Calculate | CalculateWithFastEngine]</span><br><span class="line">   End</span><br><span class="line">End</span><br></pre></td></tr></table></figure>
<ul>
<li><p><code>File</code>：包含初始Hessian（或包含它的结果目录）的KF文件。这可用于加载先前使用[Properties％Hessian]关键字计算出的Hessian。</p>
</li>
<li><p><code>Type</code>：默认为<code>auto</code>，让程序选择初始模型Hessian。</p>
<ul>
<li><code>UnitMatrix</code>：最简单的初始模型Hessian，只是优化坐标中的一个单位矩阵</li>
<li><code>Swart</code>： model Hessian from M. Swart.</li>
<li><code>FromFile</code>：从先前计算的结果加载Hessian。配合<code>File</code>使用</li>
<li><code>Calculate</code>：计算初始的Hessian，计算比较昂贵，大多数建议用于TransitionStateSearch计算</li>
<li><code>CalculateWithFastEngine</code>：使用更快的方法计算初始的Hessian</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="Quasi-Newton"><a href="#Quasi-Newton" class="headerlink" title="Quasi-Newton"></a><code>Quasi-Newton</code></h3><p>准牛顿几何优化：</p>
<figure class="highlight pgsql"><table><tr><td class="code"><pre><span class="line">GeometryOptimization</span><br><span class="line">   Quasi-Newton</span><br><span class="line">      MaxGDIISVectors <span class="type">integer</span></span><br><span class="line">      Step</span><br><span class="line">         TrustRadius <span class="type">float</span></span><br><span class="line">         VaryTrustRadius Yes/<span class="keyword">No</span></span><br><span class="line">      <span class="keyword">End</span></span><br><span class="line">      UpdateTSVectorEveryStep Yes/<span class="keyword">No</span></span><br><span class="line">   <span class="keyword">End</span></span><br><span class="line"><span class="keyword">End</span></span><br></pre></td></tr></table></figure>
<ul>
<li><code>MaxGDIISVectors</code>：设置GDIIS向量的最大数量。默认为<code>0</code>，如果&gt; 0将启用GDIIS方法。</li>
<li><code>Step%TrustRadius</code>：信任半径的初始值。</li>
<li><code>Step%VaryTrustRadius</code>：是否允许信任半径在优化过程中改变。默认情况下，在能量最小化期间为 True，在过渡状态搜索期间为 False。（2021才支持）</li>
<li><code>UpdateTSVectorEveryStep</code>：是否在每个步骤用当前特征向量更新TS反应坐标。默认为<code>Yes</code>。</li>
</ul>
<p>准牛顿优化器使用Hessian计算几何优化步骤。Hessian通常在开始时近似，然后在优化过程中进行更新。因此，非常好的<a href="#初始Hessian">初始Hessian</a>可以提高优化器的性能，并导致更快，更稳定的收敛。</p>
<h3 id="FIRE"><a href="#FIRE" class="headerlink" title="FIRE"></a><code>FIRE</code></h3><figure class="highlight pgsql"><table><tr><td class="code"><pre><span class="line">GeometryOptimization</span><br><span class="line">   FIRE</span><br><span class="line">      AllowOverallRotation Yes/<span class="keyword">No</span></span><br><span class="line">      AllowOverallTranslation Yes/<span class="keyword">No</span></span><br><span class="line">      MapAtomsToUnitCell Yes/<span class="keyword">No</span></span><br><span class="line">      NMin <span class="type">integer</span></span><br><span class="line">      alphaStart <span class="type">float</span></span><br><span class="line">      dtMax <span class="type">float</span></span><br><span class="line">      dtStart <span class="type">float</span></span><br><span class="line">      fAlpha <span class="type">float</span></span><br><span class="line">      fDec <span class="type">float</span></span><br><span class="line">      fInc <span class="type">float</span></span><br><span class="line">      strainMass <span class="type">float</span></span><br><span class="line">   <span class="keyword">End</span></span><br><span class="line"><span class="keyword">End</span></span><br></pre></td></tr></table></figure>
<h3 id="SCMGO"><a href="#SCMGO" class="headerlink" title="SCMGO"></a><code>SCMGO</code></h3><figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">GeometryOptimization</span><br><span class="line">   SCMGO</span><br><span class="line">      ContractPrimitives <span class="literal">Yes</span>/<span class="literal">No</span></span><br><span class="line">      NumericalBMatrix <span class="literal">Yes</span>/<span class="literal">No</span></span><br><span class="line">      <span class="keyword">Step</span></span><br><span class="line">         TrustRadius float</span><br><span class="line">         VariableTrustRadius <span class="literal">Yes</span>/<span class="literal">No</span></span><br><span class="line">      End</span><br><span class="line">      logSCMGO <span class="literal">Yes</span>/<span class="literal">No</span></span><br><span class="line">      testSCMGO <span class="literal">Yes</span>/<span class="literal">No</span></span><br><span class="line">   End</span><br><span class="line">End</span><br></pre></td></tr></table></figure>
<h3 id="HessianFree"><a href="#HessianFree" class="headerlink" title="HessianFree"></a><code>HessianFree</code></h3><p>有限内存BFGS方法</p>
<figure class="highlight fortran"><table><tr><td class="code"><pre><span class="line">GeometryOptimization</span><br><span class="line">   HessianFree</span><br><span class="line">      Step</span><br><span class="line">         MaxCartesianStep <span class="built_in">float</span></span><br><span class="line">         MinRadius <span class="built_in">float</span></span><br><span class="line">         TrialStep <span class="built_in">float</span></span><br><span class="line">         TrustRadius <span class="built_in">float</span></span><br><span class="line">      <span class="keyword">End</span></span><br><span class="line">   <span class="keyword">End</span></span><br><span class="line"><span class="keyword">End</span></span><br></pre></td></tr></table></figure>
<h1 id="重新开始几何优化"><a href="#重新开始几何优化" class="headerlink" title="重新开始几何优化"></a>重新开始几何优化</h1><p>参见AMS的<code>LoadSystem</code>关键词，指定之前优化的ams.rkf文件作为File。可以使用相对路径。</p>
<h1 id="几何不收敛"><a href="#几何不收敛" class="headerlink" title="几何不收敛"></a>几何不收敛</h1><ul>
<li><p>修改<code>CoordinateType</code></p>
</li>
<li><p>修改优化方法：</p>
<figure class="highlight oxygene"><table><tr><td class="code"><pre><span class="line">GeometryOptimization</span><br><span class="line">    <span class="function"><span class="keyword">Method</span> <span class="title">Quasi</span>-<span class="title">Newton</span></span></span><br><span class="line"><span class="function">    <span class="title">Quasi</span>-<span class="title">Newton</span></span></span><br><span class="line"><span class="function">      <span class="title">Step</span></span></span><br><span class="line"><span class="function">         <span class="title">TrustRadius</span> 0.02</span></span><br><span class="line"><span class="function">      <span class="title">End</span></span></span><br><span class="line"><span class="function">      <span class="title">UpdateTSVectorEveryStep</span> <span class="title">True</span></span></span><br><span class="line"><span class="function">    <span class="title">End</span></span></span><br><span class="line"><span class="function"><span class="title">End</span></span></span><br></pre></td></tr></table></figure>
</li>
<li><p>提高<code>Engine ADF</code>中<code>NumericalQuality</code>的精度</p>
</li>
</ul>
<h1 id="限制性几何优化Constraints"><a href="#限制性几何优化Constraints" class="headerlink" title="限制性几何优化Constraints"></a>限制性几何优化<code>Constraints</code></h1><blockquote>
<p>ADF2019中可以直接使用<code>Constraints</code>块</p>
<figure class="highlight puppet"><table><tr><td class="code"><pre><span class="line">CONSTRAINTS</span><br><span class="line">  ATOM <span class="keyword">Ia1</span> &#123;Xa1 Ya1 Za1&#125;</span><br><span class="line">  <span class="keyword">COORD</span> <span class="keyword">Ia1</span> <span class="keyword">Icoord</span> &#123;valcoord&#125;</span><br><span class="line">  <span class="keyword">DIST</span> <span class="keyword">Ia1</span> <span class="keyword">Ia2</span> <span class="keyword">Ra</span></span><br><span class="line">  <span class="keyword">ANGLE</span> <span class="keyword">Ib1</span> <span class="keyword">Ib2</span> <span class="keyword">Ib3</span> <span class="keyword">Rb</span></span><br><span class="line">  <span class="keyword">DIHED</span> <span class="keyword">Ic1</span> <span class="keyword">Ic2</span> <span class="keyword">Ic3</span> <span class="keyword">Ic4</span> <span class="keyword">Rc</span></span><br><span class="line">  <span class="keyword">SUMDIST</span> <span class="keyword">Ic1</span> <span class="keyword">Ic2</span> <span class="keyword">Ic3</span> <span class="keyword">Ic4</span> <span class="keyword">Rc</span></span><br><span class="line">  <span class="keyword">DIFDIST</span> <span class="keyword">Ic1</span> <span class="keyword">Ic2</span> <span class="keyword">Ic3</span> <span class="keyword">Ic4</span> <span class="keyword">Rc</span></span><br><span class="line">  <span class="keyword">BLOCK</span> <span class="keyword">bname</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
</blockquote>
<ul>
<li>在计算开始时，不需要满足约束条件。</li>
</ul>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">Constraints</span><br><span class="line">   Atom <span class="built_in">int</span>eger</span><br><span class="line">   AtomList <span class="built_in">int</span>eger_list</span><br><span class="line">   FixedRegion <span class="built_in">string</span></span><br><span class="line">   Coordinate <span class="built_in">int</span>eger [x|y|z] <span class="built_in">float</span>?</span><br><span class="line">   Distance (<span class="built_in">int</span>eger)&#123;<span class="number">2</span>&#125; <span class="built_in">float</span></span><br><span class="line">   All ... [Bonds|Triangles] ...</span><br><span class="line">   Angle (<span class="built_in">int</span>eger)&#123;<span class="number">3</span>&#125; <span class="built_in">float</span></span><br><span class="line">   Dihedral (<span class="built_in">int</span>eger)&#123;<span class="number">4</span>&#125; <span class="built_in">float</span></span><br><span class="line">   SumDist (<span class="built_in">int</span>eger)&#123;<span class="number">4</span>&#125; <span class="built_in">float</span></span><br><span class="line">   DifDist (<span class="built_in">int</span>eger)&#123;<span class="number">4</span>&#125; <span class="built_in">float</span></span><br><span class="line">   BlockAtoms <span class="built_in">int</span>eger_list</span><br><span class="line">   Block <span class="built_in">string</span></span><br><span class="line">   FreezeStrain [xx] [xy] [xz] [yy] [yz] [zz]</span><br><span class="line">   EqualStrain  [xx] [xy] [xz] [yy] [yz] [zz]</span><br><span class="line">End</span><br></pre></td></tr></table></figure>
<h2 id="固定原子"><a href="#固定原子" class="headerlink" title="固定原子"></a>固定原子</h2><ul>
<li><code>Atom atomIdx</code>：用<code>System%Atoms</code>块中给出的索引<code>atomIdx</code>将原子固定在初始位置，如那样</li>
<li><code>AtomList [atomIdx1 .. atomIdxN]</code>：固定列表中所有原子的初始位置</li>
<li><code>FixedRegion regionName</code>：通过region的方法来指定固定原子块</li>
<li><code>Coordinate atomIdx [x|y|z] coordValue</code>：用原子序号固定原子使其具有<code>coordValue</code>的笛卡尔坐标，如果<code>coordValue</code>缺失，就固定为初始值。</li>
</ul>
<h2 id="内自由度"><a href="#内自由度" class="headerlink" title="内自由度"></a>内自由度</h2><ul>
<li><code>Distance atomIdx1 atomIdx2 distValue</code>：键长</li>
<li><code>Angle atomIdx1 atomIdx2 atomIdx3 angleValue</code>：键角</li>
<li><code>Dihedral atomIdx1 atomIdx2 atomIdx3 atomIdx4 dihedValue</code>：二面角</li>
<li><code>SumDist atomIdx1 atomIdx2 atomIdx3 atomIdx4 sumDistValue</code>：限制R(1,2)+R(3,4) 两个键长之和为固定值</li>
<li><code>DifDist atomIdx1 atomIdx2 atomIdx3 atomIdx4 difDistValue</code>：限制R(1,2)-R(3,4) 两个键长之差为固定值</li>
</ul>
<h2 id="All"><a href="#All" class="headerlink" title="All"></a><code>All</code></h2><ul>
<li><p><code>Distance</code>为特定原子对来设定约束，如果想固定某种键或者键角：</p>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">All</span><span class="meta"> [bondOrder] bonds at1 at2 [to distance]</span></span><br><span class="line"><span class="attribute">All</span> triangles at<span class="number">1</span> at<span class="number">2</span> at<span class="number">3</span></span><br></pre></td></tr></table></figure>
<ul>
<li><code>bondOrder</code>可以是 <code>single</code>，<code>double</code>， <code>triple</code> 或者<code>aromatic</code>，如果省略了它，那么任何特定原子之间的键都会受到约束。</li>
<li>原子名是区分大小写的，它们必须和它们在原子块中的位置一样，或者用星号<code>*</code>表示任何原子。</li>
<li>如果忽略<code>distance</code>，则使用从初始几何结构开始的键长。</li>
</ul>
</li>
<li><p>eg：将所有碳-碳单键的距离限制在1.4埃，所有氢原子键的距离限制在初始距离</p>
</li>
</ul>
<figure class="highlight mathematica"><table><tr><td class="code"><pre><span class="line">Constraints</span><br><span class="line">   <span class="keyword">All</span> single bonds <span class="keyword">C</span> <span class="keyword">C</span> to <span class="number">1.4</span></span><br><span class="line">   <span class="keyword">All</span> bonds H *</span><br><span class="line"><span class="keyword">End</span></span><br></pre></td></tr></table></figure>
<h2 id="区域约束"><a href="#区域约束" class="headerlink" title="区域约束"></a>区域约束</h2><ul>
<li><p><code>BlockAtoms [atomIdx1 ... atomIdxN]</code>：冻结这个原子块的所有内部自由度</p>
</li>
<li><p><code>Block regionName</code>：为Sy<code>stem% atoms</code>块中定义的区域中的所有原子创建一个块约束，如：</p>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">System</span></span><br><span class="line">   <span class="attribute">Atoms</span></span><br><span class="line">      <span class="attribute">C</span>  <span class="number">0</span>.<span class="number">0</span>  <span class="number">0</span>.<span class="number">0</span>  <span class="number">0</span>.<span class="number">0</span>    region=myblock</span><br><span class="line">      <span class="attribute">C</span>  <span class="number">0</span>.<span class="number">0</span>  <span class="number">0</span>.<span class="number">0</span>  <span class="number">1</span>.<span class="number">0</span>    region=myblock</span><br><span class="line">      <span class="attribute">C</span>  <span class="number">0</span>.<span class="number">0</span>  <span class="number">1</span>.<span class="number">0</span>  <span class="number">0</span>.<span class="number">0</span></span><br><span class="line">   <span class="attribute">End</span></span><br><span class="line"><span class="attribute">End</span></span><br><span class="line"><span class="attribute">Constraints</span></span><br><span class="line">   <span class="attribute">Block</span> myblock</span><br><span class="line"><span class="attribute">End</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
]]></content>
      <categories>
        <category>计算化学</category>
        <category>软件</category>
      </categories>
      <tags>
        <tag>AMS</tag>
        <tag>几何优化</tag>
      </tags>
  </entry>
  <entry>
    <title>【AMS】03.振动光谱</title>
    <url>/2019/09/23/%E3%80%90AMS%E3%80%9103.%E6%8C%AF%E5%8A%A8%E5%85%89%E8%B0%B1/</url>
    <content><![CDATA[<ul>
<li><p>通过系统的Hessian矩阵求得，即能量对于原子坐标的二阶导数<script type="math/tex">H_{ij} = \frac{\partial^2E}{\partial{}R_i\partial{}R_j}</script>得到Hessian矩阵。然后Hessian的特征值是相应简正模式的力常数（按照谐振子公式，可以求得谐振频率），特征向量是简正模式。</p>
<ul>
<li>（非质量加权的）Hessian 作为变量保存在引擎结果文件 <code>AMSResults%Hessian</code>中。它不会打印到文本输出。列/行索引的顺序为：原子 1 的 x 分量、原子 1 的 y 分量、原子 1 的 z 分量、原子 2 的 x 分量等。</li>
</ul>
</li>
<li><p>完整 Hessian 的计算非常昂贵（全Hessian的数值计算需要6N个单点计算），因此只能计算完整光谱的一部分或者仅获得系统区域的模式。完整、部分或近似 Hessian 本身对于（基于 Hessian 的）几何优化或过渡状态搜索很有用。</p>
</li>
<li><p>振动谱是通过在PES的一个(局部)最小值上微分法向模的特性而获得的。如果没有几何优化，会得到虚频。</p>
</li>
<li><p>通常与<code>Task SinglePoint</code>、<code>Task GeometryOptimization</code>或<code>Task TransitionStateSearch</code>一起使用 </p>
</li>
<li><p>计算简正模式或振动光谱是通过：</p>
<figure class="highlight gams"><table><tr><td class="code"><pre><span class="line">Properties</span><br><span class="line">   NormalModes <span class="keyword">Yes</span>/<span class="keyword">No</span></span><br><span class="line">   Raman <span class="keyword">Yes</span>/<span class="keyword">No</span></span><br><span class="line">   VROA <span class="keyword">Yes</span>/<span class="keyword">No</span></span><br><span class="line">   VCD <span class="keyword">Yes</span>/<span class="keyword">No</span></span><br><span class="line">   Phonons <span class="keyword">Yes</span>/<span class="keyword">No</span></span><br><span class="line">End</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h1 id="红外光谱"><a href="#红外光谱" class="headerlink" title="红外光谱"></a>红外光谱</h1><figure class="highlight mathematica"><table><tr><td class="code"><pre><span class="line"><span class="keyword">Properties</span></span><br><span class="line">  NormalModes Yes</span><br><span class="line"><span class="keyword">End</span></span><br></pre></td></tr></table></figure>
<p><code>ADF</code>块中也有相应的设置。</p>
<h2 id="重新扫描虚频"><a href="#重新扫描虚频" class="headerlink" title="重新扫描虚频"></a>重新扫描虚频</h2><p>主要用于识别虚频，因此是默认开启的</p>
<figure class="highlight gams"><table><tr><td class="code"><pre><span class="line">NormalModes</span><br><span class="line">   ReScanModes <span class="keyword">Yes</span>/<span class="keyword">No</span></span><br><span class="line">   ReScanFreqRange float_list</span><br><span class="line">End</span><br></pre></td></tr></table></figure>
<ul>
<li><code>ReScanModes</code>：默认是<code>Yes</code>，在正常模式计算结束后是否扫描虚模式。</li>
<li><code>ReScanFreqRange</code>：默认是<code>[-10000000.0, 10.0]</code>，指定将扫描所有模式的频率范围。</li>
</ul>
<blockquote>
<p>ADF19中，这部分的关键词为<code>SCANFREQ low high &#123;NUM=num DISRAD=disrad&#125;</code></p>
<ul>
<li>low high：扫描频率的反位，虚频用负数</li>
<li>num：默认是2，用于数值微分的点数，还可以用4和6</li>
</ul>
</blockquote>
<h1 id="VibrationalAnalysis数值频率"><a href="#VibrationalAnalysis数值频率" class="headerlink" title="VibrationalAnalysis数值频率"></a><code>VibrationalAnalysis</code>数值频率</h1><p>数值频率计算是通过请求<code>VibrationalAnalysis</code>任务来执行的 </p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">Task VibrationalAnalysis</span><br><span class="line">VibrationalAnalysis</span><br><span class="line">  <span class="built_in"> Type </span>ModeScanning</span><br><span class="line">   Displacement 0.001</span><br><span class="line">   NormalModes</span><br><span class="line">     ModeFile adf.rkf</span><br><span class="line">     # select all modes with imaginary frequencies</span><br><span class="line">     ModeSelect</span><br><span class="line">        ImFreq <span class="literal">true</span></span><br><span class="line">     End</span><br><span class="line">   End</span><br><span class="line">End</span><br></pre></td></tr></table></figure>
<h1 id="有虚频"><a href="#有虚频" class="headerlink" title="有虚频"></a>有虚频</h1><ul>
<li><p>在原本的几何坐标上加上虚频的位移。一个简单的脚本。</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line"><span class="meta">#</span><span class="bash">简单查看adf输出的末尾能量，点群和是否有虚频，如果有加上虚频的位移矢量。</span></span><br><span class="line"><span class="meta">#</span><span class="bash">example:adf_simpleout *.out</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">echo &quot; &quot;</span><br><span class="line">echo &quot; &quot;</span><br><span class="line">echo &quot;Geometry: &quot;</span><br><span class="line">opt_geo_line=`grep -n &quot;Coordinates&quot; $&#123;1&#125; |tail -1|cut -d &#x27;:&#x27; -f 1`   #Coordinates in Geometry Cycle</span><br><span class="line">sed -n &quot;$&#123;opt_geo_line&#125;&quot;&#x27;,$p&#x27; $&#123;1&#125;|grep -o &quot;[a-zA-Z]\&#123;1,\&#125;[[:blank:]]\&#123;1,\&#125;-*[0-9]\&#123;1,\&#125;\.[0-9]*[[:blank:]]\&#123;1,\&#125;-*[0-9]\&#123;1,\&#125;\.[0-9]*[[:blank:]]\&#123;1,\&#125;-*[0-9]\&#123;1,\&#125;\.[0-9]*&quot;</span><br><span class="line"></span><br><span class="line">echo &quot;&quot;</span><br><span class="line">grep &#x27;Bond Energy&#x27;  $&#123;1&#125; | tail -3 | awk &#x27;&#123;print $3,$4,$5,$6&#125;&#x27;</span><br><span class="line"></span><br><span class="line">echo &quot;&quot;</span><br><span class="line">grep &#x27;Symmetry&#x27; $&#123;1&#125; |tail -1 | awk &#x27;&#123;print $3,$4,$5&#125;&#x27;</span><br><span class="line"></span><br><span class="line">echo &quot;&quot;</span><br><span class="line">freqline=`grep -n &quot;Vibrations and Normal Modes&quot; $&#123;1&#125; | tail -1| cut -d &#x27;:&#x27; -f 1`</span><br><span class="line">freqstart=`expr $&#123;freqline&#125; + 7`</span><br><span class="line">firstfreq=`sed -n $&#123;freqstart&#125;p $&#123;1&#125;| awk &#x27;&#123;print $1&#125;&#x27;`</span><br><span class="line">echo &quot;The first frequency is $&#123;firstfreq&#125;&quot;</span><br><span class="line"></span><br><span class="line">image=$(echo &quot;$&#123;firstfreq&#125; &lt; 0&quot; | bc)</span><br><span class="line"></span><br><span class="line">if [ $image -eq 1 ]</span><br><span class="line">then </span><br><span class="line"> echo &quot;&quot;</span><br><span class="line"> echo &quot;shift:&quot;</span><br><span class="line"> sed -n &quot;$&#123;opt_geo_line&#125;&quot;&#x27;,$p&#x27; $&#123;1&#125;|grep -o &quot;[a-zA-Z]\&#123;1,\&#125;[[:blank:]]\&#123;1,\&#125;-*[0-9]\&#123;1,\&#125;\.[0-9]*[[:blank:]]\&#123;1,\&#125;-*[0-9]\&#123;1,\&#125;\.[0-9]*[[:blank:]]\&#123;1,\&#125;-*[0-9]\&#123;1,\&#125;\.[0-9]*&quot; &gt; Geometry.txt</span><br><span class="line"> opt_geo_end_line=`grep -n &quot;[a-zA-Z]\&#123;1,\&#125;[[:blank:]]\&#123;1,\&#125;-*[0-9]\&#123;1,\&#125;\.[0-9]*[[:blank:]]\&#123;1,\&#125;-*[0-9]\&#123;1,\&#125;\.[0-9]*[[:blank:]]\&#123;1,\&#125;-*[0-9]\&#123;1,\&#125;\.[0-9]&quot; *out|tail -1|cut -d &#x27;:&#x27; -f 1`</span><br><span class="line"> atom_num=`expr $&#123;opt_geo_end_line&#125; - $&#123;opt_geo_line&#125; - 1`  </span><br><span class="line"> freq1=`expr $&#123;freqstart&#125; + 2`</span><br><span class="line"> freq2=`expr $&#123;freqline&#125; + 9 + $&#123;atom_num&#125;`</span><br><span class="line"> sed -n $&#123;freq1&#125;,$&#123;freq2&#125;p $&#123;1&#125; | awk &#x27;&#123;print $2,$3,$4&#125;&#x27; &gt; imagefreq.txt</span><br><span class="line"> for ((i=1; i &lt;= $&#123;atom_num&#125;;i++));do</span><br><span class="line">   a=`sed -n $&#123;i&#125;p Geometry.txt | awk &#x27;&#123; print $1 &#125;&#x27;` </span><br><span class="line">  </span><br><span class="line">   numx1=`sed -n $&#123;i&#125;p Geometry.txt | awk &#x27;&#123; print $2 &#125;&#x27;`</span><br><span class="line">   numx2=`sed -n $&#123;i&#125;p imagefreq.txt | awk &#x27;&#123; print $1 &#125;&#x27;` </span><br><span class="line">   numx3=$(echo &quot; $numx1 + $numx2 &quot;|bc)</span><br><span class="line">    </span><br><span class="line">   numy1=`sed -n $&#123;i&#125;p Geometry.txt | awk &#x27;&#123; print $3 &#125;&#x27;`</span><br><span class="line">   numy2=`sed -n $&#123;i&#125;p imagefreq.txt | awk &#x27;&#123; print $2 &#125;&#x27;`</span><br><span class="line">   numy3=$(echo &quot; $numy1 + $numy2 &quot;|bc)   </span><br><span class="line">   </span><br><span class="line">   numz1=`sed -n $&#123;i&#125;p Geometry.txt | awk &#x27;&#123; print $4 &#125;&#x27;`</span><br><span class="line">   numz2=`sed -n $&#123;i&#125;p imagefreq.txt | awk &#x27;&#123; print $3 &#125;&#x27;`</span><br><span class="line">   numz3=$(echo &quot; $numz1 + $numz2 &quot;|bc)</span><br><span class="line">  </span><br><span class="line">   printf &quot;%-10s %10.6f %10.6f %10.6f \n&quot; $a $numx3 $numy3 $numz3 </span><br><span class="line"> done</span><br><span class="line">rm Geometry.txt imagefreq.txt</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line">echo &quot; &quot;</span><br><span class="line">echo &quot; &quot;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
</li>
</ul>
]]></content>
      <categories>
        <category>计算化学</category>
        <category>软件</category>
      </categories>
      <tags>
        <tag>AMS</tag>
        <tag>频率</tag>
      </tags>
  </entry>
  <entry>
    <title>【AMS】04.键级</title>
    <url>/2020/06/24/%E3%80%90AMS%E3%80%9104.%E9%94%AE%E7%BA%A7/</url>
    <content><![CDATA[<p>键级的计算要在<code>Engine ADF</code>中指定对称性为<code>NOSYM</code></p>
<figure class="highlight properties"><table><tr><td class="code"><pre><span class="line"><span class="attr">Engine</span> <span class="string">ADF </span></span><br><span class="line">  <span class="attr">symmetry</span> <span class="string">NOSYM</span></span><br><span class="line"><span class="attr">EndEngine</span></span><br></pre></td></tr></table></figure>
<ol>
<li>在<code>Properties</code>中指定：</li>
</ol>
<figure class="highlight mathematica"><table><tr><td class="code"><pre><span class="line"><span class="keyword">Properties</span></span><br><span class="line">   BondOrders Yes</span><br><span class="line"><span class="keyword">End</span></span><br></pre></td></tr></table></figure>
<ol>
<li>在<code>Engine ADF</code>中指定：</li>
</ol>
<figure class="highlight coq"><table><tr><td class="code"><pre><span class="line">BondOrders</span><br><span class="line">   PrintAll Yes/No</span><br><span class="line">   PrintTolerance float</span><br><span class="line">   TypeForAMS [Nalewajski-Mrozek<span class="number">-1</span> | <span class="type">Nalewajski</span>-Mrozek<span class="number">-2</span> | <span class="type">Nalewajski</span>-Mrozek<span class="number">-3</span> | <span class="type">Mayer</span> | <span class="type">Gopinathan</span>-Jug]</span><br><span class="line"><span class="keyword">End</span></span><br></pre></td></tr></table></figure>
<ul>
<li><code>PrintAll</code>：默认<code>No</code>，如果为是，将输出所有5种键级</li>
<li><code>PrintTolerance</code>：默认为<code>0.2</code>，大于该阈值才能被输出</li>
<li><code>TypeForAMS</code>：选择输出键级的种类。</li>
</ul>
<h1 id="2020版本之前"><a href="#2020版本之前" class="headerlink" title="2020版本之前"></a>2020版本之前</h1><h2 id="MAYER键级等"><a href="#MAYER键级等" class="headerlink" title="MAYER键级等"></a>MAYER键级等</h2><h3 id="输入"><a href="#输入" class="headerlink" title="输入"></a>输入</h3><ul>
<li><p>优化好的结构，再算single point</p>
</li>
<li><p>设置好single piont的相关输入后，再点击ADFinput &gt; Details &gt; Userinput，在窗口中输入： </p>
<figure class="highlight ebnf"><table><tr><td class="code"><pre><span class="line"><span class="attribute">bondorder printall</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>默认显示大于0.2的键级，如果需要自定义阈值，例如0.0（所有原子之间的键级无论大小均列出）可以设置为：</p>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">bondorder</span> printall tol=<span class="number">0</span>.<span class="number">0</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>同时ADFinput &gt; Details &gt; Symmetry，将默认的Auto改为<code>NOSYM</code>。</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">……</span><br><span class="line">……</span><br><span class="line">bondorder printall</span><br><span class="line">ATOMS</span><br><span class="line">1 C      -5.772012228837       0.492926664171      -0.000000000000    </span><br><span class="line">……</span><br><span class="line">……</span><br><span class="line">……</span><br><span class="line">SYMMETRY NOSYM</span><br><span class="line"></span><br><span class="line">BASIS</span><br><span class="line">type TZP</span><br><span class="line">……</span><br><span class="line">……</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="输出"><a href="#输出" class="headerlink" title="输出"></a>输出</h3><ul>
<li><p>计算完毕后，得到所有原子，两两之间的MAYER、G-J、N-M (1)、N-M (2)、N-M (3) (*)键级关系</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">-----------------------------------------------------------------------------------------------</span><br><span class="line">                          DIST. [A]                   BOND-ORDERS</span><br><span class="line">                                                  (THRESHOLD =  <span class="number">0.000</span> )</span><br><span class="line"> -----------------------------------------------------------------------------------------------</span><br><span class="line">                                      MAYER        G-J    N-M (<span class="number">1</span>)    N-M (<span class="number">2</span>)    N-M (<span class="number">3</span>) (*)</span><br><span class="line"> -----------------------------------------------------------------------------------------------</span><br><span class="line">  C      <span class="number">1</span> - C      <span class="number">2</span>     <span class="number">1.4005</span>     <span class="number">1.2389</span>     <span class="number">1.4344</span>     <span class="number">1.4936</span>     <span class="number">1.4415</span>     <span class="number">1.5643</span></span><br><span class="line">  C      <span class="number">1</span> - C      <span class="number">3</span>     <span class="number">2.4257</span>    <span class="number">-0.0243</span>     <span class="number">0.0085</span>     <span class="number">0.0089</span>    <span class="number">-0.0294</span>     <span class="number">0.0093</span></span><br><span class="line">  C      <span class="number">1</span> - C      <span class="number">4</span>     <span class="number">2.8009</span>     <span class="number">0.0719</span>     <span class="number">0.1189</span>     <span class="number">0.1238</span>     <span class="number">0.0845</span>     <span class="number">0.1297</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
]]></content>
      <categories>
        <category>计算化学</category>
        <category>软件</category>
      </categories>
      <tags>
        <tag>键级</tag>
        <tag>AMS</tag>
      </tags>
  </entry>
  <entry>
    <title>【AMS】05.过渡态</title>
    <url>/2020/06/24/%E3%80%90AMS%E3%80%9105.%E8%BF%87%E6%B8%A1%E6%80%81/</url>
    <content><![CDATA[<h1 id="1-线性扫描"><a href="#1-线性扫描" class="headerlink" title="1. 线性扫描"></a>1. 线性扫描</h1><ul>
<li><p>将反应物放在一起，猜测反应路径，即一个反应物靠近另一个反应物的过程。可以是键长、键角、二面角等。</p>
</li>
<li><p>设置扫描的范围和点数。</p>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">Task</span> PESScan</span><br><span class="line"><span class="attribute">PESScan</span></span><br><span class="line">    <span class="attribute">ScanCoordinate</span></span><br><span class="line">        <span class="attribute">nPoints</span> <span class="number">10</span></span><br><span class="line">        <span class="attribute">Angle</span> <span class="number">6</span> <span class="number">1</span> <span class="number">7</span> <span class="number">28</span>.<span class="number">9</span>  <span class="number">90</span></span><br><span class="line">    <span class="attribute">End</span></span><br><span class="line"><span class="attribute">End</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>如果是两个参数同时 变化，扫描10个点，则是：</p>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">Task</span> PESScan</span><br><span class="line"><span class="attribute">PESScan</span></span><br><span class="line">    <span class="attribute">ScanCoordinate</span></span><br><span class="line">        <span class="attribute">nPoints</span> <span class="number">10</span></span><br><span class="line">        <span class="attribute">Distance</span>  <span class="number">1</span> <span class="number">2</span>  <span class="number">0</span>.<span class="number">8</span> <span class="number">1</span>.<span class="number">1</span></span><br><span class="line">        <span class="attribute">Distance</span>  <span class="number">1</span> <span class="number">3</span>  <span class="number">0</span>.<span class="number">8</span> <span class="number">1</span>.<span class="number">1</span></span><br><span class="line">    <span class="attribute">End</span></span><br><span class="line"><span class="attribute">End</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>计算完成后，基于能量最高的点再进行单点频率计算。</p>
</li>
</ul>
<h1 id="2-频率计算"><a href="#2-频率计算" class="headerlink" title="2. 频率计算"></a>2. 频率计算</h1><figure class="highlight ada"><table><tr><td class="code"><pre><span class="line"><span class="keyword">Task</span> SinglePoint</span><br><span class="line">Properties</span><br><span class="line">  NormalModes YES</span><br><span class="line"><span class="keyword">END</span></span><br></pre></td></tr></table></figure>
<h1 id="3-过渡态搜索"><a href="#3-过渡态搜索" class="headerlink" title="3. 过渡态搜索"></a>3. 过渡态搜索</h1><figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">Task TransitionStateSearch</span><br><span class="line">GeometryOptimization</span><br><span class="line">    InitialHessian</span><br><span class="line">       <span class="built_in"> Type </span>FromFile</span><br><span class="line">        File <span class="built_in">..</span>/2_SinglePoint/XXXX.rkf</span><br><span class="line">    End</span><br><span class="line">End</span><br><span class="line">Properties</span><br><span class="line">    NormalModes <span class="literal">Yes</span></span><br><span class="line">End</span><br></pre></td></tr></table></figure>
<h1 id="通过PESScan计算"><a href="#通过PESScan计算" class="headerlink" title="通过PESScan计算"></a>通过<code>PESScan</code>计算</h1><ol>
<li><p><strong>优化反应物和产物的结构</strong></p>
</li>
<li><p>猜测反应路径进行PESScan扫描计算。</p>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">Task</span> PESScan</span><br><span class="line"><span class="attribute">PESScan</span></span><br><span class="line">    <span class="attribute">ScanCoordinate</span></span><br><span class="line">        <span class="attribute">nPoints</span> <span class="number">10</span></span><br><span class="line">        <span class="attribute">Distance</span> <span class="number">1</span> <span class="number">7</span> <span class="number">2</span>.<span class="number">092447</span> <span class="number">3</span>.<span class="number">0</span></span><br><span class="line">        <span class="attribute">Distance</span> <span class="number">1</span> <span class="number">6</span> <span class="number">2</span>.<span class="number">092447</span> <span class="number">3</span>.<span class="number">0</span></span><br><span class="line">    <span class="attribute">End</span></span><br><span class="line"><span class="attribute">End</span></span><br></pre></td></tr></table></figure>
<ul>
<li><p>如果需要确认过渡态，每个点计算频率比较费时，因此可以仅仅确认每个点的特征</p>
<figure class="highlight gams"><table><tr><td class="code"><pre><span class="line">Properties</span><br><span class="line">   PESPointCharacter <span class="keyword">Yes</span>/<span class="keyword">No</span></span><br><span class="line">End</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>计算2中反应路径最高点，看是否有虚频</p>
<figure class="highlight ada"><table><tr><td class="code"><pre><span class="line"><span class="keyword">Task</span> SinglePoint</span><br><span class="line">Properties</span><br><span class="line">    NormalModes Yes</span><br><span class="line"><span class="keyword">End</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>对该点进行过渡态搜索，可以读3中的输出来进行计算。</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">Task TransitionStateSearch</span><br><span class="line">GeometryOptimization</span><br><span class="line">    InitialHessian</span><br><span class="line">       <span class="built_in"> Type </span>FromFile</span><br><span class="line">        File <span class="built_in">..</span>/3_step/OgF6_Scan.rkf</span><br><span class="line">    End</span><br><span class="line">End</span><br><span class="line">Properties</span><br><span class="line">   NormalModes <span class="literal">Yes</span></span><br><span class="line">End</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="PESScan的详细设置"><a href="#PESScan的详细设置" class="headerlink" title="PESScan的详细设置"></a>PESScan的详细设置</h2><figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">PESScan</span><br><span class="line">   CalcPropertiesAtPESPoints [True | False]</span><br><span class="line">   FillUnconvergedGaps [True | False]</span><br><span class="line">   ScanCoordinate</span><br><span class="line">      nPoints <span class="built_in">int</span>eger</span><br><span class="line">      Coordinate <span class="built_in">int</span>eger [x|y|z] (<span class="built_in">float</span>)&#123;<span class="number">2</span>&#125;</span><br><span class="line">      Distance (<span class="built_in">int</span>eger)&#123;<span class="number">2</span>&#125; (<span class="built_in">float</span>)&#123;<span class="number">2</span>&#125;</span><br><span class="line">      Angle (<span class="built_in">int</span>eger)&#123;<span class="number">3</span>&#125; (<span class="built_in">float</span>)&#123;<span class="number">2</span>&#125;</span><br><span class="line">      Dihedral (<span class="built_in">int</span>eger)&#123;<span class="number">4</span>&#125; (<span class="built_in">float</span>)&#123;<span class="number">2</span>&#125;</span><br><span class="line">      SumDist (<span class="built_in">int</span>eger)&#123;<span class="number">4</span>&#125; (<span class="built_in">float</span>)&#123;<span class="number">2</span>&#125;</span><br><span class="line">      DifDist (<span class="built_in">int</span>eger)&#123;<span class="number">4</span>&#125; (<span class="built_in">float</span>)&#123;<span class="number">2</span>&#125;</span><br><span class="line">   End</span><br><span class="line">End</span><br></pre></td></tr></table></figure>
<ul>
<li><p><code>CalcPropertiesAtPESPoints</code>：是否对 PES 的所有采样点执行额外的属性计算。默认为<code>False</code>。</p>
</li>
<li><p><code>FillUnconvergedGaps</code>：在最初通过 PES 后，从收敛的相邻点重新开始未收敛的点。默认为<code>Yes</code>。</p>
</li>
<li><p><code>PESScan</code>块中至少要包含一个<code>ScanCoordinate</code>块，指定要扫描的坐标和计算几何结构数目。默认情况下，沿每个扫描坐标（包括扫描的起点和终点）采样 10 个点。</p>
<ul>
<li><p>可以同时扫描两个坐标：</p>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">ScanCoordinate</span></span><br><span class="line">   <span class="attribute">Distance</span>  <span class="number">1</span> <span class="number">2</span>  <span class="number">0</span>.<span class="number">8</span> <span class="number">1</span>.<span class="number">1</span></span><br><span class="line">   <span class="attribute">Distance</span>  <span class="number">1</span> <span class="number">3</span>  <span class="number">0</span>.<span class="number">8</span> <span class="number">1</span>.<span class="number">1</span></span><br><span class="line"><span class="attribute">End</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>也可以分别扫描两个坐标</p>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">ScanCoordinate</span></span><br><span class="line">   <span class="attribute">Distance</span>  <span class="number">1</span> <span class="number">2</span>  <span class="number">0</span>.<span class="number">8</span> <span class="number">1</span>.<span class="number">1</span></span><br><span class="line">   <span class="attribute">Distance</span>  <span class="number">1</span> <span class="number">3</span>  <span class="number">0</span>.<span class="number">8</span> <span class="number">1</span>.<span class="number">1</span></span><br><span class="line"><span class="attribute">End</span></span><br><span class="line"><span class="attribute">ScanCoordinate</span></span><br><span class="line">   <span class="attribute">Angle</span>  <span class="number">2</span> <span class="number">1</span> <span class="number">3</span>  <span class="number">90</span> <span class="number">130</span></span><br><span class="line"><span class="attribute">End</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h1 id="通过NEB计算"><a href="#通过NEB计算" class="headerlink" title="通过NEB计算"></a>通过<code>NEB</code>计算</h1><ol>
<li><p>优化反应物和产物的结构</p>
</li>
<li><p>给出初始结果和最终结构</p>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="comment"># This is the initial system:</span></span><br><span class="line"><span class="attribute">System</span></span><br><span class="line">   <span class="attribute">Atoms</span></span><br><span class="line">      <span class="attribute">C</span>   <span class="number">0</span>.<span class="number">0000</span>   <span class="number">0</span>.<span class="number">0000</span>   <span class="number">0</span>.<span class="number">0000</span></span><br><span class="line">      <span class="attribute">N</span>   <span class="number">1</span>.<span class="number">1800</span>   <span class="number">0</span>.<span class="number">0000</span>   <span class="number">0</span>.<span class="number">0000</span></span><br><span class="line">      <span class="attribute">H</span>   <span class="number">2</span>.<span class="number">1960</span>   <span class="number">0</span>.<span class="number">0000</span>   <span class="number">0</span>.<span class="number">0000</span></span><br><span class="line">   <span class="attribute">End</span></span><br><span class="line"><span class="attribute">End</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># This is the final system (note the header &#x27;final&#x27; in the next line):</span></span><br><span class="line"><span class="attribute">System</span> final</span><br><span class="line">   <span class="attribute">Atoms</span></span><br><span class="line">      <span class="attribute">C</span>   <span class="number">0</span>.<span class="number">0000</span>   <span class="number">0</span>.<span class="number">0000</span>   <span class="number">0</span>.<span class="number">0000</span></span><br><span class="line">      <span class="attribute">N</span>   <span class="number">1</span>.<span class="number">1630</span>   <span class="number">0</span>.<span class="number">0000</span>   <span class="number">0</span>.<span class="number">0000</span></span><br><span class="line">      <span class="attribute">H</span>  -<span class="number">1</span>.<span class="number">0780</span>   <span class="number">0</span>.<span class="number">0000</span>   <span class="number">0</span>.<span class="number">0000</span></span><br><span class="line">   <span class="attribute">End</span></span><br><span class="line"><span class="attribute">End</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">Task</span> NEB</span><br><span class="line"><span class="attribute">Properties</span></span><br><span class="line">    <span class="attribute">PESPointCharacter</span> Yes</span><br><span class="line"><span class="attribute">End</span></span><br><span class="line"><span class="attribute">NEB</span></span><br><span class="line">    <span class="attribute">Images</span> <span class="number">20</span></span><br><span class="line"><span class="attribute">End</span></span><br></pre></td></tr></table></figure>
<ul>
<li>也可以用<code>System intermediate</code>给定第三个结构，来为过渡状态提供更好的近似值。此时最好将<code>OptimizeEnds</code>设置为<code>False</code>防止创建不平衡的反应路径。</li>
</ul>
</li>
</ol>
<h2 id="NEB的相关选项"><a href="#NEB的相关选项" class="headerlink" title="NEB的相关选项"></a>NEB的相关选项</h2><figure class="highlight gams"><table><tr><td class="code"><pre><span class="line">NEB</span><br><span class="line">   Climbing <span class="keyword">Yes</span>/<span class="keyword">No</span></span><br><span class="line">   ClimbingThreshold float</span><br><span class="line">   Images <span class="keyword">integer</span></span><br><span class="line">   InterpolateInternal <span class="keyword">Yes</span>/<span class="keyword">No</span></span><br><span class="line">   InterpolateShortest <span class="keyword">Yes</span>/<span class="keyword">No</span></span><br><span class="line">   Iterations <span class="keyword">integer</span></span><br><span class="line">   Jacobian float        #固态 NEB</span><br><span class="line">   MapAtomsToCell <span class="keyword">Yes</span>/<span class="keyword">No</span>  #固态 NEB</span><br><span class="line">   OldTangent <span class="keyword">Yes</span>/<span class="keyword">No</span></span><br><span class="line">   OptimizeEnds <span class="keyword">Yes</span>/<span class="keyword">No</span></span><br><span class="line">   OptimizeLattice <span class="keyword">Yes</span>/<span class="keyword">No</span>  #固态 NEB</span><br><span class="line">   Parallel</span><br><span class="line">      nCoresPerGroup <span class="keyword">integer</span></span><br><span class="line">      nGroups <span class="keyword">integer</span></span><br><span class="line">      nNodesPerGroup <span class="keyword">integer</span></span><br><span class="line">   End</span><br><span class="line">   ReOptimizeEnds <span class="keyword">Yes</span>/<span class="keyword">No</span></span><br><span class="line">   Restart string</span><br><span class="line">   Skewness float</span><br><span class="line">   Spring float</span><br><span class="line">End</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li><code>Climbing</code>：默认为<code>yes</code>。使用爬升图像算法将最高图像驱动到过渡状态。</li>
<li><p><code>ClimbingThreshold</code>：默认为<code>0.0</code>Hartree/Bohr。如果 ClimbingThreshold &gt; 0 并且最大垂直力分量高于阈值，则在此步骤不执行攀爬。此条目可用于在开始搜索过渡态之前获得对反应路径的更好近似。典型值为 <code>0.01</code> Hartree/Bohr。</p>
</li>
<li><p><code>Images</code>：默认为<code>8</code>，即NEB 图像的数量（不包括两端）</p>
</li>
<li><code>InterpolateInternal</code>：默认为<code>yes</code>。初始 NEB 图像几何形状是通过在初始状态和最终状态之间进行插值来计算的。默认情况下，对于非周期系统，插值是在内部坐标系中执行的，但用户可以选择在笛卡尔坐标系中执行。对于周期系统，插值总是在笛卡尔坐标中完成。</li>
<li><code>InterpolateShortest</code>：默认为<code>yes</code>。允许跨周期性单元边界进行插值。</li>
<li><code>Iterations</code>：NEB 迭代的最大次数。默认值取决于自由度的数量（图像数量、原子数量、周期维度）。</li>
<li><code>OptimizeEnds</code>：通过优化反应物和产品几何结构启动 NEB。默认为<code>yes</code>。</li>
<li><code>Restart</code>：提供来自先前 NEB 计算的 ams.rkf 文件以重新开始。</li>
<li><code>ReOptimizeEnds</code>：重新启动时重新优化反应物和产品的几何形状。默认为<code>No</code>。</li>
<li><code>Spring</code>：力常数，单位是原子单位Hartree/Bohr^2，默认为<code>1.0</code>。</li>
<li><code>Skewness</code>：图像移向或远离 TS 的程度，默认为<code>1.0</code>。大于 1 的值将确保图像集中在过渡状态附近。最佳值取决于路径长度、图像数量（更长的路径和更少的图像可能需要更大的 [Skewness]）</li>
</ul>
<p>在每次迭代中，可以并行计算图像。并行执行通常是完全自动配置的，也可以通过<code>Parallel</code>指定：</p>
<ul>
<li><code>nCoresPerGroup</code>：每个工作组中的内核数。</li>
<li><code>nGroups</code>：处理器组的总数。这是将并行执行的任务数。</li>
<li><code>nNodesPerGroup</code>：每组中的节点数。</li>
</ul>
<h1 id="通过PESExploration计算"><a href="#通过PESExploration计算" class="headerlink" title="通过PESExploration计算"></a>通过<code>PESExploration</code>计算</h1>]]></content>
      <categories>
        <category>计算化学</category>
        <category>软件</category>
      </categories>
      <tags>
        <tag>AMS</tag>
        <tag>过渡态</tag>
      </tags>
  </entry>
  <entry>
    <title>【CP2K】01.基础</title>
    <url>/2020/11/20/%E3%80%90CP2K%E3%80%9101.%E5%9F%BA%E7%A1%80/</url>
    <content><![CDATA[<h1 id="安装vim插件规范-inp文件"><a href="#安装vim插件规范-inp文件" class="headerlink" title="安装vim插件规范.inp文件"></a>安装vim插件规范.inp文件</h1><ol>
<li><p>如果下载失败，可以直接从<a href="http://manual.cp2k.org/trunk/cp2k.vim下载到">http://manual.cp2k.org/trunk/cp2k.vim下载到</a> ~/.vim/syntax中</p>
<figure class="highlight awk"><table><tr><td class="code"><pre><span class="line">mkdir -p ~<span class="regexp">/.vim/</span>syntax</span><br><span class="line">wget -O ~<span class="regexp">/.vim/</span>syntax<span class="regexp">/cp2k.vim http:/</span><span class="regexp">/manual.cp2k.org/</span>trunk/cp2k.vim</span><br></pre></td></tr></table></figure>
</li>
<li><p>再在~/.vim/下新建<code>filetype.vim</code>，输入：</p>
<figure class="highlight vim"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> <span class="built_in">exists</span>(<span class="string">&quot;did_load_filetypes&quot;</span>)</span><br><span class="line">   <span class="keyword">finish</span></span><br><span class="line"><span class="keyword">endif</span></span><br><span class="line"><span class="keyword">augroup</span> filetypedetect</span><br><span class="line">   au! BufNewFile,BufRead *.inp <span class="keyword">setf</span> cp2k</span><br><span class="line"><span class="keyword">augroup</span> END</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="语法折叠"><a href="#语法折叠" class="headerlink" title="语法折叠"></a>语法折叠</h2><p>在~/.vimrc中添加：</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">au FileType cp2k setlocal <span class="attribute">foldlevel</span>=99 <span class="attribute">foldmethod</span>=indent</span><br></pre></td></tr></table></figure>
<ul>
<li><code>za</code>：切换当前折叠级别的折叠</li>
<li><code>zA</code>：递归切换所有折叠级别的折叠</li>
<li><code>zM</code>：关闭当前缓冲区中的所有折叠</li>
<li><code>zR</code>：打开当前缓冲区中的所有折叠</li>
</ul>
<h2 id="自动缩进"><a href="#自动缩进" class="headerlink" title="自动缩进"></a>自动缩进</h2><p>只更改指定文件类型cp2k的缩进，在~/.vimrc中添加：</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">au FileType cp2k setlocal <span class="attribute">shiftwidth</span>=1 <span class="attribute">tabstop</span>=1</span><br></pre></td></tr></table></figure>
<p>更改所有文件类型和缓冲区的缩进：</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line"><span class="builtin-name">set</span> <span class="attribute">shiftwidth</span>=1 <span class="attribute">tabstop</span>=1</span><br></pre></td></tr></table></figure>
<ul>
<li><code>=G</code>正确缩进文件的整个部分</li>
<li><code>=</code>正确缩进文件的某个部分（区域）</li>
</ul>
<h1 id="inp语法"><a href="#inp语法" class="headerlink" title="inp语法"></a>inp语法</h1><p>可以在cp2k目录下，通过<code>grep -iR 关键词 ~/tests</code>来查询相关的输入文件。（tests目录中的输入文件主要是用来测试程序运行的正常与否，往往使用了不合理的参数）</p>
<ul>
<li><p>主要结构如下，可以在其中嵌套多个<code>&amp;SECTION</code>和<code>&amp;END SECTION</code></p>
<figure class="highlight ruleslanguage"><table><tr><td class="code"><pre><span class="line">&amp;<span class="keyword">SECTION</span></span><br><span class="line">	KEYWORD PARAMETER</span><br><span class="line">&amp;<span class="keyword">END</span> <span class="keyword">SECTION</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>语法</p>
<ul>
<li><code>@INCLUDE ’filename’</code>：从文件中读取文本</li>
<li><code>@SET VAR value</code>：定义变量</li>
<li><code>@VAR</code>：变量</li>
<li><code>@IF</code>/<code>@ENDIF</code>：简单的逻辑</li>
<li><code>#</code>：注释</li>
</ul>
</li>
<li><p>单位的设定：（可供的单位有：<a href="https://manual.cp2k.org/cp2k-7_1-branch/units.html）">https://manual.cp2k.org/cp2k-7_1-branch/units.html）</a></p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment">#默认是angstrom，也可以设置bohr等等</span></span><br><span class="line"><span class="string">ABC</span> [<span class="string">nm</span>] <span class="number">100</span> <span class="number">100</span> <span class="number">100</span></span><br><span class="line"><span class="comment">#默认是hatree，设置Ry等等</span></span><br><span class="line"><span class="string">EMAX_SPLINE</span> [<span class="string">eV</span>] <span class="number">50</span></span><br><span class="line"><span class="comment">#也可以一起用</span></span><br><span class="line">[<span class="string">hatree*bohr^2</span>]</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="GLOBAL"><a href="#GLOBAL" class="headerlink" title="GLOBAL"></a>GLOBAL</h2><figure class="highlight properties"><table><tr><td class="code"><pre><span class="line"><span class="attr">&amp;GLOBAL</span></span><br><span class="line">	<span class="attr">PROJECT</span> <span class="string">H2O-32</span></span><br><span class="line">	<span class="attr">RUN_TYPE</span> <span class="string">MD</span></span><br><span class="line">	<span class="attr">PRINT_LEVEL</span> <span class="string">HIGH</span></span><br><span class="line">	<span class="attr">&amp;TIMINGS</span></span><br><span class="line">		<span class="attr">THRESHOLD</span> <span class="string">0.000001</span></span><br><span class="line">	<span class="attr">&amp;END</span></span><br><span class="line">	<span class="attr">WALLTIME</span> <span class="string">3600</span></span><br><span class="line"><span class="meta">&amp;END</span> <span class="string">GLOBAL</span></span><br></pre></td></tr></table></figure>
<ul>
<li><code>PROJECT</code>：任务名称，等同于<code>PROJECT_NAME</code></li>
<li><code>RUN_TYPE</code>：任务类型<ul>
<li><code>ENERGY</code>：计算当前结构的能量。对于DFT 来说，就是一个SCF 计算。</li>
<li><code>ENERGY_FORCE</code>：计算当前结构的能量，同时计算出每个原子上的梯度（即受力）。</li>
<li><code>BAND</code>：使用band方法来进行最低能量路径(MEP)以及反应过渡态的搜索，通常可以使用的方法有CI-NEB, IT-NEB等方法。</li>
<li><code>MD</code>：Molecular Dynamics分子动力学模拟</li>
<li><code>CELL_OPT</code>：晶胞参数的优化。</li>
<li><code>GEO_OPT</code>：对当前结构进行几何结构的优化，以获得当前结构对应的局部极小点或者过渡态。GEO_OPT 有两种类型，一种是MINIMIZATION，即优化到极小点；一种是TRANSITION_STATE，即优化到过渡态。过渡态的优化采用Dimer方法来实现。</li>
<li><code>VIBRATIONAL_ANALYSIS</code>：对当前结构进行振动分析。频率计算可以计算部分原子的频率（INVOLVED_ATOMS），也可以计算某一频率范围内的频率计算（MODE_SELECTIVE）。</li>
</ul>
</li>
<li><code>PRINT_LEVEL</code>：输出内容级别，可以是<code>SILENT</code>、<code>MEDIUM</code>（默认）、<code>LOW</code>、<code>HIGH</code>等。</li>
<li><code>&amp;TIMINGS</code>：在CP2K执行结束时控制时序报告的打印<ul>
<li><code>THRESHOLD</code>：阈值</li>
</ul>
</li>
<li><code>WALLTIME</code>：此运行的最大执行时间。时间以秒为单位或以HH：MM：SS为单位。</li>
</ul>
<h2 id="FORCE-EVAL"><a href="#FORCE-EVAL" class="headerlink" title="FORCE_EVAL"></a>FORCE_EVAL</h2><p>计算能量和力并描述您要分析的系统所需的参数。</p>
<figure class="highlight oxygene"><table><tr><td class="code"><pre><span class="line">&amp;FORCE_EVAL</span><br><span class="line">	<span class="function"><span class="keyword">METHOD</span> <span class="title">QS</span></span></span><br><span class="line"><span class="function">	&amp;<span class="title">DFT</span></span></span><br><span class="line"><span class="function">		...</span></span><br><span class="line"><span class="function">	&amp;<span class="title">END</span> <span class="title">DFT</span></span></span><br><span class="line"><span class="function">	&amp;<span class="title">SUBSYS</span></span></span><br><span class="line"><span class="function">		...</span></span><br><span class="line"><span class="function">	&amp;<span class="title">END</span> <span class="title">SUBSYS</span></span></span><br><span class="line"><span class="function">&amp;<span class="title">END</span> <span class="title">FORCE_EVAL</span></span></span><br></pre></td></tr></table></figure>
<ul>
<li><code>METHOD</code>：使用哪种方法来计算力<ul>
<li><code>QS</code>：默认，同<code>QUICKSTEP</code></li>
<li><code>FIST</code>：分子力学</li>
<li><code>QMMM</code>：Hybrid quantum classical</li>
</ul>
</li>
</ul>
<h2 id="MOTION"><a href="#MOTION" class="headerlink" title="MOTION"></a>MOTION</h2><p>定义了一组与原子核运动有关的工具。</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&amp;MOTION</span></span><br><span class="line">	<span class="meta">&amp;MD</span></span><br><span class="line">		<span class="string">ENSEMBLE</span> <span class="string">NVE</span></span><br><span class="line">		<span class="string">STEPS</span> <span class="number">10</span></span><br><span class="line">		<span class="string">TIMESTEP</span> <span class="number">0.5</span></span><br><span class="line">		<span class="string">TEMPERATURE</span> <span class="number">300.0</span></span><br><span class="line">	<span class="string">&amp;END</span> <span class="string">MD</span></span><br><span class="line"><span class="string">&amp;END</span> <span class="string">MOTION</span></span><br></pre></td></tr></table></figure>
<h1 id="输出文件"><a href="#输出文件" class="headerlink" title="输出文件"></a>输出文件</h1><ul>
<li><code>PROGJECT-1.restart</code>：重启计算的输入文件</li>
<li><code>PROGJECT-pos-1.xyz：</code>MD或结构优化的轨迹</li>
<li><code>PROGJECT-1.ener</code>：MD能量、温度……</li>
<li><code>PROGJECT-1.cell</code>：cell参数</li>
<li><code>PROGJECT-RESTRAT.wfn</code>：重启计算的轨道</li>
</ul>
]]></content>
      <categories>
        <category>计算化学</category>
        <category>软件</category>
      </categories>
      <tags>
        <tag>CP2K</tag>
      </tags>
  </entry>
  <entry>
    <title>【Gaussian】02.基组</title>
    <url>/2019/09/03/%E3%80%90Gaussian%E3%80%9102.%E5%9F%BA%E7%BB%84/</url>
    <content><![CDATA[<p><a href="https://gaussian.com/basissets/">https://gaussian.com/basissets/</a></p>
<h1 id="高斯中的5d、6d"><a href="#高斯中的5d、6d" class="headerlink" title="高斯中的5d、6d"></a>高斯中的5d、6d</h1><ul>
<li>5d和6d分别指球谐型d函数（由6个笛卡尔型d函数组合得到）和笛卡尔型d函数。</li>
<li>高斯一般默认使用6d关键字（在使用gen等关键字时往往默认为5d）。</li>
</ul>
<h2 id="5d"><a href="#5d" class="headerlink" title="5d"></a>5d</h2><p>如果使用5d关键词，会使用xy、yz、xz、x^2-y^2、3*z^2-r^2这5种轨道描述d轨道。输出的d轨道符号会显示D 0, D+1, D-1, D+2, D-2。这不是指这样由GTF组合出来的波函数的角动量z轴分量的本征值，也不是指这5个轨道用来对应地近似描述5个真实的复数型原子轨道。这样的轨道符号没有意义，还会引起严重混淆，它仅仅是做个标识罢了。</p>
<p>对应关系：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">作为基函数的GTF</th>
<th style="text-align:center">实型真实原子轨道符号</th>
<th style="text-align:center">高斯中用了5d关键字后对d轨道的标识</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">3*z^2-r^2</td>
<td style="text-align:center">dz^2</td>
<td style="text-align:center">d 0</td>
</tr>
<tr>
<td style="text-align:center">xz</td>
<td style="text-align:center">dxz</td>
<td style="text-align:center">d+1</td>
</tr>
<tr>
<td style="text-align:center">yz</td>
<td style="text-align:center">dyz</td>
<td style="text-align:center">d-1</td>
</tr>
<tr>
<td style="text-align:center">x^2-y^2</td>
<td style="text-align:center">dx^2-y^2</td>
<td style="text-align:center">d+2</td>
</tr>
<tr>
<td style="text-align:center">xy</td>
<td style="text-align:center">dxy</td>
<td style="text-align:center">d-2</td>
</tr>
</tbody>
</table>
</div>
<h2 id="6d"><a href="#6d" class="headerlink" title="6d"></a>6d</h2><p>使用xx、yy、zz、yz、yx、zx这6种笛卡尔型GTF轨道，在输出的d轨道符号中也对应地以xx、yy、zz、yz、yx、zx标识。在d轨道基函数不分裂情况下，描述d轨道的可独立变分的基函数就相对于5d关键字时的5个增加到了6个，可看到输出文件中basis functions的数目对应地增加了。但无论用5d还是6d，输出文件显示的原始基函数（primitive gaussians，即笛卡尔型GTF）的数目都一样，这是因为5d的5个轨道仍需要有全部6种笛卡尔型d型GTF才能组合出来。</p>
<ul>
<li>比如对5d中的3<em>z^2-r^2函数来说，将其中r^2展开，可写成N</em>(2*z^2-x^2-y^2)，即等于zz、xx、yy三种笛卡尔型GTF系数按照<script type="math/tex">2:-1:-1</script>组合并乘上归一化系数，这个比值这是固定的，不会在计算过程中改变，某种意义上也可看作是CGTF（收缩型GTF）。</li>
<li>6d型轨道好处是方便编程，能够直接计算各种积分。缺点很明显，由于缺乏与真实原子轨道的对应关系，结果不像用5d的结果那样方便分析。虽然这6个笛卡尔型轨道不直接对应于真实原子轨道，但在计算过程中经过变分，其结果同样会展现出真实原子轨道的行为。这是因为以它们为基函数变分的结果，等价于对它们线性变换后的基函数变分的结果。</li>
<li><p>使用6d关键字，就是在5d型的基函数基础上多添加了一个内部含有节面的s型GTF轨道，由于这个轨道与其它s轨道有不小重叠，会造成一定线性相关问题，所以并不会比5d的结果有多少改进。</p>
</li>
<li><p>7f与10f的关系与5d与6d的关系类似，对于g、h等更高角动量函数也有如上讨论，笛卡尔型与球谐型GTF转换关系将更为复杂，而且组合方法并不唯一（比如有所谓标准纯f集、纯f“立方”集）。计算时若同时含有d和f轨，用5d时应当结合7f，用6d时应当结合10f。顺带一提，6d轨道间不都是正交的，例如XX与YY，而5d轨道间都是正交的，同样10f和7f的关系也是如此。</p>
</li>
</ul>
<h1 id="高斯中的基函数的数目"><a href="#高斯中的基函数的数目" class="headerlink" title="高斯中的基函数的数目"></a>高斯中的基函数的数目</h1><p>例子：C的6-31+G*</p>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">C</span>     <span class="number">0</span></span><br><span class="line"><span class="attribute">S</span>   <span class="number">6</span>   <span class="number">1</span>.<span class="number">00</span>     &lt;--下面定义S型基函数壳层，其收缩度为<span class="number">6</span>，即这个基函数壳层由下面写的<span class="number">6</span>个primitive壳层收缩而成。<span class="number">1</span>.<span class="number">00</span>是刻度因子，不用去管它，总是输入<span class="number">1</span>.<span class="number">00</span>就行了（具体含义参见手册里gen关键词）</span><br><span class="line">   <span class="attribute">3047</span>.<span class="number">5249000</span>              <span class="number">0</span>.<span class="number">0018347</span>  &lt;---- 第<span class="number">1</span>个primitive壳层的指数和收缩系数</span><br><span class="line">    <span class="attribute">457</span>.<span class="number">3695100</span>              <span class="number">0</span>.<span class="number">0140373</span>  &lt;---- 第<span class="number">2</span>个primitive壳层...</span><br><span class="line">    <span class="attribute">103</span>.<span class="number">9486900</span>              <span class="number">0</span>.<span class="number">0688426</span>        </span><br><span class="line">     <span class="attribute">29</span>.<span class="number">2101550</span>              <span class="number">0</span>.<span class="number">2321844</span>        </span><br><span class="line">      <span class="attribute">9</span>.<span class="number">2866630</span>              <span class="number">0</span>.<span class="number">4679413</span>        </span><br><span class="line">      <span class="attribute">3</span>.<span class="number">1639270</span>              <span class="number">0</span>.<span class="number">3623120</span>        </span><br><span class="line"><span class="attribute">SP</span>   <span class="number">3</span>   <span class="number">1</span>.<span class="number">00</span>     &lt;--SP型基函数壳层，仅在Pople系列基组及其它少数基组中才出现，其中S和P型基函数共享相同指数但收缩系数不同，在Gaussian中用SP壳层比起单独用一个S壳层和一个P壳层计算起来更快</span><br><span class="line">      <span class="attribute">7</span>.<span class="number">8682724</span>             -<span class="number">0</span>.<span class="number">1193324</span>              <span class="number">0</span>.<span class="number">0689991</span>   &lt;--共用的指数，S的收缩系数，P的收缩系数</span><br><span class="line">      <span class="attribute">1</span>.<span class="number">8812885</span>             -<span class="number">0</span>.<span class="number">1608542</span>              <span class="number">0</span>.<span class="number">3164240</span>        </span><br><span class="line">      <span class="attribute">0</span>.<span class="number">5442493</span>              <span class="number">1</span>.<span class="number">1434564</span>              <span class="number">0</span>.<span class="number">7443083</span>        </span><br><span class="line"><span class="attribute">SP</span>   <span class="number">1</span>   <span class="number">1</span>.<span class="number">00</span></span><br><span class="line">      <span class="attribute">0</span>.<span class="number">1687144</span>              <span class="number">1</span>.<span class="number">0000000</span>              <span class="number">1</span>.<span class="number">0000000</span>        </span><br><span class="line"><span class="attribute">SP</span>   <span class="number">1</span>   <span class="number">1</span>.<span class="number">00</span>   &lt;--此壳层指数很小，所以显然是<span class="number">6</span>-<span class="number">31</span>+G*中的+号对应的弥散函数。弥散函数、极化函数的收缩度总是为<span class="number">1</span>，即未收缩，这样的壳层的收缩系数必定是<span class="number">1</span>.<span class="number">0</span>。</span><br><span class="line">      <span class="attribute">0</span>.<span class="number">0438000</span>              <span class="number">1</span>.<span class="number">0000000</span>              <span class="number">1</span>.<span class="number">0000000</span>        </span><br><span class="line"><span class="attribute">D</span>   <span class="number">1</span>   <span class="number">1</span>.<span class="number">00</span>   &lt;--D型极化函数，对应<span class="number">6</span>-<span class="number">31</span>+G*中的*。</span><br><span class="line">      <span class="attribute">0</span>.<span class="number">8000000</span>              <span class="number">1</span>.<span class="number">0000000</span>        </span><br></pre></td></tr></table></figure>
<p>15 basis functions,  28 primitive gaussians,  15 cartesian basis functions</p>
<div class="table-container">
<table>
<thead>
<tr>
<th></th>
<th>1s</th>
<th>2s</th>
<th>2p*3</th>
<th>d*6</th>
<th>总数</th>
</tr>
</thead>
<tbody>
<tr>
<td>GTF</td>
<td>1</td>
<td>2</td>
<td>2</td>
<td>1</td>
<td>15</td>
</tr>
<tr>
<td>PGTF</td>
<td>6</td>
<td>3+1</td>
<td>3+1</td>
<td>1</td>
<td>28</td>
</tr>
</tbody>
</table>
</div>
<p>无论高斯中用5d还是6d，输出文件显示的原始基函数（primitive gaussians，即笛卡尔型GTF）的数目都一样，这是因为5d的5个轨道仍需要有全部6种笛卡尔型d型GTF才能组合出来。</p>
<h1 id="常见基组及其指定方法"><a href="#常见基组及其指定方法" class="headerlink" title="常见基组及其指定方法"></a>常见基组及其指定方法</h1><h2 id="6-31G类"><a href="#6-31G类" class="headerlink" title="6-31G类"></a><strong>6-31G类</strong></h2><p>可以用n-31G、n-31G**、n-31++G、n-31G(2df,p)等方式直接在关键词区域定义。</p>
<h2 id="cc-pVnZ系列"><a href="#cc-pVnZ系列" class="headerlink" title="cc-pVnZ系列"></a>cc-pVnZ系列</h2><ul>
<li>直接用cc-pVnZ指定。</li>
<li>弥散函数用aug-cc-pVnZ、spAug-cc-pVnZ、dAug-cc-pVnZ等</li>
</ul>
<h2 id="def系列"><a href="#def系列" class="headerlink" title="def系列"></a>def系列</h2><ul>
<li><p>def用SV, SVP, TZV, TZVP 等指定</p>
</li>
<li><p>def2-系列用Def2SV, Def2SVP, Def2SVPP, Def2TZV, Def2TZVP, Def2TZVPP, Def2QZV, Def2QZVP, Def2QZVPP, and QZVP等指定，去掉了”-“</p>
</li>
</ul>
<p>用IOp(3/24=1)可以显示每个原子实际用的基组，检查是否设对了；也可以用GFPrint关键词输出相似内容，但没那么清楚；也可以用GFInput关键词来输出实际所用基组，这些信息可以直接作为基组输入的信息。</p>
<h1 id="赝势的输入"><a href="#赝势的输入" class="headerlink" title="赝势的输入"></a><strong>赝势的输入</strong></h1><figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line"># B3LYP/genecp</span><br><span class="line"></span><br><span class="line">Cu(CO)+</span><br><span class="line"></span><br><span class="line"><span class="number">1</span> <span class="number">1</span></span><br><span class="line"> Cu             </span><br><span class="line"> C                  <span class="number">1</span>            B1</span><br><span class="line"> O                  <span class="number">2</span>            B2    <span class="number">1</span>            <span class="number">180.</span></span><br><span class="line"></span><br><span class="line">Cu <span class="number">0</span></span><br><span class="line">Lanl2DZ    &lt;-- Cu用Lanl2DZ赝势基组</span><br><span class="line">****</span><br><span class="line">C O <span class="number">0</span></span><br><span class="line"><span class="number">6</span><span class="number">-31</span>G*   &lt;-- C O用的基组为<span class="number">6</span><span class="number">-31</span>G*</span><br><span class="line">****</span><br><span class="line"></span><br><span class="line">Cu <span class="number">0</span></span><br><span class="line">Lanl2   &lt;-- Cu用的赝势为Lanl2，这种赝势是Lanl2DZ赝势基组对应的赝势。如果不知道赝势名是什么，此处直接写赝势基组名就可以。比如这里也可以写成Lanl2DZ，和写Lanl2是等价的</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="Stuttgart赝势"><a href="#Stuttgart赝势" class="headerlink" title="Stuttgart赝势"></a>Stuttgart赝势</h2><p>Stuttgart赝势规范的写法是nXY这种形式，含义是：</p>
<ul>
<li>n = 被赝势表示的核电子数</li>
<li>X = S/M：拟合赝势时的参考体系。S是只考虑模型体系仅有的单个价电子的能量，M是考虑实际原子全部价电子的能量</li>
<li>Y = HF/WB/DF：拟合赝势用的数据的计算级别。HF=Hartree-Fock非相对论（即此赝势不考虑相对论效应），WB=Wood-Boring准相对论，DF=Dirac-Fock全相对论</li>
</ul>
<p>每个元素的SDD默认的基组和可用的Stuttgart赝势：<a href="https://gaussian.com/pseudo/">https://gaussian.com/pseudo/</a></p>
]]></content>
      <categories>
        <category>计算化学</category>
        <category>软件</category>
      </categories>
      <tags>
        <tag>Gaussian</tag>
        <tag>基组</tag>
      </tags>
  </entry>
  <entry>
    <title>【Gaussian】01.基础知识</title>
    <url>/2019/09/03/%E3%80%90Gaussian%E3%80%9101.%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/</url>
    <content><![CDATA[<h1 id="输入文件基本格式"><a href="#输入文件基本格式" class="headerlink" title="输入文件基本格式"></a>输入文件基本格式</h1><h1 id="坐标的输入"><a href="#坐标的输入" class="headerlink" title="坐标的输入"></a>坐标的输入</h1><ul>
<li><code>geom=check</code>：输入结构从chk中读取，输入文件里此时不能写坐标</li>
<li><code>geom=allcheck</code>：标题段落、电荷、自旋多重度、坐标都从chk中读取。输入文件里此时不能写坐标多重度等，关键词后面空行直接跟指定的基组或者为空。</li>
</ul>
<h1 id="chk文件相关"><a href="#chk文件相关" class="headerlink" title="chk文件相关"></a>chk文件相关</h1><ul>
<li><p>在哪个操作系统下得到的chk文件就要在哪个操作系统下转换：</p>
<ul>
<li><p>Windows下点击Gaussian图形界面的Utilities-FormChk，选择chk文件</p>
</li>
<li><p>Linux使用格式：（直接formchk的前提是已经将formchk添加到环境变量中，否则可以是：相应的路径/formchk）</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">formchk</span> <span class="selector-tag">xxx</span><span class="selector-class">.chk</span> <span class="selector-tag">xxx</span><span class="selector-class">.fchk</span></span><br><span class="line"><span class="selector-tag">formchk</span> <span class="selector-tag">xxx</span><span class="selector-class">.chk</span> <span class="selector-id">#y</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h1 id="电子能量读取"><a href="#电子能量读取" class="headerlink" title="电子能量读取"></a>电子能量读取</h1><ul>
<li>Hartree-Fock（HF）方法&amp;普通泛函的DFT计算：<ul>
<li>SCF Done</li>
<li>archive段落HF=后面的数值和之前输出的SCF Done后面显示的完全相同</li>
</ul>
</li>
</ul>
<hr>
<p>以下的方法中，SCF Done以及archive段落的HF=后面的值，基本都是HF级别的电子能量。</p>
<ul>
<li><p>MP2后HF方法：</p>
<ul>
<li>输出文件里EUMP2 =后面的值</li>
<li>archive段落的MP2=后面的值</li>
</ul>
</li>
<li><p>双杂化泛函：</p>
<ul>
<li>比如用的是B2PLYP双杂化泛函，则最终双杂化泛函的能量就是输出文件中E(B2PLYP) =后面的值</li>
<li>直接从archive段落里读MP2=后头的值</li>
</ul>
</li>
<li><p>CCSD(T)：</p>
<ul>
<li>输出文件中CCSD(T)=后面的值</li>
<li>archive段落里读取CCSD(T)=后面的值</li>
</ul>
</li>
</ul>
<hr>
<ul>
<li><p>CASSCF方法：</p>
<ul>
<li>直接搜EIGENVALUES AND  EIGENVECTORS OF CI MATRIX，下面的EIGENVALUE后面的值就是相应的电子态的电子能量</li>
<li>archive段落的HF=后面的值也是CASSCF的电子能量，如果同时算了多个态的话，这个值是序号最高的那个态的值。</li>
</ul>
</li>
<li><p>TDDFT计算</p>
<ul>
<li>在输出激发态信息的段落中，第几激发态下面就会有一行Total Energy, E(TD-HF/TD-DFT) =，后面的值就是这个激发态的电子能量，相当于基态电子能量加上这个态的激发能。</li>
<li>archive段落里HF=后面的值是基态的电子能量，当前激发态的电子能量在archive段落里并没有输出</li>
</ul>
</li>
</ul>
<p>其他：</p>
<ul>
<li>半经验方法：<ul>
<li>SCF Done的值就是半经验方法的能量</li>
<li>archive段落里依然是以HF=作为标签来输出</li>
</ul>
</li>
</ul>
<p>​        特别要注意的是，半经验方法在原作者拟合参数的时候大多都是朝着生成焓来拟合的，因此Gaussian做半经验方法计算给出的能量并不是一般意义的电子能量，而是当前体系在标况下的生成焓。由于生成焓是个相对能量，这也是为什么半经验方法计算得到的能量比起用前面那些方法的数量级都要小得多得多。</p>
<ul>
<li>分子力学计算<ul>
<li>从输出文件中搜Energy=，后面的值就是分子力学能量</li>
<li>在archive段落以HF=标签来输出</li>
</ul>
</li>
</ul>
<p>​        注意分子力学计算给出的能量也不是一般意义的电子能量，分子力学计算时根本都没有把原子核与电子单独进行描述，而是每个原子被整个当做一个质点考虑。分子力学的能量零点是每个几何变量都恰处于分子力场定义的能量最低位置。</p>
<p>​        由于半经验方法和分子力学方法给出的能量都不是体系的绝对能量，虽然你说成“电子能量”别人也知道你指的是什么，但是说成“单点能”或简单说成“能量”从语义上更合适。</p>
]]></content>
      <categories>
        <category>计算化学</category>
        <category>软件</category>
      </categories>
      <tags>
        <tag>Gaussian</tag>
        <tag>基组</tag>
      </tags>
  </entry>
  <entry>
    <title>【Gaussian】03.单点计算</title>
    <url>/2019/09/09/%E3%80%90Gaussian%E3%80%9103.%E5%8D%95%E7%82%B9%E8%AE%A1%E7%AE%97/</url>
    <content><![CDATA[<h1 id="Geom几何相关选项"><a href="#Geom几何相关选项" class="headerlink" title="Geom几何相关选项"></a><code>Geom</code>几何相关选项</h1><h1 id="Charge点电荷"><a href="#Charge点电荷" class="headerlink" title="Charge点电荷"></a><code>Charge</code>点电荷</h1><ul>
<li><p>为分子添加背景电荷，格式为<code>x y z charge</code>，单位默认是Å，可以通过选项<code>Angstroms</code>，<code>Bohrs</code>控制。</p>
</li>
<li><p>选项<code>Check</code>从chk文件中读取点电荷</p>
</li>
<li><p>例子：</p>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="comment"># B3LYP/6=31G(d) Opt=Z-Matrix Charge NoSymm</span></span><br><span class="line"> </span><br><span class="line"><span class="attribute">Water</span> with point charges</span><br><span class="line"> </span><br><span class="line"><span class="attribute">0</span>,<span class="number">1</span></span><br><span class="line"><span class="attribute">O</span> -<span class="number">0</span>.<span class="number">75</span> -<span class="number">0</span>.<span class="number">94</span> <span class="number">0</span>.<span class="number">0</span></span><br><span class="line"><span class="attribute">H</span> <span class="number">0</span>.<span class="number">21</span> -<span class="number">0</span>.<span class="number">94</span> <span class="number">0</span>.<span class="number">0</span></span><br><span class="line"><span class="attribute">H</span>-<span class="number">1</span>.<span class="number">07</span> -<span class="number">0</span>.<span class="number">0</span> <span class="number">0</span>.<span class="number">0</span></span><br><span class="line"> </span><br><span class="line"><span class="attribute">2</span>.<span class="number">0</span>  <span class="number">2</span>.<span class="number">0</span> <span class="number">2</span>.<span class="number">0</span> <span class="number">1</span>.<span class="number">2</span></span><br><span class="line"><span class="attribute">2</span>.<span class="number">0</span> -<span class="number">2</span>.<span class="number">0</span> <span class="number">2</span>.<span class="number">0</span> <span class="number">1</span>.<span class="number">1</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h1 id="SCF相关选项"><a href="#SCF相关选项" class="headerlink" title="SCF相关选项"></a><code>SCF</code>相关选项</h1><h2 id="算法相关"><a href="#算法相关" class="headerlink" title="算法相关"></a>算法相关</h2><ul>
<li><code>DIIS</code>：迭代子空间中直接求逆。在迭代子空间 (DIIS) 外推方法中使用 Pulay 的直接反演 。默认的加速SCF收敛的方法。使用<code>NoDIIS</code>关闭。</li>
<li><code>Fermi</code>：默认是<code>NoFermi</code>关闭。使用Fermi展宽时，此时默认也会择情自动使用能级移动和阻尼。</li>
</ul>
<h1 id="初猜guess"><a href="#初猜guess" class="headerlink" title="初猜guess="></a>初猜<code>guess=</code></h1><h2 id="算法相关-1"><a href="#算法相关-1" class="headerlink" title="算法相关"></a>算法相关</h2><ul>
<li><code>Harris</code>：使用Harris泛函的DFT方法的结果作为初猜。是所有HF和DFT的默认方法。通过自由原子密度叠加作为分子电子密度来构建KS算符，然后将变分得到的轨道用做后续计算的初猜，这步只做一次而不像普通DFT方法继续做迭代。</li>
<li><code>Huckel</code>：扩展Huckel方法，也不需要迭代。是一些半经验方法（CNDO、INDO、MNDO 和 MINDO3 ）的初猜默认设置。对于涉及许多第二行原子的 PM6 计算，应考虑 Huckel 猜测。 </li>
<li><code>INDO</code>：实指INDO、CNDO、Huckel的混合。第一行为INDO，第二行为CNDO，第三行及以上为Huckel。<ul>
<li>是迭代的方法，给高等级计算提供初猜波函数之前自身也需要初猜（扩展Huckel方法），本身亦有不收敛的可能。</li>
</ul>
</li>
<li><code>Core</code>：将核哈密顿量对角化以形成初始猜测。是一些半经验方法（AM1、PM3、PM3MM、PM6 和 PDDG ）计算的默认设置。初始的Fock矩阵元只含单电子项而不含双电子项，即密度矩阵用空矩阵，比较粗糙。</li>
<li><code>AM1</code>：进行AM1计算作为初猜。一般不能直接使用。</li>
</ul>
<h2 id="读取波函数作为初猜"><a href="#读取波函数作为初猜" class="headerlink" title="读取波函数作为初猜"></a>读取波函数作为初猜</h2><p><code>guess=read</code>可以从chk文件中读取波函数作为初猜。</p>
<ul>
<li>比如某个体系之前已经算过一次，并且有chk文件，那么chk文件里就记录了收敛的波函数。若又想重算一次（先用小基组，再用大基组；或者写掉了关键词，想重新算），为了节约时间，可以通过guess-read直接从chk里读取已收敛的波函数，这样SCF只需要一轮就能收敛。</li>
</ul>
<p>同时<code>%chk=</code>部分有两种写法</p>
<ul>
<li><p><code>%chk=name.chk</code>会从该chk文件中读取波函数，并且改写该文件。（覆盖模式）</p>
</li>
<li><p>如果避免破坏之前的版本，可以用</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">%<span class="attribute">oldchk</span>=C:\name.chk</span><br><span class="line">%<span class="attribute">chk</span>=C:\new.chk</span><br><span class="line"><span class="comment"># guess=read</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h1 id="检测波函数的稳定性stable"><a href="#检测波函数的稳定性stable" class="headerlink" title="检测波函数的稳定性stable"></a>检测波函数的稳定性<code>stable</code></h1><ul>
<li><code>stable</code>只检查波函数稳定性</li>
<li><code>stable=opt</code>如果检查到不稳定就找到一个最近的稳定点</li>
</ul>
<p>提示结果有：</p>
<ul>
<li><code>The wavefunction is stable under the perturbations considered.</code> 表示当前的波函数是最稳定的</li>
<li><code>The wavefunction has an RHF -&gt; UHF instability</code>表示对闭壳层计算，但是基态是开壳层，被当成了闭壳层计算</li>
<li><code>The wavefunction has an internal instability</code>说明可能是其他情况。</li>
</ul>
<h1 id="SCF不收敛的常用做法"><a href="#SCF不收敛的常用做法" class="headerlink" title="SCF不收敛的常用做法"></a>SCF不收敛的常用做法</h1><p>首先要使用<code>#P</code>，这样SCF迭代过程的每一轮信息才会输出出来，能够了解当前已经迭代到了第几轮，能量变化（Delta-E）、密度矩阵元最大变化（MaxDP）和密度矩阵平均变化（RMSDP）是多少，当前离收敛限还有多远（收敛限会在SCF开始之前明确提示）以及迭代过程是否有收敛的趋势。</p>
<ul>
<li>可以通过<code>grep “SCF Done”  *log</code>和<code>grep &quot;Delta-E=&quot; *log</code>来输出并查看趋势。</li>
</ul>
<h2 id="常用方法"><a href="#常用方法" class="headerlink" title="常用方法"></a>常用方法</h2><p>参考<a href="http://sobereva.com/61：">http://sobereva.com/61：</a></p>
<ul>
<li><p>使用<code>int=ultrafine</code>增加泛函积分格点的精度。</p>
<ul>
<li>对于M06、M06-2X等明尼苏达系列泛函可尝试。对于其它泛函见效几率则比较有限。</li>
<li>G09默认是<code>int=fine</code>，相当于(75,302)，可以提升到<code>int=ultrafine</code>（G16默认），相当于(99,590)</li>
</ul>
</li>
<li><p>使用<code>SCF=NoVarAcc</code>避免因自动降低积分精度，即使迭代过程中精度不发生变化。</p>
<ul>
<li>Gaussian会自动在计算初期时降低积分计算精度以加快计算，但有可能因此阻碍收敛。</li>
<li>对于使用了弥散函数的情况出现不收敛时建议尝试。</li>
</ul>
</li>
<li><p>用<code>int=acc2e=12</code>（G16默认）可以增加积分精度。</p>
<ul>
<li>对因为使用大量弥散函数（其它情况不算）导致的大体系难收敛问题奏效几率较大。</li>
</ul>
</li>
<li><p>用<code>SCF=noincfock</code>避免近似方式构建Fock矩阵。</p>
<ul>
<li>Gaussian默认使用Incremental Fock方式以近似方式构建Fock矩阵来显著节约迭代过程每一步的时间，但可能因此阻碍收敛。</li>
</ul>
</li>
</ul>
<blockquote>
<p>含有很<strong>大量弥散</strong>函数的基组（如aug-cc-pVTZ及更大）计算中、大体系时，往往很难收敛。</p>
<p><code>SCF(novaracc,noincfock) int=acc2e=12</code>同时使用（对于G16<code>SCF(novaracc,noincfock)</code>即可），解决问题的几率较大，而耗时增加不算很大。但是如果基组里弥散函数不多，或者没加弥散函数，解决不收敛的概率不太高。</p>
</blockquote>
<ul>
<li>使用<code>SCF=vshift=x</code>（x=300~500）用能级移动法提升虚轨道能量以增大HOMO-LUMO gap，避免虚轨道和占据轨道间过度混合。<ul>
<li>只影响收敛过程，而不影响任何最终计算结果，包括轨道能级。</li>
<li>对于HOMO-LUMO gap较小情况，常见的比如<strong>含过渡金属</strong>的体系，可尝试。从300依次增加。</li>
</ul>
</li>
<li>用<code>SCF=conver=N</code>改变收敛限。令密度矩阵RMS收敛限为1E-N，密度矩阵最大变化和能量收敛限都为1E(-N+2)。<ul>
<li>G09/16对单点计算默认是<code>SCF=tight</code>，相当于<code>SCF=conver=8</code>，对密度矩阵的收敛要求有点太严，往往不容易达到，而且达到的时候能量通常都早已经收敛到极高精度了。</li>
<li>对于计算单点能的目的可降到<code>conver=6</code>，相当于把收敛标准放宽100倍，通常收敛时能量变化已经非常小了。</li>
<li>但是做几何优化、振动分析的时候不建议降低默认的SCF收敛限，否则可能结果不准确，还可能阻碍几何优化的收敛。</li>
<li>如果优化时有些体系的初猜结构可能构建得和实际结构偏差较大，导致优化初期SCF收敛难，可降低SCF收敛限到<code>=6</code>使结构粗略收敛，再在最后的结构下用默认的SCF收敛限进一步严格优化。但此法对于G16不适用，因为G16中后HF和涉及能量导数的任务都强制要求收敛到至少<code>SCF=conver=8</code>的水平，否则无法继续进行。</li>
</ul>
</li>
<li>尝试其它泛函作为初猜。若某个泛函下计算不收敛，可以尝试其它泛函，如果能收敛，再<a href="#读取波函数作为初猜">用<code>guess=read</code>读取其收敛的波函数作为初猜</a>。<ul>
<li>比如M06-2X等明尼苏达系列泛函SCF难度往往高于其它泛函，碰到难收敛的时候，可以试试B3LYP等泛函，如果发现能收敛，将之作为M06-2X的初猜。</li>
<li>通常HF成份越高的泛函往往越容易收敛，特别是对于含过渡金属的体系来说。</li>
</ul>
</li>
<li>尝试小基组作为初猜。小基组通常比大基组更容易收敛。直接用大基组难收敛但小基组能收敛时，可将小基组收敛的波函数作为大基组计算时的初猜。<ul>
<li>比如def2-TZVP收敛不了，但def2-SVP能收敛，可尝试用后者收敛的波函数作为def2-TZVP计算时的初猜。</li>
<li>比如加弥散函数后收敛会变得更困难，用aug-cc-pVTZ计算时发现不收敛，cc-pVTZ能收敛则将其收敛的波函数当aug-cc-pVTZ的初猜</li>
<li>两个基组尺寸差异太大没什么意义，比如拿STO-3G收敛的波函数当def2-TZVP的初猜对收敛并不会带来明显的益处。</li>
<li>对于特别难收敛的情况，可以尝试逐级提升基组档次，如STO-3G→3-21G→6-31G<em>→6-311G*</em>→def2-TZVP。</li>
</ul>
</li>
<li>使用<code>guess=huckel</code>、<code>guess=INDO</code><a href="#算法相关">改变默认的初猜方法</a>。</li>
<li>使用<code>SCF=QC</code>或者<code>SCF=XQC</code>二次收敛方法（Quadratic convergence, QC），这种方法收敛所需步数通常比默认情况更少，有一定可能性解决SCF不收敛。<ul>
<li>G09中，<code>SCF=XQC</code>代表先用普通方式迭代到64轮（或者自己用<code>scf=maxcyc</code>设的值），如果不收敛再自动切换为QC。</li>
<li>而G16中用<code>SCF=XQC</code>时，是用<code>MaxConventionalCycles=N</code>设定常规迭代多少轮不收敛才切换为XQC，N默认为<code>32</code>。</li>
<li>缺点：<ul>
<li>QC方法耗时颇高，SCF每一轮的耗时是平常的好几倍</li>
<li>如果必须借助此方法SCF才能收敛的话，非常有可能最终并没有收敛到最稳定的波函数，导致得到的能量高于此结构下当前级别的基态的真实值，因此结果无意义。用QC时建议同时加上stable关键词检测一下所得波函数稳定性（如果是优化，则对最后一个结构测试一下稳定性。）</li>
<li>用QC时照样还是可能最后不收敛，最终会提示L508报错，这期间会做漫长的计算，导致花了大量时间做无用功。</li>
</ul>
</li>
</ul>
</li>
<li><code>SCF=Fermi</code>使用Fermi展宽</li>
<li>使用<code>SCF=noDIIS</code>关闭DIIS的SCF加速方法。</li>
<li>修改分子的几何结构。略微改变分子几何结构，比如稍微缩短/伸长键长、改变键角，若能得到收敛的波函数，可作为原来的几何构型下计算的初猜。Gaussian在几何优化中一般也会自动将当前步结构的收敛波函数作为计算下一步结构的波函数的初猜。</li>
<li><p>对于开壳层体系，可以先计算相应的闭壳层离子体系得到收敛的波函数，然后读取其收敛的波函数作为初猜。</p>
<ul>
<li>RO方式计算开壳层体系比非限制性计算(U)难收敛得多得多，如果RO收敛不了，先改成U</li>
</ul>
</li>
<li><p>先计算电离态，将得到收敛波函数用作初猜。因为电子数少的时候往往更容易收敛，比如阳离子比阴离子一般容易收敛。</p>
</li>
<li><p>含有溶剂可以使用其它溶剂下或者真空下或者其它溶剂模型计算谨慎性初猜。</p>
</li>
<li><p><code>SCF=maxcyc=N</code>或者<code>scfcyc=N</code>加大迭代次数。默认的128已经绝对够大，一般60步不收敛的话继续算下去收故成功的可能性就已经微乎其微了。</p>
</li>
<li><p>改用其它方法或基组，或尝试其它程序来计算当前体系。通过转换结果文件来作为Gaussian的初猜。</p>
<ul>
<li>用Multiwfn载入那个程序产生的含有基函数信息的文件（如.molden），进入主功能100的子功能2，选择导出波函数为fch文件，之后再用Gaussian的unfchk工具将之转换成chk文件，然后Gaussian计算时用<code>guess=read</code>从中读取波函数作为初猜</li>
</ul>
</li>
</ul>
<h2 id="批量脚本"><a href="#批量脚本" class="headerlink" title="批量脚本"></a>批量脚本</h2><p>将上述方法都试一下的脚本，先新建一个文件夹，在其中存在.gjf和.sub文件，.gjf部分写入<code># SCF</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">mkdir 01_novaracc_noincfock 02_vshift300 03_vshift400 04_vshift500 05_huckel 06_INDO 07_QC 08_XQC 09_Fermi 10_NODIIS 11_mix</span><br><span class="line"></span><br><span class="line">for i in 01 02 03 04 05 06 07 08 09 10 11; do cp 00_noconv/*gjf 00_noconv/g16* $&#123;i&#125;* ;done</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">sed -i &#x27;s/\#/&amp;SCF\(novaracc,noincfock,maxcyc=300\) /&#x27; 01_novaracc_noincfock/*gjf</span><br><span class="line">sed -i &#x27;s/\#/&amp;SCF\(vshift=300,maxcyc=300\) /&#x27; 02_vshift300/*gjf</span><br><span class="line">sed -i &#x27;s/\#/&amp;SCF\(vshift=400,maxcyc=300\) /&#x27; 03_vshift400/*gjf</span><br><span class="line">sed -i &#x27;s/\#/&amp;SCF\(vshift=500,maxcyc=300\) /&#x27; 04_vshift500/*gjf</span><br><span class="line">sed -i &#x27;s/\#/&amp;SCF\(maxcyc=300\) guess=huckel /&#x27; 05_huckel/*gjf</span><br><span class="line">sed -i &#x27;s/\#/&amp;SCF\(maxcyc=300\) guess=INDO /&#x27; 06_INDO/*gjf</span><br><span class="line">sed -i &#x27;s/\#/&amp;SCF=QC /&#x27; 07_QC/*gjf</span><br><span class="line">sed -i &#x27;s/\#/&amp;SCF=XQC /&#x27; 08_XQC/*gjf</span><br><span class="line">sed -i &#x27;s/\#/&amp;SCF\(maxcyc=300,Fermi\) /&#x27; 09_Fermi/*gjf</span><br><span class="line">sed -i &#x27;s/\#/&amp;SCF\(maxcyc=300,NODIIS\) /&#x27; 10_NODIIS/*gjf</span><br><span class="line">sed -i &#x27;s/\#/&amp;SCF\(maxcyc=300\) guess=mix /&#x27; 11_mix/*gjf</span><br><span class="line"></span><br><span class="line">for i in 01 02 03 04 05 06 07 08 09 10 11; do cd $&#123;i&#125;* qsub g16*; cd ..; done </span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>计算化学</category>
        <category>软件</category>
      </categories>
      <tags>
        <tag>Gaussian</tag>
        <tag>SCF</tag>
        <tag>收敛</tag>
        <tag>单点</tag>
      </tags>
  </entry>
  <entry>
    <title>【Gaussian】对称性</title>
    <url>/2021/03/02/%E3%80%90Gaussian%E3%80%91%E5%AF%B9%E7%A7%B0%E6%80%A7/</url>
    <content><![CDATA[<p>Gaussian默认启动对称性，有对称性的体系，让Gaussian正确判断出实际的点群，有以下好处：</p>
<ul>
<li>通常可以显示出轨道以及体系电子态的不可约表示【对绘制光谱等有作用】</li>
<li>可以大大降低计算耗时，尤其是对称性很高的体系</li>
<li>SCF收敛往往更容易</li>
</ul>
<h1 id="关键词"><a href="#关键词" class="headerlink" title="关键词"></a>关键词</h1><h2 id="nosymm的使用"><a href="#nosymm的使用" class="headerlink" title="nosymm的使用"></a><code>nosymm</code>的使用</h2><ul>
<li>输入文件里的坐标称为输入朝向（Input orientation）。Gaussian为了判断和利用对称性，会先把输入文件里的坐标调整到标准朝向(Standard orientation)下，然后再进行点群的判断及后续的各种计算。这个调整过程会把体系进行平移，使原子核电荷中心处于笛卡尔坐标原点，并且根据一定规则对体系进行旋转。</li>
<li>使用<code>nosymm</code>关键词，让Gaussian在计算中完全不利用对称性，以避免Gaussian将体系摆到标准朝向的：<ul>
<li>加外场矢量时、绘制密度差图过程、CDA分析等</li>
<li>做几何优化的时候，Gaussian会把每一步的坐标都调整到标准朝向，这往往导致坐标不连续，在观看优化轨迹过程中体系朝向会发生剧烈跳变，从而难以考察优化过程。</li>
</ul>
</li>
</ul>
<h2 id="其他关键词"><a href="#其他关键词" class="headerlink" title="其他关键词"></a>其他关键词</h2><ul>
<li><code>symm=loose</code>：如果在gview里做过对称化后还不奏效才应当用此处理。因为输入文件里的笛卡尔坐标数值精度有限，用稍微宽松一点的判断标准来识别点群。也可以用<code>veryloose</code>。</li>
<li><code>symm(PG=C3v)</code>：设置对称点群，使判断出来的对称性为C3v的一个<strong>子群</strong>。即由PG来限制最高对称性。</li>
</ul>
<h1 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h1><h2 id="对称性在优化时改变"><a href="#对称性在优化时改变" class="headerlink" title="对称性在优化时改变"></a>对称性在优化时改变</h2><p>原因可能是因为：</p>
<ul>
<li>因为当前计算级别下低对称性的能量更低</li>
<li>由于一些数值问题破坏了对称性（比如用弥散函数时容易出现此问题。DFT格点积分精度不够高时可能也会出现此问题）。</li>
</ul>
<p>解决方案：</p>
<ol>
<li>使用内坐标书写坐标</li>
<li>在优化的时候使用<code>opt=z-matrix</code></li>
<li>让初始结构在gview里对称化，然后用Gaussian优化，确保任务最开始时判断对了实际点群（如果没判断对，用<code>symm=loose</code>）。</li>
</ol>
<p>如果优化过程中点群还是发生了不希望的降低：</p>
<ul>
<li>如果有弥散函数，先把弥散函数去掉</li>
<li>对于DFT加上<code>int=ultrafine</code>，如果对称性还是出现下降，换成其它泛函</li>
<li>尝试MP2，如果对称性也都下降了，那么很有可能高对称性结构不是最稳定的，最后收敛到的低对称性的结构才是真正极小点，因此若非要保持高对称性则无物理意义。</li>
</ul>
]]></content>
      <categories>
        <category>计算化学</category>
        <category>软件</category>
      </categories>
      <tags>
        <tag>Gaussian</tag>
        <tag>对称性</tag>
      </tags>
  </entry>
  <entry>
    <title>【Gaussian】柔性力常数</title>
    <url>/2020/09/21/%E3%80%90Gaussian%E3%80%91%E6%9F%94%E6%80%A7%E5%8A%9B%E5%B8%B8%E6%95%B0/</url>
    <content><![CDATA[<p>力常数有力常数、柔性力常数</p>
<h1 id="力常数"><a href="#力常数" class="headerlink" title="力常数"></a>力常数</h1><ul>
<li>力常数是从高斯计算完频率的地方读取的，或者<ul>
<li>直接取Hessian矩阵的对应的对角元</li>
<li>用Gaussian，使用内坐标方式书写gjf里的坐标，然后在使用<code>#P</code>的情况下做<code>freq</code>任务，这时候在输出文件中会看到<code>Force constants in internal coordinates</code>字段，这即是内坐标下的Hessian矩阵。假设输入文件里4-1键对应第5个内坐标，那么在Hessian矩阵中找第5个对角元，就得到了4-1键的力常数。</li>
</ul>
</li>
</ul>
<p>直接使用Hessian对角元作为键的力常数等于忽略了变量间耦合的影响，这会导致其没法定量准确反映键强（会高估力常数），甚至结论定性错误。</p>
<h1 id="柔性力常数"><a href="#柔性力常数" class="headerlink" title="柔性力常数"></a>柔性力常数</h1><h2 id="compliance程序的安装"><a href="#compliance程序的安装" class="headerlink" title="compliance程序的安装"></a>compliance程序的安装</h2><ol>
<li><p>在Ubuntu系统下安装compliance程序源代码：<a href="http://www.oc.tu-bs.de/Grunenberg/compliance.html上免费下载。">http://www.oc.tu-bs.de/Grunenberg/compliance.html上免费下载。</a></p>
</li>
<li><p>在控制台下运行</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">sudo apt-<span class="builtin-name">get</span> install gcc</span><br><span class="line">sudo apt-<span class="builtin-name">get</span> install g++</span><br><span class="line">sudo apt-<span class="builtin-name">get</span> install gtkmm-2.4</span><br><span class="line">sudo apt-<span class="builtin-name">get</span> install libgtkglextmm-x11-1.2-0</span><br><span class="line">sudo apt-<span class="builtin-name">get</span> install libgtkglextmm-x11-1.2-dev</span><br><span class="line">sudo apt-<span class="builtin-name">get</span> install liblapack-dev</span><br></pre></td></tr></table></figure>
</li>
<li><p>在software center里搜gmm，把libgmm++-dev装上。</p>
</li>
<li><p>把Compliance压缩包解压，进入其中，运行</p>
<figure class="highlight gauss"><table><tr><td class="code"><pre><span class="line">tar compliance</span><br><span class="line"></span><br><span class="line">./configure</span><br><span class="line"><span class="built_in">make</span></span><br><span class="line">sudo <span class="built_in">make</span> install</span><br></pre></td></tr></table></figure>
<p>程序会被安装到/usr/local/bin/compliance。运行compliance即可启动。（可以直接在命令行里输入compliance启动）</p>
</li>
</ol>
<h2 id="compliance程序的使用"><a href="#compliance程序的使用" class="headerlink" title="compliance程序的使用"></a>compliance程序的使用</h2><ol>
<li>在左上角选File→Open，在新窗口的右下角格式选.fchk，载入Gaussian做freq产生的.fchk文件</li>
<li>调整视角：右键上下拖动体系以缩放，用左键拖动来旋转。</li>
<li>添加感兴趣的坐标，程序会把这些坐标对应的compliance matrix（C矩阵）显示出来。compliance程序是主要用来考察键：<ul>
<li>在图上点击右键，可以看到有Stretching（添加键长）、Bending（添加键角）、Torsion三种模式，选择对应的模式</li>
<li>在图上点击两个（三个）原子成为粉色，再点右键选Add/Remove coordinate，则这个键长（键角）项就会被添加。</li>
<li>所有已添加的变量所构成的C矩阵会显示在另一个窗口里。矩阵的单位是 Å/mdyn，要得到柔性力常数就把C矩阵对角元求倒数即可。<br>1 mdyn/Å=1 N/cm=100 N/m=100 J/m<sup>2</sup></li>
<li>点击某一行或者某一列的开头，对应原子也会被高亮，再次点击可以播放动画，再次点击可以停止。也可以通过右键→Toggle animation可以播放动画，Save animation as png可以存一系列图片做成动图</li>
</ul>
</li>
<li>若要清空，通过File→Close关闭当前文件，再次打开。</li>
</ol>
]]></content>
      <categories>
        <category>计算化学</category>
        <category>软件</category>
      </categories>
      <tags>
        <tag>Gaussian</tag>
        <tag>compliance</tag>
        <tag>力常数</tag>
      </tags>
  </entry>
  <entry>
    <title>【Gaussian】核独立化学位移（NICS）</title>
    <url>/2021/05/20/%E3%80%90Gaussian%E3%80%91%E6%A0%B8%E7%8B%AC%E7%AB%8B%E5%8C%96%E5%AD%A6%E4%BD%8D%E7%A7%BB%EF%BC%88NICS%EF%BC%89/</url>
    <content><![CDATA[<h1 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h1><p>NICS原始的定义是：环上重原子的几何中心处的各向同性化学屏蔽值的负值，以ppm为单位。因为考察的这个点不是原子核位置，所以叫“核独立”。</p>
<h2 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h2><ul>
<li>对于芳香性体系，一般这个屏蔽值是正值，即<strong>NICS为负</strong>，本质是因为外磁场导致的共轭环上的环电流产生的感生磁场会一定程度对外磁场有抵消（屏蔽）作用。</li>
<li>对于反芳香性体系，环电流的感生磁场和外磁场方向相同，故会加强外磁场，所以这个屏蔽值为负，NICS即为正。</li>
<li>非芳香性接近0。</li>
</ul>
<h2 id="方法"><a href="#方法" class="headerlink" title="方法"></a>方法</h2><ul>
<li>在几何中心处设定一个虚原子，在Gaussian输入文件原子坐标后面写上它们的坐标。即<code>Bq x y z</code>，并写上<code>NMR</code>关键词，使得Gaussian输出这些位置的NMR信息即可。<ul>
<li>默认使用的是GIAO方法计算NMR。</li>
<li>用其它方法，如<code>NMR=CSGT</code>，当基组不很完备时结果会与GIAO的稍有不同。</li>
</ul>
</li>
<li>计算NICS用不着很高级别的方法和基组就能得到合理结果，通常用B3LYP/6-31+G*就可以。</li>
</ul>
<h2 id="不同NICS"><a href="#不同NICS" class="headerlink" title="不同NICS"></a>不同NICS</h2><p>垂直于环平面的屏蔽张量的分量才和环上离域的电子对应的环电流所产生的感生磁场直接相关，才真正能清楚地展现芳香性特征。<script type="math/tex">NICS(1)_{ZZ}</script>比较好。</p>
<ul>
<li><script type="math/tex">NICS(0)</script>：参考点设在环的中心，取的是各项同性值。</li>
<li><script type="math/tex">NICS(1)</script>：参考点设在环的中心垂直于平面上方1Å处，考察磁屏蔽张量的各项同性。</li>
<li><script type="math/tex">NICS(0)_{ZZ}</script>：参考点设在环的中心，考察磁屏蔽张量的垂直于环平面方向分量。</li>
<li><script type="math/tex">NICS(1)_{ZZ}</script>：指的在环平面上方1埃处，垂直于环平面方向的屏蔽张量分量值的负值。由于在环上方1埃处sigma轨道效应影响很小，所以<script type="math/tex">NICS(1)_{ZZ}</script>衡量的主要是pi芳香性。</li>
</ul>
<h2 id="结果"><a href="#结果" class="headerlink" title="结果"></a>结果</h2><figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">25</span>  Bq   Isotropic =     <span class="number">8</span>.<span class="number">7039</span>   Anisotropy =     <span class="number">5</span>.<span class="number">0411</span></span><br><span class="line">  <span class="attribute">XX</span>=    <span class="number">12</span>.<span class="number">0647</span>   YX=     <span class="number">0</span>.<span class="number">0000</span>   ZX=     <span class="number">0</span>.<span class="number">0000</span></span><br><span class="line">  <span class="attribute">XY</span>=     <span class="number">0</span>.<span class="number">0000</span>   YY=     <span class="number">6</span>.<span class="number">3843</span>   ZY=    -<span class="number">0</span>.<span class="number">7977</span></span><br><span class="line">  <span class="attribute">XZ</span>=     <span class="number">0</span>.<span class="number">0000</span>   YZ=    -<span class="number">0</span>.<span class="number">8627</span>   ZZ=     <span class="number">7</span>.<span class="number">6628</span></span><br></pre></td></tr></table></figure>
<ul>
<li>3<em>3矩阵是磁屏蔽张量，因为电子对不同方向射来的磁场屏蔽强度是不同的。这个张量矩阵乘以外磁场矢量得到的矢量的<em>*负矢量</em></em>就是感生磁场矢量。</li>
<li>磁屏蔽张量的对角元的平均就是Isotropic后面的值，即NICS的值，也就是各项同性屏蔽值，这也是NMR实验所对应的结果。</li>
<li><code>ZZ=</code>就是<script type="math/tex">NICS_{ZZ}</script></li>
</ul>
<h1 id="选择Bq的位置"><a href="#选择Bq的位置" class="headerlink" title="选择Bq的位置"></a>选择Bq的位置</h1><h2 id="计算倾斜-扭曲环的NICS-0-和NICS-ZZ"><a href="#计算倾斜-扭曲环的NICS-0-和NICS-ZZ" class="headerlink" title="计算倾斜/扭曲环的NICS(0)和NICS_{ZZ}"></a>计算倾斜/扭曲环的<script type="math/tex">NICS(0)</script>和<script type="math/tex">NICS_{ZZ}</script></h2><ol>
<li><p>首先用Multiwfn打开结构文件，比如gjf，pdb等，输入：</p>
<figure class="highlight basic"><table><tr><td class="code"><pre><span class="line"><span class="number">100</span></span><br><span class="line"><span class="symbol">21 </span>  // 计算各种基于几何结构的属性</span><br><span class="line"><span class="number">5</span>,<span class="number">6</span>,<span class="number">25</span>,<span class="number">27</span>-<span class="number">29</span>   // 组成环的原子的序号，这些原子将会被用来计算各种基于几何结构的属性</span><br></pre></td></tr></table></figure>
<p>就可以得到<strong>质心、几何中心</strong>：</p>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">Geometry</span> center (X/Y/Z):    <span class="number">0</span>.<span class="number">96300000</span>   -<span class="number">1</span>.<span class="number">89100000</span>    <span class="number">0</span>.<span class="number">43750000</span> Angstrom</span><br><span class="line"><span class="attribute">Center</span> of mass (X/Y/Z):     <span class="number">0</span>.<span class="number">96300000</span>   -<span class="number">1</span>.<span class="number">89100000</span>    <span class="number">0</span>.<span class="number">43750000</span> Angstrom</span><br></pre></td></tr></table></figure>
</li>
<li><p>将质心复制下来，输入：</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">q   <span class="comment">//返回</span></span><br><span class="line"><span class="number">24</span>    <span class="comment">//辅助计算非平面体系的NICS_ZZ</span></span><br><span class="line"><span class="number">0.96300000</span>   <span class="number">-1.89100000</span>    <span class="number">0.43750000</span>   <span class="comment">//粘贴刚才的质心坐标，对于几何中心和质心相同的体系，可以直接回车</span></span><br><span class="line"><span class="number">5</span>,<span class="number">6</span>,<span class="number">25</span>,<span class="number">27</span><span class="number">-29</span> </span><br></pre></td></tr></table></figure>
<p>通过环上的原子根据最小二乘法拟合出一个最具有代表性的平面，输出了平面的拟合误差（如果平面本身就是纯平的则误差为0）、此平面的单位法向量，以及从刚才输入的环中心沿着法向量向上和向下分别移动1埃后的坐标：</p>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">RMS</span> error of the plane fitting:    <span class="number">0</span>.<span class="number">194520</span> Angstrom</span><br><span class="line"><span class="attribute">The</span> unit normal vector is    <span class="number">0</span>.<span class="number">31391747</span>   -<span class="number">0</span>.<span class="number">90899632</span>    <span class="number">0</span>.<span class="number">27419245</span></span><br><span class="line">   </span><br><span class="line"><span class="attribute">The</span> X,Y,Z coordinate of the points below and above <span class="number">1</span> Angstrom of the plane from the point you defined, respectively:</span><br><span class="line">   <span class="attribute">0</span>.<span class="number">6490825274</span>   -<span class="number">0</span>.<span class="number">9820036752</span>    <span class="number">0</span>.<span class="number">1633075459</span> Angstrom</span><br><span class="line">   <span class="attribute">1</span>.<span class="number">2769174726</span>   -<span class="number">2</span>.<span class="number">7999963248</span>    <span class="number">0</span>.<span class="number">7116924541</span> Angstrom</span><br></pre></td></tr></table></figure>
<ul>
<li>如果整个体系大体是个平面，用这两个点的<script type="math/tex">NICS(1)_{ZZ}</script>值取平均比较合理</li>
<li>如果当前体系是笼状体系，只应当取处在环外的那个点来算<script type="math/tex">NICS(1)_{ZZ}</script>。</li>
</ul>
</li>
<li><p>先不要关闭Multiwfn。</p>
</li>
<li><p>将得到的坐标通过虚原子在Gaussian中计算。注意，输入文件中应使用<code>nosymm</code>，如果不写Gaussian可能会自动旋转体系到标准朝向下，导致垂直于环平面的方向在计算前后不同，Multiwfn没法正确提取垂直于环平面方向的分量。计算完成后，得到该点的：</p>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line">  <span class="attribute">37</span>  Bq   Isotropic =    -<span class="number">6</span>.<span class="number">1166</span>   Anisotropy =    <span class="number">25</span>.<span class="number">9219</span></span><br><span class="line"><span class="attribute">XX</span>=     <span class="number">0</span>.<span class="number">1309</span>   YX=    -<span class="number">0</span>.<span class="number">5201</span>   ZX=    -<span class="number">1</span>.<span class="number">2347</span></span><br><span class="line"><span class="attribute">XY</span>=     <span class="number">3</span>.<span class="number">2617</span>   YY=   -<span class="number">23</span>.<span class="number">2564</span>   ZY=     <span class="number">7</span>.<span class="number">2520</span></span><br><span class="line"><span class="attribute">XZ</span>=     <span class="number">6</span>.<span class="number">9045</span>   YZ=   -<span class="number">35</span>.<span class="number">8046</span>   ZZ=     <span class="number">4</span>.<span class="number">7756</span></span><br><span class="line"><span class="attribute">Eigenvalues</span>:   -<span class="number">29</span>.<span class="number">4361</span>    -<span class="number">0</span>.<span class="number">0784</span>    <span class="number">11</span>.<span class="number">1646</span></span><br></pre></td></tr></table></figure>
<p>然后将这些屏蔽张量依次输入进去，也可以直接复制包含<code>XX=</code>的三行，直接粘贴到Multiwfn窗口：</p>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">0</span>.<span class="number">1309</span>,-<span class="number">0</span>.<span class="number">5201</span>,-<span class="number">1</span>.<span class="number">2347</span></span><br><span class="line"><span class="attribute">3</span>.<span class="number">2617</span>,-<span class="number">23</span>.<span class="number">2564</span>,<span class="number">7</span>.<span class="number">2520</span></span><br><span class="line"><span class="attribute">6</span>.<span class="number">9045</span>,-<span class="number">35</span>.<span class="number">8046</span>,<span class="number">4</span>.<span class="number">7756</span></span><br></pre></td></tr></table></figure>
<p>就可以得到：</p>
<figure class="highlight livecodeserver"><table><tr><td class="code"><pre><span class="line">The shielding <span class="built_in">value</span> <span class="keyword">normal</span> <span class="built_in">to</span> <span class="keyword">the</span> plane is      <span class="number">-13.3723975088</span></span><br><span class="line">The NICS_ZZ <span class="built_in">value</span> is thus       <span class="number">13.3723975088</span></span><br></pre></td></tr></table></figure>
<ul>
<li>对于平面上方和下方1埃处的<script type="math/tex">NICS(1)_{ZZ}</script>都需要计算的情况，把平面上方1埃处的屏蔽张量粘贴进去，得到的就是上方1埃处的<script type="math/tex">NICS(1)_{ZZ}</script>，如果把下方1埃处的屏蔽张量粘贴进去，得到的就是下方1埃处的<script type="math/tex">NICS(1)_{ZZ}</script>。</li>
</ul>
</li>
</ol>
<h2 id="AIM理论的电子密度的环临界点-RCP"><a href="#AIM理论的电子密度的环临界点-RCP" class="headerlink" title="AIM理论的电子密度的环临界点(RCP)"></a>AIM理论的电子密度的环临界点(RCP)</h2>]]></content>
      <categories>
        <category>计算化学</category>
        <category>软件</category>
      </categories>
      <tags>
        <tag>Gaussian</tag>
        <tag>芳香性</tag>
        <tag>NICS</tag>
      </tags>
  </entry>
  <entry>
    <title>【Linux】Shell脚本</title>
    <url>/2020/11/22/%E3%80%90Linux%E3%80%91Shell%E8%84%9A%E6%9C%AC/</url>
    <content><![CDATA[<h1 id="添加环境变量"><a href="#添加环境变量" class="headerlink" title="添加环境变量"></a>添加环境变量</h1><p>linux命令行下面执行某个命令的时候，首先保证该命令是否存在，若存在，但输入命令的时候若仍提示：command not found，这个时候就需要使用<code>echo $PATH</code>查看PATH环境变量的设置了，当前命令是否存在于PATH环境变量中，如果不存在，设置方法如下：</p>
<h2 id="方法一"><a href="#方法一" class="headerlink" title="方法一"></a>方法一</h2><figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line"><span class="builtin-name">export</span> <span class="attribute">PATH</span>=/usr/local/bin:$PATH</span><br></pre></td></tr></table></figure>
<ul>
<li>生效方法：立即生效</li>
<li>有效期限：临时改变，只能在当前的终端窗口中有效，当前窗口关闭后就会恢复原有的path配置</li>
<li>用户局限：仅对当前用户</li>
</ul>
<h2 id="方法二"><a href="#方法二" class="headerlink" title="方法二"></a>方法二</h2><ol>
<li><p><code>vim ~/.bashrc</code>后，在最后一行添加：</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line"><span class="builtin-name">export</span> <span class="attribute">PATH</span>=/usr/local/bin:$PATH</span><br></pre></td></tr></table></figure>
</li>
<li><p>生效：</p>
<ol>
<li>关闭当前终端窗口，重新打开一个新终端窗口就能生效</li>
<li>输入<code>source ~/.bashrc</code>命令，立即生效</li>
</ol>
</li>
</ol>
<ul>
<li>有效期限：永久有效</li>
<li>用户局限：仅对当前用户</li>
</ul>
<h1 id="echo命令"><a href="#echo命令" class="headerlink" title="echo命令"></a>echo命令</h1><p>打印shell变量的值，或者直接输出指定的字符串。</p>
<h2 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h2><figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="title">echo</span><span class="params">(选项)</span><span class="params">(参数)</span></span></span><br></pre></td></tr></table></figure>
<p>选项：</p>
<ul>
<li><code>-e</code>：激活转义字符：<ul>
<li><code>\a</code> 发出警告声；</li>
<li><code>\b</code> 删除前一个字符；</li>
<li><code>\c</code> 最后不加上换行符号；</li>
<li><code>\f</code> 换行但光标仍旧停留在原来的位置；<code>\v</code> 与<code>\f</code>相同；</li>
<li><code>\n</code> 换行且光标移至行首；</li>
<li><code>\r</code> 光标移至行首，但不换行；</li>
<li><code>\t</code> 插入tab；</li>
<li><code>\\</code> 插入\字符；</li>
<li><code>\nnn</code> 插入nnn（八进制）所代表的ASCII字符</li>
</ul>
</li>
</ul>
<h2 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h2><ul>
<li><p>显示普通字符串，可以省略双引号</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&quot;It is a test&quot;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>显示转义字符，双引号也可以省略</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">echo</span> <span class="string">&quot;\&quot;It is a test\&quot;&quot;</span></span></span><br><span class="line">&quot;It is a test&quot;</span><br></pre></td></tr></table></figure>
</li>
<li><p>显示变量</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$name</span> It is a test&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$variable</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$PATH</span>  <span class="comment">#显示当前用户路径PATH的值</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>显示换行</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">echo</span> -e <span class="string">&quot;OK! \n&quot;</span> </span><br></pre></td></tr></table></figure>
</li>
<li><p>显示不换行</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">echo</span> -e <span class="string">&quot;OK! \c&quot;</span> </span></span><br><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">echo</span> <span class="string">&quot;It is a test&quot;</span></span></span><br><span class="line">OK! It is a test</span><br></pre></td></tr></table></figure>
</li>
<li><p>显示结果定向至文件</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&quot;It is a test&quot;</span> &gt; myfile</span><br></pre></td></tr></table></figure>
</li>
<li><p>原样输出字符串，不进行转义或取变量(用单引号)</p>
<figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="attribute">echo</span> <span class="string">&#x27;<span class="variable">$name</span>\&quot;&#x27;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>显示命令执行结果</p>
<figure class="highlight dos"><table><tr><td class="code"><pre><span class="line"><span class="built_in">echo</span> `<span class="built_in">date</span>`</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="用echo命令打印带有色彩的文字"><a href="#用echo命令打印带有色彩的文字" class="headerlink" title="用echo命令打印带有色彩的文字"></a>用echo命令打印带有色彩的文字</h2><p>文字色：</p>
<ul>
<li><code>\e[1;31m</code> 将颜色设置为红色</li>
<li><code>\e[0m</code> 将颜色重新置回</li>
<li>颜色码：重置=0，黑色=30，红色=31，绿色=32，黄色=33，蓝色=34，洋红=35，青色=36，白色=37</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">echo</span> -e <span class="string">&quot;\e[1;31mThis is red text\e[0m&quot;</span></span></span><br></pre></td></tr></table></figure>
<p>背景色：</p>
<ul>
<li>颜色码：重置=0，黑色=40，红色=41，绿色=42，黄色=43，蓝色=44，洋红=45，青色=46，白色=47</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">echo</span> -e <span class="string">&quot;\e[1;42mGreed Background\e[0m&quot;</span></span><br></pre></td></tr></table></figure>
<p>文字闪动：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">echo</span> -e <span class="string">&quot;\033[37;31;5mMySQL Server Stop...\033[39;49;0m&quot;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>红色数字处还有其他数字参数：0 关闭所有属性、1 设置高亮度（加粗）、4 下划线、5 闪烁、7 反显、8 消隐</li>
</ul>
<h1 id="printf-命令"><a href="#printf-命令" class="headerlink" title="printf 命令"></a>printf 命令</h1><h2 id="语法-1"><a href="#语法-1" class="headerlink" title="语法"></a>语法</h2><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="built_in">printf</span>  format-<span class="built_in">string</span>  [arguments...]</span><br></pre></td></tr></table></figure>
<ul>
<li><code>format-string</code>：格式控制字符串<ul>
<li><code>%s</code>：字符串</li>
<li><code>%c</code>：ASCII字符。显示相对应参数的第一个字符</li>
<li><code>%d</code>，<code>%i</code>：十进制整数</li>
<li><code>%e</code>，<code>%E</code>，<code>%f</code>：浮点格式</li>
</ul>
</li>
<li><code>arguments</code>：参数列表</li>
</ul>
<h2 id="例子-1"><a href="#例子-1" class="headerlink" title="例子"></a>例子</h2><ul>
<li><code>%-10s</code>指一个宽度为10个字符（-表示左对齐，没有则表示右对齐），任何字符都会被显示在10个字符宽的字符内，如果不足则自动以空格填充，超过也会将内容全部显示出来。</li>
<li><code>%-4.2f</code>格式为左对齐宽度为4，其中.2指保留2位小数</li>
</ul>
<h1 id="流程控制"><a href="#流程控制" class="headerlink" title="流程控制"></a>流程控制</h1><h2 id="if-分支结构"><a href="#if-分支结构" class="headerlink" title="if 分支结构"></a>if 分支结构</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">if commands; then</span><br><span class="line">     commands</span><br><span class="line">[elif commands; then</span><br><span class="line">     commands...]</span><br><span class="line">[else</span><br><span class="line">     commands]</span><br><span class="line">fi</span><br></pre></td></tr></table></figure>
<h3 id="test"><a href="#test" class="headerlink" title="test"></a>test</h3><p>commands可以是一个表达式：</p>
<figure class="highlight subunit"><table><tr><td class="code"><pre><span class="line"><span class="keyword">test </span>expression</span><br></pre></td></tr></table></figure>
<p>或</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">[ expression ]</span><br></pre></td></tr></table></figure>
<ul>
<li>expression返回True，可以是：<ul>
<li><code>-d file</code>：file 存在并且是一个目录</li>
<li><code>-e file</code>：file 存在</li>
<li><code>-f file</code>：file 存在并且是一个普通文件</li>
<li></li>
</ul>
</li>
</ul>
<h2 id="amp"><a href="#amp" class="headerlink" title="&amp;"></a>&amp;</h2><ul>
<li><code>&amp;</code> 放在启动参数后面表示设置此进程为后台进程。默认情况下，进程是前台进程，这时就把Shell给占据了，我们无法进行其他操作，对于那些没有交互的进程，很多时候，我们希望将其在后台启动，可以在启动参数的时候加一个’&amp;’实现这个目的。</li>
</ul>
<h2 id="for-循环"><a href="#for-循环" class="headerlink" title="for 循环"></a>for 循环</h2><figure class="highlight jboss-cli"><table><tr><td class="code"><pre><span class="line">for var in item1 item2 <span class="string">...</span> itemN</span><br><span class="line">do</span><br><span class="line">    <span class="keyword">command</span>1</span><br><span class="line">    <span class="keyword">command</span>2</span><br><span class="line">    <span class="string">...</span></span><br><span class="line">    <span class="keyword">command</span>N</span><br><span class="line">done</span><br></pre></td></tr></table></figure>
<p>例子：</p>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">for</span> loop in <span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span> <span class="number">5</span></span><br><span class="line"><span class="attribute">do</span></span><br><span class="line">    <span class="attribute">echo</span> <span class="string">&quot;The value is: $loop&quot;</span></span><br><span class="line"><span class="attribute">done</span></span><br></pre></td></tr></table></figure>
<h3 id="数字类循环"><a href="#数字类循环" class="headerlink" title="数字类循环"></a>数字类循环</h3><figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">for</span>((i=<span class="number">1</span>;i&lt;=<span class="number">10</span>;i++));  </span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> $(seq <span class="number">1</span> <span class="number">10</span>)  </span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> &#123;<span class="number">1.</span><span class="number">.10</span>&#125;  </span><br><span class="line"></span><br><span class="line">#实现<span class="number">1</span>~<span class="number">5</span>之内的数字，按照步数<span class="number">2</span>进行跳跃</span><br><span class="line"><span class="keyword">for</span> variable  <span class="keyword">in</span> &#123;<span class="number">1.</span><span class="number">.5</span>.<span class="number">.2</span>&#125; </span><br><span class="line"><span class="keyword">for</span> variable  <span class="keyword">in</span> $(seq <span class="number">1</span> <span class="number">2</span> <span class="number">5</span>) </span><br></pre></td></tr></table></figure>
<h3 id="字符类循环"><a href="#字符类循环" class="headerlink" title="字符类循环"></a>字符类循环</h3><figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> <span class="built_in">i</span> in `ls`;  </span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span> in $* ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span> in f1 f2 f3 ;  </span><br><span class="line"></span><br><span class="line">list=<span class="string">&quot;rootfs usr data data2&quot;</span>  </span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span> in $list;  </span><br></pre></td></tr></table></figure>
<h1 id="字符串截取"><a href="#字符串截取" class="headerlink" title="字符串截取"></a>字符串截取</h1><h2 id="从指定位置开始截取"><a href="#从指定位置开始截取" class="headerlink" title="从指定位置开始截取"></a>从指定位置开始截取</h2><p>指定起始位置和截取长度</p>
<ul>
<li><p>从字符串左边开始计数</p>
<figure class="highlight applescript"><table><tr><td class="code"><pre><span class="line">$&#123;<span class="built_in">string</span>: start :<span class="built_in">length</span>&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>从右边开始计数，多了<code>0-</code></p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">$&#123;<span class="built_in">string</span>: <span class="number">0</span>-start :length&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>例子：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">url=<span class="string">&quot;c.biancheng.net&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;url: 2: 9&#125;</span></span><br><span class="line">&gt; biancheng</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;url: 2&#125;</span> <span class="comment">#省略 length，截取到字符串末尾</span></span><br><span class="line">&gt; biancheng.net</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;url: 0-13: 9&#125;</span></span><br><span class="line">&gt; biancheng</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;url: 0-13&#125;</span>  <span class="comment">#省略 length，直接截取到字符串末尾</span></span><br><span class="line">&gt; biancheng.net</span><br></pre></td></tr></table></figure>
<h2 id="从指定字符（子字符串）开始截取"><a href="#从指定字符（子字符串）开始截取" class="headerlink" title="从指定字符（子字符串）开始截取"></a>从指定字符（子字符串）开始截取</h2><p>截取指定字符（子字符串）右边的所有字符或者左边的所有字符。</p>
<ul>
<li><p>使用 # 号截取右边字符</p>
<figure class="highlight applescript"><table><tr><td class="code"><pre><span class="line">$&#123;<span class="built_in">string</span><span class="comment">#*chars&#125;</span></span><br></pre></td></tr></table></figure>
<ul>
<li><p>其中，string 表示要截取的字符，chars 是指定的字符（或者子字符串），<code>*</code>是通配符的一种，表示任意长度的字符串。<code>*chars</code>连起来使用的意思是：忽略左边的所有字符，直到遇见 chars（chars 不会被截取）。</p>
<figure class="highlight elixir"><table><tr><td class="code"><pre><span class="line">url=<span class="string">&quot;http://c.biancheng.net/index.html&quot;</span></span><br><span class="line">echo <span class="variable">$&#123;</span>url<span class="comment">#*:&#125;</span></span><br><span class="line">echo <span class="variable">$&#123;</span>url<span class="comment">#*p:&#125;</span></span><br><span class="line">echo <span class="variable">$&#123;</span>url<span class="comment">#*ttp:&#125;</span></span><br><span class="line"></span><br><span class="line">&gt; <span class="regexp">//c</span>.biancheng.net/index.html</span><br></pre></td></tr></table></figure>
</li>
<li><p>如果不需要忽略 chars 左边的字符，那么也可以不写<code>*</code></p>
<figure class="highlight roboconf"><table><tr><td class="code"><pre><span class="line">url=&quot;http://c.biancheng.net/index.html&quot;</span><br><span class="line">echo $&#123;<span class="attribute">url#http</span>://&#125;</span><br><span class="line"></span><br><span class="line">&gt; c<span class="variable">.biancheng</span><span class="variable">.net</span>/index<span class="variable">.html</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>以上写法遇到第一个匹配的字符（子字符串）就结束了，如果希望直到最后一个指定字符（子字符串）再匹配结束，那么可以使用<code>##</code></p>
<figure class="highlight axapta"><table><tr><td class="code"><pre><span class="line">url=<span class="string">&quot;http://c.biancheng.net/index.html&quot;</span></span><br><span class="line">echo $&#123;url<span class="meta">#*/&#125;</span></span><br><span class="line">&gt; /c.biancheng.net/<span class="keyword">index</span>.html</span><br><span class="line"></span><br><span class="line">echo $&#123;url<span class="meta">##*/&#125;</span></span><br><span class="line">&gt; <span class="keyword">index</span>.html</span><br><span class="line"></span><br><span class="line"><span class="built_in">str</span>=<span class="string">&quot;---aa+++aa@@@&quot;</span></span><br><span class="line">echo $&#123;<span class="built_in">str</span><span class="meta">#*aa&#125;   </span></span><br><span class="line">&gt; +++aa@@@</span><br><span class="line">echo $&#123;<span class="built_in">str</span><span class="meta">##*aa&#125;  </span></span><br><span class="line">&gt; @@@</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>使用 % 截取左边字符</p>
<figure class="highlight mel"><table><tr><td class="code"><pre><span class="line">$&#123;<span class="keyword">string</span>%chars*&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><p>注意<code>*</code>的位置，因为要截取 chars 左边的字符，而忽略 chars 右边的字符，所以<code>*</code>应该位于 chars 的右侧。</p>
</li>
<li><p>其他方面<code>%</code>和<code>#</code>的用法相同</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">url=<span class="string">&quot;http://c.biancheng.net/index.html&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;url%/*&#125;</span>   </span><br><span class="line">&gt; http://c.biancheng.net</span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;url%%/*&#125;</span>   </span><br><span class="line">&gt; http:</span><br><span class="line"></span><br><span class="line">str=<span class="string">&quot;---aa+++aa@@@&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;str%aa*&#125;</span>   </span><br><span class="line">&gt; ---aa+++</span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;str%%aa*&#125;</span>   </span><br><span class="line">&gt; ---</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
]]></content>
      <categories>
        <category>系统</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>Shell</tag>
      </tags>
  </entry>
  <entry>
    <title>【Linux】Vim编辑器</title>
    <url>/2019/09/25/%E3%80%90Linux%E3%80%91Vim%E7%BC%96%E8%BE%91%E5%99%A8/</url>
    <content><![CDATA[<h1 id="一般编辑"><a href="#一般编辑" class="headerlink" title="一般编辑"></a>一般编辑</h1><h2 id="输入或取代"><a href="#输入或取代" class="headerlink" title="输入或取代"></a>输入或取代</h2><ul>
<li><code>i</code>：从目前光标所在处输入</li>
<li><code>I</code>：在目前所在行的第一个非空格符处开始输入</li>
<li><code>a</code>：为光标所在的下一个字符处开始插入</li>
<li><code>A</code>：行尾插入</li>
<li><code>o</code>：在目前光标所在的下一行处输入新的一行</li>
<li><code>O</code>：在目前光标所在处的上一行输入新的一行</li>
<li><code>&gt;</code>：缩进<ul>
<li><code>&gt;n</code>：缩进n行</li>
</ul>
</li>
<li><code>&lt;</code>：反缩进</li>
<li><code>Esc</code>：退出编辑模式，回到一般模式中</li>
</ul>
<h2 id="取代或删除输入"><a href="#取代或删除输入" class="headerlink" title="取代或删除输入"></a>取代或删除输入</h2><ul>
<li><code>r</code>：只会取代光标所在的那一个字符一次</li>
<li><code>R</code>：会一直取代光标所在的文字，直到按下 <code>ESC</code> 为止</li>
<li><code>s</code>：删字符插入</li>
<li><code>S</code>：删行插入</li>
<li><code>c</code>：和d一样，但是进入编辑模式</li>
</ul>
<h2 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h2><ul>
<li><code>crtl+a</code>：光标所在处数字+1</li>
<li><code>~</code>：转换光标所在字符的大小写</li>
<li><code>J</code>：将光标所在行与下一行的数据结合成一行</li>
</ul>
<h1 id="光标移动"><a href="#光标移动" class="headerlink" title="光标移动"></a>光标移动</h1><h2 id="行内移动"><a href="#行内移动" class="headerlink" title="行内移动"></a>行内移动</h2><ul>
<li><code>h</code>或<code>←</code>：向左移动一个字符<ul>
<li><code>2←</code>：向左移动2个字符</li>
</ul>
</li>
<li><code>l</code>或<code>→</code>：向右移动一个字符</li>
<li><code>0</code>或<code>Home</code>或<code>|</code>或<code>^</code>：行首</li>
<li><code>$</code>或<code>End</code>：行尾</li>
</ul>
<h2 id="词间移动"><a href="#词间移动" class="headerlink" title="词间移动"></a>词间移动</h2><ul>
<li><code>w</code>：下一个符号分隔的单词词首<ul>
<li>结合其他指令处理下一个词，比如<code>dw</code>，可以删除单词，<code>yw</code>可以复制单词</li>
</ul>
</li>
<li><code>e</code>：下一个符号分隔的单词词尾</li>
<li><code>b</code>：上一个符号分隔的单词词首</li>
<li><code>W</code>：下一个空格分隔的单词词首</li>
<li><code>E</code>：下一个空格分隔的单词词尾</li>
<li><code>B</code>：上一个空格分隔的单词词首</li>
</ul>
<h2 id="行间移动"><a href="#行间移动" class="headerlink" title="行间移动"></a>行间移动</h2><ul>
<li><code>space</code>：向右移动一个字符<ul>
<li><code>n+space</code>，移动n个字符，不限于行内</li>
</ul>
</li>
<li><code>k</code>或<code>↑</code>：向上移动一个字符</li>
<li><code>j</code>或<code>↓</code>：向下移动一个字符<ul>
<li><code>30↓</code>或<code>30j</code>：向下移动30行</li>
</ul>
</li>
<li><code>-</code>：上一行行首</li>
<li><code>enter</code>或<code>+</code>：向下移动至行首<ul>
<li><code>30enter</code>或<code>30+</code>，向下移动30行行首</li>
</ul>
</li>
<li><code>H</code>：光标移动到该页首行行首</li>
<li><code>M</code>：光标移动到该页中间行行首</li>
<li><code>L</code>：光标移动到该页末行行首</li>
<li><code>G</code>：移动到文件最后一行(常用)<ul>
<li><code>20G</code>，移动到文件的第20行</li>
<li><code>gg</code>，移动到第一行=<code>1G</code></li>
</ul>
</li>
</ul>
<h2 id="段间移动"><a href="#段间移动" class="headerlink" title="段间移动"></a>段间移动</h2><ul>
<li><code>(</code>：上一段首</li>
<li><code>)</code>：下一段首</li>
<li><code>&#123;</code>：上一段首空行</li>
<li><code>&#125;</code>：下一段首空行</li>
</ul>
<h2 id="翻页"><a href="#翻页" class="headerlink" title="翻页"></a>翻页</h2><ul>
<li><code>ctrl+f</code>或<code>pagedown</code>：屏幕向下移动一页</li>
<li><code>ctrl+b</code>或<code>pageup</code>：屏幕向上移动一页</li>
<li><code>ctrk+d</code>：屏幕向下移动半页</li>
<li><code>ctrl+u</code>：屏幕向上移动半页</li>
</ul>
<h1 id="搜索替换"><a href="#搜索替换" class="headerlink" title="搜索替换"></a>搜索替换</h1><ul>
<li><code>/word</code>：向下寻找word</li>
<li><code>?word</code>：向上寻找</li>
<li><code>n</code>：重复查找</li>
<li><code>N</code>：反向查找</li>
<li><code>:n1,n2s/word1/word2/g</code>：在第 n1 与 n2 行之间寻找 word1 这个字符串，并将该字符串取代为 word2 <ul>
<li>n2用<code>$</code>代表结尾，则<code>:1,$s/word1/word2/g</code>代表全文中替换，也可以用<code>:1,%s/word1/word2/g</code></li>
<li><code>g</code>用<code>gc</code>时可以确认是否取代</li>
</ul>
</li>
</ul>
<h1 id="删除d"><a href="#删除d" class="headerlink" title="删除d"></a>删除d</h1><ul>
<li><code>x</code>或者<code>delete</code>：向后删除<ul>
<li><code>2x</code>：向后删除2个字符</li>
</ul>
</li>
<li><code>X</code>或<code>backspace</code>：向前删除</li>
<li><code>d</code>：<ul>
<li><code>dd</code>：删除一行。<code>20dd</code>：删除20行</li>
<li><code>d$</code>：删除至行尾=<code>D</code></li>
<li><code>d0</code>：删除至行首</li>
<li><code>d1G</code>： 删除光标所在到第一行的所有数据</li>
<li><code>dG</code>：删除光标所在到最后一行的所有数据</li>
<li><code>: 1,10d</code>：删除第一行到第十行</li>
<li><code>dfc</code>：删除从文本中出现字符“c”的位置，一直向前直到下一个该字符所出现的位置（包括该字符）之间的内容 </li>
<li><code>daw</code>：删除光标所在的一个单词</li>
</ul>
</li>
</ul>
<h1 id="可视化"><a href="#可视化" class="headerlink" title="可视化"></a>可视化</h1><ul>
<li><code>v</code>：可视</li>
<li><code>V</code>：行可视</li>
<li><code>ctrl+v</code>：块可视</li>
</ul>
<h1 id="复制粘贴"><a href="#复制粘贴" class="headerlink" title="复制粘贴"></a>复制粘贴</h1><h2 id="复制y"><a href="#复制y" class="headerlink" title="复制y"></a>复制y</h2><ul>
<li><code>yy</code>或<code>Y</code>：复制游标所在的那一行(常用) <ul>
<li><code>20yy</code>：向下复制20行</li>
</ul>
</li>
<li><code>y$</code>：复制光标所在的那个字符到该行行尾的所有数据</li>
<li><code>y0</code>：复制光标所在的那个字符到该行行首的所有数据</li>
<li><code>y1G</code>：复制游标所在行到第一行的所有数据</li>
<li><code>yG</code>：复制游标所在行到最后一行的所有数据</li>
</ul>
<h2 id="粘贴p"><a href="#粘贴p" class="headerlink" title="粘贴p"></a>粘贴p</h2><ul>
<li><code>p</code>：将已复制的数据贴在光标下一行</li>
<li><code>P</code>：贴在游标上一行</li>
</ul>
<h1 id="其他动作"><a href="#其他动作" class="headerlink" title="其他动作"></a>其他动作</h1><ul>
<li><code>u</code>：撤销命令</li>
<li><code>U</code>：撤销行内命令</li>
<li><code>ctrl+r</code> 重做上一个动作。【与撤销相反】</li>
<li><code>.</code>：重复前一个动作的意思。 比如重复删除、重复贴上等等动作</li>
</ul>
<h1 id="退出Vim"><a href="#退出Vim" class="headerlink" title="退出Vim"></a>退出Vim</h1><ul>
<li><code>:w</code> ：保存</li>
<li><code>:w!</code> ：强制保存</li>
<li><code>:q</code>：退出</li>
<li><code>:q!</code>：强制退出</li>
<li><code>:wq</code> 储存后离开</li>
<li><code>:wq!</code> 为强制储存后离开</li>
<li><code>ZQ</code>：不保存退出</li>
<li><code>ZZ</code>：保存退出</li>
<li><code>:w [filename]</code>：另存为</li>
<li><code>:r [filename]</code>：读取另一个文档的内容，内容追加到光标所在行之后</li>
<li><code>:n1,n2 w [filename]</code>：将 n1 到 n2 的内容储存成 filename 这个档案</li>
<li><code>:! command</code>：暂时离开 vi 到指令行模式下执行 command 的显示结果</li>
</ul>
<h1 id="vim-环境的变更境的变更"><a href="#vim-环境的变更境的变更" class="headerlink" title="vim 环境的变更境的变更"></a>vim 环境的变更境的变更</h1><ul>
<li><code>:set nu</code>：显示行号，设定之后，会在每一行的前缀显示该行的行号</li>
<li><code>:set nonu</code>：与 set nu 相反，为取消行号</li>
</ul>
<h1 id="管理命令"><a href="#管理命令" class="headerlink" title="管理命令"></a>管理命令</h1><ul>
<li><code>:vs 路径/文件名</code>：同时再打开另外的一个文件，通过<code>ctrl ww</code>使得光标在两个文件间切换；两个文件是左右并排显示的。</li>
<li><code>:sp 路径/文件名</code>：同时再打开另外的一个文件，通过<code>ctrl ww</code>使得光标在两个文件间切换；两个文件是上下并排显示的。</li>
</ul>
<p><img src="vi-vim-cheat-sheet-sch.gif" alt=""></p>
]]></content>
      <categories>
        <category>系统</category>
      </categories>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title>【Linux】Windows下安装虚拟机</title>
    <url>/2020/09/24/%E3%80%90Linux%E3%80%91Windows%E4%B8%8B%E5%AE%89%E8%A3%85%E8%99%9A%E6%8B%9F%E6%9C%BA/</url>
    <content><![CDATA[<h1 id="安装虚拟机"><a href="#安装虚拟机" class="headerlink" title="安装虚拟机"></a>安装虚拟机</h1><p>安装VMware虚拟机（或者上北邮人上下载），步骤见<a href="https://mp.weixin.qq.com/s/7K3IOzZ6XFVDm5-OjY5otw">https://mp.weixin.qq.com/s/7K3IOzZ6XFVDm5-OjY5otw</a></p>
<h1 id="安装Ubuntu系统"><a href="#安装Ubuntu系统" class="headerlink" title="安装Ubuntu系统"></a>安装Ubuntu系统</h1><p>下载ubuntu镜像，安装ubuntu，步骤见<a href="https://mp.weixin.qq.com/s/piZJUGii2s-aUDoh8utxUA">https://mp.weixin.qq.com/s/piZJUGii2s-aUDoh8utxUA</a></p>
<p>注意事项：</p>
<ul>
<li>使用完毕要点击shut down关机，而不要直接关闭VMware。</li>
<li>可以通过右键Open in Terminal 打开命令行</li>
</ul>
<h1 id="与windows共享文件夹"><a href="#与windows共享文件夹" class="headerlink" title="与windows共享文件夹"></a>与windows共享文件夹</h1><ul>
<li><p>进入虚拟机中，然后，右击虚拟机的标签，选择设置→选项→共享文件夹→勾选总是启用→添加</p>
</li>
<li><p>再在Linux系统中打开文件夹即可</p>
<figure class="highlight awk"><table><tr><td class="code"><pre><span class="line">cd <span class="regexp">/mnt/</span>hgfs/&lt;你的共享名&gt;</span><br></pre></td></tr></table></figure>
</li>
</ul>
]]></content>
      <categories>
        <category>系统</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>虚拟机</tag>
      </tags>
  </entry>
  <entry>
    <title>【LmodeA】01.基础使用</title>
    <url>/2021/10/21/%E3%80%90LmodeA%E3%80%9101.%E5%9F%BA%E7%A1%80%E4%BD%BF%E7%94%A8/</url>
    <content><![CDATA[<h1 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h1><p>在Linux系统下：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tar -xzvf lmodea-200.tar</span><br><span class="line"><span class="built_in">cd</span> <span class="variable">$LMODEA</span>/src</span><br><span class="line">make</span><br></pre></td></tr></table></figure>
<p>需要有Fortran90编译器。</p>
<p>运行：</p>
<figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line">./lmodea<span class="selector-class">.exe</span> -<span class="selector-tag">b</span> &lt; <span class="selector-tag">input</span> &gt; output</span><br></pre></td></tr></table></figure>
<h1 id="输入"><a href="#输入" class="headerlink" title="输入"></a>输入</h1><p>通过<code>$xxx ...  $END</code>控制，只有<code>$QCData</code>中数据的名字区分大小写。</p>
<h2 id="Control"><a href="#Control" class="headerlink" title="$Control"></a>$Control</h2><p>指定计算的类型，关键词有：</p>
<ul>
<li><p><code>QCProg=&quot;XXXX&quot;</code>：<code>XXXX</code>为量化软件名字，比如<code>Gaussian</code>、<code>GAMESS</code>、<code>ORCA</code>、<code>Molpro</code>……</p>
</li>
<li><p><code>IPrint=0</code>：默认为<code>0</code>，标准输出，可以改成<code>1</code>，也打印振动的简正模式，平动模式和旋转模式……等</p>
</li>
<li><p><code>ISymm=1</code>：</p>
<ul>
<li>默认为<code>1</code>，识别分子的点群和不可约表示，支持以下点群</li>
</ul>
<p><img src="/image-20211021223040207.png" alt="image-20211021223040207" style="zoom: 67%;" /></p>
<ul>
<li>当软件无法识别点群，比如不支持的点群、Jahn-Teller效应、或者程序的bug时候，可以使用<code>-1</code>，然后再使用<code>$Irreps</code>模块指定。</li>
<li><code>0</code>不使用对称性</li>
</ul>
</li>
<li><p><code>IFSAVE=.False.</code>：默认不保存原子质量、笛卡尔坐标、Hessian矩阵、APT矩阵（Atomic Polar Tensors原子极化张量）等，如果为<code>.True.</code>则会保存到ALMODE纯文本文件中。</p>
</li>
<li><p><code>IFlocal=.True.</code>：默认计算计算局域模，需要指定<code>$LocMod</code>组，如果是<code>.False.</code>，则只计算简正模。</p>
</li>
</ul>
<h3 id="局域模分析"><a href="#局域模分析" class="headerlink" title="局域模分析"></a>局域模分析</h3><p>如果<code>IFlocal=.False.</code>，以下的选项都不起作用</p>
<ul>
<li><code>KaFml=0</code>：定义力常数的计算方式，以下两种方式在完全优化的最小值和非常严格的收敛准则下是等价的，但在其他情况下，它们的结果可能有一点不同<ul>
<li>默认为<code>0</code>，计算的是局域力常数</li>
<li><code>1</code>：计算的是柔性力常数。</li>
</ul>
</li>
<li><p><code>IFProj=.False.</code>：仅适用于<code>KaFml=0</code>的情况，指在计算局部模态、力常数和频率时，是否投影出虚频。</p>
<ul>
<li>默认是<code>.False.</code></li>
<li>如果需要计算IRC或过渡态的时候，需要使用<code>IFProj=.True.</code></li>
</ul>
</li>
</ul>
<h2 id="QCData"><a href="#QCData" class="headerlink" title="$QCData"></a>$QCData</h2><p>指定用引号括起来的数据文件，其中获取数据(原子质量、坐标、APT和Hessian)，通常通过选项<code>FCHK</code>只需要一个数据文件。但是对于某些程序，多个数据文件应该用关键字HESS、DDIP和/或GEOM分别定义。</p>
<ul>
<li><p>GAUSSIAN：使用的是*.fchk文件，但是在计算时输入文件中要使用<code>FREQ(SaveNormalModes)</code>关键词去自动保存原子质量</p>
</li>
<li><p>ORCA：使用的是*.hess文件</p>
</li>
<li><p>MOLPRO：使用*.out文件，但是输入文件中要用<code>&#123;frequencies,print=1;print,hessian&#125;</code>打印Hessian和APT</p>
</li>
<li><p>ADF：TAPE21或者TAPE13文件，但要通过<code>FCHK</code>选项</p>
<ul>
<li><p>ADF将t21二进制文件转换成可用的文件</p>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">source</span> /home/scicons/ADF<span class="number">2017</span>/adf<span class="number">2017</span>.<span class="number">114</span>/adfrc.sh</span><br><span class="line"><span class="attribute">dmpkf</span> *.t<span class="number">21</span> &gt; t<span class="number">21</span>_ASCII</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h2 id="LocMod"><a href="#LocMod" class="headerlink" title="$LocMod"></a>$LocMod</h2><p>指定局域模的参数</p>
<ul>
<li><code>IFBnd=.Ture.</code>：通过程序生成所有键长，默认为<code>.False.</code>关闭</li>
<li><code>IFAng=.Ture.</code>：通过程序生成所有键角，默认为<code>.False.</code>关闭</li>
<li><code>IFDih=.Ture.</code>：通过程序生成所有二面角，默认为<code>.False.</code>关闭</li>
<li><code>IFRedun=.Ture.</code>：生成所有的冗余内坐标，即等同于IFBnd = IFAng = IFDih = <code>.True.</code>，默认为<code>.False.</code>关闭，对于大分子不要使用这个。</li>
</ul>
<p>也可以通过自定义，格式为：</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"><span class="built_in">i</span> <span class="built_in">j</span> k l : ’name’</span><br></pre></td></tr></table></figure>
<ul>
<li><code>i</code>，<code>j</code>，<code>k</code>，<code>l</code>是原子的序号<ul>
<li>指定键长：<code>i</code>&gt;0，<code>j</code>&gt;0，<code>k</code>=<code>l</code>=0</li>
<li>指定键角：<code>i</code>&gt;0，<code>j</code>&gt;0，<code>k</code>&gt;0，<code>l</code>=0<ul>
<li>线型分子时，投影应该用0或者对于<code>l</code>指定一个负的值（-1代表α方向，-2代表β方向，α和β方向是垂直于化学键的两个正交的方向，比如分子在z轴方向上，那么α代表x轴方向，β代表y轴方向）。默认<code>l=0</code>代表α方向。</li>
</ul>
</li>
<li>指定二面角：<code>i</code>&gt;0，<code>j</code>&gt;0，<code>k</code>&gt;0，<code>l</code>&gt;0</li>
</ul>
</li>
<li><code>:</code>和<code>name</code>可以省略，<code>name</code>的引号也可以省略</li>
<li><code>k</code>和<code>l</code>等于0时，也可以省略，但是如果有<code>name</code>，必须在两者之间有<code>:</code></li>
<li>如果，<code>j</code>=<code>k</code>=<code>l</code>=0，那么可以在下一行指定特殊的局域模的参数（取决于<code>i</code>），</li>
</ul>
<h1 id="输出文件"><a href="#输出文件" class="headerlink" title="输出文件"></a>输出文件</h1><h2 id="ALMODE文件"><a href="#ALMODE文件" class="headerlink" title="ALMODE文件"></a>ALMODE文件</h2><ul>
<li>NATM：原子数目，一个正整数</li>
<li>AMASS：$NATM$个原子质量；如果没有会用NOMASS表示。</li>
<li>ZA：$NATM$个核电荷数目</li>
<li>XYZ：$NATM$个原子的笛卡尔桌标，一共$3 \times NATM$个数字，<ul>
<li>单位是a.u.，可以使用XYZANG换成以Å为单位</li>
</ul>
</li>
<li>FFX：Hessian矩阵，一共有$3NATM \times 3NATM $个元素<ul>
<li>可以使用FFXLT换成下三角的形式</li>
</ul>
</li>
<li>APT：原子极化张量，一共$3 \times 3 \times NATM $个元素；如果没有APT数据，会用NOAPT表示</li>
<li>DPR：极化率，$6 \times 3NATM $个数字<ul>
<li>使用DPRSQ，表现为$9 \times 3NATM $个数字</li>
<li>如果没有DPR数据，会用NODPR表示</li>
</ul>
</li>
<li>GRD：笛卡尔梯度，一共$3 \times NATM$个数字；如果没有GRD数据，会用NOGRD表示</li>
</ul>
<p>目前只支持Gaussian生成的*.fchk文件中的DPR数据和Raman强度。</p>
]]></content>
      <categories>
        <category>计算化学</category>
        <category>软件</category>
      </categories>
      <tags>
        <tag>频率</tag>
        <tag>力常数</tag>
        <tag>LmodeA</tag>
      </tags>
  </entry>
  <entry>
    <title>【MOKIT】MOKIT及其相关软件编译过程</title>
    <url>/2020/05/29/%E3%80%90Mokit%E3%80%91Mokit%E7%BC%96%E8%AF%91%E8%BF%87%E7%A8%8B%E5%92%8Cgamess%E7%9A%84%E7%BC%96%E8%AF%91/</url>
    <content><![CDATA[<p>参考量子化学公众号的博文：</p>
<ul>
<li><a href="https://mp.weixin.qq.com/s/bM244EiyhsYKwW5i8wq0TQ">自动做多参考态计算的程序MOKIT</a></li>
<li><a href="https://mp.weixin.qq.com/s?__biz=MzU5NjMxNjkzMw==&amp;mid=2247483886&amp;idx=1&amp;sn=c06c747a0c473e0f1928b6f10f139051&amp;chksm=fe65c784c9124e92d52b88b122acbec5439fe155ad6cbe2b7a902223387502dbbdae663e19aa&amp;scene=21#wechat_redirect">GAMESS编译教程</a></li>
</ul>
<h1 id="MOKIT编译"><a href="#MOKIT编译" class="headerlink" title="MOKIT编译"></a>MOKIT编译</h1><ol>
<li><p><a href="https://gitlab.com/jxzou/mokit">下载</a>MOKIT整个源码压缩包，在Linux系统下的安装目录解压，重命名</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">unzip mokit-master.zip</span><br><span class="line">mv mokit-master mokit</span><br></pre></td></tr></table></figure>
</li>
<li><p>进入mokit文件夹编译</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">cd mokit/src</span><br><span class="line">make all</span><br></pre></td></tr></table></figure>
<p>注意：该步骤之前需要先找到Intel编译器的目录，否则会出现没有ifort命令的错误。</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">source /opt/intel/bin/compilervars.sh intel64</span><br></pre></td></tr></table></figure>
</li>
<li><p>编写mokit的运行脚本mokit.sub</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line"></span><br><span class="line">export MOKIT_ROOT=/home/$USER/software/mokit</span><br><span class="line">export PATH=$MOKIT_ROOT/bin:$PATH</span><br><span class="line">export PYTHONPATH=$MOKIT_ROOT/lib:$PYTHONPATH</span><br><span class="line"></span><br><span class="line">export ORCA=/home/scicons/orca_4_1_2_linux_x86-64_shared_openmpi313</span><br><span class="line">export GMS=/home/zhaojing/software/gamess/rungms</span><br><span class="line"></span><br><span class="line">automr $&#123;1&#125;&gt;&amp; test.out&amp;</span><br></pre></td></tr></table></figure>
<p>需要用到Gaussian、Gamess、ORCA、molpro等软件：</p>
<ul>
<li><p>MOKIT会识别系统中的GAUSS_EXEDIR变量，必要时自动调用Gaussian软件。但是有时候无法识别就需要手动在sub文件中添加以下三句，将<code>g16root=</code>后更改为服务器中高斯的目录即可。</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">export g16root=/home/scicons/Gaussian16B</span><br><span class="line">source $g16root/g16/bsd/g16.profile</span><br><span class="line">export GAUSS_SCRDIR=`mktemp -d`</span><br></pre></td></tr></table></figure>
</li>
<li><p>变量ORCA对应量化软件ORCA可执行文件的完整路径</p>
</li>
<li><p>变量GMS对应量化软件GAMESS可执行文件的完整路径（如果没有需要进行安装）</p>
</li>
<li><p>PySCF、OpenMolcas和Molpro软件分别由python、pymolcas和molpro命令运行，无需告诉MOKIT它们的位置。</p>
</li>
</ul>
</li>
<li><p>将mokit.sub修改为可执行文件，运行即可</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">chmod</span> +<span class="selector-tag">x</span> <span class="selector-tag">mokit</span><span class="selector-class">.sub</span></span><br><span class="line"><span class="selector-tag">mokit</span><span class="selector-class">.sub</span> <span class="selector-tag">xxxx</span><span class="selector-class">.gjf</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<h1 id="GAMESS编译"><a href="#GAMESS编译" class="headerlink" title="GAMESS编译"></a>GAMESS编译</h1><ol>
<li><p><a href="http://bbs.keinsci.com/thread-727-1-1.html">下载gamess的安装包</a>，解压到安装目录文件下</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">tar</span> <span class="selector-tag">-zxvf</span> <span class="selector-tag">gamess-current</span><span class="selector-class">.tar</span><span class="selector-class">.gz</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>不要忘记<code>source /opt/intel/bin/compilervars.sh intel64</code>这一步</p>
</li>
<li><p>进入gamess目录，执行./config，开始进行配置：</p>
<ol>
<li>enter</li>
<li>输入机器类型：<code>linux64</code></li>
<li>设置安装目录，可选默认路径直接回车，也可自己定义路径</li>
<li>enter</li>
<li>版本号，可以自己设定，默认为00，则编译完成后会生成gamess.00.x可执行文件。（注意该步骤，mokit中的可执行文件使用的是gamess.01.x，所以最好此步包括后面的<code>./lked gamess 00</code>都用01。）</li>
<li>选择fortran编译器，此处填<code>ifort</code></li>
<li>编译器版本号，此处填<code>18</code></li>
<li>enter</li>
<li>选择数学库版本，此处填<code>mkl</code></li>
<li>填写MKL库路径，软件会自动识别目录，如果正确，可以直接复制。</li>
<li><code>proceed</code></li>
<li>enter</li>
<li>enter</li>
<li>一般做节点内并行，选<code>sockets</code>即可</li>
<li>no</li>
<li>后面还有一些yes no，不太清楚……</li>
</ol>
</li>
<li><p>编译DDI，这是GAMESS官方的并行库。</p>
<figure class="highlight jboss-cli"><table><tr><td class="code"><pre><span class="line"><span class="keyword">cd</span> ddi</span><br><span class="line"><span class="string">./compddi</span></span><br><span class="line">mv ddikick.x <span class="string">..</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>编译源代码并生成可执行文件</p>
<figure class="highlight gams"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="title">cd</span></span> ..</span><br><span class="line">./compall &gt;&amp; compall.<span class="built_in">log</span> &amp;</span><br></pre></td></tr></table></figure>
<p>这一步需要极其久的时间，完成后生成gamess.00.x可执行程序</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">./lked gamess <span class="number">00</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>修改rungms脚本</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line"><span class="builtin-name">set</span> <span class="attribute">SCR</span>=/scratch/$USER/gamess  #这是临时文件目录</span><br><span class="line"><span class="builtin-name">set</span> <span class="attribute">USERSCR</span>=/scratch/$USER/gamess  #同上</span><br><span class="line"><span class="builtin-name">set</span> <span class="attribute">GMSPATH</span>=/opt/gamess  #GAMESS的安装目录</span><br></pre></td></tr></table></figure>
<p>向下找到</p>
<figure class="highlight less"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">if</span> ($NCPUS &gt; <span class="number">1</span>) <span class="selector-tag">then</span></span><br><span class="line">      <span class="selector-tag">switch</span> (<span class="built_in">`hostname`</span>)</span><br></pre></td></tr></table></figure>
<p>在这个switch语句中添加一个case语句：</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">case node01:  #输入节点名字</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$NCPUS</span> &gt; 16) <span class="builtin-name">set</span> <span class="attribute">NCPUS</span>=16 #最多使用进程数</span><br><span class="line">            <span class="builtin-name">set</span> <span class="attribute">NNODES</span>=1</span><br><span class="line">            <span class="builtin-name">set</span> HOSTLIST=(`hostname`:<span class="attribute">cpus</span>=<span class="variable">$NCPUS</span>)</span><br><span class="line">            breaksw</span><br></pre></td></tr></table></figure>
<p>用户将/opt/gamess这个目录写入环境变量：</p>
<figure class="highlight elixir"><table><tr><td class="code"><pre><span class="line">export PATH=<span class="variable">$PATH</span><span class="symbol">:/opt/gamess</span></span><br></pre></td></tr></table></figure>
<p>测试输入文件，<code>rungms XXX</code> 如果看到最后输出ddikick.x: exited gracefully.，则说明运行成功。</p>
</li>
</ol>
<h1 id="OpenMolcas与QCMaquis-的安装"><a href="#OpenMolcas与QCMaquis-的安装" class="headerlink" title="OpenMolcas与QCMaquis 的安装"></a>OpenMolcas与QCMaquis 的安装</h1>]]></content>
      <categories>
        <category>计算化学</category>
        <category>软件</category>
      </categories>
      <tags>
        <tag>MOKIT</tag>
        <tag>多组态</tag>
      </tags>
  </entry>
  <entry>
    <title>【ORCA】01.输入文件</title>
    <url>/2020/05/28/%E3%80%90ORCA%E3%80%9101.%E8%BE%93%E5%85%A5%E6%96%87%E4%BB%B6/</url>
    <content><![CDATA[<h1 id="概要"><a href="#概要" class="headerlink" title="概要"></a>概要</h1><p><img src="orca-inputfile.png" alt=""></p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta"># comments </span></span><br><span class="line">! Keywords (control methods, basis sets, job type,…)</span><br><span class="line"></span><br><span class="line">%maxcore <span class="number">4096</span> (optional: scratch <span class="built_in">array</span> size in MB)</span><br><span class="line"></span><br><span class="line">%base “MyBaseName” (optional: name of the generated scratch files)</span><br><span class="line"></span><br><span class="line">* xyz Charge Mult</span><br><span class="line">C <span class="number">1.23</span> <span class="number">16.481</span> <span class="number">-9.87</span> </span><br><span class="line">*</span><br><span class="line"></span><br><span class="line">$new_job</span><br></pre></td></tr></table></figure>
<h1 id="注释部分"><a href="#注释部分" class="headerlink" title="注释部分"></a>注释部分</h1><ul>
<li>以#开头，若单独成行，则该行均为注释</li>
<li><p>也可用两个#在行内封装注释部分，如</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">TolE=<span class="number">1e-5</span>; #Energy conv.# TolMaxP=<span class="number">1e-6</span>; #Density conv.#</span><br></pre></td></tr></table></figure>
<p>其中TolE和TolMaxP为正常的参数输入，而另外两处#内的内容为注释。</p>
</li>
</ul>
<h1 id="控制部分"><a href="#控制部分" class="headerlink" title="控制部分"></a>控制部分</h1><ul>
<li>所有block在手册<strong>6.1 Input Blocks</strong>中列出</li>
<li>以<code>%</code>开头，<code>end</code>结尾。一个<code>%</code>和<code>end</code>的组合称为一个block，一个输入文件中可以包含多个blocks。</li>
<li>block的内容比简单输入<code>！</code>优先</li>
<li><p>ORCA中变量和数值的输入格式为</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">VariableName Value</span><br></pre></td></tr></table></figure>
<ul>
<li><p>也可以数组的形式输入变量，例如</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">Array[<span class="number">1</span>]  Value1</span><br><span class="line">Array[<span class="number">1</span>]  Value1,Value2,Value3</span><br><span class="line">Array  Value1,Value2</span><br></pre></td></tr></table></figure>
<ul>
<li>由于ORCA是用C++写的，因此数组从0开始。上面第一行表示A[1]的值为V1，实际为该数组的第二个数；第二行表示A[1]的值为V1，A[2]的值为V2，A[3]的值为V3；第三行表示A[0]的值为V1，A[1]的值为V2。</li>
<li><p>字符型的数值（例如文件名）用双引号封装，如</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">MOInp <span class="string">&quot;Myfile.gbw&quot;</span></span><br></pre></td></tr></table></figure>
<p>注意，在Unix系统中，引号中的内容是区分大小写的，MYFILE.GBW和MyFile.gbw是不同的文件，而在Windows系统中是不区分大小写的。</p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h1 id="关键词部分"><a href="#关键词部分" class="headerlink" title="关键词部分"></a>关键词部分</h1><p>以<code>!</code>开头，主要用于指定作业的类型和相关参数。</p>
<ul>
<li>主要方法和选项在<strong>6.2.1 Main Methods and Options的Table6.1</strong> 中列出</li>
<li><p>密度泛函方法在<strong>6.2.2 Density Functional Methods</strong>中的<strong>Table 6.2</strong>中列出</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">! Functional GridN NoFinalGrid VDW</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>泛函可以选择：</p>
<ul>
<li>LDA : LSD, HFS, …</li>
<li>GGA : BP=BP86, PBE, PW91, OLYP, OPBE, BLYP, PWP, …</li>
<li>LDAs/GGAs in RI mode require an auxiliary basis set (‘/J’)</li>
<li>Meta-GGA : TPSS, revTPSS, M06L, …</li>
<li>Hybrid : B3LYP, PBE0, X3LYP, BHandHLYP, B3P, B3PW, …</li>
<li>Range-Sep. Hyb. : wB97, wB97X, CAM-B3LYP, LC-BLYP</li>
<li>Hybrid Meta-GGA : TPSSh, TPSS0, M06, M062X, …</li>
<li>Double-Hybrid : RI-B2PLYP, RI-MPW2PLYP, RI-B2T-PYLP, RI-B2K-PYLP, RI-B2GP-PLYP</li>
<li>没有RI近似也可以使用这些泛函。RI模式下的双杂化需要一个辅助基集(‘ /C ‘)</li>
</ul>
<h2 id="全局内存"><a href="#全局内存" class="headerlink" title="全局内存"></a>全局内存</h2><ul>
<li><p>This limit applies per processing core.</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">%MaxCore <span class="number">3000</span> <span class="meta">#sets 3000 MB (= 3 GB)</span></span><br></pre></td></tr></table></figure>
<ul>
<li>这里，每个内核3000 MB的内存分配给ORCA。如果请求使用6个CPU内核，这意味着ORCA的总内存需求为6x3000 = 18000 MB = 18 GB。为了确保计算节点具有可用的物理内存总量。 通常，您不应要求超过75％的可用物理内存（因为ORCA偶尔会使用比maxcore设置更多的内存）。因此，在这种情况下，如果计算机具有24 GB或更多的物理内存可用就可以</li>
</ul>
</li>
<li><p>如果正在使用的计算节点也被其他用户使用，请确保请求的内存不要超过有权使用的内存。例如，如果一个12核节点具有120 GB的内存，而你提交了一个6核作业，则你有权使用该内存的一半（例如，请注意，有时排队系统要求您指定所需的内存量）。因此，仅应允许您的6核作业使用60 GB的内存或10,000 MB（10GB）的maxcore（每个核的内存）。由于ORCA中的内存使用率通常会超出maxcore，因此将maxcore降低至可用物理内存的〜75％：建议将maxcore设置为％maxcore 7500。</p>
</li>
<li><p>如果ORCA以一般消息终止：“ ORCA finished by error termination in [ORCA module]”，并且上面没有其他有用的消息， 原因取决于运行哪个ORCA模块。如果运行的模块是占用大量内存的模块，例如：orca_mp2，orca_scfhess，orca_mdci，orca_mrci等，则作业可能会耗尽内存或磁盘空间，或者访问内存或磁盘时出现问题。这也可能是运行一个具有过多内核的小型系统的计算的问题（运行一个仅包含几个原子的系统的60内核计算是没有意义的，并且会导致不可预测的结果）。</p>
</li>
</ul>
<h1 id="多步作业"><a href="#多步作业" class="headerlink" title="多步作业"></a>多步作业</h1><p>ORCA支持在一个输入文件中设置多步作业，使用<code>$new_job</code>关键词来标记下一个作业的开始。多步作业常在以下类型的计算中会用到：</p>
<ul>
<li>用不同的方法或基组计算同一个分子的性质。</li>
<li>用相同的参数计算一系列分子。</li>
<li>在结构优化之后用更高级的方法计算单点能或其他性质。</li>
<li>用小基组计算提供轨道的初始猜测，做大基组的计算。</li>
</ul>
<p>eg：表示先在LDA水平下计算BO分子的g张量，再使用BP86泛函计算。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"># -----------------------------------------------------</span><br><span class="line">! UKS LSD SVP grid5 NoFinalGrid TightSCF KeepInts</span><br><span class="line"># -----------------------------------------------------</span><br><span class="line">%eprnmr gtensor <span class="number">1</span> end</span><br><span class="line">* <span class="keyword">int</span> <span class="number">0</span> <span class="number">2</span></span><br><span class="line">B <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span></span><br><span class="line">O <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1.2049</span> <span class="number">0</span> <span class="number">0</span></span><br><span class="line">*</span><br><span class="line"># *************************************************</span><br><span class="line"># ****** This starts the input <span class="keyword">for</span> the next job *</span><br><span class="line"># *************************************************</span><br><span class="line">$new_job</span><br><span class="line"># --------------------------------------------------</span><br><span class="line">! BP86 SVP SmallPrint ReadInts NoKeepInts</span><br><span class="line"># --------------------------------------------------</span><br><span class="line">%eprnmr gtensor <span class="number">1</span> end</span><br><span class="line">* <span class="keyword">int</span> <span class="number">0</span> <span class="number">2</span></span><br><span class="line">B <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span></span><br><span class="line">O <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1.2049</span> <span class="number">0</span> <span class="number">0</span></span><br><span class="line">*</span><br></pre></td></tr></table></figure>
<ul>
<li><p>在使用$new_job来设置多步作业时，下一步任务会默认使用前一步任务的所有参数设置。如果需要使用不同的参数，可以在下一步任务中修改相关参数。例如，在前一步计算中使用了RI近似，在后一步的计算中会默认使用，如果不想使用，则需要用关键词将其关闭。此外，下一步任务会默认使用上一步任务的轨道做初始猜测，如果在下一步任务中要使用其他的初始猜测，也要指定相关的关键词。</p>
</li>
<li><p>在ORCA的计算中，假设输入文件名为MyJob.inp，那么程序产生的所有的文件都名为MyJob.xxx。有时候在多步计算中，不同的步骤需要不同的文件名，可以通过%base这个变量来修改名称，例如:</p>
<p><img src="/clipboard.png" alt="img"></p>
<ul>
<li>第一步任务中产生的所有文件以FirstJob开头，第二步任务中产生的文件以SecondJob开头。</li>
</ul>
</li>
</ul>
<h1 id="输入优先级别"><a href="#输入优先级别" class="headerlink" title="输入优先级别"></a>输入优先级别</h1><ul>
<li><p>不区分大小写</p>
</li>
<li><p>先读取所有！关键词，不分顺序</p>
<ul>
<li><p>例外是如果基组指定两个，后面那个优先，辅助基组也是如此</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">! def2-SVP def2-TZVP</span><br><span class="line">! def2/J SARC/J</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>然后按输入文件中的block顺序读取，比！优先</p>
</li>
<li><p>大多数block输入关键字控制单个变量(尽管也有例外)。如果有重复的关键字，则使用后一个值。</p>
</li>
</ul>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">! def2-TZVP UKS</span><br><span class="line">%method</span><br><span class="line">functional BP86</span><br><span class="line">correlation C_LYP</span><br><span class="line">SpecialGridAtoms[<span class="number">1</span>] <span class="number">26</span>, <span class="number">27</span></span><br><span class="line">SpecialGridIntacc <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span></span><br><span class="line">SpecialGridAtoms <span class="number">28</span>, <span class="number">29</span></span><br><span class="line">end</span><br><span class="line">! PBE def2-SVP RKS</span><br></pre></td></tr></table></figure>
<p>等同于</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">! UKS BLYP def2-SVP</span><br><span class="line">%method</span><br><span class="line">SpecialGridAtoms <span class="number">28</span>, <span class="number">29</span>, <span class="number">27</span></span><br><span class="line">SpecialGridIntacc <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span></span><br><span class="line">end</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>计算化学</category>
        <category>软件</category>
      </categories>
      <tags>
        <tag>输入</tag>
        <tag>ORCA</tag>
        <tag>内存</tag>
      </tags>
  </entry>
  <entry>
    <title>【ORCA】04.重启计算&amp;初猜</title>
    <url>/2020/09/04/%E3%80%90ORCA%E3%80%9104.%E9%87%8D%E5%90%AF%E8%AE%A1%E7%AE%97&amp;%E5%88%9D%E7%8C%9C/</url>
    <content><![CDATA[<h1 id="初猜"><a href="#初猜" class="headerlink" title="初猜"></a>初猜</h1><p><code>%scf</code>中有<code>Guess</code>、<code>MOInp</code>和<code>GuessMode</code>三个变量：</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">%scf </span><br><span class="line">    Guess HCore </span><br><span class="line">    MOInp <span class="string">&quot;Name.gbw&quot;</span></span><br><span class="line">    GuessMode FMatrix </span><br><span class="line">    AutoStart <span class="literal">true</span></span><br><span class="line">end</span><br></pre></td></tr></table></figure>
<h2 id="Guess"><a href="#Guess" class="headerlink" title="Guess"></a>Guess</h2><p>Guess可以用<code>HCore</code>、<code>Hueckel</code>、<code>PAtom</code>、<code>PModel</code> 【默认】、<code>MORead</code>：</p>
<ul>
<li><code>HCore</code>：单电子矩阵<ul>
<li>非常简单但是几乎不用，因为产生的轨道太compact</li>
</ul>
</li>
<li><p><code>MORead</code>：读取之前计算的轨道，与<code>moinp</code>一起使用</p>
</li>
<li><p><code>Hueckel</code>：扩展休克尔方法。</p>
<ul>
<li>执行最小基扩展的uckel计算和使用GuessMode两种方法之一将MOs从这个计算投影到实际的基组上进行。最小基是STO-3G，比较差，因此休克尔初猜可能不太好。</li>
</ul>
</li>
<li><code>PAtom</code>：极化原子密度。<ul>
<li>原子密度的叠加是以一种很好的初步猜测，但是分子的实际形状没有被考虑进去，更难可靠地定义单个占据轨道的ROHF计算或合理的自旋密度的UHF计算。因此，ORCA在PAtom猜测时选择了不同的方法。在所有的电子在最小的原子SCF轨道进行Huckel计算，这些都是一次性确定的，并存储在程序中，这意味着原子周围的密度非常接近原子，一个中心上的所有轨道都是正交的，最初的电子分布已经反应了分子形状，对于ROHF的计算，有明确的单已占据轨道。</li>
</ul>
</li>
<li><code>PModel</code> ：Model potential，或者直接用<code>!PModel</code>。<ul>
<li>它包括建立和对角化一个带有电子密度的Kohn-Sham矩阵，电子密度由球形中性原子密度的叠加构成，而这些密度是相对论和非相对论方法预先确定的。这一猜测对Hartree-Fock和DFT方法都有效，但对半经验模型无效。由于猜测的复杂性稍微耗时。对于元素周期表中的大多数原子来说，PModel 是可用的，因此PModel猜测通常是选择的方法(特别是对于含有重元素的分子)，除非有更精确的起始轨道可用。</li>
</ul>
</li>
</ul>
<h2 id="MOInp-amp-AutoStart-重启SCF计算"><a href="#MOInp-amp-AutoStart-重启SCF计算" class="headerlink" title="MOInp&amp;AutoStart 重启SCF计算"></a>MOInp&amp;AutoStart 重启SCF计算</h2><p>每一圈SCF都会自动储存当前的轨道，覆盖前面的gbw文件（因此要注意初猜是否需要重命名以免被覆盖），因此可以通过当前gbw文件重启计算。只有HF和数值频率可以重启（不包括post HF、分子性质、光谱等）。</p>
<ul>
<li><p><code>Autostart</code>默认是<code>true</code> ：从找是否存在存在的的同名.gbw文件，然后读取轨道和重启所需的所有其他信息，<code>Guess</code>也会被设置为<code>MORead</code>，并且该gbw文件会被重名为BaseName.ges，<code>Moinp</code>就会指向这个文件。如果不需要，则使用用<code>false</code>或者使用<code>!NoAutoStart</code>则关闭。</p>
</li>
<li><p>如果需要另外读取轨道，可以：</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">! moread</span><br><span class="line">% moinp <span class="string">&quot;name.gbw&quot;</span></span><br></pre></td></tr></table></figure>
<ul>
<li><p>注意，另外读取的轨道名字不能和输入文件名字相同。否则该gbw会新计算的结果被覆盖。</p>
</li>
<li><p>不同的gbw可以互相兼容，如果gbw文件比较旧，可以用以下方法来产生一个比较新版本的gbw：</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">! rescue moread noiter</span><br><span class="line">% moinp <span class="string">&quot;name.gbw&quot;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>当调用rescue关键字时，只从.gbw文件中读取轨道coeficients，从输入文件中读取其他所有内容。因此要确保旧gbw中的几何和基组和新的输入文件匹配。</li>
<li>如果冗余成分从该基组上去除了，则<code>! moread noiter</code>一定不能用来从之前的计算中读取SCF轨道，因为这会导致错误的结果。如果不能一次性完成整个计算，可以尝试通过<code>! rescue moread</code>来重启。</li>
<li>如果 在计算后ORCA在重叠矩阵中遗漏了非常低的特征值（默认为&lt;1e-8），则在计算后重新启动SCF时， <code>Rescue</code>关键字也是必需的 。</li>
</ul>
</li>
</ul>
</li>
<li><p>在同一个ORCA版本中，几何图形和基组都没有存储在需要匹配当前的几何或基组的name.gbw中。程序只检查当前计算中发现的分子和name.gbw是相互一致的，然后执行一个可能的轨道投影。如果这两组基是相同的，程序默认只对输入轨道进行重新正交化和重整。但是可以通过在<code>% scf</code>块中指定<code>GuessMode</code>为<code>CMatrix</code>或<code>FMatrix</code>来改变。</p>
</li>
<li><p>如果使用了<code>SCFMode = Conventional</code>和<code>SCFMode = SemiDirect</code>需要重启时：</p>
<ul>
<li><p>该程序存储了大量的积分，这些积分在磁盘上计算可能很耗时。通常程序会在计算结束时删除这些积分。但是，如果要做一个紧密相关的计算需要相同的积分（比如几何结构，基组，threshold等都相同），使用之前生成的积分会更快，则需要设置：</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">%scf</span><br><span class="line">	KeepInts <span class="literal">true</span> # Keep integrals on disk</span><br><span class="line">	ReadInts <span class="literal">true</span> # Read integrals from disk</span><br><span class="line">	IntName <span class="string">&quot;MyInts&quot;</span> # 如果第二次与第一次计算的名称不同，则需要输入第一次程序积分文件的名称（不包含拓展名，去掉了输入文件的.inp）</span><br><span class="line">end</span><br></pre></td></tr></table></figure>
</li>
<li><p>如果重新使用积分用于<code>SCFMode = SemiDirect</code>，它禁止改变<code>%scf</code>中的<code>Tcost</code>和<code>Tsize</code>。程序不会检查这些，但是结果可能完全没有意义。一般来说，用旧的积分文件重新开始计算需要用户的意识和责任，如果使用得当，该特性可以节省大量时间。</p>
</li>
</ul>
</li>
</ul>
<h3 id="改变初猜MO的轨道顺序或打破初猜的对称性"><a href="#改变初猜MO的轨道顺序或打破初猜的对称性" class="headerlink" title="改变初猜MO的轨道顺序或打破初猜的对称性"></a>改变初猜MO的轨道顺序或打破初猜的对称性</h3><ul>
<li>初猜可能会产生错误的占据，或者需要使用之前计算的轨道收敛到其他的电子态，则可以使用<code>ROTATE</code>重排MOs等。但是仅在通过<code>MOread</code>在先前收敛的解决方案中交换轨道时，此方法才适用（如果在开始时使用常规的默认猜测轨道交换了轨道，则不适用）。</li>
</ul>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">%scf</span><br><span class="line">    Rotate</span><br><span class="line">        &#123;MO1, MO2, Angle&#125; </span><br><span class="line">        &#123;MO1, MO2, Angle, Operator1, Operator2&#125;</span><br><span class="line">        &#123;MO1, MO2&#125;</span><br><span class="line">    end</span><br><span class="line">end</span><br></pre></td></tr></table></figure>
<ul>
<li>MO1和MO2是两个轨道的序号。<strong>注意ORCA的轨道序号是从0开始的。</strong></li>
<li>Angle是旋转的角度。<code>90</code>度是翻转两个轨道，<code>45</code>是1:1混合两个轨道，180度导致相变。</li>
<li><code>Operator1</code> and <code>Operator2</code>是轨道设置。对于UHF来说，alpha是<code>0</code>，beta是<code>1</code>。但是RHF和ROHF只有一个轨道设置，即<code>0</code></li>
</ul>
<p><code>Rotate</code>可以用来在过渡金属二聚体中产生对称性破缺的解。首先做一个高自旋的计算，然后找到相互对称和反对称组合的MOs对，让这些轨道作为初猜，然后对每一对用45的旋转。</p>
<h2 id="GuessMode"><a href="#GuessMode" class="headerlink" title="GuessMode"></a>GuessMode</h2><p>其余的猜测(可能)需要将最初的猜测轨道投影到实际的基组上，有两种方法：</p>
<ul>
<li><code>FMatrix</code> ：FMatrix projection</li>
<li><code>CMatrix</code> ：Corresponding orbital projection</li>
</ul>
<p>结果一般很相似，某些情况<code>CMatrix</code>更好，<code>FMatrix</code>会更简单更快：</p>
<ul>
<li><p>FMatrix projection定义了一个有效的单电子算符，<script type="math/tex">f=\sum_{i} \varepsilon_{i} a_{i}^{\dagger} a_{i}</script></p>
<ul>
<li>这个和是初猜轨道集中的所有轨道，<script type="math/tex">a_{i}^{\dagger}</script>是一个猜测MO<em>i的电子生成算符，$$a</em>{i}<script type="math/tex">是相应的湮灭算符，</script>ε_i$$是轨道能量。这个有效的单电子算符在实际基组中被对角化，特征向量是在目标基础上的初始猜测轨道。对于大多数波函数，这产生了一个相当合理的猜测。</li>
</ul>
</li>
<li><p>CMatrix更加复杂，它用了Corresponding orbital去分别拟合每个MO的子空间（占据、部分占据、alpha、beta占据）。拟合已占据轨道后，在已占据轨道的正交补中选择虚起始轨道。在某些情况下，特别是重新启动ROHF计算时，这可能是一个优势。</p>
</li>
</ul>
<h1 id="用Gaussian的输出转换为初猜文件gbw"><a href="#用Gaussian的输出转换为初猜文件gbw" class="headerlink" title="用Gaussian的输出转换为初猜文件gbw"></a>用Gaussian的输出转换为初猜文件gbw</h1><ul>
<li>先用高斯进行计算：<ul>
<li>确保Gaussian里用的基组和ORCA里精确一致。</li>
<li>Gaussian计算时候加上<code>nosymm</code>关键词避免摆到标准朝向下</li>
<li><code>int=NoBasisTransform</code>关键词避免去掉任何primitive GTF，即基组原始怎么定义的就怎么用。</li>
</ul>
</li>
<li>用formchk将chk转换为fch，载入Multiwfn后依次输入</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">100  //其它功能 Part 1</span><br><span class="line">2   //导出文件</span><br><span class="line">9   //导出mkl文件</span><br><span class="line">y   //表明产生的mkl文件是给ORCA当初猜用，程序会做特殊处理</span><br><span class="line">XXX.mkl</span><br></pre></td></tr></table></figure>
<ul>
<li><p>将mkl转换成gbw作为orca的初猜</p>
<figure class="highlight autohotkey"><table><tr><td class="code"><pre><span class="line">orc<span class="built_in">a_2mkl</span> xxx -gbw</span><br></pre></td></tr></table></figure>
</li>
<li><p>如果传递给orca后，没有1圈就结束迭代，需要仔细对比二者的基函数是否有区别，高斯中可以使用<code>GFPrint</code>打印基函数，orca用<code>printbasis</code>打印基函数。</p>
</li>
</ul>
<h1 id="几何优化的重启"><a href="#几何优化的重启" class="headerlink" title="几何优化的重启"></a>几何优化的重启</h1><ul>
<li>迭代圈数耗尽或者意外崩溃，最简单的办法是最后一组坐标并从那里开始新的计算</li>
<li>从底部搜“<code>CARTESIAN COORDINATES</code>”或者直接从 jobname.xyz中读取</li>
<li>几何优化不会自动读取gbw文件。因此如果需要读取old orbitals（几何优化中通常没有必要），可以用MOREAD 和 %moinp 指定。</li>
</ul>
<h1 id="频率的重启"><a href="#频率的重启" class="headerlink" title="频率的重启"></a>频率的重启</h1><ul>
<li>解析频率不能重启</li>
<li>数值频率计算确保.hess文件存在，如果在集群上使用作业提交脚本，确保将.hess文件复制到执行计算的节点上的本地scratch目录中。</li>
</ul>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">!</span><br><span class="line">%freq </span><br><span class="line">restart truec</span><br><span class="line">end</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>计算化学</category>
        <category>软件</category>
      </categories>
      <tags>
        <tag>ORCA</tag>
        <tag>初猜</tag>
      </tags>
  </entry>
  <entry>
    <title>【ORCA】DLPNO-CCSD(T)</title>
    <url>/2020/05/29/%E3%80%90ORCA%E3%80%91DLPNO-CCSD(T)/</url>
    <content><![CDATA[<ul>
<li>DLPNO-CCSD(T)是一种基于局域轨道的近似CCSD(T)方法，其所得相关能与标准CCSD(T)的相关能比值可达99.9%以上，误差可控制在1 kcal/mol。在平时的计算中，需要用高精度方法的电子能量时，如果体系较大，无法做标准CCSD(T)计算，可以考虑使用ORCA的DLPNO-CCSD(T)方法。</li>
</ul>
<p>输入文件例子：</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">%pal nprocs <span class="number">16</span> end</span><br><span class="line">%maxcore <span class="number">28000</span></span><br><span class="line">! def2-TZVP def2-TZVP/C DLPNO-CCSD(T) TightSCF tightPNO</span><br><span class="line">* xyz <span class="number">0</span> <span class="number">1</span></span><br><span class="line">体系xyz坐标</span><br><span class="line">*</span><br></pre></td></tr></table></figure>
<h1 id="内存"><a href="#内存" class="headerlink" title="内存"></a>内存</h1><ul>
<li>一般使用的核数比较小，因为DLPNO-CCSD(T)比较消耗内存</li>
<li><code>%maxcore</code>×<code>%pal</code>要小于总内存（大约是orca.sub中指定的节点数*4）</li>
<li>对硬盘的空间大小要求不是很高，但是对硬盘的读写性能要求很高，如果用SSD就会提升很多计算速度</li>
</ul>
<h1 id="基组"><a href="#基组" class="headerlink" title="基组"></a>基组</h1><ul>
<li><p>LPNO必须使用RI近似，因此必须提供<strong>相关拟合</strong>的基组。比如：def2-SVP/C, def2-TZVP/C, def2-TZVPP/C, def2-QZVPP/C, cc-pVnZ/C, aug-cc-pVnZ/C (n=D,T,Q,5,6) </p>
</li>
<li><p>DLPNO-CCSD(T)的HF计算部分可以用RIJK或者RIJCOSX方法来加速，并指定辅助基组</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">RIJK def2/JK</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">RIJCOSX def2/J</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h1 id="精度控制选项"><a href="#精度控制选项" class="headerlink" title="精度控制选项"></a>精度控制选项</h1><h2 id="tightpno"><a href="#tightpno" class="headerlink" title="tightpno"></a>tightpno</h2><p><code>tightPNO</code>为控制CCSD(T)精度的参数，对应的可选值有<code>LoosePNO</code>、<code>NormalPNO</code>（默认）、<code>TightPNO</code>，一般来说LoosePNO精度不高，尽量选择后两个：</p>
<ul>
<li>用NormalPNO的时候精度就已经显著超过PWPB95-D3(BJ)了，相对于CCSD(T)的误差通常在1kcal/mol以内。</li>
<li>DLPNO-CCSD(T)结合tightPNO的时候，根据J. Chem. Theory Comput., 11, 4054 (2015)的测试（注意此文里有很多在耗时方面的严重误导性说法），与CCSD(T)的误差在1 kJ/mol的程度，几乎可认为没有差别。tightPNO的耗时比NormalPNO通常高几倍。在笔者的Intel 36核机子上，用当前级别计算66个原子的有机体系耗时约8小时，耗硬盘最多时候为120GB。如果你还想要更好的精度，建议将基组提升至cc-pVQZ，但也会贵非常多。如果不用RIJK，即去掉RIJK cc-pVTZ/JK关键词，精度会有所改进，但对较大的体系，SCF部分的耗时会增加许多。</li>
</ul>
<h2 id="ccsd-t1"><a href="#ccsd-t1" class="headerlink" title="ccsd(t1)"></a>ccsd(t1)</h2><ul>
<li>在ORCA 4.2版中，需要注意直接在关键词中写DLPNO-CCSD(T)实际做的是<code>DLPNO-CCSD(T0)</code>计算。所谓T0是指在进行(T)计算时使用semi-canonical (SC) 近似。在局域轨道表象下，分子轨道基的Fock矩阵的非对角元不为0，此时(T)的计算需要迭代求解。<strong>在SC近似下，忽略Fock矩阵的非对角元，不进行迭代求解。</strong></li>
<li><strong>而不使用SC近似，对(T)部分进行迭代求解</strong>，这部分功能在ORCA中应该写为<code>DLPNO-CCSD(T1)</code>，这样结果与标准CCSD(T)更为接近。在J. Chem. Phys. 148, 011101 (2018)一文中，作者提到，一般在研究相对能量的问题时，使用T0便可以得到很好的结果，而对gap比较小的体系，可能需要T1才能得到准确的结果。</li>
</ul>
<h2 id="tcutpno"><a href="#tcutpno" class="headerlink" title="tcutpno"></a>tcutpno</h2><ul>
<li><p>如果还需要更准，可以修改<code>TCutPNO</code>的具体值。(<code>TCutPNO 3.33e-7</code> 默认)</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">%mdci</span><br><span class="line">	TCutPNO <span class="number">0.0</span></span><br><span class="line">end</span><br></pre></td></tr></table></figure>
</li>
<li><p>更高精度的话，比如追求CCSD(T)的精度，可以把cutoff都设置为0：</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">%mdci</span><br><span class="line">	TCutPNO <span class="number">0.0</span></span><br><span class="line">	TCutDo <span class="number">0.0</span></span><br><span class="line">	TCutTNO <span class="number">0.0</span></span><br><span class="line">	TCutPairs <span class="number">0.0</span></span><br><span class="line">end</span><br></pre></td></tr></table></figure>
<ul>
<li>在此基础上还需要用比较大的辅助基组，否则RI对 四个virtual的积分会有比较大的误差。比如用DLPNO-CCSD（T1）/cc-pvdz 希望得到和标准CCSD(T) 一模一样的结果（小数点后第六位一样，单位hartree），除了把cutoff设置为0，还要用cc-pv5z/c作为cc-pvdz的辅助基组</li>
</ul>
</li>
</ul>
<p>20210130 8核 cc-pvtz 测试B<sub>9</sub><sup>-</sup>结果</p>
<p><img src="image-20210205164601861.png" alt=""></p>
<h1 id="优化"><a href="#优化" class="headerlink" title="优化"></a>优化</h1><ul>
<li>通常只拿来算单点</li>
<li>ccsd(t)没有解析梯度，因此要加上</li>
</ul>
<figure class="highlight armasm"><table><tr><td class="code"><pre><span class="line">!<span class="meta">opt</span> numgrad</span><br></pre></td></tr></table></figure>
<p><img src="clipboard.png" alt=""></p>
<ul>
<li><p>计算开壳层时，最好使用UCO</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">! UCO</span><br><span class="line">#是用于绘制UHF波函数的自然轨道，同UNO。</span><br></pre></td></tr></table></figure>
</li>
</ul>
]]></content>
      <categories>
        <category>计算化学</category>
        <category>软件</category>
      </categories>
      <tags>
        <tag>ORCA</tag>
        <tag>DLPNO</tag>
      </tags>
  </entry>
  <entry>
    <title>【Pyscf】02.SCF</title>
    <url>/2021/11/05/%E3%80%90Pyscf%E3%80%9102.SCF/</url>
    <content><![CDATA[<ul>
<li>主要是<a href="https://pyscf.org/pyscf_api_docs/pyscf.scf.html">scf部分</a></li>
<li>自洽场 (SCF) 方法包括 Hartree-Fock (HF) 理论和 Kohn-Sham (KS) 密度泛函理论 (DFT)。</li>
</ul>
<h1 id="方法"><a href="#方法" class="headerlink" title="方法"></a>方法</h1><p>HF 或 KS-DFT 波函数中使用的一般自旋轨道可以写为<script type="math/tex">\psi_i(1) = \phi_{i\alpha}(r)\alpha + \phi_{i\beta}(r)\beta \;,</script></p>
<ul>
<li>受限（RHF/RKS）<ul>
<li>自旋轨道是 alpha（自旋向上）或 beta（自旋向下）：<script type="math/tex">\psi_i =\phi_i(r)\alpha</script>或者<script type="math/tex">\psi_i = \phi_i(r)\beta</script></li>
<li>alpha 和 beta 轨道共享相同的空间轨道<script type="math/tex">\phi_i(r)</script></li>
<li>闭壳行列式：<script type="math/tex">\Phi=\mathcal{A}|\phi_1(r_1)\alpha \phi_1(r_2)\beta \ldots
\phi_{N/2}(r_{N-1})\alpha \phi_{N/2}(r_N)\beta|</script></li>
</ul>
</li>
<li>无限制 (UHF/UKS)：<ul>
<li>轨道可以有 alpha 或 beta 自旋，但 alpha 和 beta 轨道可能具有不同的空间分量</li>
<li><script type="math/tex; mode=display">\Phi=\mathcal{A}|\phi_1(r_1)\sigma_1
\phi_2(r_2)\sigma_2 \ldots \phi_{N}(r_N)\sigma_N|</script></li>
</ul>
</li>
<li>受限开壳 (ROHF/ROKS):<ul>
<li><script type="math/tex">N_\alpha > N_\beta</script>，首先$N_\beta$个轨道<script type="math/tex">\alpha</script> 和<script type="math/tex">\beta</script>具有相同的空间分量</li>
<li><script type="math/tex">N_\alpha - N_\beta</script>是<script type="math/tex">\alpha</script>自旋</li>
<li><script type="math/tex; mode=display">\Phi=\mathcal{A}|\phi_1
\alpha \phi_1\beta \ldots \phi_{N_\beta} \alpha \phi_{N_\beta}\beta
\phi_{N_\beta+1}\alpha \ldots \phi_{N}\alpha|</script></li>
</ul>
</li>
<li>广义 (GHF/GKS)</li>
</ul>
<p>调用方法：</p>
<figure class="highlight ini"><table><tr><td class="code"><pre><span class="line"><span class="attr">mf</span> = scf.RHF(mol).run()</span><br><span class="line"><span class="attr">mf</span> = scf.UHF(mol).run()</span><br><span class="line"><span class="attr">mf</span> = scf.ROHF(mol).run()</span><br><span class="line"><span class="attr">mf</span> = scf.GHF(mol).run()</span><br><span class="line"><span class="attr">mf</span> = scf.RKS(mol).run()</span><br><span class="line"><span class="attr">mf</span> = scf.UKS(mol).run()</span><br><span class="line"><span class="attr">mf</span> = scf.ROKS(mol).run()</span><br><span class="line"><span class="attr">mf</span> = scf.GKS(mol).run()</span><br></pre></td></tr></table></figure>
<h1 id="调用"><a href="#调用" class="headerlink" title="调用"></a>调用</h1><p>对象可以通过两种方式创建：</p>
<ol>
<li><p>通过pyscf创建</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pyscf</span><br><span class="line"></span><br><span class="line">mol = pyscf.M(</span><br><span class="line">    atom = <span class="string">&#x27;H 0 0 0; F 0 0 1.1&#x27;</span>,  <span class="comment"># in Angstrom</span></span><br><span class="line">    basis = <span class="string">&#x27;ccpvdz&#x27;</span>,</span><br><span class="line">    symmetry = <span class="literal">True</span>,</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">myhf = mol.HF()</span><br><span class="line">myhf.kernel()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Orbital energies, Mulliken population etc.</span></span><br><span class="line">myhf.analyze()</span><br></pre></td></tr></table></figure>
</li>
<li><p>通过gto和scf模块进行创建：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pyscf <span class="keyword">import</span> gto, scf</span><br><span class="line">mol = gto.M(</span><br><span class="line">    atom = <span class="string">&#x27;H 0 0 0; F 0 0 1.1&#x27;</span>,  <span class="comment"># in Angstrom</span></span><br><span class="line">    basis = <span class="string">&#x27;ccpvdz&#x27;</span>,</span><br><span class="line">    symmetry = <span class="literal">True</span>,</span><br><span class="line">)</span><br><span class="line">myhf = scf.HF(mol)</span><br><span class="line">myhf.kernel()</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h1 id="HF"><a href="#HF" class="headerlink" title="HF"></a>HF</h1><h2 id="一般参数"><a href="#一般参数" class="headerlink" title="一般参数"></a>一般参数</h2><ul>
<li><code>verbose</code>：打印级别，默认等于<code>Mole.verbose</code></li>
<li><code>max_memory</code>：内存，默认等于<code>Mole.max_memory</code></li>
<li><code>chkfile</code>：保存分子轨道，轨道能量等的文件，如果设置为<code>None</code>或者<code>False</code>，则禁止写入chkfile。</li>
<li><code>conv_tol</code>：收敛限，默认为<code>1e-9</code></li>
<li><code>conv_tol_grad</code>：梯度收敛阈值，默认为<code>conv_tol</code>的开方</li>
<li><code>max_cycle</code>：最大迭代次数。如果<code>max_cycle</code>≤0，SCF 迭代将被跳过，kernel函数将仅根据初始猜测计算总能量。默认为<code>50</code>。</li>
</ul>
<h2 id="初猜"><a href="#初猜" class="headerlink" title="初猜"></a>初猜</h2><p><code>init_guess</code>：</p>
<ul>
<li><p><code>minao</code>（默认）：从 cc-pVTZ 或 cc-pVTZ-PP 基组中的第一个收缩函数获得的最小基中投影的原子密度的叠加。猜测轨道是通过对角化由自旋受限猜测密度产生的 Fock 矩阵获得的。</p>
</li>
<li><p><code>1e</code>：单电子猜测，也称为核猜测，从核哈密顿量<script type="math/tex">\mathbf{H}_0 = \mathbf{T} + \mathbf{V}</script>的对角化得到猜测轨道，忽略了所有电子间的相互作用和对核电荷的屏蔽。只能作为最后的手段，因为它对分子系统来说不是很好。</p>
</li>
<li><p><code>atom</code>：原子 HF 密度矩阵的叠加。原子 HF 计算受到自旋限制，并采用球平均分数占据，基态通过完全数值计算的完整基组限制下确定 。</p>
</li>
<li><p><code>huckel</code>：无参数 Hückel 猜测 ，它基于与 类似执行的动态原子 HF 计算<code>&#39;atom&#39;</code>。球平均原子自旋受限 Hartree-Fock 计算产生原子轨道和轨道能量的最小基础，用于构建 Hückel 型矩阵，该矩阵对角化以获得猜测轨道。</p>
</li>
<li><p><code>chkfile</code>：从*.chk文件中读取轨道并将它们用作初始猜测。</p>
<figure class="highlight clean"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pyscf <span class="keyword">import</span> scf</span><br><span class="line">mf = scf.RHF(mol)</span><br><span class="line">mf.chkfile = <span class="string">&#x27;/path/to/chkfile&#x27;</span></span><br><span class="line">mf.init_guess = <span class="string">&#x27;chkfile&#x27;</span></span><br><span class="line">mf.kernel()</span><br></pre></td></tr></table></figure>
<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">from pyscf import scf</span><br><span class="line">mf = scf.<span class="constructor">RHF(<span class="params">mol</span>)</span></span><br><span class="line">dm = scf.hf.from<span class="constructor">_chk(<span class="params">mol</span>, &#x27;<span class="operator">/</span><span class="params">path</span><span class="operator">/</span><span class="params">to</span><span class="operator">/</span><span class="params">chkfile</span>&#x27;)</span></span><br><span class="line">mf.kernel(dm)</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>hcore</code></p>
</li>
</ul>
<p>也可以通过<code>dm0</code>参数来覆盖 SCF 计算的初始猜测密度矩阵：</p>
<figure class="highlight nix"><table><tr><td class="code"><pre><span class="line"><span class="comment"># First calculate the Cr6+ cation</span></span><br><span class="line"><span class="attr">mol</span> = gto.Mole()</span><br><span class="line">mol.build(</span><br><span class="line">    <span class="attr">symmetry</span> = &#x27;D2h&#x27;,</span><br><span class="line">    <span class="attr">atom</span> = [[&#x27;Cr&#x27;,(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>)], ],</span><br><span class="line">    <span class="attr">basis</span> = &#x27;cc-pvdz&#x27;,</span><br><span class="line">    <span class="attr">charge</span> = <span class="number">6</span>,</span><br><span class="line">    <span class="attr">spin</span> = <span class="number">0</span>,</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="attr">mf</span> = scf.RHF(mol)</span><br><span class="line">mf.kernel()</span><br><span class="line"><span class="attr">dm1</span> = mf.make_rdm1()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Now switch to the neutral atom in the septet state</span></span><br><span class="line">mol.<span class="attr">charge</span> = <span class="number">0</span></span><br><span class="line">mol.<span class="attr">spin</span> = <span class="number">6</span></span><br><span class="line">mol.build(False,False)</span><br><span class="line"></span><br><span class="line"><span class="attr">mf</span> = scf.RHF(mol)</span><br><span class="line">mf.kernel(<span class="attr">dm0=dm1)</span></span><br></pre></td></tr></table></figure>
<h2 id="收敛"><a href="#收敛" class="headerlink" title="收敛"></a>收敛</h2><ul>
<li><p>能级移动增加了占据轨道和虚拟轨道之间的差距，从而减慢和稳定轨道更新。在具有小的 HOMO-LUMO 间隙的系统的情况下，电平转换可以帮助收敛 SCF。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">mf = scf.RHF(mol)</span><br><span class="line">mf.level_shift = <span class="number">0.2</span></span><br><span class="line">mf.kernel()</span><br></pre></td></tr></table></figure>
<ul>
<li><p>通过应用不同的电平转换来打破 alpha 和 beta 简并</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">mf = scf.UHF(mol)</span><br><span class="line">mf.level_shift = (<span class="number">0.3</span>, <span class="number">0.2</span>)</span><br><span class="line">mf.kernel()</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<p>其他函数</p>
<ul>
<li><p><code>pyscf.scf.hf.get_init_guess(mol, key=&#39;minao&#39;)</code>：为初始猜测生成密度矩阵，<code>key</code>是<code>minao</code>，<code>atom</code>，<code>huckel</code>，<code>hcore</code>，<code>1e</code>,<code>chkfile</code>中的一个。</p>
<ul>
<li>可以获得初猜后，赋值给<code>dm0</code></li>
</ul>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">mf</span> = scf.GHF(mol)</span><br><span class="line"><span class="attribute">dm</span> = mf.get_init_guess() + <span class="number">0</span>j</span><br><span class="line"><span class="attribute">dm</span>[<span class="number">0</span>,:] += .<span class="number">1</span>j</span><br><span class="line"><span class="attribute">dm</span>[:,<span class="number">0</span>] -= .<span class="number">1</span>j</span><br><span class="line"><span class="attribute">mf</span>.kernel(dm<span class="number">0</span>=dm)</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h1 id="Kernel"><a href="#Kernel" class="headerlink" title="Kernel()"></a><code>Kernel()</code></h1><p>SCF 驱动程序</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">pyscf.scf.hf.kernel(mf, <span class="attribute">conv_tol</span>=1e-10, <span class="attribute">conv_tol_grad</span>=None, <span class="attribute">dump_chk</span>=<span class="literal">True</span>, <span class="attribute">dm0</span>=None, <span class="attribute">callback</span>=None, <span class="attribute">conv_check</span>=<span class="literal">True</span>, **kwargs)</span><br></pre></td></tr></table></figure>
<ul>
<li><code>mf</code>：给定的一个对象，包含控制SCF的所有参数。<code>Kernel()</code>会调用：<code>mf.get_init_guess</code>，<code>mf.get_hcore</code>，<code>mf.get_ovlp</code>，<code>mf.get_veff</code>，<code>mf.get_fock</code>，<code>mf.get_grad</code>，<code>mf.eig</code>，<code>mf.get_occ</code>，<code>mf.make_rdm1</code>，<code>mf.energy_tot</code>，<code>mf.dump_chk</code>。</li>
<li><code>conv_tol</code>，<code>conv_tol_grad</code>：收敛限和梯度收敛阈值</li>
<li><code>dump_chk</code>：布尔值，chk文件中是否保存SCF中间结果</li>
<li><code>dm0</code>：数组，初始猜测密度矩阵。如果没有给出（默认），<code>Kernel()</code>采用 <code>mf.get_init_guess</code> 生成的密度矩阵。</li>
</ul>
<p>会返回一个列表</p>
<ul>
<li><code>scf_conv</code>：布尔值，True 表示 SCF 收敛</li>
<li><code>e_tot</code>：浮点数，最后迭代的 Hartree-Fock 能量</li>
<li><code>mo_energy</code>：一维数组，轨道能量。取决于 <code>mf</code>对象提供的 eig，可能无法对轨道能量进行排序。</li>
<li><code>mo_coeff</code>：二维数组，轨道系数</li>
<li><code>mo_occ</code>：一维数组，轨道占据数。可能不会从大到小排序。</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> pyscf <span class="keyword">import</span> gto, scf</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>mol = gto.M(atom=<span class="string">&#x27;H 0 0 0; H 0 0 1.1&#x27;</span>, basis=<span class="string">&#x27;cc-pvdz&#x27;</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>conv, e, mo_e, mo, mo_occ = scf.hf.kernel(scf.hf.SCF(mol), dm0=numpy.eye(mol.nao_nr()))</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(<span class="string">&#x27;conv = %s, E(HF) = %.12f&#x27;</span> % (conv, e))</span><br><span class="line">conv = <span class="literal">True</span>, E(HF) = <span class="number">-1.081170784378</span></span><br></pre></td></tr></table></figure>
<h1 id="analyze"><a href="#analyze" class="headerlink" title="analyze()"></a><code>analyze()</code></h1><p>分析给定的 SCF 对象：打印轨道能量、占据；打印轨道系数；Mulliken布局分析；偶极矩。</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">pyscf.scf.hf.analyze(mf, <span class="attribute">verbose</span>=5, <span class="attribute">with_meta_lowdin</span>=<span class="literal">True</span>, **kwargs)</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>计算化学</category>
        <category>软件</category>
      </categories>
      <tags>
        <tag>SCF</tag>
        <tag>Pyscf</tag>
      </tags>
  </entry>
  <entry>
    <title>【VMD】01.绘制分子轨道</title>
    <url>/2020/09/29/%E3%80%90VMD%E3%80%9101.%E7%BB%98%E5%88%B6%E5%88%86%E5%AD%90%E8%BD%A8%E9%81%93/</url>
    <content><![CDATA[<h1 id="单个cube文件"><a href="#单个cube文件" class="headerlink" title="单个cube文件"></a>单个cube文件</h1><ol>
<li><p>直接将*.cub文件拖入main窗口</p>
</li>
<li><p>将分子改为球棍模型：Graphics→Representation→Drawing method→CPK</p>
</li>
<li><p>新建一个等值面：Graphics→Representation→Create Rep</p>
<ol>
<li>修改Drawing method为Isosurface</li>
<li>修改Isovalue为0.05</li>
<li>修改等值面风格：在Draw中选择Solid Surface（实心）或者Wireframe（网格显示）</li>
<li>取消显示边框：修改Show为Isosurface</li>
<li>修改颜色：在Coloring Method选择colorID，在其后选择颜色，如1（红色）</li>
<li>修改材质：在Material中选择，比如Glossy</li>
</ol>
</li>
<li><p>重复步骤3，除了：</p>
<ol>
<li>将Isovalue为负的</li>
<li>颜色修改为另一个颜色，比如0（蓝色）</li>
</ol>
</li>
<li><p>其他美化：</p>
<ol>
<li>display→depth cueing→off</li>
<li>display→Rendermode→GLSL</li>
<li>修改背景为白色：Graphics→Color→Display→Background→White</li>
<li>取消显示坐标轴：Display→Axes→off</li>
<li>……</li>
</ol>
</li>
<li><p>导出：File→Render→Tachyon，修改Filename，Start Rendering即可，此时VMD目录下有相应的*.dat（是Tachyon的输入文件）和*.bmp文件（在默认设置下渲染出来的图像文件）。</p>
<ul>
<li>还可以通过Flie→Save Visualization state…保存当前的操作</li>
</ul>
</li>
<li><p>进一步渲染，6中是使用的默认方法，可以调用VMD自带的tachyon_WIN32.exe渲染器进一步在当前目录下使用*dat文件渲染出*.bmp图像文件，在命令行中输入：</p>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">tachyon_WIN32</span>.exe XXXX.dat -format BMP -o XXXX.bmp -trans_raster<span class="number">3</span>d -res <span class="number">2000</span> <span class="number">1500</span> -fullshade -numthreads <span class="number">4</span> -aasamples <span class="number">24</span> -shadow_filter_off</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h1 id="批量处理多个轨道文件"><a href="#批量处理多个轨道文件" class="headerlink" title="批量处理多个轨道文件"></a>批量处理多个轨道文件</h1><h2 id="1-生成cube文件"><a href="#1-生成cube文件" class="headerlink" title="1. 生成cube文件"></a>1. 生成cube文件</h2><h3 id="打开Multiwfn生成"><a href="#打开Multiwfn生成" class="headerlink" title="打开Multiwfn生成"></a>打开Multiwfn生成</h3><ol>
<li><p>Multiwfn载入*fchk文件后，通过以下命令一步步生成。然后就会在Multiwfn文件夹下生成orb0000XX.cub的文件。</p>
<figure class="highlight basic"><table><tr><td class="code"><pre><span class="line"><span class="symbol">200 </span>#其他功能</span><br><span class="line"><span class="symbol">3 </span>#保存轨道</span><br><span class="line"><span class="number">1</span>-<span class="number">4</span>，<span class="number">47</span>-<span class="number">50</span> #绘制轨道的范围</span><br><span class="line"><span class="symbol">3 </span>#选择格点质量</span><br><span class="line"><span class="symbol">1 </span>#单独保存每一个</span><br></pre></td></tr></table></figure>
<ul>
<li><p>如果是空轨道，Multiwfn计算格点数据的默认的延展距离不够大，可能造成以比较小的轨道等值面数值显示时轨道等值面被截断，可以在第三行和第四行之间加入以下步骤将延展距离加大到12Bohr：</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line"><span class="number">-10</span></span><br><span class="line"><span class="number">12</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>以上内容可以保存为一个文本文件放在Multiwfn文件夹下用于后续的批处理，如showorb.txt（Multiwfn文件夹中的examples\scripts也有）</p>
</li>
</ul>
</li>
<li><p>再将*.cub文件移动到VMD根文件夹下</p>
</li>
</ol>
<h3 id="不打开Multiwfn生成"><a href="#不打开Multiwfn生成" class="headerlink" title="不打开Multiwfn生成"></a>不打开Multiwfn生成</h3><ol>
<li><p>通过Windows批处理命令，在Multiwfn文件夹下新建showorb.bat文件（Multiwfn文件夹中的examples\scripts也有）：</p>
<figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line">Multiwfn .\XXXXXXXX<span class="selector-class">.fchk</span> &lt; showorb.txt</span><br><span class="line">move /Y *<span class="selector-class">.cub</span> <span class="string">&quot;XXXX\VMD\&quot;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>修改*.fchk文件的路径和名字</li>
<li>修改VMD的路径，如果路径中有空格，必须加双引号。</li>
</ul>
</li>
<li><p>直接双击showorb.bat，这个脚本就会调用Multiwfn去对指定的输入文件计算要考察的各个轨道的格点数据，并且导出为cube文件，所有算出来的cube文件会被这个脚本自动挪到VMD目录下。</p>
</li>
</ol>
<h2 id="2-绘制部分"><a href="#2-绘制部分" class="headerlink" title="2. 绘制部分"></a>2. 绘制部分</h2><ul>
<li><p>把Multiwfn文件包的examples\scripts目录下的VMD绘图脚本<strong>showorb.vmd</strong>拷到VMD目录下，然后用文本编辑器编辑VMD目录下的<strong>vmd.rc</strong>，在最后插入此命令：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">source</span> showorb.vmd</span><br></pre></td></tr></table></figure>
<ul>
<li>它定义了三个命令：<ul>
<li><code>orb</code>：用来载入和显示轨道。输入orb 33，就会载入VMD目录下的orb000033.cub，并把它的绘制方式修改为等值面图的形式。之后如果比如再输入orb 34，则33号轨道就会被撤销，而将orb00034.cub以等值面形式显示。</li>
<li><code>orbiso</code>：用来修改等值面数值，默认为0.05。</li>
<li><code>orbclean</code>：用来把VMD目录下所有orb开头的.cub文件全都删掉。</li>
</ul>
</li>
</ul>
</li>
<li><p>启动VMD，在命令行窗口输入就可以显示相应的文件。</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">orb</span> <span class="selector-attr">[序号]</span> </span><br></pre></td></tr></table></figure>
</li>
<li><p>看完轨道后，输入<code>orbclean</code>可以把VMD目录下的cub文件都清掉。</p>
</li>
</ul>
<h3 id="showorb-vmd"><a href="#showorb-vmd" class="headerlink" title="showorb.vmd"></a>showorb.vmd</h3><h4 id="orb命令"><a href="#orb命令" class="headerlink" title="orb命令"></a><code>orb</code>命令</h4><figure class="highlight lsl"><table><tr><td class="code"><pre><span class="line">proc orb &#123;iorb&#125; &#123;</span><br><span class="line">#修改轨道等值面数值默认值，推荐<span class="number">0.02</span>~<span class="number">0.06</span></span><br><span class="line">set isoval <span class="number">0.05</span></span><br><span class="line"></span><br><span class="line">#修改等值面材质，如果想改成透明的，可以使用EdgyGlass或Translucent等</span><br><span class="line">set mater Glossy</span><br><span class="line"></span><br><span class="line">#开启额外的<span class="number">3</span>号光源令图像更亮</span><br><span class="line">#light <span class="number">3</span> on</span><br><span class="line"></span><br><span class="line">color Display Background white</span><br><span class="line">display depthcue off</span><br><span class="line"></span><br><span class="line">#设置某个元素的颜色</span><br><span class="line">color Name C tan</span><br><span class="line">#修改tan颜色的定义。这最终使得碳原子比其默认的深青色显得更柔美</span><br><span class="line">#color change rgb tan <span class="number">0.700000</span> <span class="number">0.560000</span> <span class="number">0.360000</span></span><br><span class="line"></span><br><span class="line">display projection Orthographic</span><br><span class="line">display rendermode GLSL</span><br><span class="line">axes location Off</span><br><span class="line"></span><br><span class="line">if &#123;[molinfo num]&gt;<span class="number">0</span>&#125; &#123;</span><br><span class="line">set viewpoint [molinfo top get &#123;center_matrix rotate_matrix scale_matrix&#125;]</span><br><span class="line">&#125;</span><br><span class="line">mol delete top</span><br><span class="line"></span><br><span class="line">#修改cub文件的命名格式</span><br><span class="line">#mol new AdNDPorb[format %<span class="number">04</span>d $iorb].cub</span><br><span class="line">mol new orb[format %<span class="number">06</span>d $iorb].cub</span><br><span class="line"></span><br><span class="line">mol modstyle <span class="number">0</span> top CPK <span class="number">0.800000</span> <span class="number">0.300000</span> <span class="number">22.000000</span> <span class="number">22.000000</span></span><br><span class="line">mol addrep top</span><br><span class="line">mol modstyle <span class="number">1</span> top Isosurface $isoval <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">1</span></span><br><span class="line"></span><br><span class="line">#修改正等值面颜色淡绿色</span><br><span class="line">#mol modcolor <span class="number">1</span> top ColorID <span class="number">12</span></span><br><span class="line">mol modcolor <span class="number">1</span> top ColorID <span class="number">1</span></span><br><span class="line"></span><br><span class="line">mol modmaterial <span class="number">1</span> top $mater</span><br><span class="line">mol addrep top</span><br><span class="line">mol modstyle <span class="number">2</span> top Isosurface -$isoval <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">1</span></span><br><span class="line"></span><br><span class="line">#修改负值部分等值面的颜色为淡蓝色</span><br><span class="line">#mol modcolor <span class="number">2</span> top ColorID <span class="number">22</span></span><br><span class="line">mol modcolor <span class="number">2</span> top ColorID <span class="number">0</span></span><br><span class="line"></span><br><span class="line">mol modmaterial <span class="number">2</span> top $mater</span><br><span class="line">if [info exists viewpoint] &#123;</span><br><span class="line">molinfo top set &#123;center_matrix rotate_matrix scale_matrix&#125; $viewpoint</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#保存当前状态的渲染文件</span><br><span class="line">#render Tachyon $iorb.dat <span class="string">&quot;tachyon_WIN32.exe $&#123;iorb&#125;.dat -format BMP -o $&#123;iorb&#125;.bmp -trans_raster3d -res 2000 1500 -numthreads 4 -aasamples 24 -mediumshade &quot;</span></span><br><span class="line">render Tachyon $iorb.dat <span class="string">&quot;tachyon_WIN32.exe $&#123;iorb&#125;.dat -format BMP -o $&#123;iorb&#125;.bmp  -aasamples 12&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>其他美化：</p>
<ul>
<li>material change mirror Opaque 0.15：修改不透明材质（用于显示分子结构）的mirror属性，大于0的时候通过考虑光线追踪的渲染器渲染的时候就会有反光效果</li>
<li>material change outline Opaque 4.000000：设定不透明材质的轮廓深度</li>
<li>material change outlinewidth Opaque 0.5：设定不透明材质的轮廓粗度。设置轮廓可以使原子有勾边效果（有效避免白色的氢原子在某些地方和白色背景连为一体）</li>
<li>material change ambient Glossy 0.1：设置用于显示等值面的Glossy材质的ambient属性</li>
<li>material change diffuse Glossy 0.600000</li>
<li>material change opacity Glossy 0.75：把Glossy材质改为微透明</li>
<li>material change shininess Glossy 1.0</li>
<li>display distance -7.0：让视角距离画面的更远，可避免在窗口边缘的物体由于近大远小而畸变太厉害</li>
<li>display height 10：这句是避免因为减小了distance而导致图像变小</li>
<li>……</li>
</ul>
<h4 id="orbiso命令"><a href="#orbiso命令" class="headerlink" title="orbiso命令"></a><code>orbiso</code>命令</h4><figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">proc orbiso &#123;isoval&#125; &#123;</span><br><span class="line">mol modstyle <span class="number">1</span> top Isosurface $isoval <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">1</span></span><br><span class="line">mol modstyle <span class="number">2</span> top Isosurface -$isoval <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">1</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="orbclean命令"><a href="#orbclean命令" class="headerlink" title="orbclean命令"></a><code>orbclean</code>命令</h4><figure class="highlight tcl"><table><tr><td class="code"><pre><span class="line"><span class="keyword">proc</span><span class="title"> orbclean</span> &#123;&#125; &#123;</span><br><span class="line"><span class="comment">#修改cub文件的命名格式</span></span><br><span class="line"><span class="comment">#file delete &#123;*&#125;[glob AdNDPorb*.cub]</span></span><br><span class="line"><span class="keyword">file</span> delete &#123;*&#125;[<span class="keyword">glob</span> orb*.cub]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="使用脚本任意cube文件"><a href="#使用脚本任意cube文件" class="headerlink" title="使用脚本任意cube文件"></a>使用脚本任意cube文件</h1><p>把Multiwfn文件包的examples\scripts目录下的VMD绘图脚本showorb.vmd拷到VMD目录下，然后用文本编辑器编辑VMD目录下的vmd.rc，在最后插入此命令：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">source</span> showcub.vmd</span><br></pre></td></tr></table></figure>
<p>此脚本定义了四条命令，可以直接在VMD的控制台里输入，这里直接给出一些例子：</p>
<ul>
<li><code>cub MIO</code>：将VMD目录下的MIO.cub绘制成等值面图，正值和负值部分分别用绿色和蓝色显示，等值面数值分别为默认值0.05和-0.05</li>
<li><code>cub MIO 0.02</code>：同上，但正值和负值部分等值面数值直接分别设为0.02和-0.02</li>
<li><code>cubiso 0.015</code>：在使用cub命令后使用，把当前载入的格点数据的正值和负值部分分别设为0.015和-0.015</li>
</ul>
<p>有的时候我们需要同时将两个cube文件显示在一起，此脚本里也定义了相应命令用于此目的，示例：</p>
<ul>
<li><code>cub2 eri nozomi</code>：将VMD目录下的eri.cub和nozomi.cub同时绘制成等值面，分别用绿色和蓝色表示，等值面数值都为默认的0.05（注：如果eri和nozomi格点数据里也有负值部分，负值部分不会被显示出来）</li>
<li><code>cub2 eri nozomi 0.02</code>：同上，但是二者的等值面数值都直接设为0.02</li>
<li><code>cub2iso 0.015</code>：在使用cub2命令后使用，代表把已载入的两套cube文件对应的等值面数值都设为0.015</li>
</ul>
<p>用Multiwfn的主功能5计算完这个体系的自旋密度格点数据后，在后处理菜单选择导出cube文件，当前目录下就得到了spindensity.cub。将此文件挪到VMD目录下，启动VMD，直接输入cub spindensity 0.01</p>
]]></content>
      <categories>
        <category>计算化学</category>
        <category>软件</category>
      </categories>
      <tags>
        <tag>VMD</tag>
        <tag>绘图</tag>
        <tag>分子轨道</tag>
      </tags>
  </entry>
  <entry>
    <title>【VMD】常见命令</title>
    <url>/2020/09/29/%E3%80%90VMD%E3%80%91%E5%B8%B8%E8%A7%81%E5%91%BD%E4%BB%A4/</url>
    <content><![CDATA[<h1 id="脚本基础"><a href="#脚本基础" class="headerlink" title="脚本基础"></a>脚本基础</h1><ul>
<li><p>设定变量</p>
<figure class="highlight livecodeserver"><table><tr><td class="code"><pre><span class="line"><span class="built_in">set</span> &lt;<span class="built_in">variable</span>&gt; &lt;<span class="built_in">value</span>&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>使用变量</p>
<figure class="highlight gams"><table><tr><td class="code"><pre><span class="line"><span class="keyword">set</span> x <span class="comment">10</span></span><br><span class="line">puts <span class="comment">&quot;the value of x is:$x&quot;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>打印</p>
<figure class="highlight gams"><table><tr><td class="code"><pre><span class="line">puts <span class="symbol">$</span>&lt;<span class="keyword">variable</span>&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>条件逻辑：</p>
<figure class="highlight dust"><table><tr><td class="code"><pre><span class="line"><span class="xml">if </span><span class="template-variable">&#123;conditional&#125;</span><span class="xml"> </span><span class="template-variable">&#123;script&#125;</span><span class="xml"> elseif </span><span class="template-variable">&#123;conditional&#125;</span><span class="xml"> </span><span class="template-variable">&#123;script&#125;</span><span class="xml"> else </span><span class="template-variable">&#123;script&#125;</span></span><br></pre></td></tr></table></figure>
<p>比如：</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line"><span class="builtin-name">set</span> a 30</span><br><span class="line"><span class="keyword">if</span> &#123;<span class="variable">$a</span> &lt;= 30&#125; &#123;puts <span class="string">&quot;<span class="variable">$a</span> is seq 30&quot;</span>&#125; <span class="keyword">else</span> &#123;puts <span class="string">&quot;<span class="variable">$a</span> is larger than 30&quot;</span>&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>循环：</p>
<figure class="highlight dust"><table><tr><td class="code"><pre><span class="line"><span class="xml">for </span><span class="template-variable">&#123;initialization&#125;</span><span class="xml"> </span><span class="template-variable">&#123;conditional&#125;</span><span class="xml"> </span><span class="template-variable">&#123;increment&#125;</span><span class="xml"> </span><span class="template-variable">&#123;commands&#125;</span></span><br></pre></td></tr></table></figure>
<p>或</p>
<figure class="highlight dust"><table><tr><td class="code"><pre><span class="line"><span class="xml">foreach <span class="tag">&lt;<span class="name">variable</span> <span class="attr">name</span>&gt;</span> <span class="tag">&lt;<span class="name">list</span>&gt;</span> </span><span class="template-variable">&#123;commands&#125;</span></span><br></pre></td></tr></table></figure>
<p>比如：</p>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">for</span> &#123;set i <span class="number">0</span>&#125; &#123;$i &lt; <span class="number">10</span>&#125; &#123;incr i <span class="number">1</span>&#125; &#123;puts <span class="string">&quot;i is $i&quot;</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="attribute">set</span> m &#123;<span class="number">0</span> <span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span> <span class="number">5</span>&#125;</span><br><span class="line"><span class="attribute">foreach</span> i $m &#123;puts <span class="string">&quot;two times m is [expr $i *2]&quot;</span>&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>调用脚本，在tk窗口中：</p>
<figure class="highlight applescript"><table><tr><td class="code"><pre><span class="line">source &lt;<span class="keyword">script</span> <span class="built_in">file</span>&gt;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h1 id="axes"><a href="#axes" class="headerlink" title="axes"></a><code>axes</code></h1><p><img src="image-20211120181556786.png" alt="image-20211120181556786"></p>
<ul>
<li><p><code>locations</code>：列出位置的列表</p>
</li>
<li><p><code>location</code>：获取当前的位置</p>
</li>
<li><p><code>location &lt;Position&gt;</code>：设置轴的位置，比如：<code>off</code>、<code>origin</code> 、 <code>lowerleft</code>、 <code>lowerright</code>、<code>upperleft</code>、<code>upperright</code>：</p>
<figure class="highlight crmsh"><table><tr><td class="code"><pre><span class="line">axes <span class="keyword">location</span> <span class="title">Off</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h1 id="color"><a href="#color" class="headerlink" title="color"></a><code>color</code></h1><p><img src="image-20211120181437883.png" alt="image-20211120181437883"></p>
<ul>
<li><p><code>&lt;Category&gt; &lt;Name&gt; &lt;color&gt;</code>：更改类别和名字指定的对象：</p>
<ul>
<li><p>category包含（具体Categories、Names和Colors可在VMD界面的Graphics→Colors中查看）：</p>
<ul>
<li><code>Display</code>：背景颜色</li>
<li><code>Axes</code>：轴相关</li>
<li><code>Name</code>：原子名称</li>
<li>……</li>
</ul>
</li>
<li><p>例子：</p>
<figure class="highlight hsp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#改变背景颜色</span></span><br><span class="line"><span class="keyword">color</span> Display Background white</span><br><span class="line"></span><br><span class="line"><span class="meta">#改变某个元素颜色</span></span><br><span class="line"><span class="keyword">color</span> Name C silver</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>……</p>
</li>
</ul>
<h1 id="display"><a href="#display" class="headerlink" title="display"></a><code>display</code></h1><ul>
<li><p><code>depthcue &lt;on|off&gt;</code>: 景深效果，前面的物体比后面的更亮，默认开启，关闭用：</p>
<figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="attribute">display</span> depthcue <span class="literal">off</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><code>projection &lt;mode&gt;</code>：投影模式mode有：</p>
<ul>
<li><code>perspective</code>：透视的，默认</li>
<li><code>orthographic</code>：</li>
</ul>
<figure class="highlight arduino"><table><tr><td class="code"><pre><span class="line"><span class="built_in">display</span> projection Orthographic</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>rendermode &lt;mode&gt;</code>：渲染模式，使用各种 OpenGL 扩展来实现 alpha 混合透明度，或可编程着色以获得更高质量的分子图形。默认渲染模式不会启用这些功能。</p>
<ul>
<li><code>Normal</code>：</li>
<li><code>AlphaBlend</code>：</li>
<li><code>GLSL</code>：</li>
</ul>
<figure class="highlight arduino"><table><tr><td class="code"><pre><span class="line"><span class="built_in">display</span> rendermode GLSL</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h1 id="mol"><a href="#mol" class="headerlink" title="mol"></a><code>mol</code></h1><p>在VMD中加载、修改或删除一个分子。</p>
<ul>
<li><code>&lt;molecule_number&gt;</code>：选择是哪个分子，<ul>
<li>可以是<code>all</code>、 <code>top</code>、<code>active</code>、 <code>inactive</code>、 <code>displayed</code>、 <code>on</code>、<code>off</code>、<code>fixed</code>、<code>free</code></li>
<li>也可以是他们的<code>id</code>，是从0开始的，而且即使删除后，也不会重复使用。比如三个分子为0，1，2，删掉0，再载入一个分子，这个分子的<code>id</code>是3，但是它的<code>index</code>仍然是2。</li>
</ul>
</li>
<li><p><code>new [filename] [options]</code>和<code>addfile &lt;filename&gt; [options]</code>：</p>
<ul>
<li><code>mol new</code>是用来从文件中新建一个分子。filename是可选的，如果是空的，创建一个空白的没有原子的画布，用户可以在其上自定义几何等。</li>
<li><code>mol addfile</code>与<code>mol new</code>类似，但是结构和坐标数据加载到top的分子中而不是创建一个新的分子。</li>
<li>可选的option有：<ul>
<li><code>type &lt;type&gt;</code>：定义文件的类型（pdf，pdb等），否则根据文件扩展名来决定文件类型。</li>
<li>……</li>
</ul>
</li>
</ul>
</li>
<li><p><code>list</code>：为每个分子打印一行状态摘要。</p>
</li>
<li><code>list &lt;molecule_number&gt;</code>：打印与molecule_number匹配的每个分子的单行状态摘要。如果只有一个分子与molecule_number匹配，也打印该分子的详细表示状态。</li>
<li><code>color &lt;coloring_method&gt;</code>：更改默认的原子着色方法设置。</li>
<li><code>representation &lt;rep_style&gt;</code>：更改默认呈现方法设置。</li>
<li><code>selection select_method</code>：更改默认的原子选择设置</li>
</ul>
<h2 id="Molecule部分"><a href="#Molecule部分" class="headerlink" title="Molecule部分"></a>Molecule部分</h2><p><img src="image-20211120181853394.png" alt="image-20211120181853394"></p>
<p>分子的一些状态，对应于VMD main窗口中的一些标记（黑色为打开状态）：</p>
<ul>
<li><code>delete &lt;molecule_number&gt;</code>：删除分子。</li>
<li><code>fix/free &lt;molecule_number&gt;</code>：固定或者不固定这个分子，对应于”F“标记。</li>
<li><code>on/off &lt;molecule_number&gt;</code>：显示或者隐藏这个分子，对应于”D“标记</li>
<li><code>active/inactive &lt;molecule_number&gt;</code>：激活或者不激活这个分子，对应于”A“</li>
<li><code>top &lt;molecule_number&gt;</code>：置顶这个分子，对应于”T“</li>
<li><code>rename &lt;molecule_number&gt; XX</code>：重命名指定的分子。</li>
</ul>
<p><img src="image-20211120181329843.png" alt="image-20211120181329843"></p>
<h2 id="Representation部分"><a href="#Representation部分" class="headerlink" title="Representation部分"></a>Representation部分</h2><p><img src="image-20211120185644801.png" alt="image-20211120185644801"></p>
<ul>
<li><p><code>addrep &lt;molecule_number&gt;</code>：使用当前默认设置（比如原子选择、着色和渲染方法），为指定的分子添加新的表示。</p>
<figure class="highlight coq"><table><tr><td class="code"><pre><span class="line">mol addrep <span class="built_in">top</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><code>delrep &lt;rep_number&gt; &lt;molecule_number&gt;</code>：从指定的分子中删除给定的rep。</p>
</li>
<li><p><code>modrep &lt;rep_number&gt; &lt;molecule_number&gt;</code>：将给定分子的给定rep的方法设置为默认设置。</p>
</li>
<li><p><code>modselect &lt;rep_number&gt; &lt;molecule_number&gt; &lt;select_method&gt;</code>：更改指定分子、指定的Rep所包含的部分。select_method可以是（更多可以查看Graphics→Representations→Selections）</p>
<ul>
<li><code>all</code>、<code>none</code>……</li>
<li>逻辑<code>and</code>、<code>or</code>、<code>not</code></li>
<li><code>Name</code>、<code>Type</code>、<code>Element</code>……</li>
</ul>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">mol</span> modselect <span class="number">1</span> <span class="number">0</span> <span class="literal">all</span> not index <span class="number">72</span> <span class="number">73</span> <span class="number">74</span> </span><br><span class="line"></span><br><span class="line"><span class="attribute">mol</span> modselect <span class="number">1</span> top name U<span class="number">74</span> Ce<span class="number">75</span> C<span class="number">73</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>图形相关设置：</p>
<ul>
<li><p><code>modstyle &lt;rep_number&gt; &lt;molecule_number&gt; &lt;rep_style&gt;</code>：为指定的分子、指定的Rep指定表示方式。</p>
<ul>
<li>rep_style可以是<code>Line</code>，<code>CPK</code>等（更多可以查看Graphics→Representations→Draw style→Drawing Method），后面还可以跟相应的设置。</li>
</ul>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">mol</span> modstyle <span class="number">1</span> <span class="number">0</span> Lines <span class="number">3</span>.<span class="number">000000</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">mol</span> modstyle <span class="number">0</span> top CPK <span class="number">0</span>.<span class="number">800000</span> <span class="number">0</span>.<span class="number">300000</span> <span class="number">22</span>.<span class="number">000000</span> <span class="number">22</span>.<span class="number">000000</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">mol</span> modstyle <span class="number">1</span> top Isosurface <span class="number">0</span>.<span class="number">05</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><code>modcolor &lt;rep_number&gt; &lt;molecule_number&gt; &lt;coloring_method&gt;</code>：修改给定分子的给定rep的着色方法。</p>
<ul>
<li>coloring_method可以是<code>Name</code>、<code>Element</code>等。（更多可以查看Graphics→Representations→Draw style→Cokoring Method）</li>
</ul>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">mol modcolor <span class="number">1</span> top ColorID <span class="number">1</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><code>modmaterial &lt;rep_number&gt; &lt;molecule_number&gt; &lt;material_name&gt;</code>：修改给定分子的给定rep的材料</p>
<ul>
<li>material_name可以是<code>Glossy</code>、<code>EdgyGlass</code>等。（更多可以查看Graphics→Representations→Draw style→Material）</li>
</ul>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">mol modmaterial <span class="number">1</span> top EdgyGlass</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h1 id="molinfo"><a href="#molinfo" class="headerlink" title="molinfo"></a><code>molinfo</code></h1><p>获取有关分子(或已加载文件)的信息，包括已加载原子的数量、文件名、图形选择和查看矩阵。</p>
<ul>
<li><code>list</code>：返回所有当前分子id的列表。</li>
<li><code>num</code>：返回加载分子的数量。</li>
<li><p><code>top</code>：返回顶部分子的id</p>
</li>
<li><p><code>index n</code>：返回第 n 个分子的 id</p>
</li>
<li><p><code>&lt;molecule_id&gt; get &lt;keywords&gt;</code> ：获取关于给定分子某个信息</p>
</li>
<li><p><code>&lt;molecule_id&gt; set &lt;keywords&gt; &#123;list of values&#125;</code>：修改关于给定分子的某个信息。<a href="https://www.ks.uiuc.edu/Research/vmd/vmd-1.8.3/ug/node125.html">keyword</a>有</p>
<ul>
<li><code>center_matrix</code>：中心矩阵</li>
<li><code>rotate_matrix</code>：旋转矩阵</li>
<li><code>scale_matrix</code>：缩放矩阵</li>
</ul>
</li>
</ul>
<p>例如：</p>
<ul>
<li><p>将新加载的分子改成与之前相同的朝向</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line"><span class="builtin-name">set</span> viewpoint [molinfo top <span class="builtin-name">get</span> &#123;center_matrix rotate_matrix scale_matrix&#125;]</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [<span class="builtin-name">info</span> exists viewpoint] &#123;</span><br><span class="line">molinfo top <span class="builtin-name">set</span> &#123;center_matrix rotate_matrix scale_matrix&#125; <span class="variable">$viewpoint</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h1 id="render"><a href="#render" class="headerlink" title="render"></a><code>render</code></h1><ul>
<li><p><code>list</code>：列出可用的渲染方法</p>
</li>
<li><p><code>&lt;method&gt; filename</code>：使用method渲染为filename，method可以是：</p>
<ul>
<li>ART</li>
<li>Tachyon</li>
<li>TachyonInternal</li>
<li>snapshot</li>
<li>POV3</li>
<li>PostScript</li>
<li>Radiance</li>
<li>Raster3D</li>
<li>Rayshade</li>
<li>Renderman</li>
<li>STL</li>
<li>VRML-1</li>
<li>VRML-2</li>
</ul>
</li>
<li><p><code>&lt;method&gt; filename command</code>：渲染完成后，执行其他命令。command中的%s都会被文件名替换。比如：</p>
<figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line"><span class="selector-id">#render</span> Tachyon <span class="variable">$iorb</span><span class="selector-class">.dat</span> <span class="string">&quot;tachyon_WIN32.exe $&#123;iorb&#125;.dat -format BMP -o $&#123;iorb&#125;.bmp -trans_raster3d -res 2000 1500 -numthreads 4 -aasamples 24 -mediumshade &quot;</span></span><br><span class="line"></span><br><span class="line">render Tachyon <span class="variable">$iorb</span><span class="selector-class">.dat</span> <span class="string">&quot;tachyon_WIN32.exe $&#123;iorb&#125;.dat -format BMP -o $&#123;iorb&#125;.bmp  -aasamples 12&quot;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><code>options &lt;method&gt;</code>：获取指定method的默认命令</p>
</li>
<li><code>options &lt;method&gt; command</code>：为method设置新的默认命令</li>
<li><code>default &lt;method&gt;</code>：获取method最初的默认命令</li>
</ul>
<h2 id="Tachyon"><a href="#Tachyon" class="headerlink" title="Tachyon"></a>Tachyon</h2><p>在windows命令行中使用方法为：</p>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">tachyon_WIN32</span>.exe XXXX.dat -format BMP -o XXXX.bmp -trans_raster<span class="number">3</span>d -res <span class="number">2000</span> <span class="number">1500</span> -fullshade -numthreads <span class="number">4</span> -aasamples <span class="number">24</span> -shadow_filter_off</span><br></pre></td></tr></table></figure>
<ul>
<li>透明着色选项：<code>-trans_raster3d</code>（实测效果比其它选项更好）</li>
<li><code>-res</code>：渲染出的图像像素为2000*1500（通常来说已经足够大了）。</li>
<li><code>-fullshade</code>代表渲染时考虑阴影效果，还可以用<code>-mediumshade</code>等。</li>
<li><code>-numthreads</code>设定渲染时的线程数（建议设为CPU的实际物理核心数）。</li>
<li><code>-aasamples</code>是抗锯齿设定，数值越大抗锯齿效果越好。</li>
<li><code>-shadow_filter_off</code>：绘制出的图也有阴影效果，但透明的材质的物体，即轨道等值面，不会产生阴影。</li>
</ul>
]]></content>
      <categories>
        <category>计算化学</category>
        <category>软件</category>
      </categories>
      <tags>
        <tag>VMD</tag>
        <tag>绘图</tag>
      </tags>
  </entry>
  <entry>
    <title>【molpro】02.对称性</title>
    <url>/2020/11/16/%E3%80%90molpro%E3%80%9102.%E5%AF%B9%E7%A7%B0%E6%80%A7/</url>
    <content><![CDATA[<h1 id="对称性（点群）"><a href="#对称性（点群）" class="headerlink" title="对称性（点群）"></a>对称性（点群）</h1><ul>
<li>MOLPRO只能使用阿贝尔点群对称性，对于有简并对称性的分子，必须使用阿贝尔子群，如下：</li>
</ul>
<p><img src="1.png" style="zoom:80%;" /></p>
<ul>
<li>对于每个点群的不可约表示，编号为1至8，顺序如下表，表中还给出了x，y，和z乘积的转换特性。s表示各向同性函数，例如s轨道，另外，它还给出了这些群的x<sup>2</sup>，y<sup>2</sup>，和z<sup>2</sup>的转换特性：</li>
</ul>
<p><img src="2.png" style="zoom:80%;" /></p>
<p><img src="3.png" style="zoom:80%;" /></p>
<p><img src="4.png" style="zoom:80%;" /></p>
<ul>
<li>轨道和基函数的引用格式一般是<code>序号.不可约表示编号</code>，比如C<sub>2v</sub>的3.2表示C<sub>2v</sub>的第二个不可约表示B<sub>2</sub>的第三个轨道。</li>
</ul>
<h1 id="指定对称性"><a href="#指定对称性" class="headerlink" title="指定对称性"></a>指定对称性</h1><p>在<code>geometry</code>块之前，通过表4.1中的生成元表示，例如：</p>
<figure class="highlight gml"><table><tr><td class="code"><pre><span class="line">symmetry,<span class="symbol">x</span>,<span class="symbol">y</span></span><br><span class="line">geometry=&#123;o&#125;</span><br></pre></td></tr></table></figure>
<h1 id="波函"><a href="#波函" class="headerlink" title="波函"></a>波函</h1><h2 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h2><ul>
<li><p>波函数的总对称性通过<code>wf</code>卡定义：</p>
<figure class="highlight autohotkey"><table><tr><td class="code"><pre><span class="line"><span class="built_in">WF,</span>nelec,irrep,spin</span><br></pre></td></tr></table></figure>
<p>或</p>
<figure class="highlight inform7"><table><tr><td class="code"><pre><span class="line">WF,<span class="comment">[NELEC=nelec]</span>,<span class="comment">[SYM<span class="comment">[METRY]</span>=irrep]</span>,<span class="comment">[spin= spin]</span>,<span class="comment">[CHARGE=charge]</span></span><br></pre></td></tr></table></figure>
<ul>
<li><code>nelec</code>是电子总数，也可以通过<code>charge</code>指定。默认是核电荷的总和。</li>
<li><code>irrep</code>是波函数的对称性，用不可约表示的序号表示。默认是1全对称的（第一个不可约表示}<ul>
<li>对于一个双重态来说，它等于一个已占据的分子轨道的对称性。</li>
<li>如果是三重态，则是两个单占据轨道对称性的直积。（比如O<sub>2</sub>的最高单占据轨道分别为π<sub>g,x</sub>和π<sub>g,y</sub>，分别对应于B<sub>2g</sub>和B<sub>3g</sub>，直积为B<sub>1g</sub>，对称性为4。）</li>
</ul>
</li>
<li><code>spin</code>是单电子数。默认对偶数个电子是0（单重态），否则是2（双重态）。</li>
</ul>
</li>
<li><p>也可以通过变量来定义（系统变量需要用SET）：</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">SET,<span class="attribute">CHARGE</span>=charge</span><br><span class="line">SET,<span class="attribute">NELEC</span>=nelec</span><br><span class="line">SET,<span class="attribute">SPIN</span>=spin</span><br><span class="line">SER,<span class="attribute">SYMMETRY</span>=irrep</span><br></pre></td></tr></table></figure>
<ul>
<li>还可以使用<code>SCFSPIN</code>和<code>SCFSYM[METRY]</code>、<code>MCSPIN</code>和<code>MCSYM[METRY]</code>、<code>CISPIN</code>和<code>CISYM[METRY]</code>来定义仅用于HF、MCSCF、MRCI的自旋和对称性。</li>
</ul>
</li>
</ul>
<p>因为有默认值，在很多情况下，不需要指定WF卡。如果需要指定，一般是在SCF计算中指定WF信息，后面的MCSCF或CI计算可以不指定WF；这也适用于续算。如果在命令输入区外给出WF指令，那么它作为全局指令处理。根据顺序执行。</p>
<h2 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h2><ul>
<li><p>HCO<sup>+</sup>，<sup>2</sup>B<sub>2</sub>（一个电子从最高占据b<sub>2</sub>轨道失去）</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">wf,<span class="number">15</span>,<span class="number">3</span>,<span class="number">1</span></span><br></pre></td></tr></table></figure>
<p>或</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">wf,charge=<span class="number">1</span>,symmetry=<span class="number">3</span>,spin=<span class="number">1</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h1 id="轨道子空间"><a href="#轨道子空间" class="headerlink" title="轨道子空间"></a>轨道子空间</h1><h2 id="定义-1"><a href="#定义-1" class="headerlink" title="定义"></a>定义</h2><ul>
<li><p>由<code>OCC</code>，<code>CORE</code>，<code>CLOSED</code>，<code>FROZEN</code>卡提供：</p>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">OCC</span>,m<span class="number">1</span>,m<span class="number">2</span>,...m<span class="number">8</span>;</span><br><span class="line"><span class="attribute">CORE</span>,co<span class="number">1</span>,co<span class="number">2</span>,...co<span class="number">8</span>;</span><br><span class="line"><span class="attribute">CLOSED</span>,cl<span class="number">1</span>,cl<span class="number">2</span>,...cl<span class="number">8</span>;</span><br><span class="line"><span class="attribute">FROZEN</span>,fr<span class="number">1</span>,fr<span class="number">2</span>,...fr<span class="number">8</span>;</span><br></pre></td></tr></table></figure>
</li>
<li><p>轨道空间也可以在命令区外定义，作为全局指令处理，即用于随后所有的程序。对某些波函类型特定的空间，可以使用以下两种方式定义：</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">OCC,<span class="number">4</span>,<span class="number">2</span>,<span class="number">1</span>,CONTEXT=MULTI</span><br></pre></td></tr></table></figure>
<p>或</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">OCC_MULTI,<span class="number">4</span>,<span class="number">2</span>,<span class="number">1</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><code>OCC</code>，<code>CORE</code>，和<code>CLOSED</code>命令一般在每个有关的程序模块中都是必须的；但是程序会记住最近一次使用的值，因此如果不改变前面的轨道空间值的话，这些命令可以忽略。这一信息也保存在续算中。</p>
<h2 id="含义"><a href="#含义" class="headerlink" title="含义"></a>含义</h2><ul>
<li><code>OCC</code>：<code>mi</code>是不可约表示i的占据轨道数（包括<code>CORE</code>/<code>FROZEN</code>轨道和<code>CLOSED</code>轨道）</li>
<li><code>CORE</code>：芯轨道数</li>
<li><code>CLOSED</code>：<code>cli</code>闭壳层轨道数（包括芯轨道）</li>
<li><code>FROZEN</code>只能用于MCSCF程序，表示不做优化的冻芯轨道</li>
</ul>
<p>通常<code>OCC</code>≥<code>CLOSED</code>≥<code>CORE</code>，不同的计算中，<code>OCC</code>，<code>CORE</code>，<code>CLOSED</code>，<code>FROZEN的</code>含义略有不同，默认的值也会有所不同：</p>
<ul>
<li>SCF中：<ul>
<li><code>OCC</code>是任何出现在CSF中的轨道</li>
</ul>
</li>
<li>MCSCF中：<ul>
<li><code>OCC</code>是任何出现在CSF中的轨道</li>
<li><code>FROZEN</code>轨道在所有CSF中都是双占据，并且冻结的（也就是不做优化）</li>
<li><code>CLOSED</code>表示所有的双占据轨道（<code>FROZEN</code>中冻结的加上做优化的）</li>
</ul>
</li>
<li>电子关联方法（CI，MPn，CCSD等）中：<ul>
<li><code>OCC</code>表示在所有参考CSF中占据的轨道</li>
</ul>
</li>
<li>在CI和CCSD程序中：<ul>
<li><code>CORE</code>是不做关联能处理的轨道</li>
<li><code>CLOSED</code>在所有的参考CSF中保持双占据的轨道。</li>
</ul>
</li>
</ul>
]]></content>
      <categories>
        <category>计算化学</category>
        <category>软件</category>
      </categories>
      <tags>
        <tag>对称性</tag>
        <tag>molpro</tag>
        <tag>点群</tag>
        <tag>波函</tag>
        <tag>占据</tag>
      </tags>
  </entry>
  <entry>
    <title>【molpro】03.HF计算</title>
    <url>/2019/11/16/%E3%80%90molpro%E3%80%9103.HF%E8%AE%A1%E7%AE%97/</url>
    <content><![CDATA[<h1 id="调用方法"><a href="#调用方法" class="headerlink" title="调用方法"></a>调用方法</h1><ul>
<li><code>HF</code>或<code>RHF</code>，自旋限制Hartree-Fock程序，开壳层和比可曾都可以，或者用<code>HF-SCF</code>、<code>RHF-SCF</code>也可以。</li>
<li><code>UHF</code>或<code>UHF-SCF</code>，自旋非限制Hartree-Fock程序</li>
</ul>
<h1 id="选项"><a href="#选项" class="headerlink" title="选项"></a>选项</h1><h2 id="定义波函数"><a href="#定义波函数" class="headerlink" title="定义波函数"></a>定义波函数</h2><figure class="highlight autohotkey"><table><tr><td class="code"><pre><span class="line"><span class="built_in">WF,</span>elec,sym,spin</span><br></pre></td></tr></table></figure>
<ul>
<li><code>OCC</code>定义每个对称性的占据轨道数，轨道的总数必须等于(总电子数+spin)/2</li>
<li><code>CLOSED</code>定义闭壳层轨道，可用于开壳层计算，指定每个对称性中闭壳层轨道的数量。</li>
<li><code>OPEN</code>指定开壳层轨道，即指定单占据轨道，单占据轨道的数量必须等于spin，其对称性乘<br>积必须等于sym，如果<code>orbi.sym</code>为负，这个轨道将用负自旋占据（仅允许在UHF中）。<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">OPEN</span>,<span class="selector-tag">orb1</span><span class="selector-class">.sym1</span>,<span class="selector-tag">orb</span><span class="selector-class">.sym2</span>,..<span class="selector-class">.orbn</span><span class="selector-class">.symn</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h3><p>O<sub>2</sub></p>
<ul>
<li>轨道占据为<script type="math/tex">1\sigma_g^21\sigma_u^22\sigma_g^22\sigma_u^23\sigma_g^21\pi_{u,x}^21\pi_{u,y}^21\pi_{g,x}^11\pi_{g,y}^1</script></li>
<li><script type="math/tex">\sigma_g</script>，<script type="math/tex">\pi_{u,x}</script>，<script type="math/tex">\pi_{u,y}</script>，<script type="math/tex">\sigma_u</script>，<script type="math/tex">\pi_{g,x}</script>，<script type="math/tex">\pi_{g,y}</script>的对称性分别对应于<script type="math/tex">D_{2h}</script>的1，2，3，5，6，7，则<code>OCC</code>中为<code>3,1,1,,2,1,1</code></li>
<li><script type="math/tex">\pi_{g,x}</script>，<script type="math/tex">\pi_{g,y}</script>相乘为4（<script type="math/tex">B_{2g}\times B_{3g}=B_{1g}</script>），<code>wf</code>的对称性是4</li>
<li><script type="math/tex">\pi_{u,x}</script>，<script type="math/tex">\pi_{u,y}</script>相乘也为4，所以需要用<code>OPEN</code>进一步明确开壳层的轨道</li>
<li>输入文件为：<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">&#123;hf</span><br><span class="line">wf,<span class="number">16</span>,<span class="number">4</span>,<span class="number">2</span></span><br><span class="line">occ,<span class="number">3</span>,<span class="number">1</span>,<span class="number">1</span>,,<span class="number">2</span>,<span class="number">1</span>,<span class="number">1</span></span><br><span class="line">open,<span class="number">1.6</span>,<span class="number">1.7</span>&#125; </span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="初始轨道"><a href="#初始轨道" class="headerlink" title="初始轨道"></a>初始轨道</h2><p>程序既可以产生初始轨道猜测，也可以从以前优化的轨道开始。还可以使用以前的密度矩阵构造第一个Fock算符。如果不指定START卡，程序会按照以下方式试着寻找合适的初始轨道：</p>
<ol>
<li>试着从<code>ORBITAL</code>或<code>SAVE</code>卡指定的record或它们相应的默认值（参见ORBITAL）中读取轨道。所有的文件都被搜索。</li>
<li>试着从以前的SCF或MCSCF计算寻找轨道。所有的文件都被搜索。</li>
<li>如果没有发现轨道，则初始轨道用近似原子密度或ℎ的本征矢产生（见下）。</li>
</ol>
<p>由于这些默认值通常都是合适的，因此在大多数情况下不需要<code>START</code>卡。</p>
<p>定义方法：</p>
<figure class="highlight pgsql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">START</span>,[<span class="keyword">TYPE</span>=]<span class="keyword">option</span></span><br></pre></td></tr></table></figure>
<ul>
<li>option关键词可以是：<ul>
<li><code>H0</code>：用ℎ的本征矢作为初始猜测。</li>
<li><code>ATDEN</code>：使用从原子占据数构造的对角密度矩阵的自然轨道。</li>
</ul>
</li>
</ul>
<h1 id="其他指令"><a href="#其他指令" class="headerlink" title="其他指令"></a>其他指令</h1><h2 id="能级移动"><a href="#能级移动" class="headerlink" title="能级移动"></a>能级移动</h2><ul>
<li>对α和β电子分别使用<code>shifta</code>和<code>shiftb</code>的能级移动，可以改善收敛，对求解没有影响。<ul>
<li>闭壳层的默认值是shifta=<code>0</code></li>
<li>开壳层的默认值是<code>-0.3 0</code></li>
</ul>
</li>
</ul>
<figure class="highlight autohotkey"><table><tr><td class="code"><pre><span class="line"><span class="built_in">SHIFT,</span>shifta,shiftb</span><br></pre></td></tr></table></figure>
<h2 id="迭代的最大数量"><a href="#迭代的最大数量" class="headerlink" title="迭代的最大数量"></a>迭代的最大数量</h2><ul>
<li>设置迭代的最大数量为maxit。默认为maxit= 60。</li>
</ul>
<figure class="highlight autohotkey"><table><tr><td class="code"><pre><span class="line"><span class="built_in">MAXIT,</span>maxit</span><br></pre></td></tr></table></figure>
<h2 id="收敛阈值"><a href="#收敛阈值" class="headerlink" title="收敛阈值"></a>收敛阈值</h2><ul>
<li>收敛阈值设置为<script type="math/tex">10^{-accu}</script>。这用于密度矩阵元变化量的平方和。</li>
<li>默认值取决于全局能量阈值，并且阈值会在几何优化或频率计算中自动更小，除非给出了一个阈值。</li>
</ul>
<figure class="highlight autohotkey"><table><tr><td class="code"><pre><span class="line"><span class="built_in">ACCU,</span>accu</span><br></pre></td></tr></table></figure>
<h2 id="能量的合理性检查"><a href="#能量的合理性检查" class="headerlink" title="能量的合理性检查"></a>能量的合理性检查</h2><ul>
<li>禁止能量的合理性检查，即使是能量值不合理时。否则，默认自动检查能<br>量。</li>
</ul>
<figure class="highlight ebnf"><table><tr><td class="code"><pre><span class="line"><span class="attribute">NOENEST</span></span><br></pre></td></tr></table></figure>
<h2 id="打印"><a href="#打印" class="headerlink" title="打印"></a>打印</h2><ul>
<li>打印虚轨道的数量，默认为print= 0。</li>
<li>print= −1完全禁止打印轨道。test=1在每次迭代后打印轨道。</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ORBPRINT,<span class="built_in">print</span>,<span class="built_in">test</span></span><br></pre></td></tr></table></figure>
<h1 id="SCF不收敛"><a href="#SCF不收敛" class="headerlink" title="SCF不收敛"></a>SCF不收敛</h1><ul>
<li><p>看一下波函数的对称性</p>
</li>
<li><p>通过能级移动，导致更平滑但更慢的收敛</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">&#123;rhf; shift,<span class="number">-1.0</span>,<span class="number">-0.5</span>&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>冻结占据，在迭代第N次的时候，冻结轨道占据。<code>rhf，nitord = 1&#125;</code>会冻结最初的占据。</p>
<figure class="highlight clojure"><table><tr><td class="code"><pre><span class="line">&#123;rhf，nitord = N&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>极小基SCF猜：</p>
</li>
<li><p>增加DIIS：</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">&#123;rhf,maxdis=<span class="number">30</span>,iptyp=DIIS,nitord=<span class="number">20</span>; shift,<span class="number">-1.0</span>,<span class="number">-0.5</span>&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">&#123;rhf,maxdis=<span class="number">10</span>,iptyp=KAIN,nitord=<span class="number">10</span>; shift,<span class="number">-1.0</span>,<span class="number">-0.5</span>&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
]]></content>
      <categories>
        <category>计算化学</category>
        <category>软件</category>
      </categories>
      <tags>
        <tag>molpro</tag>
        <tag>HF</tag>
      </tags>
  </entry>
  <entry>
    <title>【molpro】04.多组态计算</title>
    <url>/2019/11/17/%E3%80%90molpro%E3%80%9104.%E5%A4%9A%E7%BB%84%E6%80%81%E8%AE%A1%E7%AE%97/</url>
    <content><![CDATA[<h1 id="一般输入结构"><a href="#一般输入结构" class="headerlink" title="一般输入结构"></a>一般输入结构</h1><ol>
<li>用命令<code>MULTI</code>或<code>MCSCF</code>调用程序。</li>
<li>定义轨道空间分区的卡：<code>OCC</code>，<code>FROZEN</code>，<code>CLOSED</code></li>
<li>一般选项</li>
<li><code>WF</code>卡，定义态的对称性</li>
<li>与态对称性有关的选项：<code>WEIGHT</code>,<code>STATE</code>,<code>LQUANT</code></li>
<li>态对称性的组态定义：<code>SELECT</code>,<code>CON</code>,<code>RESTRICT</code></li>
<li>定义态对称性的主要组态：<code>PSPACE</code></li>
<li>更多的一般选项。</li>
</ol>
<p>4~8可以重复几次，指定对于不同对称性的几个态的能量做平均。</p>
<h2 id="MULTI-CASSCF调用程序"><a href="#MULTI-CASSCF调用程序" class="headerlink" title="MULTI/CASSCF调用程序"></a><code>MULTI</code>/<code>CASSCF</code>调用程序</h2><p>全活性空间自洽场<code>CASSCF</code>，此命令的别名是<code>mcscf</code>或<code>multi</code>。这个命令后面可选地跟着定义波函数的进一步输入。</p>
<figure class="highlight ebnf"><table><tr><td class="code"><pre><span class="line"><span class="attribute">casscf</span></span><br></pre></td></tr></table></figure>
<p>该命令行后面可以接：</p>
<ul>
<li><code>MAXIT</code>：最大迭代数（默认10）</li>
<li><code>ENERGY</code>：能量收敛阈值</li>
<li><code>GRADIENT</code>：梯度收敛阈值</li>
<li><code>STEP</code>：步长收敛阈值</li>
<li><code>FAILSAFE</code>：（逻辑型）使用更稳定的收敛选项</li>
</ul>
<h2 id="OCC，FROZEN，CLOSED轨道子空间的定义"><a href="#OCC，FROZEN，CLOSED轨道子空间的定义" class="headerlink" title="OCC，FROZEN，CLOSED轨道子空间的定义"></a><code>OCC</code>，<code>FROZEN</code>，<code>CLOSED</code>轨道子空间的定义</h2><p>在一个CASSCF波函数中，已占据轨道空间被划分为一组非活性或闭壳层轨道和一组活性轨道：</p>
<ul>
<li>所有的非活性轨道在每个Slater行列式中都被双占据。</li>
<li>活性轨道有不同的占据，所有可能的Slater行列式(或conﬁguration state functions，CSFs)都被考虑在内，通过把N<sub>act</sub>（=N<sub>el</sub>-2m<sub>closed</sub>）个电子以各种可能的方式分布在活性轨道中。（在m<sub>closed</sub>是封闭外壳的数量(不活跃)轨道，N<sub>el</sub>是电子的总数）因此，它对应于活性空间中的一个完整CI。</li>
</ul>
<p>具体定义方法</p>
<ul>
<li><code>occ,m1,m2……m8;</code>定义每个对称性中的占据轨道：<ul>
<li>如果没有给定，默认来自最近的MCSCF计算。如果没有，则使用最小的价轨道集的轨道，即使用全部价轨道空间。</li>
</ul>
</li>
<li><p><code>FROZEN,n1,n2,...,record.file;</code>定义每个对称性中的冻芯轨道，这些轨道在全部组态中都是双占据的，并且不会被优化。</p>
<ul>
<li><code>record.file</code>是冻芯轨道的记录名称；如果没有提供，来自<code>START</code>卡的<code>orb</code>。<code>record.file</code>可以在最后一个非零<code>ni</code>之后的任何位置指定。如果轨道初始猜测来自邻近的几何结构，它必须给出，接下来要定义在当前结构计算的SCF轨道。如果使用当前波函进行随后的梯度计算，那么record.file 是强制的，而且必须指定当前结构的闭壳层SCF轨道。注意，<code>record</code>必须大于2000。</li>
<li>如果没有给定，默认来自最近的MCSCF计算。如果没有则不做轨道冻结。</li>
<li>如果给定为<code>FROZEN,record.file</code>使用对应原子内壳层的轨道冻结，即Li-Ne是1s，Na-Ar是1s2s2p等</li>
<li>没有任何说明的<code>FROZEN</code>卡把冻芯轨道数重新设置为0。</li>
</ul>
</li>
<li><p><code>closed,n1,n2,……n8;</code>定义每个对称性中非活性的轨道，包含所有的<code>FROZEN</code>轨道，它们在所有的CSF中都是双占据的；但是与<code>FROZEN</code>轨道相反，这些轨道是完全优化的。</p>
<ul>
<li>如果忽略<code>CLOSED</code>卡，那么默认数据来自最近的MCSCF计算，如果没有则使用原子内壳层。</li>
<li>m<sub>i</sub>≥n<sub>i</sub>，每一个不可约表示中的<strong>活性轨道数目为m<sub>i</sub>-n<sub>i</sub></strong></li>
</ul>
</li>
<li><code>FREEZE,orb.sym;</code>指定的轨道将不被优化，仍保持和初始猜测相同<ul>
<li><code>orb.sym</code> 应当是一个活性或闭壳层轨道，如果是<code>FROZEN</code>冻芯轨道，这个卡不起作用。</li>
</ul>
</li>
</ul>
<h3 id="选择轨道的方法"><a href="#选择轨道的方法" class="headerlink" title="选择轨道的方法"></a>选择轨道的方法</h3><p>一般有两种选法：</p>
<ul>
<li>看原子的价层轨道</li>
<li>看分子的成键和反键轨道</li>
</ul>
<p>可以先算个hf来看看<code>molden</code>文件中的轨道，注意输出的轨道<code>print,orbital</code>只输出占据轨道，通过<code>print,orbital=n</code>来控制输出的最低的空轨道数目。</p>
<h2 id="WF定义被优化的态"><a href="#WF定义被优化的态" class="headerlink" title="WF定义被优化的态"></a><code>WF</code>定义被优化的态</h2><p>每个需要优化的态的对称性用一个WF卡定义：</p>
<figure class="highlight autohotkey"><table><tr><td class="code"><pre><span class="line"><span class="built_in">WF,</span>elec,sym,spin</span><br></pre></td></tr></table></figure>
<ul>
<li>之后可以选择接<code>STATE</code>，<code>WEIGHT</code>，<code>RESTRICT</code>，<code>SELECT</code>，<code>CON</code>，和/或<code>PSPACE</code>卡来定义这个WF卡 ，这些卡总是指前一个WF卡定义的态对称性，但是各个卡之间的顺序是任意的。</li>
</ul>
<h2 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h2><p>如果全部选择默认，那么甲醛的CASSCF计算最简单的输入是：</p>
<figure class="highlight properties"><table><tr><td class="code"><pre><span class="line"><span class="attr">***,formaldehyde</span></span><br><span class="line"><span class="meta">print,orbitals,civector</span>   <span class="string">! 打印轨道和CI矢量</span></span><br><span class="line">                          </span><br><span class="line"><span class="attr">angstrom</span></span><br><span class="line"><span class="attr">geometry</span>=<span class="string">&#123;   </span></span><br><span class="line"><span class="attr">C</span></span><br><span class="line"><span class="attr">O</span>  <span class="string">, C , rco</span></span><br><span class="line"><span class="attr">H1</span> <span class="string">, C , rch , O , hco</span></span><br><span class="line"><span class="attr">H2</span> <span class="string">, C , rch , O , hco , H1 , 180</span></span><br><span class="line"><span class="attr">&#125;</span></span><br><span class="line"><span class="attr">rco</span>=<span class="string">1.182 Ang</span></span><br><span class="line"><span class="attr">rch</span>=<span class="string">1.102 Ang</span></span><br><span class="line"><span class="attr">hco</span>=<span class="string">122.1789 Degree</span></span><br><span class="line"></span><br><span class="line"><span class="attr">basis</span>=<span class="string">vdz</span></span><br><span class="line"><span class="attr">hf</span>                     <span class="string">!执行HF计算</span></span><br><span class="line"><span class="attr">casscf</span>                 <span class="string">!实行CASSCF计算，用HF轨道作为初猜</span></span><br></pre></td></tr></table></figure>
<ul>
<li><p>默认下碳和氧的1s轨道是非活性的，而碳和氧的2s、2p和氢的1s轨道是活性的，因此和以下定义相同：</p>
<figure class="highlight maxima"><table><tr><td class="code"><pre><span class="line">&#123;casscf</span><br><span class="line">closed,<span class="number">2</span>               !<span class="number">2</span> inactive orbitals <span class="keyword">in</span> Symmetry <span class="number">1</span> (a1)</span><br><span class="line">occ,<span class="number">7</span>,<span class="number">2</span>,<span class="number">3</span>              !7a1, <span class="number">2b1</span>, <span class="number">3b2</span> occupied orbitals</span><br><span class="line">wf,<span class="number">16</span>,<span class="number">1</span>,<span class="number">0</span>&#125;             !<span class="number">16</span> electrons, Symmetry <span class="number">1</span> (A1), singlet</span><br></pre></td></tr></table></figure>
<ul>
<li>有5个a<sub>1</sub>，2个b<sub>1</sub>，3个b<sub>2</sub>活性轨道。这产生了3644个CSFs或11148个Slater行列式。注意，wf指令必须在<code>occ</code>和<code>closed</code>指令之后给出。</li>
</ul>
</li>
<li><p>如果使氧的2s轨道变成非活性，其膨胀时间就会缩短，只生成了1408个CSFs或4036个Slater行列式。</p>
<figure class="highlight maxima"><table><tr><td class="code"><pre><span class="line">&#123;casscf</span><br><span class="line">closed,<span class="number">3</span>               !<span class="number">3</span> inactive orbitals <span class="keyword">in</span> Symmetry <span class="number">1</span> (a1)</span><br><span class="line">occ,<span class="number">7</span>,<span class="number">2</span>,<span class="number">3</span>              !7a1, <span class="number">2b1</span>, <span class="number">3b2</span> occupied orbitals</span><br><span class="line">wf,<span class="number">16</span>,<span class="number">1</span>,<span class="number">0</span>&#125;             !<span class="number">16</span> electrons, Symmetry <span class="number">1</span> (A1), singlet</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h1 id="态平均MCSCF"><a href="#态平均MCSCF" class="headerlink" title="态平均MCSCF"></a>态平均MCSCF</h1><p>为了计算激发态，通常最好对所考虑的所有状态的平均能量进行优化。这避免了优化过程中的根本问题，并为所有状态生成一组折衷轨道。</p>
<ul>
<li><p>通过<code>STATE,nstate;</code>定义当前对称性中态的数量，默认所有的态都用权重1来优化，它必须直接跟随在wf指令之后</p>
<figure class="highlight lsl"><table><tr><td class="code"><pre><span class="line">wf,<span class="number">16</span>,<span class="number">1</span>,<span class="number">0</span>;<span class="section">state</span>,<span class="number">2</span> !optimize two states of symmetry <span class="number">1</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>可以优化不同对称性的状态。在这种情况下，几个wf /state指令可以相互遵循：</p>
<figure class="highlight lsl"><table><tr><td class="code"><pre><span class="line">wf,<span class="number">16</span>,<span class="number">1</span>,<span class="number">0</span>;<span class="section">state</span>,<span class="number">2</span> !optimize two states of symmetry <span class="number">1</span> </span><br><span class="line">wf,<span class="number">16</span>,<span class="number">2</span>,<span class="number">0</span>;<span class="section">state</span>,<span class="number">1</span> !optimize one states of symmetry <span class="number">2</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><code>WEIGHT,w(1),w(2),...,w(nstate);</code>定义态平均计算中的权重，<code>w(i)</code>是当前对称性第i个态的权重。所有的权重默认都是1.0。</p>
<ul>
<li><font color=red>**如果只想优化特定态对称性的第二个态，可以指定:**</font>

<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">STATE,<span class="number">2</span>;WEIGHT,<span class="number">0</span>,<span class="number">1</span>;</span><br></pre></td></tr></table></figure>
<p>但是注意，这可能会导致根的跳跃问题。</p>
</li>
<li><p>优化对称性1的两个态，第一个权重0.2，第二个0.8</p>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">wf</span>,<span class="number">16</span>,<span class="number">1</span>,<span class="number">0</span>;state,<span class="number">2</span>;weight,<span class="number">0</span>.<span class="number">2</span>,<span class="number">0</span>.<span class="number">8</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>例子：对O<sub>2</sub>的状态平均计算，其中将$^1\Sigma^+_g$，$^3\Sigma_g^-$，$^1\Delta_g$放在一起处理：（在本例中，对具有不同自旋多重性的状态进行平均只对CASSCF可行，而对限制更严格的RASSCF或MCSCF波函数则不可行。）</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="string">***,O2</span></span><br><span class="line"><span class="string">print,basis,orbitals</span></span><br><span class="line"><span class="string">geometry=&#123;</span>                 </span><br><span class="line"><span class="string">o1</span></span><br><span class="line"><span class="string">o2,o1,r</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">r=2.2</span> <span class="string">bohr</span>                 </span><br><span class="line"><span class="string">basis=vtz</span></span><br><span class="line">&#123;<span class="string">hf</span></span><br><span class="line"><span class="string">wf</span>,<span class="number">16</span>,<span class="number">4</span>,<span class="number">2</span></span><br><span class="line"><span class="string">occ</span>,<span class="number">3</span>,<span class="number">1</span>,<span class="number">1</span>,,<span class="number">2</span>,<span class="number">1</span>,<span class="number">1</span></span><br><span class="line"><span class="string">open</span>,<span class="number">1.6</span>,<span class="number">1.7</span>&#125;</span><br><span class="line"></span><br><span class="line">&#123;<span class="string">casscf</span>                    <span class="type">!invoke</span> <span class="string">CASSCF</span> <span class="string">program</span></span><br><span class="line"><span class="string">wf</span>,<span class="number">16</span>,<span class="number">4</span>,<span class="number">2</span>                  <span class="type">!triplet</span> <span class="string">Sigma-</span></span><br><span class="line"><span class="string">wf</span>,<span class="number">16</span>,<span class="number">4</span>,<span class="number">0</span>                  <span class="type">!singlet</span> <span class="string">delta</span> <span class="string">(xy)</span></span><br><span class="line"><span class="string">wf</span>,<span class="number">16</span>,<span class="number">1</span>,<span class="number">0</span>&#125;                 <span class="type">!singlet</span> <span class="string">delta</span> <span class="string">(xx</span> <span class="bullet">-</span> <span class="string">yy)</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h1 id="restrict占据限制"><a href="#restrict占据限制" class="headerlink" title="restrict占据限制"></a><code>restrict</code>占据限制</h1><p>由于CSFs或Slater行列式的数量以及计算成本会随着活动轨道的数量而迅速增加，所以最好使用更小的CSFs集合。选择的一种方法是限制某些子空间中的电子数，得到受限活性空间自洽场RASSCF。例如，可以只允许某些活跃轨道的强占据部分的单激发态和双激发态，或者将另一个活跃轨道的电子数限制在最多2个。通常，可以使用<code>restrict</code>指令来定义这些限制：</p>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">restrict</span>,nmin,nmax,orb<span class="number">1</span>，orb<span class="number">2</span>，....，orbn;</span><br></pre></td></tr></table></figure>
<ul>
<li><p>只有在指定轨道orb1，orb2，….，orbn中包含电子数在<code>nmin</code>和<code>nmax</code> 之间的组态，才能包含在波函中。。轨道按照<code>number.sym</code>的形式定义。</p>
</li>
<li><p>如果<code>nmin</code>和<code>nmax</code>为负，那么指定轨道中有<code>abs(nmin)</code>和<code>abs(nmax)</code>个电子的组态将被删除。比如用来忽略单激发组态。</p>
</li>
<li><p>可以连续用几个<code>RESTRICT</code>卡</p>
</li>
<li><p>在第一个<code>WF</code>卡之前给出的<code>RESTRICT</code>卡是全局的，用于所有的态对称性。</p>
</li>
<li><p>例：甲醛，假设只有单激发和双激发可以进入波函数中未占据的轨道6.1、7.1、2.2、3.3。</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">&#123;casscf</span><br><span class="line">closed,<span class="number">2</span>                        !<span class="number">2</span>个对称性为<span class="number">1</span>（A1）的活性轨道</span><br><span class="line">occ,<span class="number">7</span>,<span class="number">2</span>,<span class="number">3</span>                       !<span class="number">7</span>个a1, <span class="number">2</span>个b1, <span class="number">3</span>个b2占据轨道</span><br><span class="line">wf,<span class="number">16</span>,<span class="number">1</span>,<span class="number">0</span>                       !<span class="number">16</span>个电子，对称性<span class="number">1</span>，单线态</span><br><span class="line">restrict,<span class="number">0</span>,<span class="number">2</span>,<span class="number">6.1</span>,<span class="number">7.1</span>,<span class="number">2.2</span>,<span class="number">3.3</span>&#125;   !在给定的轨道列表中最多<span class="number">2</span>个电子</span><br></pre></td></tr></table></figure>
<p>可以进一步只允许3.1和4.1轨道的两次激发态，但这种情况下，这没有影响，因为没有其他激发态是可能的。为了证明这种情况，将对称性1的已占据轨道数增加到8，并取消了6.1轨道的限制：</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">&#123;casscf</span><br><span class="line">closed,<span class="number">2</span>                        </span><br><span class="line">occ,<span class="number">8</span>,<span class="number">2</span>,<span class="number">3</span>                       </span><br><span class="line">wf,<span class="number">16</span>,<span class="number">1</span>,<span class="number">0</span>                       </span><br><span class="line">restrict,<span class="number">0</span>,<span class="number">2</span>,<span class="number">7.1</span>,<span class="number">8.1</span>,<span class="number">2.2</span>,<span class="number">3.3</span>   </span><br><span class="line">restrict,<span class="number">2</span>,<span class="number">4</span>,<span class="number">3.1</span>,<span class="number">4.1</span>&#125;          !<span class="number">2</span>~<span class="number">4</span>个电子在给定的轨道中</span><br></pre></td></tr></table></figure>
<p>结果表明，这种计算不收敛。原因是有些轨道旋转在单激发态下几乎是多余的，即强占位空间和弱占位空间之间的轨道变换效应可以用单激发态和双激发态来表示。这使得优化问题非常病态。这个问题可以通过以下方法来消除来自/进入受限轨道空间的单个激发来解决，结果可以收敛。</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">&#123;casscf</span><br><span class="line">closed,<span class="number">2</span>                        </span><br><span class="line">occ,<span class="number">8</span>,<span class="number">2</span>,<span class="number">3</span>                       </span><br><span class="line">wf,<span class="number">16</span>,<span class="number">1</span>,<span class="number">0</span>           </span><br><span class="line">restrict,<span class="number">0</span>,<span class="number">2</span>, <span class="number">7.1</span>,<span class="number">8.1</span>,<span class="number">2.2</span>,<span class="number">3.3</span>  </span><br><span class="line">restrict,<span class="number">-1</span>,<span class="number">0</span> <span class="number">7.1</span>,<span class="number">8.1</span>,<span class="number">2.2</span>,<span class="number">3.3</span>   !不允许单个电子在给定的轨道空间</span><br><span class="line">restrict,<span class="number">2</span>,<span class="number">4</span>, <span class="number">3.1</span>,<span class="number">4.1</span>           </span><br><span class="line">restrict,<span class="number">-3</span>,<span class="number">0</span>,<span class="number">3.1</span>,<span class="number">4.1</span>&#125;          !<span class="number">3</span>个电子不允许在给定的轨道空间</span><br></pre></td></tr></table></figure>
</li>
<li><p>收敛的MCSCF计算有时是棘手和困难的。一般来说，CASSCF计算比受限计算更容易收敛，但即使在CASSCF计算中也可能出现问题。缓慢或没有收敛的原因可能有以下一种或多种。</p>
<ul>
<li>轨道和CI系数之间的近冗余变化。<ul>
<li>消除单个激发态</li>
</ul>
</li>
<li>两个或两个以上的弱占据轨道对能量的影响几乎相同，但活动空间只允许包含一个激发态<ul>
<li>增加或减少活动空间(occ卡)。</li>
</ul>
</li>
<li>一个活性轨道的占位数非常接近2。程序可能很难决定哪个轨道是不活跃的。<ul>
<li>增加不活跃的空间</li>
</ul>
</li>
<li>一个活性轨道的相关比一个非活性轨道的相关得到的能量降低要小。程序试图交换活动轨道和非活动轨道。<ul>
<li>减少(或可能增加)活动空间。</li>
</ul>
</li>
<li>同样对称的另一种状态在能量上非常接近(近似简并)。程序可能在状态之间振荡(根翻转)。<ul>
<li>将所有接近简并的状态纳入计算，优化它们的平均能量。</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="指定轨道组态"><a href="#指定轨道组态" class="headerlink" title="指定轨道组态"></a>指定轨道组态</h2><p>还可以使用任意选择的组态空间执行MCSCF。唯一的限制是包含同一个占据轨道中所有不同自旋耦合的csf。从<code>select</code>指令开始，有两种选择组态的方法：</p>
<ul>
<li><p>从先前带有阈值的计算中选择：</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">SELECT,<span class="built_in">ref</span>1,<span class="built_in">ref</span>2,<span class="built_in">ref</span>thr,<span class="built_in">ref</span>stat,mxshrf;</span><br></pre></td></tr></table></figure>
</li>
<li><p>在输入中明确定义，以关键字<code>con</code>开头的一行给出每个轨道组态：</p>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">SELECT</span></span><br><span class="line"><span class="attribute">CON</span>,n<span class="number">1</span>,n<span class="number">2</span>,n<span class="number">3</span>,n<span class="number">4</span>,…</span><br></pre></td></tr></table></figure>
<ul>
<li><p>n1，n2等是活性轨道的占据数（0，1，或2），比如对于<code>OCC,5,2,2;CLOSED,2,1,1;</code>，n1是轨道3.1的占据数，n2是轨道4.1的占据数，n3，n4，n5是轨道5.1，2.2，2.3的占据数。</p>
</li>
<li><p>例：BH分子</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">OCC,<span class="number">4</span>,<span class="number">1</span>,<span class="number">1</span>;             ! 四个σ，一个π</span><br><span class="line">FROZEN,<span class="number">1</span>;              ! 第一个σ双占且冻结</span><br><span class="line">WF,<span class="number">6</span>,<span class="number">1</span>;                ! <span class="number">6</span>个电子，单重态</span><br><span class="line">SELECT                 ! 触发组态输入</span><br><span class="line">CON,<span class="number">2</span>,<span class="number">2</span>                ! <span class="number">2</span>sigma**<span class="number">2</span>, <span class="number">3</span>sigma**<span class="number">2</span></span><br><span class="line">CON,<span class="number">2</span>,<span class="number">1</span>,<span class="number">1</span>              ! <span class="number">2</span>sigma**<span class="number">2</span>, <span class="number">3</span>sigma, <span class="number">4</span>sigma</span><br><span class="line">CON,<span class="number">2</span>,<span class="number">0</span>,<span class="number">2</span>              ! <span class="number">2</span>sigma**<span class="number">2</span>, <span class="number">4</span>sigma**<span class="number">2</span></span><br><span class="line">CON,<span class="number">2</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">2</span>            ! <span class="number">2</span>sigma**<span class="number">2</span>, <span class="number">1</span>pi_x**<span class="number">2</span></span><br><span class="line">CON,<span class="number">2</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">2</span>          ! <span class="number">2</span>sigma**<span class="number">2</span>, <span class="number">1</span>pi_y**<span class="number">2</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h1 id="其他选项"><a href="#其他选项" class="headerlink" title="其他选项"></a>其他选项</h1><h2 id="rotate"><a href="#rotate" class="headerlink" title="rotate"></a><code>rotate</code></h2><p>将<code>sym</code>对称性中的初始轨道<code>orb1</code>和<code>orb2</code>做<code>angle</code>度的2×2 转动：</p>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">ROTATE</span>,orb<span class="number">1</span>.sym,orb<span class="number">2</span>.sym,angle</span><br></pre></td></tr></table></figure>
<ul>
<li>angle=<code>0</code>表示交换轨道（等价于angle=90）。<strong>只能针对相同对称性的交换</strong></li>
<li><code>ROTATE</code>只在<code>START</code>卡之后才有意义。</li>
</ul>
<h2 id="natorb自然轨道"><a href="#natorb自然轨道" class="headerlink" title="natorb自然轨道"></a><code>natorb</code>自然轨道</h2><p>计算最终的自然轨道，并写到记录record中。（默认的record是2140.2，或者在ORBITAL卡指定）</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">NATORB</span>,<span class="selector-attr">[record,]</span> <span class="selector-attr">[options]</span></span><br></pre></td></tr></table></figure>
<p>options的可以是：</p>
<ul>
<li><code>CI</code>：以计算的自然轨道为基，把哈密顿量对角化，并打印组态及其有关的因子。与全局打印中的<code>CIVECTOR</code>等同。</li>
<li><code>PRINT(=n)</code>：打印每个对称性的n个虚轨道。与全局打印中的<code>ORBITAL(=n)</code>等同。</li>
</ul>
<h2 id="CANORB赝正则轨道"><a href="#CANORB赝正则轨道" class="headerlink" title="CANORB赝正则轨道"></a><code>CANORB</code>赝正则轨道</h2><p>正则化最终的轨道，等同于<code>CANONICAL</code>。options与自然轨道中的一样。</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">CANORB</span>,<span class="selector-attr">[record,]</span> <span class="selector-attr">[options]</span></span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>计算化学</category>
        <category>软件</category>
      </categories>
      <tags>
        <tag>多组态</tag>
        <tag>molpro</tag>
        <tag>CASSCF</tag>
        <tag>MCSCF</tag>
      </tags>
  </entry>
  <entry>
    <title>【molpro】05.多态多参考</title>
    <url>/2021/11/27/%E3%80%90molpro%E3%80%9105.%E5%A4%9A%E6%80%81%E5%A4%9A%E5%8F%82%E8%80%83/</url>
    <content><![CDATA[<ul>
<li><p>CASSCF主要是考虑静态相关，CI，微扰理论等考虑动态相关。MRCI和CASPT2都考虑了。</p>
</li>
<li><p>多参考微扰计算作为MRCI程序的特例执行。对于RS2（CASPT2，RASPT2），只需要对单电子算符计算矩阵元，因此计算量远远小于相应的MRCI。对于RS3（CASPT3），必须计算一阶波函的能量期待值，计算量几乎与一次MRCI迭代相同。RS2 和RS3程序使用与MRCI相同的组态空间，即，只对双激发的外组态进行内收缩。</p>
</li>
</ul>
<h1 id="多参考微扰理论"><a href="#多参考微扰理论" class="headerlink" title="多参考微扰理论"></a>多参考微扰理论</h1><ul>
<li>如果没有进一步的输入卡，波函的定义（芯轨道，闭壳层及活性轨道空间和对称性）对应最近的SCF或MCSCF计算所用的定义。轨道来自相应的SCF或MCSCF 计算，除非给出了<code>ORBITAL</code>指令。</li>
<li>对于CASPT2计算，如果使用了（赝）正则轨道，零阶哈密顿量将会成为分块对角化的形式。这会加速收敛。因此在此前的MULTI计算中，推荐用<code>CANONICAL</code> 指令保存轨道（默认是<code>NATORB</code>）。</li>
</ul>
<p>执行二阶或三阶微扰计算：</p>
<figure class="highlight autohotkey"><table><tr><td class="code"><pre><span class="line"><span class="built_in">RS2,</span>options</span><br><span class="line"><span class="built_in">RS2C,</span>options</span><br><span class="line"><span class="built_in">RS3,</span>options</span><br></pre></td></tr></table></figure>
<ul>
<li>RS3总是包含RS2作为第一步计算。</li>
<li>对于rs2和rs3，使用与MRCI完全相同的组态空间。在这种情况下，外层轨道空间中有两个电子的激发态在内部收缩。对于32位系统，相关轨道的总数限制为16，对于64位系统，相关轨道的总数限制为32。对于闭壳层单参考的情况，这等价于MP2或MP3。</li>
<li>在rs2c情况下，单激发外部和内部组态空间的子空间也都是内收缩的。这种方法比RS2效率更高，特别是对具有多个闭壳层（非活性）轨道的大分子。特别地，在这种情况下，只有活性轨道的数量被限制为16个或32个，分别在32位和64位机器上，并且可以使用任何数量的封闭壳层（非活性的）轨道（根据程序参数定义的最大值）。RS2C调用新的更高效的二阶程序，如果不计算三阶项的话，一般使用这个。<ul>
<li>注意，RS2和RS2c方法产生的结果略有不同。在这两种情况下，结果也与在MOLCAS中实现的使用Roos等人的方法得到的结果略有不同，因为后一种情况下，所有组态空间都在内部收缩。这就引入了MOLPRO中不存在的一些瓶颈。</li>
</ul>
</li>
<li>可以使用restrict和/或select指令来执行限制活性空间RASPT2或常规MRPT2计算，如MCSCF和CASSCF部分所述。</li>
</ul>
<h2 id="Options"><a href="#Options" class="headerlink" title="Options"></a>Options</h2><ul>
<li><p>MRPT2和CASPT2的计算经常遇到激发态计算的入侵态问题，导致波函数爆炸而不收敛。可以使用以下方法来避免。</p>
<ul>
<li><p><code>Gn</code>：使用修改的零阶哈密顿量</p>
</li>
<li><p><code>SHIFT=value</code>：能级移动（(Chem. Phys. Lett. 245, 215 (1995)).）典型的移动是0.1 − 0.3。在小数点之后只考虑两位数字。打印的能量以及ENERGY 变量包含了Roos和Andersson对能级移动建议的能量修正。收敛后还打印未修正的能量用于比较。</p>
</li>
<li><p><code>IPEA=value</code>：IPEA 能级移动。（G. Ghigo, B. O. Roos, and P.A. Malmqvist, Chem. Phys. Lett. 396, 142 (2004））</p>
</li>
<li>可以同时使用<code>SHIFT</code>和<code>IPEA</code>，但<code>Gn</code>选项不能和<code>IPEA</code>一起使用。</li>
</ul>
</li>
<li><p><code>MIX=nstates</code>：调用nstates个态的多态（MS-CASPT2）处理。</p>
</li>
<li><code>ROOT=ioptroot</code>：在次梯度计算（比如几何优化）中需要优化的根数（只有在随后进行梯度计算时才需要）。和MS-CASPT2中的<code>nstates</code>有关。</li>
<li><code>SAVEH=record</code>：在MS-CASPT2计算中，保存有效哈密顿量的记录。如果没有给出，则使用默认的记录（推荐）。</li>
<li><code>INIT</code>：（逻辑型）用单个态的参考函数初始化MS-CASPT2。</li>
<li><code>IGNORE</code>：（逻辑型）不使用CP-CASPT2的近似梯度计算标记。</li>
</ul>
<h2 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h2><figure class="highlight maxima"><table><tr><td class="code"><pre><span class="line">***,mscaspt2 <span class="keyword">for</span> h2o <span class="number">3B2</span> states</span><br><span class="line">basis=vdz</span><br><span class="line">geometry=&#123;O</span><br><span class="line">          H1,O,R;</span><br><span class="line">          H2,O,R,H1,THETA&#125;</span><br><span class="line">R=<span class="number">2.4</span></span><br><span class="line">Theta=<span class="number">98</span></span><br><span class="line">hf</span><br><span class="line">&#123;multi;closed,<span class="number">2</span></span><br><span class="line">wf,<span class="number">10</span>,<span class="number">1</span>,<span class="number">2</span>;state,<span class="number">3</span>         !three 3A1 states included <span class="keyword">in</span> sa-casscf</span><br><span class="line">wf,<span class="number">10</span>,<span class="number">2</span>,<span class="number">2</span>;state,<span class="number">2</span>         !two <span class="number">3B1</span> states included <span class="keyword">in</span> sa-casscf</span><br><span class="line">wf,<span class="number">10</span>,<span class="number">3</span>,<span class="number">2</span>;state,<span class="number">3</span>         !three <span class="number">3B2</span> states included <span class="keyword">in</span> sa-casscf</span><br><span class="line">canonical,<span class="number">2140.2</span>&#125;         !<span class="built_in">save</span> pseudo canonical orbitals</span><br><span class="line"></span><br><span class="line">&#123;rs2,xms=<span class="number">2</span>,mix=<span class="number">3</span>,root=<span class="number">2</span>;  !include three B2 states,</span><br><span class="line">                          !select the <span class="built_in">second</span> state <span class="keyword">for</span> gradients</span><br><span class="line">wf,<span class="number">10</span>,<span class="number">3</span>,<span class="number">2</span>&#125;                !Triplet B2 state symmetry</span><br><span class="line"></span><br><span class="line">optg                      !<span class="built_in">optimize</span> the geometry</span><br></pre></td></tr></table></figure>
<h2 id="计算激发态"><a href="#计算激发态" class="headerlink" title="计算激发态"></a>计算激发态</h2><h3 id="分别计算每个态"><a href="#分别计算每个态" class="headerlink" title="分别计算每个态"></a>分别计算每个态</h3><figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">STATE,<span class="number">1</span>,root</span><br></pre></td></tr></table></figure>
<ul>
<li><code>root</code>是所需要的根（即，2对应第一激发态）。在这种情况下，用于零阶哈密顿量的Fock算符用给定态的密度进行计算。</li>
</ul>
<h3 id="同时计算两个或更多的态"><a href="#同时计算两个或更多的态" class="headerlink" title="同时计算两个或更多的态"></a>同时计算两个或更多的态</h3><figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">STATE</span>, n<span class="meta"> [,root1, root2, . . . , rootn]</span></span><br></pre></td></tr></table></figure>
<ul>
<li><code>n</code>是计算的态的个数。</li>
<li>默认计算最低的n个根。默认设置也可以通过指定所需要的根<code>rooti</code>来修改。</li>
</ul>
]]></content>
      <categories>
        <category>计算化学</category>
        <category>软件</category>
      </categories>
      <tags>
        <tag>molpro</tag>
        <tag>CASPT2</tag>
        <tag>微扰理论</tag>
      </tags>
  </entry>
  <entry>
    <title>【molpro】06.旋轨耦合计算</title>
    <url>/2021/11/27/%E3%80%90molpro%E3%80%9106.%E6%97%8B%E8%BD%A8%E8%80%A6%E5%90%88%E8%AE%A1%E7%AE%97/</url>
    <content><![CDATA[<h1 id="仅旋轨耦合计算"><a href="#仅旋轨耦合计算" class="headerlink" title="仅旋轨耦合计算"></a>仅旋轨耦合计算</h1><p>首先要通过casscf计算，再保存对应的波函数</p>
<figure class="highlight stata"><table><tr><td class="code"><pre><span class="line">&#123;<span class="keyword">ci</span>;...;<span class="keyword">save</span>,record1.<span class="keyword">file</span>&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><p>如果是全电子计算中，继续计算SO的积分（BP哈密顿量的单、双电子自旋轨道积分可以预先计算并存储到硬盘上）：</p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">LSINT [<span class="string">,X</span>] [<span class="string">,Y</span>] [<span class="string">,Z</span>][<span class="symbol">,ONECENTER</span>] [;TWOINT,twoint;] [;PREFAC,prefac;]</span><br></pre></td></tr></table></figure>
<ul>
<li><code>X</code>，<code>Y</code>，和<code>Z</code>定义计算的分量。如果没有给出，三个全部求解。预先计算积分的好处是它们可以用于后面的任何SO计算，但是这可能需要大量的硬盘空间（是在能量计算中积分的六倍）。如果没有给出<code>LSINT</code>卡，那么只要需要就会计算积分。</li>
<li><code>ONECENTER</code>关键词激活单、双电子自旋轨道积分的单中心近似，对于大分子这会极大地减少计算时间。</li>
<li><code>TWOINT</code>和<code>PREFAC</code> 可用于控制自旋轨道积分的精度。这些阈值类似于标准积分的<code>TWOINT</code>和<code>PREFAC</code>。<code>prefac</code>的默认值是<code>twoint</code>/100，<code>twoint</code>的默认值是<script type="math/tex">10^{−7}</script>。</li>
</ul>
</li>
</ul>
<p>生成和处理SO矩阵：</p>
<figure class="highlight stata"><table><tr><td class="code"><pre><span class="line">&#123;<span class="keyword">ci</span>;hlsmat,<span class="keyword">type</span>,record1.<span class="keyword">file</span>,..,recordn.<span class="keyword">file</span>&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>使用记录record1，record2， record3，. . .中所有的态，计算整个SO矩阵元并进行对角化。这些记录文件必须用MRCI程序的<code>SAVE</code>指令产生。如前。</li>
<li>type是用于Breit-Pauli计算的<code>ls</code>或是用于ECP-LS计算的<code>ecp</code>用于全电子或 ECP 计算。<ul>
<li>如果<code>ls</code>给出（推荐），epcs 将用于所有持有 ecps 的原子，并且对剩余的原子进行全电子处理。</li>
<li>如果<code>ecp</code>给出，自旋轨道仅包括 ecps 的贡献。</li>
</ul>
</li>
<li>默认打印本征值以及基态与激发态之间的偶极跃迁矩阵元。</li>
</ul>
<h2 id="打印选项"><a href="#打印选项" class="headerlink" title="打印选项"></a>打印选项</h2><figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">PRINT</span>,option<span class="number">1</span>=value<span class="number">1</span>, option<span class="number">2</span>=value<span class="number">2</span>, . . .</span><br></pre></td></tr></table></figure>
<p>选项可以是：</p>
<ul>
<li><code>HLS</code><ul>
<li><code>=-1</code>：只打印SO能量以及基态和激发态之间的跃迁矩阵元（默认）。</li>
<li>≥0，打印SO矩阵</li>
<li>≥1，打印特性矩阵</li>
<li>≥2，打印各个矩阵元（同<code>OPTION,MATEL</code>）。</li>
<li>≥3，打印调试信息</li>
</ul>
</li>
<li><code>VLS</code><ul>
<li><code>=-1</code>：不打印本征矢（默认）。</li>
<li>≥0，打印本征矢。</li>
</ul>
</li>
</ul>
<p>eg：</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">print,hls=<span class="number">1</span>,vls=<span class="number">0</span></span><br></pre></td></tr></table></figure>
<h2 id="其他选项"><a href="#其他选项" class="headerlink" title="其他选项"></a>其他选项</h2><p>使用OPTION指令设置（以任何次序）：</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">OPTIONS [,<span class="attribute">WIGNER</span>=value] [,<span class="attribute">HLSTRANS</span>=value] [,<span class="attribute">MATEL</span>=value]</span><br></pre></td></tr></table></figure>
<ul>
<li>如果用<code>HLSMAT</code>计算整个SO矩阵，那么通常不显示各个矩阵元。当给定了选项MATEL=1时，会打印各个矩阵元以及内部和外部组态类的贡献。</li>
</ul>
<h2 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h2><p>含有ECP的例子：</p>
<figure class="highlight lsl"><table><tr><td class="code"><pre><span class="line">***,Br</span><br><span class="line">geometry=&#123;br&#125;</span><br><span class="line">basis=vtz-pp</span><br><span class="line">&#123;rhf;wf,sym=<span class="number">5</span>&#125;</span><br><span class="line">&#123;multi;wf,sym=<span class="number">2</span>;wf,sym=<span class="number">3</span>;wf,sym=<span class="number">5</span>&#125;  !<span class="number">2</span>P states, <span class="section">state</span> averaged</span><br><span class="line">&#123;ci;wf,sym=<span class="number">2</span>;save,<span class="number">5101.2</span>&#125;           !<span class="number">2</span>Px <span class="section">state</span></span><br><span class="line">&#123;ci;wf,sym=<span class="number">3</span>;save,<span class="number">5102.2</span>&#125;           !<span class="number">2</span>Py <span class="section">state</span></span><br><span class="line">&#123;ci;wf,sym=<span class="number">5</span>;save,<span class="number">5103.2</span>&#125;           !<span class="number">2</span>Pz <span class="section">state</span></span><br><span class="line">&#123;ci;hlsmat,ls,<span class="number">5101.2</span>,<span class="number">5102.2</span>,<span class="number">5103.2</span>&#125; !compute and diagonalize SO matrix</span><br></pre></td></tr></table></figure>
<p>全电子的例子：</p>
<figure class="highlight lsl"><table><tr><td class="code"><pre><span class="line">***,Br</span><br><span class="line">dkroll=<span class="number">1</span></span><br><span class="line">geometry=&#123;br&#125;</span><br><span class="line">basis=vtz-dk</span><br><span class="line">&#123;rhf;wf,sym=<span class="number">5</span>&#125;</span><br><span class="line">&#123;multi;wf,sym=<span class="number">2</span>;wf,sym=<span class="number">3</span>;wf,sym=<span class="number">5</span>&#125;  !<span class="number">2</span>P states, <span class="section">state</span> averaged</span><br><span class="line">&#123;lsint&#125;                             !Compute spin-orbit <span class="number">2</span>-electron integrals</span><br><span class="line">&#123;ci;wf,sym=<span class="number">2</span>;save,<span class="number">6101.2</span>&#125;           !<span class="number">2</span>Px <span class="section">state</span></span><br><span class="line">&#123;ci;wf,sym=<span class="number">3</span>;save,<span class="number">6102.2</span>&#125;           !<span class="number">2</span>Py <span class="section">state</span></span><br><span class="line">&#123;ci;wf,sym=<span class="number">5</span>;save,<span class="number">6103.2</span>&#125;           !<span class="number">2</span>Pz <span class="section">state</span></span><br><span class="line">&#123;ci;hlsmat,ls,<span class="number">6101.2</span>,<span class="number">6102.2</span>,<span class="number">6103.2</span>&#125; !compute and diagonalize SO matrix</span><br></pre></td></tr></table></figure>
<p>S的例子：</p>
<figure class="highlight lsl"><table><tr><td class="code"><pre><span class="line">***,SO calculation for the S-atom</span><br><span class="line">geometry=&#123;s&#125;</span><br><span class="line">basis=&#123;spd,s,vtz&#125;                                 !use uncontracted basis</span><br><span class="line"></span><br><span class="line">&#123;rhf;occ,<span class="number">3</span>,<span class="number">2</span>,<span class="number">2</span>,,<span class="number">2</span>;wf,<span class="number">16</span>,<span class="number">4</span>,<span class="number">2</span>&#125;                      !rhf for <span class="number">3</span>P <span class="section">state</span></span><br><span class="line"></span><br><span class="line">&#123;multi                                            !casscf</span><br><span class="line">wf,<span class="number">16</span>,<span class="number">4</span>,<span class="number">2</span>;wf,<span class="number">16</span>,<span class="number">6</span>,<span class="number">2</span>;wf,<span class="number">16</span>,<span class="number">7</span>,<span class="number">2</span>;                    !<span class="number">3</span>P states</span><br><span class="line">wf,<span class="number">16</span>,<span class="number">1</span>,<span class="number">0</span>;<span class="section">state</span>,<span class="number">3</span>;wf,<span class="number">16</span>,<span class="number">4</span>,<span class="number">0</span>;wf,<span class="number">16</span>,<span class="number">6</span>,<span class="number">0</span>;wf,<span class="number">16</span>,<span class="number">7</span>,<span class="number">0</span>&#125;  !<span class="number">1</span>D and <span class="number">1</span>S states</span><br><span class="line"></span><br><span class="line">&#123;ci;wf,<span class="number">16</span>,<span class="number">1</span>,<span class="number">0</span>;save,<span class="number">3010.1</span>;<span class="section">state</span>,<span class="number">3</span>;noexc&#125;          !save casscf wavefunctions using mrci</span><br><span class="line">&#123;ci;wf,<span class="number">16</span>,<span class="number">4</span>,<span class="number">0</span>;save,<span class="number">3040.1</span>;noexc&#125;</span><br><span class="line">&#123;ci;wf,<span class="number">16</span>,<span class="number">6</span>,<span class="number">0</span>;save,<span class="number">3060.1</span>;noexc&#125;</span><br><span class="line">&#123;ci;wf,<span class="number">16</span>,<span class="number">7</span>,<span class="number">0</span>;save,<span class="number">3070.1</span>;noexc&#125;</span><br><span class="line">&#123;ci;wf,<span class="number">16</span>,<span class="number">4</span>,<span class="number">2</span>;save,<span class="number">3042.1</span>;noexc&#125;</span><br><span class="line">&#123;ci;wf,<span class="number">16</span>,<span class="number">6</span>,<span class="number">2</span>;save,<span class="number">3062.1</span>;noexc&#125;</span><br><span class="line">&#123;ci;wf,<span class="number">16</span>,<span class="number">7</span>,<span class="number">2</span>;save,<span class="number">3072.1</span>;noexc&#125;</span><br><span class="line"></span><br><span class="line">&#123;ci;wf,<span class="number">16</span>,<span class="number">1</span>,<span class="number">0</span>;save,<span class="number">4010.1</span>;<span class="section">state</span>,<span class="number">3</span>&#125;                !mrci calculations for <span class="number">1</span>D, <span class="number">1</span>S states</span><br><span class="line">ed=energy(<span class="number">1</span>)                                      !save energy for <span class="number">1</span>D <span class="section">state</span> in variable ed</span><br><span class="line">es=energy(<span class="number">3</span>)                                      !save energy for <span class="number">1</span>S <span class="section">state</span> in variable es</span><br><span class="line">&#123;ci;wf,<span class="number">16</span>,<span class="number">4</span>,<span class="number">2</span>;save,<span class="number">4042.1</span>&#125;                        !mrci calculations for <span class="number">3</span>P states</span><br><span class="line">ep=energy                                         !save energy for <span class="number">3</span>P <span class="section">state</span> in variable ep</span><br><span class="line">&#123;ci;wf,<span class="number">16</span>,<span class="number">6</span>,<span class="number">2</span>;save,<span class="number">4062.1</span>&#125;                        !mrci calculations for <span class="number">3</span>P states</span><br><span class="line">&#123;ci;wf,<span class="number">16</span>,<span class="number">7</span>,<span class="number">2</span>;save,<span class="number">4072.1</span>&#125;                        !mrci calculations for <span class="number">3</span>P states</span><br><span class="line">text,only triplet states, casscf</span><br><span class="line"></span><br><span class="line">lsint                                             !compute so integrals</span><br><span class="line"></span><br><span class="line">text,<span class="number">3</span>P states, casscf</span><br><span class="line">&#123;ci;hlsmat,ls,<span class="number">3042.1</span>,<span class="number">3062.1</span>,<span class="number">3072.1</span>&#125;               !Only triplet states, casscf</span><br><span class="line"></span><br><span class="line">text,<span class="number">3</span>P states, mrci</span><br><span class="line">&#123;ci;hlsmat,ls,<span class="number">4042.1</span>,<span class="number">4062.1</span>,<span class="number">4072.1</span>&#125;               !Only triplet states, mrci</span><br><span class="line"></span><br><span class="line">text,<span class="number">3</span>P, <span class="number">1</span>D, <span class="number">1</span>S states, casscf</span><br><span class="line">&#123;ci;hlsmat,ls,<span class="number">3010.1</span>,<span class="number">3040.1</span>,<span class="number">3060.1</span>,<span class="number">3070.1</span>,<span class="number">3042.1</span>,<span class="number">3062.1</span>,<span class="number">3072.1</span>&#125;       !All states, casscf</span><br><span class="line"></span><br><span class="line">text,only triplet states, use mrci energies and casscf SO-matrix elements</span><br><span class="line">hlsdiag=[ed,ed,es,ed,ed,ed,ep,ep,ep]             !set variable hlsdiag to mrci energies</span><br><span class="line">&#123;ci;hlsmat,ls,<span class="number">3010.1</span>,<span class="number">3040.1</span>,<span class="number">3060.1</span>,<span class="number">3070.1</span>,<span class="number">3042.1</span>,<span class="number">3062.1</span>,<span class="number">3072.1</span>&#125;</span><br></pre></td></tr></table></figure>
<h1 id="结果"><a href="#结果" class="headerlink" title="结果"></a>结果</h1><ul>
<li>ΔSO在Summary of SO results中，为<code>E-E0</code>或者用最后两行中的E1-E0。如果所有态都考虑进去了，这两者是相等的，如果没有，不相等。</li>
</ul>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">Summary of SO results</span><br><span class="line">=====================</span><br><span class="line"></span><br><span class="line">Eigenvalues of the spin-orbit matrix</span><br><span class="line">....................................</span><br><span class="line"></span><br><span class="line">  Nr  Sym         E             E-E0         E-E0           E-E(<span class="number">1</span>)      E-E(<span class="number">1</span>)      E-E(<span class="number">1</span>)</span><br><span class="line">                (au)            (au)        (cm<span class="number">-1</span>)           (au)       (cm<span class="number">-1</span>)        (eV)</span><br><span class="line">  <span class="number">1</span>   <span class="number">1</span>   <span class="number">-332.08423469</span>     <span class="number">-0.00013437</span>      <span class="number">-29.49</span>      <span class="number">0.00000000</span>        <span class="number">0.00</span>      <span class="number">0.0000</span></span><br><span class="line">  <span class="number">2</span>   <span class="number">1</span>   <span class="number">-332.08422135</span>     <span class="number">-0.00012103</span>      <span class="number">-26.56</span>      <span class="number">0.00001334</span>        <span class="number">2.93</span>      <span class="number">0.0004</span></span><br><span class="line">  <span class="number">3</span>   <span class="number">1</span>   <span class="number">-332.08422135</span>     <span class="number">-0.00012103</span>      <span class="number">-26.56</span>      <span class="number">0.00001334</span>        <span class="number">2.93</span>      <span class="number">0.0004</span></span><br><span class="line">  ………………</span><br><span class="line"> E0 =   <span class="number">-332.08410032</span> <span class="keyword">is</span> the energy of the lowest zeroth-order state</span><br><span class="line"> E1 =   <span class="number">-332.08423469</span> <span class="keyword">is</span> the energy of the lowest SO-state</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>计算化学</category>
        <category>软件</category>
      </categories>
      <tags>
        <tag>molpro</tag>
        <tag>旋轨耦合</tag>
        <tag>SO</tag>
      </tags>
  </entry>
  <entry>
    <title>【【草稿】】分子振动</title>
    <url>/2022/03/28/%E3%80%90%E3%80%90%E8%8D%89%E7%A8%BF%E3%80%91%E3%80%91%E5%88%86%E5%AD%90%E6%8C%AF%E5%8A%A8/</url>
    <content><![CDATA[<h1 id="振动模式"><a href="#振动模式" class="headerlink" title="振动模式"></a>振动模式</h1><ul>
<li>一个拥有 n 个原子的非线性分子有 3n − 6 个振动正交模（vibrational normal mode），其余为 3 个转动、3 个移动。而线性的分子有 3n − 5 个振动正交模，只有 2 个转动。<ul>
<li>原因：当所有原子都沿着x或y或z方向移动的时候，只是整个分子在移动，而不是分子在振动，因此要减去3个自由度；而当所有原子沿着x或y或z方向转动时，也不是分子振动，因此要再减去3个自由度（当线性的时候，没有分子轴的转动，所以是减去2）。</li>
</ul>
</li>
</ul>
<h2 id="振动模式的分类"><a href="#振动模式的分类" class="headerlink" title="振动模式的分类"></a>振动模式的分类</h2><div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">对称伸缩<br/>（Symmetrical stretching）</th>
<th style="text-align:center">不对称伸缩<br/>（Asymmetrical stretching）</th>
<th style="text-align:center">平面剪式运动<br/>（Scissoring / Bending）</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><a href="https://en.wikipedia.org/wiki/File:Symmetrical_stretching.gif"><img src="https://upload.wikimedia.org/wikipedia/commons/0/0e/Symmetrical_stretching.gif" alt="Symmetrical stretching.gif"></a></td>
<td style="text-align:center"><a href="https://en.wikipedia.org/wiki/File:Asymmetrical_stretching.gif"><img src="https://upload.wikimedia.org/wikipedia/commons/0/0c/Asymmetrical_stretching.gif" alt="Asymmetrical stretching.gif"></a></td>
<td style="text-align:center"><a href="https://en.wikipedia.org/wiki/File:Scissoring.gif"><img src="https://upload.wikimedia.org/wikipedia/commons/6/60/Scissoring.gif" alt="Scissoring.gif"></a></td>
</tr>
<tr>
<td style="text-align:center"><strong>平面摆动<br/>（Rocking）</strong></td>
<td style="text-align:center"><strong>非平面摇摆<br/>（Wagging）</strong></td>
<td style="text-align:center"><strong>非平面扭转<br/>（Twisting）</strong></td>
</tr>
<tr>
<td style="text-align:center"><a href="https://en.wikipedia.org/wiki/File:Modo_rotacao.gif"><img src="https://upload.wikimedia.org/wikipedia/commons/1/14/Modo_rotacao.gif" alt="Modo rotacao.gif"></a></td>
<td style="text-align:center"><a href="https://en.wikipedia.org/wiki/File:Wagging.gif"><img src="https://upload.wikimedia.org/wikipedia/commons/8/84/Wagging.gif" alt="Wagging.gif"></a></td>
<td style="text-align:center"><a href="https://en.wikipedia.org/wiki/File:Twisting.gif"><img src="https://upload.wikimedia.org/wikipedia/commons/4/40/Twisting.gif" alt="Twisting.gif"></a></td>
</tr>
</tbody>
</table>
</div>
<ul>
<li>在摆动、摇摆与扭转模，原子间的键长不会改变。</li>
</ul>
<h2 id="举例"><a href="#举例" class="headerlink" title="举例"></a>举例</h2><p><img src="h2ovibrations.gif" alt="h2ovibrations"></p>
<p><img src="co2vibrations.gif" alt="co2vibrations"></p>
<p><img src="ch2vibrations.gif" alt="ch2vibrations"></p>
<h1 id="牛顿力学"><a href="#牛顿力学" class="headerlink" title="牛顿力学"></a>牛顿力学</h1><ul>
<li><blockquote>
<p>将振动看作弹簧，则在谐波近似（harmonic approximation）中，服从胡克定律（Hooke’s law）：拉伸弹簧所需的力与拉伸量成正比：$F=-kQ$（k是力常数，单位为N/cm=dyn/cm）</p>
</blockquote>
</li>
<li><p>牛顿第二定律：$F=ma=\mu \frac{d^{2} Q}{d t^{2}}$（$\mu$是约化质量，单位为g，一般来说，双原子为<script type="math/tex">\frac{1}{\mu}=\frac{1}{m_{A}}+\frac{1}{m_{B}}</script>）</p>
</li>
<li><p>联立以上两个方程，可以解得：（A是最大振幅）</p>
<script type="math/tex; mode=display">
Q(t)=A \cos (2 \pi \nu t) ; \quad \nu=\frac{1}{2 \pi} \sqrt{\frac{k}{\mu}}</script><ul>
<li>当用相对原子质量计算，频率用波数（<script type="math/tex">cm^{-1}</script>）时，可以得到<script type="math/tex">\tilde{v}=\frac{v}{c}=1307 \sqrt{\frac{k}{A}}</script></li>
</ul>
</li>
<li><p>在谐波近似中，力常数是势能的二阶导：$k=\frac{\partial^{2} V}{\partial Q^{2}}$</p>
</li>
</ul>
<h1 id="量子力学"><a href="#量子力学" class="headerlink" title="量子力学"></a>量子力学</h1><ul>
<li><p>动能算符：$\frac{p^{2}}{2m}$（$p=-i \hbar \frac{d}{d x}$）</p>
</li>
<li><p>薛定谔方程：$-\frac{h^{2}}{8 \pi^{2} \mu_{A B}} \frac{d^{2} \psi}{d x^{2}}+\frac{1}{2} k x^{2} \psi=E \psi$，解方程得到（n为量子数，取0，1，2……）：</p>
<script type="math/tex; mode=display">
E_{n}=h\left(n+\frac{1}{2}\right) \nu=h\left(n+\frac{1}{2}\right) \frac{1}{2 \pi} \sqrt{\frac{k}{m^{\prime}}}</script></li>
</ul>
<p><img src="https://upload.wikimedia.org/wikipedia/commons/b/bb/Anharmonic_oscillator.gif" alt="img"></p>
<ul>
<li>当n变化时，能量变化为hv。</li>
<li>当分子吸收能量ΔE时，分子振动被激发，对应于振动的频率ν，根据关系ΔE = hν。当一个这样的能量量子被处于基态的分子吸收时，就会引发基本振动。</li>
</ul>
<h1 id="群论的应用"><a href="#群论的应用" class="headerlink" title="群论的应用"></a>群论的应用</h1><p>以$D_{3h}$点群的碳酸根$CO_3^-$为例，一共有3n-3=6种正则振动。</p>
<p><img src="image-20220329142718038.png" alt=""  /></p>
<p>这些振动方式的对称都是属于某一个不可约表示：</p>
<ul>
<li>对于$v_1$，所有对称操作都没有改变图中的箭头（向量），全是1，因此是$A^{\prime}_1$对称性</li>
<li>对于$v_2$，$E$，$C_3$和$\sigma_v$不会改变向量，而$C_2$，$\sigma_h$和$S_3$则变为负，因此符合$A^{\prime\prime}_2$</li>
<li>对于<script type="math/tex">v_3</script>复杂一些，需要用<script type="math/tex">v_{3a}</script>和<script type="math/tex">v_{3b}</script>共同表示：<ul>
<li>对于$E$，<script type="math/tex">E\left(v_{3 a}\right)=v_{3 a}+0 v_{3 b} $，$E\left(v_{3 b}\right)=0 v_{3 a}+v_{3 b}</script>，用矩阵表示<script type="math/tex">\left[\begin{array}{ll}1 & 0 \\0 & 1\end{array}\right]</script>，则特征标为2；</li>
<li>对于<script type="math/tex">C_3</script>，如下图：<script type="math/tex">C_{3}\left(v_{3 a}\right)=-\frac{1}{2} v_{3 a}+\frac{1}{2} v_{3 b}</script>，<script type="math/tex">C_{3}\left(v_{3 b}\right)=-\frac{3}{2} v_{3 a}-\frac{1}{2} v_{3 b}</script>，则为<script type="math/tex">\left[\begin{array}{rr}-\frac{1}{2} & \frac{1}{2} \\-\frac{3}{2} & -\frac{1}{2}\end{array}\right]</script>，特征标为-1</li>
<li>其他以此类推，符合<script type="math/tex">E^{\prime\prime}</script></li>
</ul>
</li>
</ul>
<p><img src="image-20220329161730435.png" alt="" style="zoom: 50%;" /></p>
<h2 id="确定正则振动的对称性"><a href="#确定正则振动的对称性" class="headerlink" title="确定正则振动的对称性"></a>确定正则振动的对称性</h2><ol>
<li>通过给每个原子一个独立的笛卡尔坐标系，以该原子为原点，所有的x，y，z轴方向都相同，如下图：<br><img src="image-20220329162037142.png" alt=""></li>
<li><p>用每一个对称操作作用在这个分子上，用变换前的坐标表示变换后的坐标，比如$C_3$：</p>
<p><img src="image-20220329162244422.png" alt=""  /></p>
</li>
</ol>
<ul>
<li>则：<script type="math/tex">X_{1}^{’}=-\frac{1}{2} X_{2}-\left(\frac{\sqrt{3}}{2}\right) Y_{2}</script>，可以得到特征标为0的矩阵：</li>
</ul>
<p><img src="image-20220329163410958.png" alt=""></p>
<ul>
<li><p>对于$E$操作，对角线全是1，特征标为12。</p>
</li>
<li><p>更加简单的看是，<strong>只需要考虑没有移动到别的原子上的笛卡尔坐标系。</strong>因为它们处于对角线上。比如<script type="math/tex">X_{1}</script>，<script type="math/tex">Y_{1}</script>，<script type="math/tex">Z_{1}</script>在<script type="math/tex">C_3</script>都旋转到原子2上了，因此可以不用考虑。而原子4上的坐标仍然在原子4上，因此可以直接看原子4上的变换矩阵（红框部分）。</p>
<ul>
<li>对于$C_2$操作绕着X轴旋转，只有原子1和原子4的坐标没有移走，而且X向量不发生改变，Z和Y分别变成负的，则特征标的数值为$(1-1-1)\times2=-2$</li>
<li>对于$\sigma_h$，每个原子都只有一个向量变成负的，则为$(1+1-1)\times4=4$</li>
<li>对于$S_3$，则是先$C_3$后再$\sigma_h$，所以就是$-1/2-1/2-1=2$</li>
<li>对于$\sigma_v$，两个原子不变，每个原子有一个向量变成负的，因此特征标为2</li>
</ul>
</li>
</ul>
<ol>
<li><p>得到12个笛卡尔坐标产生的特征标后，进行分解：</p>
<p><img src="image-20220329164135814.png" alt=""></p>
</li>
</ol>
<script type="math/tex; mode=display">
\Gamma_{i}=A_{1}^{\prime}+A_{2}^{\prime}+3 E^{\prime}+2 A_{2}^{\prime \prime}+E^{\prime \prime}</script><ol>
<li>扣除6个移动和转动，通过上表可以得知，跟x，y，z移动相关的为<script type="math/tex">E^{\prime}</script>和<script type="math/tex">A_{2}^{\prime \prime}</script>，与x，y，z转动相关的是<script type="math/tex">A_{2}^{\prime}</script>和<script type="math/tex">E^{\prime\prime}</script>，进行扣除：<script type="math/tex; mode=display">
\Gamma_{g}=A_{1}^{\prime}+2E^{\prime}+A_{2}^{\prime \prime}</script></li>
</ol>
<h2 id="通过内坐标看正则振动的贡献"><a href="#通过内坐标看正则振动的贡献" class="headerlink" title="通过内坐标看正则振动的贡献"></a>通过内坐标看正则振动的贡献</h2><ol>
<li>选择三个C-O键的伸缩作为内坐标组，则特征标的顺序是3 0 1 3 0 1，进行分解可以得到<script type="math/tex">A_{1}^{\prime}+E^{\prime}</script>，可以看出这两个振动方式包含一定程度的C-O振动。（也可以通过羰基六种正则振动的图验证，与C-O键伸缩振动相关的是<script type="math/tex">A_{1}^{\prime}+E^{\prime}</script>）</li>
<li>选择三个OCO键角作为第二组内坐标组：<ul>
<li>首先要注意所有坐标不是线性无关的。如果振动使得三个OCO键角同时增大或减小，振动是<script type="math/tex">A_{1}^{\prime}</script>的对称性，但是这三个角在一个平面内不可能同时增大或减小，因此这个对称性是与键角的振动无关的。</li>
<li>同样按对称操作，则得到3 0 1 3 0 1，分解得到也是<script type="math/tex">A_{1}^{\prime}+E^{\prime}</script>，但是<script type="math/tex">A_{1}^{\prime}</script>的振动是冗余的要去掉</li>
<li>因此$E^{\prime}$的振动包含一定的OCO角的弯曲</li>
</ul>
</li>
<li>还剩一个$A_{2}^{\prime\prime}$，因此它是与二面角有关的，即C-O键与离子平面间所成的角有变化，不包含C-O键长和平面内OCO键角的变化。</li>
</ol>
<h2 id="判断红外和拉曼活性"><a href="#判断红外和拉曼活性" class="headerlink" title="判断红外和拉曼活性"></a>判断红外和拉曼活性</h2><ul>
<li>红外偶极辐射的吸收发生基频跃迁必须包含一个或多个非零的<script type="math/tex">\int \psi_{\nu}^{0} x \psi_{\nu}^{j} d \tau</script>，<script type="math/tex">\int \psi_{\nu}^{0} y \psi_{\nu}^{j} d \tau</script>，<script type="math/tex">\int \psi_{\nu}^{0} z \psi_{\nu}^{j} d \tau</script>积分，这些积分与x，y，z有关。</li>
<li>拉曼散射至少需要一个非零的<script type="math/tex">\int \psi_{\nu}^{0} P \psi_{\nu}^{j} d \tau</script>，<script type="math/tex">P</script>是笛卡尔坐标的二元函数，即与<script type="math/tex">x^2</script>，<script type="math/tex">y^2</script>，<script type="math/tex">z^2</script>，xy，yz，zx有关</li>
<li>因此通过特征标表，可知<script type="math/tex">D_{3h}</script>点群的振动<script type="math/tex">\Gamma_{g}=A_{1}^{\prime}+2E^{\prime}+A_{2}^{\prime \prime}</script>中：<ul>
<li>只具有拉曼活性：$A_{1}^{\prime}$和$E^{\prime\prime}$</li>
<li>只具有红外活性：$A_{2}^{\prime\prime}$</li>
<li>都有：$E^{\prime}$</li>
</ul>
</li>
</ul>
]]></content>
      <categories>
        <category>计算化学</category>
        <category>原理</category>
      </categories>
  </entry>
  <entry>
    <title>【【草稿】】变分法</title>
    <url>/2021/04/19/%E3%80%90%E3%80%90%E8%8D%89%E7%A8%BF%E3%80%91%E3%80%91%E5%8F%98%E5%88%86%E6%B3%95/</url>
    <content><![CDATA[<p>微扰理论：构造一个近似的哈密顿算符</p>
<p>变分法：构造一个近似的波函数</p>
<h1 id="变分法"><a href="#变分法" class="headerlink" title="变分法"></a>变分法</h1><p>变分原理：</p>
]]></content>
      <categories>
        <category>计算化学</category>
        <category>原理</category>
      </categories>
      <tags>
        <tag>变分法</tag>
      </tags>
  </entry>
  <entry>
    <title>【【草稿】】姜-泰勒效应</title>
    <url>/2022/03/28/%E3%80%90%E3%80%90%E8%8D%89%E7%A8%BF%E3%80%91%E3%80%91%E5%A7%9C-%E6%B3%B0%E5%8B%92%E6%95%88%E5%BA%94/</url>
    <content><![CDATA[<h1 id="姜-泰勒效应"><a href="#姜-泰勒效应" class="headerlink" title="姜-泰勒效应"></a>姜-泰勒效应</h1><p><img src="image-20220328154848109.png" alt="image-20220328154848109"></p>
<h1 id="二阶-赝姜-泰勒效应"><a href="#二阶-赝姜-泰勒效应" class="headerlink" title="二阶/赝姜-泰勒效应"></a>二阶/赝姜-泰勒效应</h1>]]></content>
      <categories>
        <category>计算化学</category>
        <category>原理</category>
      </categories>
      <tags>
        <tag>姜-泰勒效应</tag>
        <tag>Jahn-Teller</tag>
      </tags>
  </entry>
  <entry>
    <title>【【草稿】】激发</title>
    <url>/2022/03/28/%E3%80%90%E3%80%90%E8%8D%89%E7%A8%BF%E3%80%91%E3%80%91%E7%94%B5%E5%AD%90%E6%BF%80%E5%8F%91%E6%80%81/</url>
    <content><![CDATA[<h1 id="激发态计算的常见术语"><a href="#激发态计算的常见术语" class="headerlink" title="激发态计算的常见术语"></a>激发态计算的常见术语</h1><ul>
<li>垂直激发能：跃迁过程中结构不发生变化。（理论工作者假想出来的激发过程）<ul>
<li>计算是最简单的。</li>
<li>其数值和实验最大吸收峰近似对应：没考虑振动耦合，往往也会高估最大吸收峰位置0.1~0.3eV。可光谱、预测光谱。</li>
<li>可以计算荧光。</li>
</ul>
</li>
<li>绝热激发能：激发过程是从势能面1最小点结构跃迁到势能面2最小点结构。<ul>
<li>需要做激发态优化，比较费时间，没有垂直激发能那么接近最大吸收峰。</li>
<li>可以作为实验得到的0-0跃迁能量的较好近似：激发态ZPE通常低于基态，精确计算的绝热激发能往往会高估实际0-0值0.1eV左右。</li>
</ul>
</li>
<li>振子强度：</li>
</ul>
<h1 id="电子激发的分类"><a href="#电子激发的分类" class="headerlink" title="电子激发的分类"></a>电子激发的分类</h1><p>UV-Vis光谱涉及的电子激发：</p>
<ul>
<li>价层激发：电子从<strong>价层占据轨道</strong>激发到<strong>价层空轨道</strong>。</li>
<li>里德堡激发：电子从<strong>价层占据轨道</strong>激发到<strong>里德堡轨道</strong>。</li>
</ul>
<p>价层激发</p>
<ul>
<li>从电荷怎么转移的角度分：<ul>
<li>局域激发(Local excitation, LE)：电子被激发前后其分布区域没有明显变化。<ul>
<li>metal-centered transition (MC)、intraligand或ligand-centered transition (LC)</li>
</ul>
</li>
<li>电荷转移激发(Charge-transfer excitation, CT)：电子被激发前后其分布区域没有明显变化（分子内或分子间）。<ul>
<li>metal-to-metal charge transfer (MMCT)、ligand-to-ligand charge transfer (LLCT)、metal-to-ligand charge transfer (MLCT)、ligand-to-metal charge transfer (LMCT)。</li>
</ul>
</li>
</ul>
</li>
<li>从轨道特征上：<ul>
<li>对于主族原子，电子可以从占据的$\sigma$、$\pi$、$n$（杂原子提供的孤对电子）轨道激发到反键轨道。<script type="math/tex">\sigma^*</script>和<script type="math/tex">\pi^*</script><ul>
<li>UV-Vis光谱感兴趣的范畴内主要出现的是<script type="math/tex">\pi</script>→<script type="math/tex">\pi^*</script>和<script type="math/tex">n</script>→<script type="math/tex">\pi^*</script>，这是能量最低的两类激发。</li>
<li><script type="math/tex">\sigma</script>→<script type="math/tex">\pi^*</script>和<script type="math/tex">n</script>→<script type="math/tex">\sigma^*</script>能量往往高一些。</li>
<li>对于没有杂原子和<script type="math/tex">\pi</script>电子的，比如烷烃，就只有<script type="math/tex">\sigma</script>→<script type="math/tex">\sigma^*</script>了，由于<script type="math/tex">\sigma</script>是能量较低的占据轨道，<script type="math/tex">\sigma^*</script>是能量较高的空轨道，所以这种类型激发能很高。</li>
</ul>
</li>
<li>对于过渡金属原子，d轨道也会参与，比如d-d、d-p金属内激发。</li>
</ul>
</li>
</ul>
]]></content>
      <categories>
        <category>计算化学</category>
        <category>原理</category>
      </categories>
      <tags>
        <tag>激发</tag>
      </tags>
  </entry>
  <entry>
    <title>【【草稿】】量子化学基本常识</title>
    <url>/2021/04/19/%E3%80%90%E3%80%90%E8%8D%89%E7%A8%BF%E3%80%91%E3%80%91%E9%87%8F%E5%AD%90%E5%8C%96%E5%AD%A6%E5%9F%BA%E6%9C%AC%E5%B8%B8%E8%AF%86/</url>
    <content><![CDATA[<p>理解经典力学和量子力学的联系</p>
<p>经典力学</p>
<p>能量：$E=\frac{1}{2} mv^2$</p>
<p>动量：$p=mv$</p>
<h1 id="光"><a href="#光" class="headerlink" title="光"></a>光</h1><p>波粒二象性</p>
<ul>
<li>胡克（1665）：光波动说</li>
<li>牛顿（1672）：光微粒说（解释了反射，折射和干涉）、白光是由其他颜色混合而成的（几何光学）</li>
<li>惠更斯（1678）：光的波动理论（衍射、干涉和偏振）</li>
<li>托马斯·杨（1801）：杨氏双缝实验实验证实衍射和干涉</li>
<li>麦克斯韦（1864）：光是电磁波</li>
<li><p>赫兹（1888）：实验证明了光是一种电磁波，<script type="math/tex">\lambda \nu = c</script></p>
</li>
<li><p>黑体辐射问题：</p>
<ul>
<li>Wien（1889）：</li>
<li>Rayleigh-Jeans law（1900）：</li>
<li></li>
</ul>
</li>
</ul>
<h1 id="算符"><a href="#算符" class="headerlink" title="算符"></a>算符</h1><p>符符是把一个函数变为另一个函数的数学运算符号。比如<script type="math/tex">\hat{D}=\frac{\partial}{\partial x}</script>，则<script type="math/tex">\hat{D}f(x)=\frac{\partial f(x)}{\partial x}</script>：</p>
<ul>
<li>拉普拉斯算符：<script type="math/tex">\nabla^2=\frac{\partial^2}{\partial x^2}+\frac{\partial^2}{\partial y^2}+\frac{\partial^2}{\partial z^2}</script></li>
<li>动量：<script type="math/tex">\hat{p}_x=-i\hbar\frac{\partial}{\partial x}</script>，<script type="math/tex">\hat{p}=-i \hbar\left(\vec{i} \frac{\partial}{\partial x}+\vec{j} \frac{\partial}{\partial y}+\vec{k} \frac{\partial}{\partial z}\right)=-i \hbar \nabla</script></li>
<li>动能：<script type="math/tex">\hat{T}=\frac{1}{2 m} \hat{p} \cdot \hat{p}=\frac{1}{2 m}(-i \hbar \nabla) \cdot(-i \hbar \nabla)=-\frac{\hbar^{2}}{2 m} \nabla^{2}</script></li>
</ul>
<h2 id="算符的运算律"><a href="#算符的运算律" class="headerlink" title="算符的运算律"></a>算符的运算律</h2><ul>
<li>加法：<script type="math/tex">\hat{A}+\hat{B}=\hat{C}</script>，<script type="math/tex">\hat{C} \psi=(\hat{A}+\hat{B}) \psi=\hat{A} \psi+\hat{B} \psi</script></li>
<li>乘法：<script type="math/tex">\hat{A}\hat{B}=\hat{C}</script>，<script type="math/tex">\hat{C} \psi=(\hat{A}\hat{B}) \psi=\hat{A}(\hat{B} \psi)</script></li>
<li>平方：<script type="math/tex">\hat{A}\hat{A}=\hat{A}^2</script>，<script type="math/tex">\hat{A}\hat{A}\cdots\hat{A}=\hat{A}^n</script></li>
</ul>
<h2 id="算符的对易"><a href="#算符的对易" class="headerlink" title="算符的对易"></a>算符的对易</h2><ul>
<li>如果<script type="math/tex">[\hat{A},\hat{B}]=\hat{A}\hat{B}-\hat{B}\hat{A}=0</script>，则<script type="math/tex">\hat{A},\hat{B}</script>对易，反之，不对易</li>
<li>如果<script type="math/tex">[\hat{A},\hat{B}]_+=\hat{A}\hat{B}+\hat{B}\hat{A}=0</script>，则<script type="math/tex">\hat{A},\hat{B}</script>反对易</li>
</ul>
<p>对易子满足：</p>
<ul>
<li><script type="math/tex; mode=display">[\hat{A}, \hat{B}]=-[\hat{B}, \hat{A}]</script></li>
<li><script type="math/tex; mode=display">[\hat{A}, \hat{B}+\hat{C}]=[\hat{A}, \hat{B}]+[\hat{A}, \hat{C}]</script></li>
<li><script type="math/tex; mode=display">[\hat{A}, \hat{B} \hat{C}]=\hat{B}[\hat{A}, \hat{C}]+[\hat{A}, \hat{B}] \hat{C}</script></li>
<li><script type="math/tex; mode=display">[\hat{A} \hat{B}, \hat{C}]=\hat{A}[\hat{B}, \hat{C}]+[\hat{A}, \hat{C}] \hat{B}</script></li>
<li>Jacobi恒等式：<script type="math/tex">[\hat{\mathrm{A}},[\hat{\mathrm{B}}, \hat{\mathrm{C}}]]+[\hat{\mathrm{B}},[\hat{\mathrm{A}}, \hat{\mathrm{C}}]]+[\hat{\mathrm{C}},[\hat{\mathrm{A}}, \hat{\mathrm{B}}]]=0</script></li>
</ul>
<h2 id="线性算符"><a href="#线性算符" class="headerlink" title="线性算符"></a>线性算符</h2><script type="math/tex; mode=display">\hat{L}(c_{1}\psi_{1}+c_{2}\psi_{2})=c_{1}\hat{L}\psi_{1}+c_2 \hat{L}\psi_{2}</script><ul>
<li>线性算符：<script type="math/tex">\hat{x}^2,\frac{d}{dx},\frac{d^2}{dx^2},\cdots</script></li>
<li>非线性算符：<script type="math/tex">cos,(\ )^2,\sqrt,\cdots</script></li>
</ul>
<h2 id="常见算符"><a href="#常见算符" class="headerlink" title="常见算符"></a>常见算符</h2><h3 id="角动量算符"><a href="#角动量算符" class="headerlink" title="角动量算符"></a>角动量算符</h3><h4 id="推导"><a href="#推导" class="headerlink" title="推导"></a>推导</h4><script type="math/tex; mode=display">\vec{L}=\vec{r} \times \vec{p}=\begin{vmatrix}  
\vec{i} & \vec{j} & \vec{k} \\
x & y & z \\
p_{x} & p_{y} & p_{z} 
\end{vmatrix}=\begin{vmatrix}
y & z \\
p_{y} & p_{z}
\end{vmatrix} \vec{i}-\begin{vmatrix}
x & z \\
p_{x} & p_{z}
\end{vmatrix} \vec{j}+\begin{vmatrix}
x & y \\
p_{x} & p_{y}
\end{vmatrix} \vec{k}=L_{x} \vec{i}+L_{y} \vec{j}+L_{z} \vec{k}</script><h3 id="动能算符"><a href="#动能算符" class="headerlink" title="动能算符"></a>动能算符</h3><h3 id="势能算符"><a href="#势能算符" class="headerlink" title="势能算符"></a>势能算符</h3><h1 id="量子力学基本假设"><a href="#量子力学基本假设" class="headerlink" title="量子力学基本假设"></a>量子力学基本假设</h1><h2 id="假设-1"><a href="#假设-1" class="headerlink" title="假设 1"></a>假设 1</h2><p>微观体系的状态用波函数<script type="math/tex">\Psi\left(\vec{x}_{1}, \vec{x}_{2}, \cdots, \vec{x}_{N}, t\right)</script>描述。</p>
<h2 id="假设-2"><a href="#假设-2" class="headerlink" title="假设 2"></a>假设 2</h2><p>微观体系的力学量（可观测量）用厄米算符表示。</p>
<h2 id="假设3"><a href="#假设3" class="headerlink" title="假设3"></a>假设3</h2><p>微观体系力学量算符的全部本征函数<script type="math/tex">\{\phi_{i}, i=1,2, \ldots\}</script> 构成一个数学完备集，体系的任意状态<script type="math/tex">\Psi</script>均可表示为这些本征函数的线性组合：<script type="math/tex">\Psi=\sum_{i}c_i\phi_i</script></p>
<h3 id="本征值和本征函数"><a href="#本征值和本征函数" class="headerlink" title="本征值和本征函数"></a>本征值和本征函数</h3><script type="math/tex; mode=display">$$

定理 1：厄米算符的本征值为实数。

定理 2：厄米算符不同的两个本征函数互相正交。

## 假设4

在状态$$\Psi$$下，微观体系力学量$$F$$的测量平均值$$\bar{F}$$等于算符$$\hat{F}$$的状态期望值$$\langle\hat{F}\rangle$$ ，即$$\bar{F}=\langle\hat{F}\rangle=\frac{\int \Psi^{*} \hat{F} \Psi d \tau}{\int \Psi^{*} \Psi d \tau}=\frac{\langle\Psi|\hat{F}| \Psi\rangle}{\langle\Psi \mid \Psi\rangle}</script><h2 id="假设5"><a href="#假设5" class="headerlink" title="假设5"></a>假设5</h2><h2 id="假设6"><a href="#假设6" class="headerlink" title="假设6"></a>假设6</h2>]]></content>
      <categories>
        <category>计算化学</category>
        <category>原理</category>
      </categories>
      <tags>
        <tag>变分法</tag>
      </tags>
  </entry>
  <entry>
    <title>光谱项</title>
    <url>/2020/11/11/%E5%85%89%E8%B0%B1%E9%A1%B9/</url>
    <content><![CDATA[<h1 id="双原子"><a href="#双原子" class="headerlink" title="双原子"></a>双原子</h1><h2 id="2S-1-Lambda-简单确定方法"><a href="#2S-1-Lambda-简单确定方法" class="headerlink" title="$^{2S+1}\Lambda$简单确定方法"></a>$^{2S+1}\Lambda$简单确定方法</h2><p>根据分子轨道占据来确定双原子的分子光谱项为$^{2S+1}\Lambda$：</p>
<ol>
<li>首先根据<script type="math/tex">S=\frac {|α_{电子数}-β_{电子数}|}{2}</script>确定$2S+1$</li>
<li>$\Lambda$的确定根据单电子所占据的轨道对应的序号进行加合，注意除了σ以外，其他分子轨道都有简并轨道，因此一个是$\lambda$，一个是$-\lambda$，比如eg.1和eg.2的区别</li>
</ol>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">$\lambda$</th>
<th style="text-align:center">0</th>
<th style="text-align:center">1</th>
<th style="text-align:center">2</th>
<th style="text-align:center">3</th>
<th style="text-align:center">4</th>
<th style="text-align:center">5</th>
<th style="text-align:center">6</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">分子轨道符号</td>
<td style="text-align:center">$\sigma$</td>
<td style="text-align:center">$\pi$</td>
<td style="text-align:center">$\delta$</td>
<td style="text-align:center">$\phi$</td>
<td style="text-align:center">$\gamma$</td>
<td style="text-align:center">$\eta$</td>
<td style="text-align:center">$\iota$</td>
</tr>
<tr>
<td style="text-align:center">$\Lambda$</td>
<td style="text-align:center">$\Sigma$</td>
<td style="text-align:center">$\Pi$</td>
<td style="text-align:center">$\Delta$</td>
<td style="text-align:center">$\Phi$</td>
<td style="text-align:center">$\Gamma$</td>
<td style="text-align:center">$H$</td>
<td style="text-align:center">$I$</td>
</tr>
</tbody>
</table>
</div>
<p>当电子态为$\Sigma$时：</p>
<ul>
<li>波函数关于键轴的平面$σ_{xz}$为对称需要用$+$表示，反对称用$-$表示。<ul>
<li>简单判断方法是简并轨道中有一个轨道是关于σ<sub>xz</sub>对称（假设为+$\lambda$），一个是关于σ<sub>yz</sub>（即关于σ<sub>xz</sub>反对称，假设为-$\lambda$）。规定占据并且+$\lambda$↑为+，改变一个因素乘负号，则+$\lambda$↓、-$\lambda$↑为-，-$\lambda$↓为正，然后多个$\lambda$相乘，最后得到正负号。</li>
</ul>
</li>
<li>对于同核双原子分子，如果关于对称中心$i$对称用$g$，反对称用$u$表示。</li>
</ul>
<p><strong>例子：$\phi^1\delta^1\pi^1$</strong>（用——依次分别代表+$\lambda$和-$\lambda$）</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">eg.</th>
<th style="text-align:center">$\phi^1$</th>
<th style="text-align:center">$\delta^1$</th>
<th style="text-align:center">$\pi^1$</th>
<th style="text-align:center">$\Lambda$</th>
<th style="text-align:center">$σ_{xz}$</th>
<th style="text-align:center">分子光谱项</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">↑—</td>
<td style="text-align:center">↑—</td>
<td style="text-align:center">↑—</td>
<td style="text-align:center">$3+2+1=6=I$</td>
<td style="text-align:center"></td>
<td style="text-align:center">$^4I$</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">↑—</td>
<td style="text-align:center">↑—</td>
<td style="text-align:center">—↑</td>
<td style="text-align:center">$3+2-1=5=H$</td>
<td style="text-align:center"></td>
<td style="text-align:center">$^4H$</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">↑—</td>
<td style="text-align:center">—↑</td>
<td style="text-align:center">—↑</td>
<td style="text-align:center">$3-2-1=0=\Sigma$</td>
<td style="text-align:center"><script type="math/tex">+*-*-=+</script></td>
<td style="text-align:center">$^4\Sigma^+$</td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td style="text-align:center">—↑</td>
<td style="text-align:center">↑—</td>
<td style="text-align:center">↑—</td>
<td style="text-align:center">$-3+2+1=0=\Sigma$</td>
<td style="text-align:center"><script type="math/tex">-*+*+=-</script></td>
<td style="text-align:center">$^4\Sigma^-$</td>
</tr>
<tr>
<td style="text-align:center">5</td>
<td style="text-align:center">↑—</td>
<td style="text-align:center">—↑</td>
<td style="text-align:center">↓—</td>
<td style="text-align:center">$3-2+1=2=\Delta$</td>
<td style="text-align:center"></td>
<td style="text-align:center">$^2\Delta$</td>
</tr>
<tr>
<td style="text-align:center">6</td>
<td style="text-align:center">—↑</td>
<td style="text-align:center">↑—</td>
<td style="text-align:center">↓—</td>
<td style="text-align:center">$-3+2+1=0=\Sigma$</td>
<td style="text-align:center"><script type="math/tex">-*+*-=+</script></td>
<td style="text-align:center">$^2\Sigma^+$</td>
</tr>
<tr>
<td style="text-align:center">7</td>
<td style="text-align:center">—↑</td>
<td style="text-align:center">↓—</td>
<td style="text-align:center">↓—</td>
<td style="text-align:center">$-3+2+1=0=\Sigma$</td>
<td style="text-align:center"><script type="math/tex">-*-*-=-</script></td>
<td style="text-align:center">$^2\Sigma^-$</td>
</tr>
</tbody>
</table>
</div>
<p>例子：O<sub>2</sub></p>
<ul>
<li>$^3\Sigma^-_g$：$1-1=0=\Sigma$，$+*-=-$</li>
<li>$^1\Sigma^+_g$：$1-1=0=\Sigma$，$+*+=+$</li>
</ul>
<p><img src="1.png" alt=""></p>
<h2 id="2S-1-Lambda-Omega-中-Omega-的确定"><a href="#2S-1-Lambda-Omega-中-Omega-的确定" class="headerlink" title="$^{2S+1}\Lambda_\Omega$中$\Omega$的确定"></a>$^{2S+1}\Lambda_\Omega$中$\Omega$的确定</h2><p>$\Omega$为$\pm{(S+\Lambda)}$，$\pm{(S+\Lambda-1)}$……一共$2(S+\Lambda)+1$项</p>
<p>例子：$^4H$中$S+\Lambda=\frac{3}{2}+5=\frac{13}{2}$，则$\Omega$为$\pm\frac{13}{2}$，$\pm\frac{11}{2}$，$\pm\frac{9}{2}$，$\pm\frac{7}{2}$，$\pm\frac{5}{2}$，$\pm\frac{3}{2}$，$\pm\frac{1}{2}$一共14项。</p>
<h1 id="单原子"><a href="#单原子" class="headerlink" title="单原子"></a>单原子</h1><h2 id="等价电子原子光谱"><a href="#等价电子原子光谱" class="headerlink" title="等价电子原子光谱"></a>等价电子原子光谱</h2><script type="math/tex; mode=display">
^{2S+1}L_J</script><ol>
<li>首先根据<script type="math/tex">S=\frac {|α_{电子数}-β_{电子数}|}{2}</script>确定$2S+1$（即单电子数+1）</li>
<li>轨道角动量量子数L等于每个电子的轨道角量子数矢量和（电子从最高的轨道角量子数的轨道开始占据），根据<script type="math/tex">l</script>和确定符号，再确定J=L-S</li>
</ol>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">L(l之和)</th>
<th style="text-align:center">0</th>
<th style="text-align:center">1</th>
<th style="text-align:center">2</th>
<th style="text-align:center">3</th>
<th style="text-align:center">4</th>
<th style="text-align:center">5</th>
<th style="text-align:center">6</th>
<th style="text-align:center">7</th>
<th style="text-align:center">8</th>
<th style="text-align:center">9</th>
<th style="text-align:center">10</th>
<th style="text-align:center">11</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><strong>符号</strong></td>
<td style="text-align:center"><strong>S</strong></td>
<td style="text-align:center"><strong>P</strong></td>
<td style="text-align:center"><strong>D</strong></td>
<td style="text-align:center"><strong>F</strong></td>
<td style="text-align:center"><strong>G</strong></td>
<td style="text-align:center"><strong>H</strong></td>
<td style="text-align:center"><strong>I</strong></td>
<td style="text-align:center"><strong>K</strong></td>
<td style="text-align:center"><strong>L</strong></td>
<td style="text-align:center"><strong>M</strong></td>
<td style="text-align:center"><strong>N</strong></td>
<td style="text-align:center"><strong>O</strong></td>
</tr>
</tbody>
</table>
</div>
<p><strong>例子：</strong></p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center">U(II)<script type="math/tex">[Rn]5f^4</script></th>
<th style="text-align:center">U(III)<script type="math/tex">[Rn]5f^3</script></th>
<th style="text-align:center">U(IV)<script type="math/tex">[Rn]5f^2</script></th>
<th style="text-align:center">U(V)<script type="math/tex">[Rn]5f^1</script></th>
<th style="text-align:center">U(VI)<script type="math/tex">[Rn]5f^0</script></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">L</td>
<td style="text-align:center">3+2+1+0=6</td>
<td style="text-align:center">3+2+1=6</td>
<td style="text-align:center">3+2=5</td>
<td style="text-align:center">3</td>
<td style="text-align:center">0</td>
</tr>
<tr>
<td style="text-align:center">L-S</td>
<td style="text-align:center">6-2=4</td>
<td style="text-align:center">6-3/2=9/2</td>
<td style="text-align:center">5-1=4</td>
<td style="text-align:center">3-1/2=5/2</td>
<td style="text-align:center">0-0=0</td>
</tr>
<tr>
<td style="text-align:center"><script type="math/tex">^{2S+1}L_J</script></td>
<td style="text-align:center"><script type="math/tex">^5I_4</script></td>
<td style="text-align:center"><script type="math/tex">^4I_{9/2}</script></td>
<td style="text-align:center"><script type="math/tex">^3H_4</script></td>
<td style="text-align:center"><script type="math/tex">^2F_{5/2}</script></td>
<td style="text-align:center"><script type="math/tex">^1S_0</script></td>
</tr>
</tbody>
</table>
</div>
]]></content>
      <categories>
        <category>计算化学</category>
        <category>原理</category>
      </categories>
      <tags>
        <tag>光谱项</tag>
      </tags>
  </entry>
  <entry>
    <title>多组态MCSCF</title>
    <url>/2020/11/20/%E5%A4%9A%E7%BB%84%E6%80%81MCSCF/</url>
    <content><![CDATA[<h1 id="与CI的区别"><a href="#与CI的区别" class="headerlink" title="与CI的区别"></a>与CI的区别</h1><p>CI：</p>
<script type="math/tex; mode=display">
\Psi^{C I}=\sum_{P} C_{P} \Phi_{P}</script><p>MCSCF：</p>
<script type="math/tex; mode=display">
\Psi^{M C S C F}=\sum_{k=0}^{\operatorname{CSF}_{s}} A_{k} \Phi_{k}</script><ul>
<li>CI解决的是动态相关，MCSCF解决的是静态相关</li>
<li>通过变分法求得<script type="math/tex">C_P</script>，只优化系数。MCSCF中N电子的CSF为：<script type="math/tex">\Phi_{k}=\hat{A}\left|\phi_{1} \bar{\phi}_{1} \ldots \phi_{m} \bar{\phi}_{m}\right|</script>，单电子轨道为：<script type="math/tex">\phi_{i}=\sum_{\mu} \chi_{\mu} C_{\mu i}</script>，除了优化系数<script type="math/tex">A_{k}</script>，还会优化轨道，即<script type="math/tex">C_{\mu i}</script>。</li>
<li>CASSCF中相当于在所选的活性空间中有一个Full CI并优化了所选的轨道。</li>
</ul>
]]></content>
      <categories>
        <category>计算化学</category>
        <category>原理</category>
      </categories>
      <tags>
        <tag>MCSCF</tag>
      </tags>
  </entry>
  <entry>
    <title>组态相互作用CI</title>
    <url>/2020/11/20/%E7%BB%84%E6%80%81%E7%9B%B8%E4%BA%92%E4%BD%9C%E7%94%A8CI/</url>
    <content><![CDATA[<h1 id="分子的电子组态"><a href="#分子的电子组态" class="headerlink" title="分子的电子组态"></a>分子的电子组态</h1><p>Configuration State Functions (CSF)</p>
<h1 id="分子波函数的组态展开"><a href="#分子波函数的组态展开" class="headerlink" title="分子波函数的组态展开"></a>分子波函数的组态展开</h1><p>在从头算中，基组态<script type="math/tex">\Phi_o</script>用作基态分子的状态波函数,这是最粗略的描述方式。欲求更精确的表达,应把波函数写成相同自旋本征值的组态函数的线性组合：</p>
<script type="math/tex; mode=display">
\begin{aligned}
\Psi^{\mathrm{CI}} &=\sum_{P} C_{P} \Phi_{P} \\
&=C_{0} \Phi_{0}+\sum_{i}^{o c c} \sum_{a}^{v i t t} C_{i}^{a} \Phi_{i}^{a}+\sum_{i j}^{o c c} \sum_{a b}^{v i r t} C_{i j}^{a b} \Phi_{i j}^{a b}+\sum_{i j k}^{o c c} \sum_{a b c}^{v i j t} C_{i j k}^{a b c} \Phi_{i j k}^{a b c}+\cdots
\end{aligned}</script><ul>
<li>i，j，k代表占据轨道；a，b，c代表空轨道；Φ为行列式。依次为基态波函数、单激发行列式、双激发行列式、三激发</li>
<li>组态相互作用：每一个行列式都可以叫做组态。CI即各种各样的组态做一个线性组合来描述，一组合就表示产生了相互作用</li>
</ul>
<h1 id="CI的自洽场计算"><a href="#CI的自洽场计算" class="headerlink" title="CI的自洽场计算"></a>CI的自洽场计算</h1><p>CI方法是将实际的多电子波函数用HF波函数及各种激发行列式作为多电子基函数来线性展开，通过变分方法求解展开系数，并得到对应的能量。</p>
<h2 id="变分法"><a href="#变分法" class="headerlink" title="变分法"></a>变分法</h2><script type="math/tex; mode=display">
\Psi^{C I}=\sum_{P} C_{P} \Phi_{P}</script><p>分子体系的总电子能量：<script type="math/tex">E^{\mathrm{CI}}=\frac{\left\langle\Psi^{\mathrm{CI}}|\hat{H}| \Psi^{\mathrm{CI}}\right\rangle}{\left\langle\Psi^{\mathrm{CI}} \mid \Psi^{\mathrm{CI}}\right\rangle}</script>，其中<script type="math/tex">\hat{H}=\sum_{i} \hat{h}_{i}+\sum_{i<j} \frac{1}{r_{i j}}</script></p>
<p>定义CI矩阵元：<script type="math/tex">H_{P Q}=\left\langle\Phi_{P}|\hat{H}|\Phi_{Q}\right\rangle
\quad S_{P Q}=\left\langle\Phi_{P} \mid \Phi_{Q}\right\rangle</script></p>
<script type="math/tex; mode=display">
\begin{aligned}
E^{\mathrm{CI}} &=\frac{\left\langle\Psi^{\mathrm{CI}}|\hat{H}| \Psi^{\mathrm{CI}}\right\rangle}{\left\langle\Psi^{\mathrm{CI}} \mid \Psi^{\mathrm{CI}}\right\rangle}=\frac{\left\langle\sum_{p=1}^{n} c_{p} \Phi_{p}|\hat{H}| \sum_{q=1}^{n} c_{q} \Phi_{q}\right\rangle}{\left\langle\sum_{p=1}^{n} c_{p} \Phi_{p} \mid \sum_{q=1}^{n} c_{q} \Phi_{q}\right\rangle} \\
&= \frac{\sum_{p=1}^{n} \sum_{q=1}^{n} c_{p} c_{q}\left\langle\Phi_{p}|\hat{H}| \Phi_{q}\right\rangle}{\sum_{p=1}^{n} \sum_{q=1}^{n} c_{p} c_{q}\left\langle\Phi_{p} \mid \Phi_{q}\right\rangle}=\frac{\sum_{p=1}^{n} \sum_{q=1}^{n} c_{p} c_{q} \mathrm{H}_{p q}}{\sum_{p=1}^{n} \sum_{q=1}^{n} c_{p} c_{q} S_{p q}}
\end{aligned}</script><p>最小的<script type="math/tex">E^{CI}</script>对应的<script type="math/tex">{C_P}</script>可以通过在<script type="math/tex">\{\Phi_P\}</script>定义的组态空间中（轨道空间是<script type="math/tex">\{\psi_k\}</script>）使用变分法（<script type="math/tex">\delta E^{CI}</script>）得到。</p>
<p>构成组态空间<script type="math/tex">\{\Phi_P\}</script>的轨道空间MO波函数是正交归一的：<script type="math/tex">\left\langle\psi_{\mu} \mid \psi_{\nu}\right\rangle=\delta_{\mu \nu}</script>，</p>
<p>组态空间<script type="math/tex">\{\Phi_P\}</script> 也是正交归一的：<script type="math/tex">\left\langle\Phi_{P} \mid \Phi_{Q}\right\rangle=\delta_{P Q}</script></p>
<script type="math/tex; mode=display">
\sum_{p=1}^{n} \sum_{q=1}^{n} c_{p} c_{q}\left(H_{p q}-E^{C I} S_{p q}\right)=0\\
\frac{\partial E^{C I}}{\partial c_{r}}=0 \quad \rightarrow \quad \sum_{p=1}^{n}\left(H_{p q}-E^{C I} \delta_{p q}\right) c_{p}=0</script><p>线性变分所得出的<script type="math/tex">\{C_P\}</script>列向量满足久期方程：<script type="math/tex">\boldsymbol{H} \boldsymbol{C}=E^{CI} \boldsymbol{C}</script></p>
<p>解此本征值方程即可求出Cl波函数和能量。</p>
<h2 id="SCF-CI处理步骤"><a href="#SCF-CI处理步骤" class="headerlink" title="SCF-CI处理步骤"></a>SCF-CI处理步骤</h2><ol>
<li><p>HF-SCF MO计算（简单从头算）</p>
</li>
<li><p>在组态空间<script type="math/tex">\{\Phi_P\}</script>形成电子总哈密顿矩阵<script type="math/tex">\mathbf{H}=\{H_{pq}\}</script></p>
</li>
<li><p>对角化<script type="math/tex">\boldsymbol{H}</script>矩阵求得CI能级和波函数：<script type="math/tex">\mathbf{C}^{+} \mathbf{H C}=\mathbf{E}^{\mathrm{CI}}</script></p>
<p>产生：</p>
<script type="math/tex; mode=display">
\begin{array}{l}
E_{0}^{C I} \leq E_{1}^{C I} \leq E_{2}^{C I} \leq \cdots \\
\Psi_{0}^{C I}, \Psi_{1}^{C I}, \Psi_{2}^{C I}, \cdots
\end{array}</script><p>其中<script type="math/tex">\Psi_{0}^{C I}</script>对应基态，<script type="math/tex">\{\Psi_{k}^{CI},k=1,2,\cdots\}</script>对应第<script type="math/tex">k</script>个激发态</p>
</li>
</ol>
<ul>
<li><p>矩阵在正交变换前后阵迹不变：<script type="math/tex">\sum_{\mu} E_{\mu}^{C I}=\operatorname{Tr} \mathbf{H}</script></p>
</li>
<li><p>变分结果使低能量组态能级降低,高能量组态能级升高：</p>
<p><img src="image-20201120152427635.png" style="zoom:50%;" /></p>
</li>
<li><p>因此CISD处理可改善分子基态和低激发态的能量和波函数,但对高激发态效果不佳(需要T,Q,P,…等激发组态)</p>
</li>
</ul>
<h1 id="CI处理的分类"><a href="#CI处理的分类" class="headerlink" title="CI处理的分类"></a>CI处理的分类</h1><p>纳入越高阶激发行列式，由于可以越准确地展开实际体系多电子波函数，CI的结果也就越准确。考虑所有可能的激发行列式时称为Full CI（有n个电子就考虑到n重激发态就考虑到最高阶），是理论方法的完美极限。但由于Full CI计算量极大，实际CI计算用的都是截断的CI(Truncated CI)，越高阶精度越高耗时也越高：</p>
<ul>
<li>CIS：仅考虑全部单电子激发组态的CI处理。对基态能量无修正作用，只能算激发态，可修正若干低激发态。常用于激发态分子的几何优化计算和光化学反应及其反应途径的计算</li>
<li>CID：考虑HF波函数及二重激发行列式</li>
<li>CISD：考虑HF波函数及单重、 二重激发行列式。可修正基态相关能~90%（基组须足够大，下同）</li>
<li>CISDT：考虑HF波函数及单重、 二重、三重激发行列式。可修正基态相关能~95%（&lt;20个电子）</li>
<li>CISD (T)：CISD+部分贡献大的三电子激发组态，精度与CISDT接近。（30-40个电子）</li>
<li>CISD(TQ)：CISD (T)+部分四重激发组态，可校正相关能 98 %%，计算量很大，（&lt;10 的体系）</li>
</ul>
<h1 id="评价"><a href="#评价" class="headerlink" title="评价"></a>评价</h1><p>计算量太大、包含了很多没有贡献的构型，效率低。同样计算量下，CI的结果不如微扰、耦合簇，因此很不划算，很少被直接使用计算基态性质。</p>
<ul>
<li>Size consistency：碎片的计算误差与结合后的整体的计算误差可以抵消</li>
<li>Size extensivity：多电子与少电子的误差要一致。</li>
</ul>
<p>大小一致性很重要，若计算方法不具备大小一致性，结合能、电离能等无法比较，无法准确计算。HF、MBPT、CC和FCI具有大小一致性，而截断的CI不具有，可以通过Davisaon校正，即CISD+Q。</p>
]]></content>
      <categories>
        <category>计算化学</category>
        <category>原理</category>
      </categories>
      <tags>
        <tag>CI</tag>
      </tags>
  </entry>
  <entry>
    <title>html基础</title>
    <url>/2020/12/25/html%E5%9F%BA%E7%A1%80/</url>
    <content><![CDATA[<h1 id="HTML简介"><a href="#HTML简介" class="headerlink" title="HTML简介"></a>HTML简介</h1><ul>
<li>HTML 不是一种编程语言，指的是超文本标记语言 (<strong>H</strong>yper <strong>T</strong>ext <strong>M</strong>arkup <strong>L</strong>anguage)。标记语言是一套标记标签 (markup tag)，即使用标记标签来描述网页</li>
<li>保存 HTML 文件时，既可以使用 <code>.htm</code> 也可以使用 <code>.html</code> 扩展名。两者没有区别’</li>
<li>HTML文档也叫做 web 页面</li>
</ul>
<h1 id="HTML基本结构"><a href="#HTML基本结构" class="headerlink" title="HTML基本结构"></a>HTML基本结构</h1><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">title</span>&gt;</span>网页的标题<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"> 		<span class="tag">&lt;<span class="name">h1</span>&gt;</span>我的第一个标题<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"> 		<span class="tag">&lt;<span class="name">p</span>&gt;</span>我的第一个段落。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"> 	<span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="lt-DOCTYPE-gt"><a href="#lt-DOCTYPE-gt" class="headerlink" title="&lt;!DOCTYPE&gt;"></a><code>&lt;!DOCTYPE&gt;</code></h2><ul>
<li>用于声明网页版本，不区分大小写</li>
<li><p><code>&lt;!DOCTYPE&gt;</code> 声明位于文档中的最前面的位置，处于<code>&lt;html&gt;</code>标签之前。</p>
</li>
<li><p>HTML5（2012年发布）</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>HTML 4.01（1999年发布）</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">HTML</span> <span class="meta-keyword">PUBLIC</span> <span class="meta-string">&quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">&quot;http://www.w3.org/TR/html4/loose.dtd&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>XHTML 1.0（2020年发布）</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span> <span class="meta-keyword">PUBLIC</span> <span class="meta-string">&quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot;</span></span></span><br><span class="line"><span class="meta"><span class="meta-string">&quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="lt-html-gt"><a href="#lt-html-gt" class="headerlink" title="&lt;html&gt;"></a><code>&lt;html&gt;</code></h2><ul>
<li>HTML页面的根元素，<code>&lt;html&gt;</code> 标签告知浏览器这是一个 HTML 文档。</li>
<li>是 HTML 文档中最外层的元素。</li>
<li>是所有其他 HTML 元素（除了 &lt;!DOCTYPE&gt; 标签）的容器。</li>
</ul>
<h3 id="lt-head-gt"><a href="#lt-head-gt" class="headerlink" title="&lt;head&gt;"></a><code>&lt;head&gt;</code></h3><ul>
<li><code>&lt;head&gt;</code> 元素包含了所有的头部标签元素。在 <code>&lt;head&gt;</code>元素中你可以插入脚本（scripts）, 样式文件（CSS），及各种meta信息。</li>
<li>可以添加在头部区域的元素标签为: <code>&lt;title&gt;</code>, <code>&lt;style&gt;</code>, <code>&lt;meta&gt;</code>, <code>&lt;link&gt;</code>, <code>&lt;script&gt;</code>, <code>&lt;noscript&gt;</code> 和 <code>&lt;base&gt;</code>。</li>
</ul>
<h4 id="lt-meta-gt"><a href="#lt-meta-gt" class="headerlink" title="&lt;meta&gt;"></a><code>&lt;meta&gt;</code></h4><ul>
<li>描述了一些基本的元数据。元数据也不显示在页面上，但会被浏览器解析。</li>
<li>通常用于指定网页的描述，关键词，文件的最后修改时间，作者，和其他元数据。</li>
<li><p>元数据可以使用于浏览器（如何显示内容或重新加载页面），搜索引擎（关键词），或其他Web服务。</p>
</li>
<li><p>对于中文网页需要使用 <code>&lt;meta charset=&quot;utf-8&quot;&gt;</code> 定义网页编码格式为 utf-8，否则会出现乱码。</p>
</li>
<li><p>有些浏览器会设置 GBK 为默认编码，则需要设置为 <code>&lt;meta charset=&quot;gbk&quot;&gt;</code></p>
</li>
<li><p>为搜索引擎定义关键词:</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;keywords&quot;</span> <span class="attr">content</span>=<span class="string">&quot;HTML, CSS, XML, XHTML, JavaScript&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>为网页定义描述内容：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;description&quot;</span> <span class="attr">content</span>=<span class="string">&quot;免费 Web &amp; 编程 教程&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>定义网页作者：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;author&quot;</span> <span class="attr">content</span>=<span class="string">&quot;Runoob&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>每30秒钟刷新当前页面:</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;refresh&quot;</span> <span class="attr">content</span>=<span class="string">&quot;30&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="lt-title-gt"><a href="#lt-title-gt" class="headerlink" title="&lt;title&gt;"></a><code>&lt;title&gt;</code></h4><ul>
<li>描述了文档的标题，是不可少的</li>
<li>当网页添加到收藏夹时，显示在收藏夹中的标题</li>
<li>显示在搜索引擎结果页面的标题</li>
</ul>
<h4 id="lt-base-gt"><a href="#lt-base-gt" class="headerlink" title="&lt;base&gt;"></a><code>&lt;base&gt;</code></h4><ul>
<li><p>描述了基本的链接地址/链接目标，该标签作为HTML文档中所有的链接标签的默认链接</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">base</span> <span class="attr">href</span>=<span class="string">&quot;http://www.runoob.com/images/&quot;</span> <span class="attr">target</span>=<span class="string">&quot;_blank&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="lt-link-gt"><a href="#lt-link-gt" class="headerlink" title="&lt;link&gt;"></a><code>&lt;link&gt;</code></h4><ul>
<li><p>定义了文档与外部资源之间的关系，通常用于链接到样式表</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span> <span class="attr">href</span>=<span class="string">&quot;mystyle.css&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="lt-style-gt"><a href="#lt-style-gt" class="headerlink" title="&lt;style&gt;"></a><code>&lt;style&gt;</code></h4><ul>
<li><p>定义了HTML文档的样式文件引用地址</p>
</li>
<li><p>也可以直接添加样式来渲染 HTML 文档</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span>&gt;</span></span><br><span class="line"><span class="css"><span class="selector-tag">body</span> &#123;<span class="attribute">background-color</span>:yellow&#125;</span></span><br><span class="line"><span class="css"><span class="selector-tag">p</span> &#123;<span class="attribute">color</span>:blue&#125;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="lt-script-gt"><a href="#lt-script-gt" class="headerlink" title="&lt;script&gt;"></a><code>&lt;script&gt;</code></h4><ul>
<li>用于加载脚本文件，如： JavaScript。</li>
</ul>
<h3 id="lt-body-gt"><a href="#lt-body-gt" class="headerlink" title="&lt;body&gt;"></a><code>&lt;body&gt;</code></h3><p>包含可见的页面内容，只有<code>&lt;body&gt;</code>部分才会在浏览器中显示。</p>
<h1 id="HTML标签-元素"><a href="#HTML标签-元素" class="headerlink" title="HTML标签/元素"></a>HTML标签/元素</h1><h2 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h2><ul>
<li><p>HTML标签是由尖括号包围的关键词，通常是成对出现的。标签对中的第一个标签是开始标签，第二个标签是结束标签。</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">标签</span>&gt;</span>内容<span class="tag">&lt;/<span class="name">标签</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>开始标签常被称为起始标签（opening tag）</li>
<li>结束标签常称为闭合标签（closing tag）</li>
</ul>
</li>
<li><p>HTML 标签=HTML 元素，但是严格来讲, 一个HTML元素包含了开始标签、内容和结束标签。</p>
</li>
</ul>
<ul>
<li>没有内容的 HTML 元素被称为空元素，不需要闭合标签，但是最好在开始标签中关闭空元素，用<code>&lt; /&gt;</code>封装。</li>
<li>HTML标签对大小写不敏感，但是最好用小写。</li>
<li>大多数HTML元素可以嵌套（HTML元素可以包含其他 HTML 元素）。</li>
</ul>
<h2 id="元素分类"><a href="#元素分类" class="headerlink" title="元素分类"></a>元素分类</h2><h3 id="块状元素"><a href="#块状元素" class="headerlink" title="块状元素"></a>块状元素</h3><ul>
<li><code>&lt;div&gt;</code>、<code>&lt;p&gt;</code>、<code>&lt;h1&gt;</code>、<code>&lt;ol&gt;</code>、<code>&lt;ul&gt;</code>、<code>&lt;dl&gt;</code>、<code>&lt;table&gt;</code>、<code>&lt;address&gt;</code>、<code>&lt;blockquote&gt;</code>, <code>&lt;form&gt;</code><ul>
<li>每个块级元素都从新的一行开始，并且其后的元素也另起一行。</li>
<li>元素的高度、宽度、行高以及顶和底边距都可设置。</li>
<li>元素宽度在不设置的情况下，是它本身父容器的100%(和父元素的宽度一致），除非设定一个宽度。</li>
</ul>
</li>
</ul>
<h3 id="内联元素-行内元素"><a href="#内联元素-行内元素" class="headerlink" title="内联元素(行内元素)"></a>内联元素(行内元素)</h3><ul>
<li><code>&lt;a&gt;</code>、<code>&lt;span&gt;</code>、<code>&lt;br&gt;</code>、<code>&lt;i&gt;</code>、<code>&lt;em&gt;</code>、<code>&lt;strong&gt;</code>、<code>&lt;label&gt;</code>、<code>&lt;q&gt;</code>、<code>&lt;Var&gt;</code>、<code>&lt;cite&gt;</code>、<code>&lt;code&gt;</code><ul>
<li>和其他元素都在一行上。</li>
<li>元素的高度、宽度及顶部和底部边距不可设置。</li>
<li>元素的宽度就是它包含的文字或图片的宽度，不可改变。</li>
</ul>
</li>
</ul>
<h3 id="内联块状元素"><a href="#内联块状元素" class="headerlink" title="内联块状元素"></a>内联块状元素</h3><ul>
<li><code>&lt;img&gt;</code>、<code>&lt;input&gt;</code><ul>
<li>和其他元素都在一行上。</li>
<li>元素的高度、宽度、行高以及顶和底边距都可设置。</li>
</ul>
</li>
</ul>
<h2 id="基本标签"><a href="#基本标签" class="headerlink" title="基本标签"></a>基本标签</h2><h3 id="标题"><a href="#标题" class="headerlink" title="标题"></a>标题</h3><ul>
<li><p>通过 <code>&lt;h1&gt;</code> - <code>&lt;h6&gt;</code> 标签进行定义，由大到小，字体会加粗，大小也会由大到小。但是不要为了生成粗体或大号的文本而使用标题，因为搜索引擎会使用标题为网页的结构和内容编制索引。</p>
</li>
<li><p>浏览器会自动地在标题的前后添加空行。</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>这是一个标题<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h2</span>&gt;</span>这是一个标题<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h3</span>&gt;</span>这是一个标题<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="段落"><a href="#段落" class="headerlink" title="段落"></a>段落</h3><ul>
<li><p>通过<code>&lt;p&gt;</code>定义HTML 文档中的一个段落。</p>
</li>
<li><p>浏览器会自动地在段落的前后添加空行。（<code>&lt;/p&gt;</code> 是块级元素）</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>这是一个段落。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>这是另外一个段落。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>无法通过在HTML元素的内容中添加额外的空格或换行来改变输出的效果。</p>
<ul>
<li><p>当显示页面时，浏览器会移除源代码中多余的空格和空行。所有连续的空格或空行都会被算作一个空格。</p>
</li>
<li><p>所有连续的空行（换行）也被显示为一个空格。如果需要换行，需要用<code>&lt;br&gt;</code>。</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>这个<span class="tag">&lt;<span class="name">br</span>&gt;</span>段落<span class="tag">&lt;<span class="name">br</span>&gt;</span>演示了分行的效果<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>如果需要控制空行和空格，也可以使用定义预格式文本的标签<code>&lt;pre&gt;</code></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">pre</span>&gt;</span></span><br><span class="line">使用 pre 标签</span><br><span class="line">对空行和    空格</span><br><span class="line">进行控制</span><br><span class="line"><span class="tag">&lt;/<span class="name">pre</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h4 id="换行"><a href="#换行" class="headerlink" title="换行"></a>换行</h4><ul>
<li><p>可以在不产生一个新段落的情况下进行换行，即和上一行之间不会有空行。</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 没有关闭标签的空元素 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 关闭空元素 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="分割线"><a href="#分割线" class="headerlink" title="分割线"></a>分割线</h4><ul>
<li><p>可用于分隔内容</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>这是一个段落。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">hr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>这是一个段落。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">hr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>这是一个段落。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="链接"><a href="#链接" class="headerlink" title="链接"></a>链接</h3><ul>
<li><p>通过<code>a</code>来定义HTML链接，超链接可以是一个字，一个词，或者一组词，也可以是一幅图像，您可以点击这些内容来跳转到新的文档或者当前文档中的某个部分。</p>
</li>
<li><p>链接的地址在<code>href</code>属性中指定：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;https://www.runoob.com&quot;</span>&gt;</span>这是一个链接<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>如果希望链接在新窗口打开，则可以将 target 属性设置为 “_blank”：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;https://www.runoob.com/&quot;</span> <span class="attr">target</span>=<span class="string">&quot;_blank&quot;</span> <span class="attr">rel</span>=<span class="string">&quot;noopener noreferrer&quot;</span>&gt;</span>访问菜鸟教程!<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>空链接，点击空链接会返回顶部，实际上等于刷新了该页面</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span>&gt;</span>空链接<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>如果在当前页面链接到指定位置，则可以使用<code>id</code>或者<code>name</code>属性</p>
<ul>
<li><p>首先给要访问的地方加一个属性</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">id</span>=<span class="string">&quot;tips&quot;</span>&gt;</span>有用的提示部分<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>在HTML文档中创建一个链接到此处</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#tips&quot;</span>&gt;</span>访问有用的提示部分<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>也可以访问另一个网页中的部分</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;https://www.runoob.com/html/html-links.html#tips&quot;</span>&gt;</span></span><br><span class="line">访问有用的提示部分<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>发送邮件</p>
<ul>
<li><p><code>Subject</code>后面跟的是邮件的主题</p>
</li>
<li><p>单词之间的空格使用<code>%20</code>代替，以确保浏览器可以正常显示文本。</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">这是一个电子邮件链接：</span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;mailto:someone@example.com?Subject=Hello%20again&quot;</span> <span class="attr">target</span>=<span class="string">&quot;_top&quot;</span>&gt;</span></span><br><span class="line">发送邮件<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><code>cc</code>后面跟的是抄送地址</p>
</li>
<li><p><code>bcc</code>后面跟的是密件抄送</p>
</li>
<li><p><code>body</code>后面跟的是邮件内容</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">这是另一个电子邮件链接：</span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;mailto:someone@example.com?cc=someoneelse@example.com&amp;bcc=andsomeoneelse@example.com&amp;subject=Summer%20Party&amp;body=You%20are%20invited%20to%20a%20big%20summer%20party!&quot;</span> <span class="attr">target</span>=<span class="string">&quot;_top&quot;</span>&gt;</span>发送邮件!<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">b</span>&gt;</span>注意:<span class="tag">&lt;/<span class="name">b</span>&gt;</span> 单词之间的空格使用 %20 代替，以确保浏览器可以正常显示文本。</span><br><span class="line"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h3 id="图像"><a href="#图像" class="headerlink" title="图像"></a>图像</h3><ul>
<li><p>通过标签<code>img</code>来定义，<code>&lt;img&gt;</code> 是空标签，意思是说，它只包含属性，并且没有闭合标签。</p>
</li>
<li><p>要在页面上显示图像，你需要使用源属性（src）。src 指 “source”。源属性的值是图像的 URL 地址。语法：</p>
<ul>
<li>URL 指存储图像的位置。加载页面时，要注意插入页面图像的路径，如果不能正确设置图像的位置，浏览器无法加载图片，图像标签就会显示一个破碎的图片。</li>
<li>alt 属性用来为图像定义一串预备的可替换的文本</li>
</ul>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;url&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;some_text&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>height（高度） 与 width（宽度）属性用于设置图像的高度与宽度。 指定图像的高度和宽度是一个很好的习惯。如果图像指定了高度宽度，页面加载时就会保留指定的尺寸。如果没有指定图片的大小，加载页面时有可能会破坏HTML页面的整体布局。</p>
<ul>
<li>为了防止更改图片的比例，可以只设定高度或者宽度</li>
</ul>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;pulpit.jpg&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;Pulpit rock&quot;</span> <span class="attr">width</span>=<span class="string">&quot;304&quot;</span> <span class="attr">height</span>=<span class="string">&quot;228&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>图像的名称使用<code>title</code>定义，当鼠标悬停在图片时显示的内容</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">loading</span>=<span class="string">&quot;lazy&quot;</span> <span class="attr">src</span>=<span class="string">&quot;/images/logo.png&quot;</span> <span class="attr">width</span>=<span class="string">&quot;258&quot;</span> <span class="attr">height</span>=<span class="string">&quot;39&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>排列图片，用<code>align</code>。在HTML 4中 align 属性已废弃，HTML5 已不支持该属性，可以使用 CSS 代替。</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h4</span>&gt;</span>默认对齐的图像 (align=&quot;bottom&quot;):<span class="tag">&lt;/<span class="name">h4</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>这是一些文本。 <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;smiley.gif&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;Smiley face&quot;</span> <span class="attr">width</span>=<span class="string">&quot;32&quot;</span> <span class="attr">height</span>=<span class="string">&quot;32&quot;</span>&gt;</span> 这是一些文本。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">h4</span>&gt;</span>图片使用 align=&quot;middle&quot;:<span class="tag">&lt;/<span class="name">h4</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>这是一些文本。 <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;smiley.gif&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;Smiley face&quot;</span> <span class="attr">align</span>=<span class="string">&quot;middle&quot;</span> <span class="attr">width</span>=<span class="string">&quot;32&quot;</span> <span class="attr">height</span>=<span class="string">&quot;32&quot;</span>&gt;</span>这是一些文本。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">h4</span>&gt;</span>图片使用 align=&quot;top&quot;:<span class="tag">&lt;/<span class="name">h4</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>这是一些文本。 <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;smiley.gif&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;Smiley face&quot;</span> <span class="attr">align</span>=<span class="string">&quot;top&quot;</span> <span class="attr">width</span>=<span class="string">&quot;32&quot;</span> <span class="attr">height</span>=<span class="string">&quot;32&quot;</span>&gt;</span>这是一些文本。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><code>border</code>设置图片边框</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>创建图片链接:</span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;//www.runoob.com/html/html-tutorial.html&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">img</span>  <span class="attr">border</span>=<span class="string">&quot;10&quot;</span> <span class="attr">src</span>=<span class="string">&quot;smiley.gif&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;HTML 教程&quot;</span> <span class="attr">width</span>=<span class="string">&quot;32&quot;</span> <span class="attr">height</span>=<span class="string">&quot;32&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>用<code>usemap</code>和<code>&lt;map&gt;</code>（定义图像地图）创建带有可供点击区域的图像地图。其中的每个区域都是一个超级链接。<code>&lt;area&gt;</code> 定义图像地图中的可点击区域。</p>
<ul>
<li><code>shape</code>指的是点击区域的形状，<code>coords</code>指链接区域在图片中的坐标（像素为单位）<ul>
<li><code>rect</code>：矩形，(左上角顶点坐标为(x1,y1)，右下角顶点坐标为(x2,y2))</li>
<li><code>circle</code>：圆形：(圆心坐标为(X1,y1)，半径为r)</li>
<li><code>poly</code>：多边形：(各顶点坐标依次为(x1,y1)、(x2,y2)、(x3,y3) ……)</li>
</ul>
</li>
</ul>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>点击太阳或其他行星，注意变化：<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;planets.gif&quot;</span> <span class="attr">width</span>=<span class="string">&quot;145&quot;</span> <span class="attr">height</span>=<span class="string">&quot;126&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;Planets&quot;</span> <span class="attr">usemap</span>=<span class="string">&quot;#planetmap&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">map</span> <span class="attr">name</span>=<span class="string">&quot;planetmap&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">area</span> <span class="attr">shape</span>=<span class="string">&quot;rect&quot;</span> <span class="attr">coords</span>=<span class="string">&quot;0,0,82,126&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;Sun&quot;</span> <span class="attr">href</span>=<span class="string">&quot;sun.htm&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">area</span> <span class="attr">shape</span>=<span class="string">&quot;circle&quot;</span> <span class="attr">coords</span>=<span class="string">&quot;90,58,3&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;Mercury&quot;</span> <span class="attr">href</span>=<span class="string">&quot;mercur.htm&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">area</span> <span class="attr">shape</span>=<span class="string">&quot;circle&quot;</span> <span class="attr">coords</span>=<span class="string">&quot;124,58,8&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;Venus&quot;</span> <span class="attr">href</span>=<span class="string">&quot;venus.htm&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">map</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="注释"><a href="#注释" class="headerlink" title="注释"></a>注释</h3><ul>
<li><p>浏览器会忽略注释，也不会显示它们。开始括号之后（左边的括号）需要紧跟一个叹号，结束括号之前（右边的括号）不需要。</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 这是一个注释 --&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h1 id="HTML属性"><a href="#HTML属性" class="headerlink" title="HTML属性"></a>HTML属性</h1><h2 id="语法-1"><a href="#语法-1" class="headerlink" title="语法"></a>语法</h2><ul>
<li><p>属性值应该始终被包括在引号内，一般放在开始标签中，形式一般是<code>name=“value”</code>，</p>
</li>
<li><p>单引号也可以，如果属性值本身就含有双引号，必须使用单引号：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">name=&#x27;John &quot;ShotGun&quot; Nelson&#x27;</span><br></pre></td></tr></table></figure>
</li>
<li><p>属性和属性值对大小写不敏感，最好小写。</p>
</li>
</ul>
<h2 id="基本属性"><a href="#基本属性" class="headerlink" title="基本属性"></a>基本属性</h2><ul>
<li>class：为html元素定义一个或多个类名（classname）(类名从样式文件引入)</li>
<li>id：定义元素的唯一id</li>
<li>style：规定元素的行内样式（inline style）</li>
<li>title：描述了元素的额外信息 (作为工具条使用)</li>
</ul>
<h1 id="HTML文本格式化"><a href="#HTML文本格式化" class="headerlink" title="HTML文本格式化"></a>HTML文本格式化</h1><h2 id="粗体和斜体"><a href="#粗体和斜体" class="headerlink" title="粗体和斜体"></a>粗体和斜体</h2><ul>
<li>HTML使用标签 <code>&lt;b&gt;</code>(bold) 与 <code>&lt;i&gt;</code>(italic) 对文本加粗和斜体</li>
</ul>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">b</span>&gt;</span>加粗文本<span class="tag">&lt;/<span class="name">b</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">i</span>&gt;</span>斜体文本<span class="tag">&lt;/<span class="name">i</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>也可以用标签 <code>&lt;strong&gt;</code> , <code>&lt;em&gt;</code> 来加粗和斜体，这两个标签除了对文本格式化，还表示文本是重要的，所以要突出显示。</li>
</ul>
<h2 id="上下标"><a href="#上下标" class="headerlink" title="上下标"></a>上下标</h2><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">sub</span>&gt;</span> 下标<span class="tag">&lt;/<span class="name">sub</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">sup</span>&gt;</span> 上标<span class="tag">&lt;/<span class="name">sup</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="大小"><a href="#大小" class="headerlink" title="大小"></a>大小</h2><ul>
<li><code>&lt;small&gt;</code>定义小号字</li>
<li><code>&lt;big&gt;</code>定义大号字</li>
</ul>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">big</span>&gt;</span>这个文本字体放大<span class="tag">&lt;/<span class="name">big</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">small</span>&gt;</span>这个文本是缩小的<span class="tag">&lt;/<span class="name">small</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="计算机-编程代码"><a href="#计算机-编程代码" class="headerlink" title="计算机/编程代码"></a>计算机/编程代码</h2><ul>
<li><code>&lt;code&gt;</code>定义计算机代码</li>
<li><code>&lt;kbd&gt;</code>定义键盘码</li>
<li><code>&lt;samp&gt;</code>定义计算机代码样本</li>
<li><code>&lt;var&gt;</code>定义变量</li>
</ul>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">code</span>&gt;</span>计算机输出<span class="tag">&lt;/<span class="name">code</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">kbd</span>&gt;</span>键盘输入<span class="tag">&lt;/<span class="name">kbd</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">tt</span>&gt;</span>打字机文本<span class="tag">&lt;/<span class="name">tt</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">samp</span>&gt;</span>计算机代码样本<span class="tag">&lt;/<span class="name">samp</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">var</span>&gt;</span>计算机变量<span class="tag">&lt;/<span class="name">var</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="地址"><a href="#地址" class="headerlink" title="地址"></a>地址</h2><ul>
<li><code>&lt;address&gt;</code>定义地址</li>
</ul>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">address</span>&gt;</span></span><br><span class="line">Written by <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;mailto:webmaster@example.com&quot;</span>&gt;</span>Jon Doe<span class="tag">&lt;/<span class="name">a</span>&gt;</span>.<span class="tag">&lt;<span class="name">br</span>&gt;</span> </span><br><span class="line">Visit us at:<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">Example.com<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">Box 564, Disneyland<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">USA</span><br><span class="line"><span class="tag">&lt;/<span class="name">address</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="文字方向"><a href="#文字方向" class="headerlink" title="文字方向"></a>文字方向</h2><ul>
<li><code>&lt;bdo&gt;</code>定义文字方向</li>
</ul>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">bdo</span> <span class="attr">dir</span>=<span class="string">&quot;rtl&quot;</span>&gt;</span>该段落文字从右到左显示。<span class="tag">&lt;/<span class="name">bdo</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span> </span><br></pre></td></tr></table></figure>
<h2 id="块引用"><a href="#块引用" class="headerlink" title="块引用"></a>块引用</h2><ul>
<li><code>&lt;blockquote&gt;</code>定义长的引用</li>
<li><code>&lt;q&gt;</code>定义短的引用</li>
<li><code>&lt;cite&gt;</code>定义引用、引证</li>
<li><code>&lt;dfn&gt;</code>定义一个定义项目。</li>
</ul>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>WWF&#x27;s goal is to: </span><br><span class="line"><span class="tag">&lt;<span class="name">q</span>&gt;</span>Build a future where people live in harmony with nature.<span class="tag">&lt;/<span class="name">q</span>&gt;</span></span><br><span class="line">We hope they succeed.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="删除和插入"><a href="#删除和插入" class="headerlink" title="删除和插入"></a>删除和插入</h2><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>My favorite color is <span class="tag">&lt;<span class="name">del</span>&gt;</span>blue<span class="tag">&lt;/<span class="name">del</span>&gt;</span> <span class="tag">&lt;<span class="name">ins</span>&gt;</span>red<span class="tag">&lt;/<span class="name">ins</span>&gt;</span>!<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h1 id="HTML表格"><a href="#HTML表格" class="headerlink" title="HTML表格"></a>HTML表格</h1><ul>
<li>表格由 <code>&lt;table&gt;</code> 标签来定义。</li>
<li>每个表格均有若干行（由 <code>&lt;tr&gt;</code> 标签定义）</li>
<li>每行被分割为若干单元格（由 <code>&lt;td&gt;</code> 标签定义）。字母 td 指表格数据（table data），即数据单元格的内容。数据单元格可以包含文本、图片、列表、段落、表单、水平线、表格等等。</li>
</ul>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">table</span> <span class="attr">border</span>=<span class="string">&quot;1&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">caption</span>&gt;</span>Monthly savings<span class="tag">&lt;/<span class="name">caption</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">th</span>&gt;</span>Month<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">th</span>&gt;</span>Savings<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span>January<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span>$100<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span>February<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span>$50<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li><p>表格和边框属性：如果不定义边框属性，表格将不显示边框，可以直接去掉<code>border</code>，也可以设置为<code>border=&quot;0&quot;</code></p>
</li>
<li><p>表格表头：使用 <code>&lt;th&gt;</code> 标签进行定义，大多数浏览器会把表头显示为粗体居中的文本。</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h4</span>&gt;</span>水平标题:<span class="tag">&lt;/<span class="name">h4</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">table</span> <span class="attr">border</span>=<span class="string">&quot;1&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">th</span>&gt;</span>Name<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">th</span>&gt;</span>Telephone<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">th</span>&gt;</span>Telephone<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">td</span>&gt;</span>Bill Gates<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">td</span>&gt;</span>555 77 854<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">td</span>&gt;</span>555 77 855<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">h4</span>&gt;</span>垂直标题:<span class="tag">&lt;/<span class="name">h4</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">table</span> <span class="attr">border</span>=<span class="string">&quot;1&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">th</span>&gt;</span>First Name:<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">td</span>&gt;</span>Bill Gates<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">th</span>&gt;</span>Telephone:<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">td</span>&gt;</span>555 77 854<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">th</span>&gt;</span>Telephone:<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">td</span>&gt;</span>555 77 855<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>表格标题用<code>&lt;caption&gt;</code>定义</p>
</li>
<li><p>定义跨行或跨列的表格单元格：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h4</span>&gt;</span>单元格跨两列:<span class="tag">&lt;/<span class="name">h4</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">table</span> <span class="attr">border</span>=<span class="string">&quot;1&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">th</span>&gt;</span>Name<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">th</span> <span class="attr">colspan</span>=<span class="string">&quot;2&quot;</span>&gt;</span>Telephone<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">td</span>&gt;</span>Bill Gates<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">td</span>&gt;</span>555 77 854<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">td</span>&gt;</span>555 77 855<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">h4</span>&gt;</span>单元格跨两行:<span class="tag">&lt;/<span class="name">h4</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">table</span> <span class="attr">border</span>=<span class="string">&quot;1&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">th</span>&gt;</span>First Name:<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">td</span>&gt;</span>Bill Gates<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">th</span> <span class="attr">rowspan</span>=<span class="string">&quot;2&quot;</span>&gt;</span>Telephone:<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">td</span>&gt;</span>555 77 854<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">td</span>&gt;</span>555 77 855<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>在不同的表格元素内显示其他元素，比如：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">table</span> <span class="attr">border</span>=<span class="string">&quot;1&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">td</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">p</span>&gt;</span>这是一个段落<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">p</span>&gt;</span>这是另一个段落<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">td</span>&gt;</span>这个单元格包含一个表格:</span><br><span class="line">   <span class="tag">&lt;<span class="name">table</span> <span class="attr">border</span>=<span class="string">&quot;1&quot;</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">td</span>&gt;</span>A<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">td</span>&gt;</span>B<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">td</span>&gt;</span>C<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">td</span>&gt;</span>D<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">td</span>&gt;</span>这个单元格包含一个列表</span><br><span class="line">   <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>apples<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>bananas<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>pineapples<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">td</span>&gt;</span>HELLO<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>设置单元格边距：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">table</span> <span class="attr">border</span>=<span class="string">&quot;1&quot;</span> </span></span><br><span class="line"><span class="tag"><span class="attr">cellpadding</span>=<span class="string">&quot;10&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">td</span>&gt;</span>First<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">td</span>&gt;</span>Row<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">tr</span>&gt;</span>   </span><br><span class="line"><span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">td</span>&gt;</span>Second<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">td</span>&gt;</span>Row<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>设置单元格之间的间距，即边框的宽度</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">table</span> <span class="attr">border</span>=<span class="string">&quot;1&quot;</span> <span class="attr">cellspacing</span>=<span class="string">&quot;0&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">td</span>&gt;</span>First<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">td</span>&gt;</span>Row<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">td</span>&gt;</span>Second<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">td</span>&gt;</span>Row<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><code>&lt;colgroup&gt;</code>定义表格列的组，以便对其进行格式化。可以向整个列应用样式，而不需要重复为每个单元格或每一行设置样式。只能在 <code>&lt;table&gt;</code> 元素之内，在任何一个 <code>&lt;caption&gt;</code> 元素之后，在任何一个 <code>&lt;thead&gt;</code>、<code>&lt;tbody&gt;</code>、<code>&lt;tfoot&gt;</code>、<code>&lt;tr&gt;</code> 元素之前使用 。</p>
<ul>
<li><code>&lt;col&gt;</code>用于表格列的属性</li>
</ul>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">table</span> <span class="attr">border</span>=<span class="string">&quot;1&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">colgroup</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">col</span> <span class="attr">span</span>=<span class="string">&quot;2&quot;</span> <span class="attr">style</span>=<span class="string">&quot;background-color:red&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">col</span> <span class="attr">style</span>=<span class="string">&quot;background-color:yellow&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">colgroup</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">th</span>&gt;</span>ISBN<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">th</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">th</span>&gt;</span>Price<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span>3476896<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span>My first HTML<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span>$53<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>thead, tbody, 和 tfoot 元素定义表格的页眉、主体、页脚。这些元素默认不会影响表格的布局。可以使用 CSS 来为这些元素定义样式，从而改变表格的外观。</p>
</li>
</ul>
<h1 id="HTML列表"><a href="#HTML列表" class="headerlink" title="HTML列表"></a>HTML列表</h1><ul>
<li><p>无序列表是一个项目的列表，此列项目使用粗体圆点（典型的小黑圆圈）进行标记。使用 <code>&lt;ul&gt;</code> 标签。</p>
<ul>
<li>可以通过<code>style</code>属性定义标记，但是在 HTML 4中 <code>ul</code> 属性已废弃，HTML5 已不支持该属性，可以使用 CSS 代替来定义：<ul>
<li>“list-style-type:disc”是圆点列表</li>
<li>“list-style-type:circle”是圆圈列表</li>
<li>style=”list-style-type:square”是正方形列表</li>
</ul>
</li>
</ul>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span>Coffee<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span>Milk<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>有序列表使用数字进行标记。 有序列表始于 <code>&lt;ol&gt;</code> 标签。每个列表项始于 <code>&lt;li&gt;</code> 标签。</p>
<ul>
<li>ol标签中可以增加<code>start</code>属性，表明数字从多少开始</li>
<li><code>type</code>属性定义列表属性<ul>
<li>“A”是大写字母列表</li>
<li>“a”是小写字母列表</li>
<li>“I”是罗马数字列表</li>
<li>“i”是小写罗马数字列表</li>
</ul>
</li>
</ul>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ol</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span>Coffee<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span>Milk<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>自定义列表不仅仅是一列项目，而是项目及其注释的组合。自定义列表以 <code>&lt;dl&gt;</code> 标签开始。每个自定义列表项以 <code>&lt;dt&gt;</code> 开始。每个自定义列表项的定义以 <code>&lt;dd&gt;</code> 开始。</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dl</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dt</span>&gt;</span>Coffee<span class="tag">&lt;/<span class="name">dt</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dd</span>&gt;</span>- black hot drink<span class="tag">&lt;/<span class="name">dd</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dt</span>&gt;</span>Milk<span class="tag">&lt;/<span class="name">dt</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dd</span>&gt;</span>- white cold drink<span class="tag">&lt;/<span class="name">dd</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dl</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>列表项内部可以使用段落、换行符、图片、链接以及其他列表等</p>
<ul>
<li><p>嵌套列表</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>Coffee<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>Tea</span><br><span class="line">    <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">li</span>&gt;</span>Black tea<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">li</span>&gt;</span>Green tea<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>Milk<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>如果不想要列表前面的项目号，可以通过css在<code>li</code>的里面添加<code>list-style: none;</code></p>
</li>
</ul>
<h1 id="HTML-lt-div-gt-和-lt-span-gt"><a href="#HTML-lt-div-gt-和-lt-span-gt" class="headerlink" title="HTML&lt;div&gt;和&lt;span&gt;"></a>HTML<code>&lt;div&gt;</code>和<code>&lt;span&gt;</code></h1><h2 id="块级元素和内联元素"><a href="#块级元素和内联元素" class="headerlink" title="块级元素和内联元素"></a>块级元素和内联元素</h2><ul>
<li>块级元素在浏览器显示时，通常会以新行来开始（和结束）。比如<code>&lt;h1&gt;</code>, <p>, <code>&lt;ul&gt;</code>, <code>&lt;table&gt;</code></li>
<li>内联元素在显示时通常不会以新行开始。比如<code>&lt;b&gt;</code>, <code>&lt;td&gt;</code>, <code>&lt;a&gt;</code>, <code>&lt;img&gt;</code></li>
</ul>
<h2 id="lt-div-gt"><a href="#lt-div-gt" class="headerlink" title="&lt;div&gt;"></a><code>&lt;div&gt;</code></h2><ul>
<li><code>&lt;div&gt;</code>元素没有特定的含义，可用于组合其他 HTML 元素的容器，成为块级元素。浏览器会在其前后显示折行。</li>
<li>如果与 CSS 一同使用，<code>&lt;div&gt;</code> 元素可用于对大的内容块设置样式属性。</li>
<li><code>&lt;div&gt;</code>元素的另一个常见的用途是文档布局。它取代了使用表格定义布局的老式方法。使用 <code>&lt;table&gt;</code> 元素进行文档布局不是表格的正确用法。<code>&lt;table&gt;</code> 元素的作用是显示表格化的数据。</li>
</ul>
<h2 id="lt-span-gt"><a href="#lt-span-gt" class="headerlink" title="&lt;span&gt;"></a><code>&lt;span&gt;</code></h2><ul>
<li><code>&lt;span&gt;</code>没有特定的含义，是内联元素，可用作文本的容器。</li>
<li>当与 CSS 一同使用时，<code>&lt;span&gt;</code> 元素可用于为部分文本设置样式属性。</li>
</ul>
<h1 id="HTML滚动"><a href="#HTML滚动" class="headerlink" title="HTML滚动"></a>HTML滚动</h1><p> 使用<code>&lt;marquee&gt;</code>标签可以将文字设置为动态滚动的效果。</p>
<ul>
<li><p>方向：<code>direction</code>属性设定：<code>up</code>、<code>down</code>、<code>left</code>（默认）和<code>right</code></p>
</li>
<li><p>滚动方式<code>behavior</code>：</p>
<ul>
<li><code>scroll</code>：循环滚动，默认</li>
<li><code>slide</code>：只滚动一次就停止</li>
<li>`alternate：来回交替进行滚动</li>
</ul>
</li>
<li><p>速度：<code>scrollamount=&quot;滚动速度&quot;</code>：滚动文字的速度实际上是设置滚动文字每次移动的长度，以像素为单位。</p>
</li>
<li><p>延迟：<code>scrolldelay=&quot;时间间隔&quot;</code>，时间间隔单位是毫秒（千分之一秒）</p>
</li>
<li>次数： <code>loop=&quot;循环次数&quot;</code></li>
<li>范围：<code>width=&quot;&quot;  height=&quot;&quot;</code></li>
<li>滚动背景颜色属性：<code>bgcolor=&quot;颜色代码&quot;</code></li>
<li>滚动空间属性：<code>hspace=&quot;水平范围&quot;  vspace=&quot;垂直范围&quot;</code></li>
</ul>
]]></content>
      <categories>
        <category>网站</category>
      </categories>
      <tags>
        <tag>html</tag>
      </tags>
  </entry>
  <entry>
    <title>【ADF】01.基本计算设置</title>
    <url>/2019/09/23/%E3%80%90ADF%E3%80%9101.%E5%9F%BA%E6%9C%AC%E8%AE%A1%E7%AE%97%E8%AE%BE%E7%BD%AE/</url>
    <content><![CDATA[<h1 id="基组basis"><a href="#基组basis" class="headerlink" title="基组basis"></a>基组<code>basis</code></h1><figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">Basis</span><br><span class="line">  <span class="built_in"> Type </span>[<span class="built_in">..</span>.]</span><br><span class="line">   Core [None | Small | Large]</span><br><span class="line">   CreateOutput <span class="literal">Yes</span>/<span class="literal">No</span></span><br><span class="line">   Path string</span><br><span class="line">   PerAtomType</span><br><span class="line">      Core [None | Small | Large]</span><br><span class="line">      File stringS</span><br><span class="line">      Symbol string</span><br><span class="line">     <span class="built_in"> Type </span>[<span class="built_in">..</span>.]</span><br><span class="line">   End</span><br><span class="line">   PerRegion</span><br><span class="line">      Core [None | Small | Large]</span><br><span class="line">      Region string</span><br><span class="line">     <span class="built_in"> Type </span>[<span class="built_in">..</span>.]</span><br><span class="line">   End</span><br><span class="line">   FitType [<span class="built_in">..</span>.]</span><br><span class="line">End</span><br></pre></td></tr></table></figure>
<ul>
<li><code>Type</code>：默认<code>DZ</code>，还有一系列：[SZ, DZ, DZP, TZP, TZ2P, QZ4P, TZ2P-J, QZ4P-J, AUG/ASZ, AUG/ADZ, AUG/ADZP, AUG/ATZP, AUG/ATZ2P, ET/ET-pVQZ, ET/ET-QZ3P, ET/ET-QZ3P-1DIFFUSE, ET/ET-QZ3P-2DIFFUSE, ET/ET-QZ3P-3DIFFUSE, POLTDDFT/DZ, POLTDDFT/DZP, POLTDDFT/TZP, POLTDDFT/TZ2P]</li>
<li><code>Core</code>：默认<code>Large</code>，还可以选择<code>None</code>, <code>Small</code>, <code>Large</code></li>
<li><code>CreateOutput</code>：默认为<code>No</code>。如果为<code>true</code>，原子创建运行的输出将打印到标准输出。如果为<code>false</code>，它将被保存到CreateAtoms.out文件中。</li>
<li><code>Path</code>：默认为<code>$AMSRESOURCES/ADF</code>，ADF只在该文件夹中寻找合适的基组</li>
</ul>
<h2 id="PerAtomType"><a href="#PerAtomType" class="headerlink" title="PerAtomType"></a><code>PerAtomType</code></h2><p>为一类原子指定基组</p>
<ul>
<li><code>Symbol</code>：哪一类原子</li>
<li><p><code>File</code>：指定基组的位置，可以是相对于<code>$AMSRESOURCES/ADF</code>的相对位置，也可以是绝对位置。应该在相对论计算的路径中包含 ZORA，例如<code>ZORA/QZ4P/Au</code>。通过 <code>Type</code> 和 <code>Core</code> 明确指定基组会覆盖自动基组文件选择。</p>
</li>
<li><p><code>Core</code>、<code>type</code>等：同上</p>
</li>
</ul>
<p>这一部分也可以简写为：</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">PerAtomType <span class="attribute">Core</span>=None <span class="attribute">File</span>=string <span class="attribute">Symbol</span>=tring <span class="attribute">type</span>=XXX</span><br></pre></td></tr></table></figure>
<h2 id="PerRegion"><a href="#PerRegion" class="headerlink" title="PerRegion"></a><code>PerRegion</code></h2><p>为一个区域的原子指定基组，基本设置同上。</p>
<ul>
<li><code>Region</code>：指定基组的区域，可以用逻辑运算符，比如<code>R1+R2</code></li>
</ul>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">Basis</span><br><span class="line">  <span class="built_in"> Type </span>DZ</span><br><span class="line">   Core None</span><br><span class="line">   PerRegion <span class="attribute">Region</span>=Accurate <span class="attribute">Type</span>=TZP</span><br><span class="line">   PerRegion <span class="attribute">Region</span>=Far      <span class="attribute">Type</span>=SZ</span><br><span class="line">End</span><br></pre></td></tr></table></figure>
<blockquote>
<p>ADF19中，为同元素的不同原子设置基组</p>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">ATOMS</span></span><br><span class="line"><span class="attribute">O</span>.F<span class="number">1</span> x y z</span><br><span class="line"><span class="attribute">O</span>.F<span class="number">2</span> x y z</span><br><span class="line"><span class="attribute">End</span></span><br><span class="line"><span class="attribute">basis</span></span><br><span class="line"><span class="attribute">O</span>.F<span class="number">1</span> TZ<span class="number">2</span>P</span><br><span class="line"><span class="attribute">O</span>.F<span class="number">2</span> DZP</span><br><span class="line"><span class="attribute">END</span></span><br></pre></td></tr></table></figure>
</blockquote>
<h1 id="泛函XC"><a href="#泛函XC" class="headerlink" title="泛函XC"></a>泛函<code>XC</code></h1><figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">XC</span><br><span class="line">  &#123;LDA LDA &#123;Stoll&#125;&#125;</span><br><span class="line">  &#123;GGA GGA&#125;</span><br><span class="line">  &#123;MetaGGA metagga&#125;</span><br><span class="line">  &#123;Model MODELPOT [IP]&#125;</span><br><span class="line">  &#123;HartreeFock&#125;</span><br><span class="line">  &#123;OEP fitmethod &#123;approximation&#125;&#125;</span><br><span class="line">  &#123;HYBRID hybrid &#123;<span class="attribute">HF</span>=HFpart&#125;&#125;</span><br><span class="line">  &#123;MetaHYBRID metahybrid&#125;</span><br><span class="line">  &#123;DOUBLEHYBRID doublehybrid&#125;</span><br><span class="line">  &#123;RPA&#125;</span><br><span class="line">  &#123;XCFUN&#125;</span><br><span class="line">  &#123;RANGESEP &#123;<span class="attribute">GAMMA</span>=X&#125; &#123;<span class="attribute">ALPHA</span>=a&#125; &#123;<span class="attribute">BETA</span>=b&#125;&#125;</span><br><span class="line">  (LibXC functional&#125;</span><br><span class="line">  &#123;DISPERSION [s6scaling] [<span class="attribute">RSCALE</span>=r0scaling] [Grimme3] [BJDAMP] [<span class="attribute">PAR1</span>=par1]  [<span class="attribute">PAR2</span>=par2]  [<span class="attribute">PAR3</span>=par3]  [<span class="attribute">PAR4</span>=par4] &#125;</span><br><span class="line">  &#123;Dispersion Grimme4 &#123;<span class="attribute">s6</span>=...&#125; &#123;<span class="attribute">s8</span>=...&#125; &#123;<span class="attribute">a1</span>=...&#125; &#123;<span class="attribute">a2</span>=...&#125;&#125;</span><br><span class="line">  &#123;DISPERSION dDsC&#125;</span><br><span class="line">  &#123;DISPERSION UFF&#125;</span><br><span class="line">end</span><br></pre></td></tr></table></figure>
<h1 id="相对论Relativity"><a href="#相对论Relativity" class="headerlink" title="相对论Relativity"></a>相对论<code>Relativity</code></h1><p>2020版本开始默认使用标量相对论效应：</p>
<figure class="highlight coq"><table><tr><td class="code"><pre><span class="line">Relativity</span><br><span class="line">   Formalism [Pauli | <span class="type">ZORA</span> | <span class="type">X2C</span> | <span class="type">RA</span>-X2C]</span><br><span class="line">   Level [None | <span class="type">Scalar</span> | <span class="type">Spin</span>-Orbit]</span><br><span class="line">   Potential [MAPA | <span class="type">SAPA</span>]</span><br><span class="line">   SpinOrbitMagnetization [NonCollinear | <span class="type">Collinear</span> | <span class="type">CollinearX</span> | <span class="type">CollinearY</span> | <span class="type">CollinearZ</span>]</span><br><span class="line"><span class="keyword">End</span></span><br></pre></td></tr></table></figure>
<ul>
<li><code>Formalism</code>：如果<code>level</code>里是<code>None</code>，则不需要考虑所选择的形式。<ul>
<li><code>Pauli</code>：泡利哈密顿函数</li>
<li><code>ZORA</code>：零阶正则近似哈密顿量。默认。</li>
<li><code>X2C</code>：四分量狄拉克方程到二分量狄拉克方程的精确变换，是Dyall修正的Dirac方程。</li>
<li><code>RA-X2C</code>：四分量狄拉克方程到二分量狄拉克方程的精确变换，是修正狄拉克方程的正规方法。</li>
</ul>
</li>
<li><code>Level</code>：<ul>
<li><code>None</code>：非相对论。哈密顿量也就是Kohn-Sham方程的形式。</li>
<li><code>Scalar</code>：标量相对论，成本较低。默认。</li>
<li><code>Spin-Orbit</code>：旋轨耦合，最好的理论水平，比普通计算昂贵（4-8倍）</li>
</ul>
</li>
<li><code>Potential</code>：<ul>
<li><code>MAPA</code>：默认。the Minumium of neutral Atomical potential Approximation 中性原子势近似值的最小值。MAPA优于SAPA的优点是可以降低ZORA的规格依赖性。 除了电子密度非常接近重核外，几乎所有特性的ZORA规范依赖性都很小。 非常接近重核的电子密度可用于解释Mossbauer光谱中的异构体位移。</li>
<li><code>SAPA</code>：the Sum of neutral Atomical potential Approximation 中性原子势近似值之和。</li>
</ul>
</li>
<li><code>SpinOrbitMagnetization</code>：只与自旋轨道耦合相关，而且在<code>unrestricted</code>下使用。在不受限制的计算中，大多数XC泛函都有自旋极化作为一种成分。通常，自旋量子化轴的方向是任意的，可以方便地选择为z轴。然而，在自旋轨道计算中，方向很重要，将磁化矢量的z分量放入XC函数中是任意的。<ul>
<li><code>NonCollinear</code>：可以将磁化矢量的大小插入XC函数中。 这称为非共线方法。</li>
<li><code>CollinearX</code>，<code>CollinearY</code>，<code>CollinearZ</code>：使用x，y或z分量作为XC函数的自旋极化。默认为z。</li>
<li><code>Collinear</code>：同<code>CollinearZ</code></li>
</ul>
</li>
</ul>
<blockquote>
<p>2019版及之前的输入格式为：</p>
<figure class="highlight dust"><table><tr><td class="code"><pre><span class="line"><span class="xml">RELATIVISTIC </span><span class="template-variable">&#123;level&#125;</span><span class="xml"> </span><span class="template-variable">&#123;formalism&#125;</span><span class="xml"> </span><span class="template-variable">&#123;potential&#125;</span></span><br></pre></td></tr></table></figure>
<ul>
<li><blockquote>
<p>Scalar级别为：<code>RELATIVISTIC Scalar ZORA</code></p>
</blockquote>
</li>
<li><p>SpinOrbit级别为：<code>RELATIVISTIC spinorbit ZORA</code></p>
<ul>
<li>注意此时：unrestricted不再适用，解决办法删掉unrestricted或加上collinear/nocollinear，以及nosym关键词</li>
<li>并且不能同时计算解析freq</li>
</ul>
</li>
</ul>
</blockquote>
<h1 id="SCF选项"><a href="#SCF选项" class="headerlink" title="SCF选项"></a>SCF选项</h1><figure class="highlight puppet"><table><tr><td class="code"><pre><span class="line">SCF</span><br><span class="line"> Iterations Niter</span><br><span class="line"> Converge <span class="keyword">SCFcnv</span> &#123; sconv2 &#125;</span><br><span class="line"> </span><br><span class="line"> <span class="keyword">AccelerationMethod</span> &#123; ADIIS | LISTi | LISTb | fDIIS | LISTf | MESA | SDIIS &#125;</span><br><span class="line"> <span class="keyword">MESA</span> [NoFDIIS] [NoLISTb] [NoLISTf] [NoLISTi] [NoSDIIS] [NoADIIS]</span><br><span class="line"> ADIIS</span><br><span class="line">   &#123;THRESH1 a1&#125;</span><br><span class="line">   &#123;THRESH2 a2&#125;</span><br><span class="line"> End</span><br><span class="line"> NoADIIS</span><br><span class="line"> DIIS</span><br><span class="line">   &#123;N n&#125;</span><br><span class="line">   &#123;OK ok&#125;</span><br><span class="line">   &#123;cyc cyc&#125;</span><br><span class="line"> End</span><br><span class="line"> Mixing mix</span><br><span class="line"> Mixing1 mix1</span><br><span class="line"></span><br><span class="line"> OldSCF</span><br><span class="line">End</span><br></pre></td></tr></table></figure>
<ul>
<li><code>Iterations</code>SCF迭代的最大次数，<code>Niter</code>默认是<code>300</code></li>
<li><code>Converge</code> <ul>
<li><code>SCFcnv</code>表示停止迭代的收敛限，默认是<code>1e-6</code>。</li>
<li><code>sconv2</code>表示SCF过程难以收敛时起作用的第二个标准，默认是<code>1e-3</code>，如果达到了，仅发出警告，但是继续计算。仍无法达到的时候SCF不收敛，只能用<code>ALLOW</code>来继续</li>
</ul>
</li>
<li><code>oldSCF</code>：禁用默认 SCF 算法并使用旧的 SCF 算法。<ul>
<li>默认 SCF 提高了大型机器上大型系统的性能（当计算使用许多任务时）。也推荐用于磁盘 I/O 速度较慢的机器，因为它向磁盘写入的数据较少。支持的默认收敛方法是 A-DIIS，但也支持 LISTi。在使用<code>Occupations Steep</code>、<code>Lshift</code>，<code>ARH</code>，<code>EDIIS</code>，<code>RESTOCC</code>时，会自动启用<code>oldSCF</code>。</li>
</ul>
</li>
</ul>
<h2 id="DIIS"><a href="#DIIS" class="headerlink" title="DIIS"></a><code>DIIS</code></h2><p>允许的最大 SCF 迭代数相关设置。</p>
<ul>
<li><p><code>BFac</code>：默认为<code>0.0</code>，即DIIS算法不支持最新的向量。一个合理的值是 0.2。</p>
</li>
<li><p><code>CX</code>：当出现非常大的 DIIS 系数时，DIIS 空间会减少。该值是阈值，默认是<code>5.0</code></p>
</li>
<li><p><code>CXX</code>：当出现非常大的 DIIS 系数时，切换到传统阻尼。该值是阈值，默认为<code>25.0</code></p>
</li>
<li><p><code>Cyc</code>：禁用A-DIIS时，无论<code>DIIS OK</code>值如何，SDIIS都会在此迭代下启动，默认值为<code>5</code></p>
</li>
<li><p><code>N</code>：用于加速SCF的扩展向量的数量，默认为<code>10</code>，小于2后会禁用DIIS。此数字不仅适用于Pulay DIIS方案，还适用于其他类似DIIS的方法，例如A-DIIS和LIST方法。</p>
<blockquote>
<p>LIST家族的方法对使用的扩展向量的数量非常敏感，接近收敛时，LIST中的向量数量会增加，但始终受<code>DIIS N</code>的限制，当难以收敛时，可以将<code>DIIS N</code>设置为大于10的值，比如12~20。</p>
</blockquote>
</li>
<li><p><code>Ok</code>：禁用A-DIIS时，SDIIS起始条件。默认为<code>0.5</code> a.u.。</p>
</li>
</ul>
<h2 id="加速方法"><a href="#加速方法" class="headerlink" title="加速方法"></a>加速方法</h2><ul>
<li><code>AccelerationMethod</code>调用的SCF加速方法，<strong>默认情况下为<code>ADIIS</code>，</strong>还可以用<code>LISTi</code> | <code>LISTb</code> | <code>fDIIS</code> | <code>LISTf</code> | <code>MESA</code> | <code>SDIIS</code>。MESA采用的是ADIIS, fDIIS, LISTb, LISTf, LISTi和 SDIIS方法的组合。</li>
<li><code>MESA</code>：代表从其中删掉某一种方法，可以直接使用该关键词调用MESA（也可以用<code>AccelerationMethod MESA</code>调用），优先级大于<code>AccelerationMethod</code>指定的方法。</li>
<li><code>NoADIIS</code>：指定<code>NoADIIS</code>时才可以设置 <a href="#DIIS"><code>DIIS</code>模块</a>的<code>cycle</code>和<code>OK</code>。<ul>
<li>如果<span id="NOADIIS">没有设置<code>oldSCF</code>，则指定 <code>NoADIIS</code> </span>与<a href="#SDIIS">将 AccelerationMethod 设置为 SDIIS</a> 的效果相同。</li>
<li>在指定<code>oldscf</code>的情况下使用<code>NoADIIS</code>会禁用在SCF收敛困难的时候自动切换到ADIIS + SDIIS方法</li>
</ul>
</li>
</ul>
<h3 id="简单阻尼部分"><a href="#简单阻尼部分" class="headerlink" title="简单阻尼部分"></a>简单阻尼部分</h3><ul>
<li><code>Mixing</code>：没有激活加速方法时，指将下一个Fock矩阵确定为<script type="math/tex">F = mix F_{n} + (1-mix) F_{n-1}</script>，<script type="math/tex">mix</script>默认为<code>0.2</code></li>
<li><code>Mixing1</code>中指第一个SCF循环的混合参数值不同，默认为<code>0.2</code></li>
</ul>
<h3 id="ADIIS部分"><a href="#ADIIS部分" class="headerlink" title="ADIIS部分"></a>ADIIS部分</h3><p>使用ADIIS + SDIIS方法。根据 [F,P] 交换子矩阵中的最大元素<code>ErrMax</code>来确定具体方法：</p>
<ul>
<li>当ErrMax≥<code>a1</code>，只使用A-DIIS系数</li>
<li>当ErrMax≤ <code>a2</code>，只使用SDIIS系数</li>
<li>当<code>a2</code>≤ ErrMax≤ <code>a1</code>，根据ErrMax的值按一定的权重来计算<br><code>a1</code>和<code>a2</code>的默认值是<code>0.01</code>和<code>0.0001</code>，收敛比较困难的时候，可以降低阈值，只使用A-DIIS系数</li>
</ul>
<h3 id="SDIIS部分"><a href="#SDIIS部分" class="headerlink" title="SDIIS部分"></a>SDIIS部分</h3><p><a href="#NOADIIS">SDIIS</a> 代表原始的Pulay DIIS方法。禁用 A-DIIS 并将 SCF 切换为阻尼+SDIIS方法：从简单阻尼（Mixing）开始，持续到<code>ErrMax</code>降低到<a href="#DIIS"><code>DIIS OK</code></a>参数以下，但是不超过<code>DIIS Cyc</code>次迭代。之后使用纯的SDIIS方法。</p>
<h2 id="能级移动"><a href="#能级移动" class="headerlink" title="能级移动"></a>能级移动</h2><ul>
<li><p><code>Lshift</code>：能级移动方法，在前一次迭代的轨道表示中，Fock矩阵的对角元素提高虚轨道的<code>vshift</code>hartree。旋轨耦合不支持这种方法。</p>
</li>
<li><p><code>Lshift_err</code>指定一旦SCF error降至阈值以下，程序将关闭能级移动，<code>Shift_err</code>默认值为<code>0</code>。</p>
</li>
<li><p><code>Lshift_cyc</code>指定在第几个SCF 迭代次数的时候再启动能级移动， <code>Shift_cyc</code>默认为<code>1</code>。</p>
<figure class="highlight properties"><table><tr><td class="code"><pre><span class="line"><span class="attr">Lshift</span> <span class="string">vshift</span></span><br><span class="line"><span class="attr">Lshift_err</span> <span class="string">Shift_err</span></span><br><span class="line"><span class="attr">Lshift_cyc</span> <span class="string">Shift_cyc </span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="ARH"><a href="#ARH" class="headerlink" title="ARH"></a><code>ARH</code></h2><figure class="highlight dust"><table><tr><td class="code"><pre><span class="line"><span class="xml">SCF</span></span><br><span class="line"><span class="xml">  ARH</span></span><br><span class="line"><span class="xml">    </span><span class="template-variable">&#123;CONV conv&#125;</span></span><br><span class="line"><span class="xml">    </span><span class="template-variable">&#123;ITER iter&#125;</span></span><br><span class="line"><span class="xml">    </span><span class="template-variable">&#123;NSAVED nsaved&#125;</span></span><br><span class="line"><span class="xml">    </span><span class="template-variable">&#123;START start&#125;</span></span><br><span class="line"><span class="xml">    </span><span class="template-variable">&#123;FINAL&#125;</span><span class="xml"> ...</span></span><br><span class="line"><span class="xml">  End</span></span><br><span class="line"><span class="xml">  ...</span></span><br><span class="line"><span class="xml">End</span></span><br></pre></td></tr></table></figure>
<ul>
<li><code>CONV</code>：当RMS梯度及其最大分量均低于<code>conv</code>，ARH收敛，<code>conv</code>默认是1e-4</li>
<li><code>ITER</code>：最大ARH迭代次数，<code>iter</code>默认为500</li>
<li><code>FINAL</code>：确定ARH完成后是否继续SCF。如果设置了此选项，将执行一次Fock矩阵对角化以获得轨道，并且将停止SCF过程。默认选项为<code>OFF</code>。</li>
<li><code>START</code>：开始调用ARH的SCF迭代次数，<code>start</code>默认为2。使用较大的值可以为ARH提供更好的初猜</li>
<li><code>NSAVED</code>：保存密度和Fock矩阵的数量。 <code>nsaved</code>默认为8。在非常接近费米能级的轨道数很大的收敛困难时，应使用较大的<code>nsaved</code>值。</li>
<li>默认的最小化方法是“Untransformed Pre-conditioned Conjugate Gradient”，可以使用以下两个关键词更改：<ul>
<li><code>NOPRECOND</code>：禁用Untransformed Pre-conditioned CG最小化，不能在第二周期后的元素里使用</li>
<li><code>TRANSPCG</code>：启用Transformed Pre-conditioned CG 方法，SCF可能会更好的收敛。</li>
</ul>
</li>
<li>在每一步SCF中，先执行常规CG最小化，跟踪总步长，如果在某个微迭代中步长超过了信任半径，则过程将在缩小的空间中切换到信任半径优化，在能级移动参数mu收敛后立即中止。在CG最小化期间生成的所有试验矢量的缩小空间中，将最终步骤计算为牛顿步骤。可以通过以下关键词修改参数：<ul>
<li><code>NOSWITCHING</code>：关闭从普通CG到缩小的空间中的信任半径最小化的切换。在某些情况下，使用此选项有助于减少SCF循环的总数。</li>
<li><code>SHIFTED</code>：设置此选项将在第一次微迭代中打开信任半径优化。</li>
<li><code>CGITER=cgiter</code>：设置微迭代的最大数量。</li>
<li>确定置信半径：<ul>
<li><code>TRUSTR=trustr</code>：信任半径的初始值。默认为<code>0.5</code></li>
<li><code>MAXTRUSTR=maxtrustr</code>：最大信任半径值。默认为<code>0.5</code>，并且不会改变。</li>
</ul>
</li>
</ul>
</li>
<li>缺点：<ul>
<li>该方法仅适用于NOSYM计算</li>
<li>在每一步都要计算总能量，计算非常昂贵，而且使用总能量，需要更高的积分精度才能获得稳定的SCF收敛，该方法可能不适用于所有情况，??使用<code>ADDDIFFUSEFIT</code>关键字或更高的<code>ZlmFit</code>质量设置来提高总能量的准确性，从而提高收敛性。??</li>
</ul>
</li>
</ul>
<h2 id="SCF不收敛"><a href="#SCF不收敛" class="headerlink" title="SCF不收敛"></a>SCF不收敛</h2><ol>
<li><p>更换SCF<a href="#加速方法">加速收敛的方法</a></p>
</li>
<li><p>使用ARH方法</p>
</li>
<li><p>修改DIIS算法的参数</p>
<ul>
<li><code>Mixing</code>高于默认值<code>0.2</code>会有更高的加速度，更低会更稳定的迭代</li>
<li><code>N</code>默认为<code>10</code>，越大用于加速SCF的扩展向量的数量越多，SCF迭代更稳定，最多到25</li>
<li><code>Cyc</code>是SDIIS启动的初始SCF迭代步数，默认值为<code>5</code>，更高计算越稳定，比如使用如下参数：<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">SCF</span></span><br><span class="line">    <span class="attribute">DIIS</span></span><br><span class="line">      <span class="attribute">N</span> <span class="number">25</span></span><br><span class="line">      <span class="attribute">Cyc</span> <span class="number">30</span></span><br><span class="line">    <span class="attribute">End</span></span><br><span class="line">    <span class="attribute">Mixing</span> <span class="number">0</span>.<span class="number">015</span></span><br><span class="line">    <span class="attribute">Mixing1</span> <span class="number">0</span>.<span class="number">09</span></span><br><span class="line"><span class="attribute">End</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>HOMO-LUMO较为接近的情况（0.02Hatree以内），可能造成HOMO-LUMO的震荡。可以使用<code>Lshift vshift</code>方法，比如0.01，不能太大，不适于激发态的计算、<strong>解析频率</strong>、旋轨耦合的计算。</p>
</li>
<li><p>使用Electron smearing设定在允许的能量范围内分数占据。</p>
</li>
<li><p>指定占据</p>
</li>
<li><p>其他：<a href="https://www.fermitech.com.cn/wiki/doku.php?id=adf:scfnonconvergence">费米维基</a>的4、7。</p>
<figure class="highlight pgsql"><table><tr><td class="code"><pre><span class="line">OCCUPATIONS keeporbitals=<span class="number">50</span> <span class="keyword">freeze</span> </span><br><span class="line">OCCUPATIONS keeporbitals=<span class="number">50</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">mkdir</span> <span class="number">01</span>_listi <span class="number">02</span>_listb <span class="number">03</span>_fdiis <span class="number">04</span>_listf <span class="number">05</span>_mesa <span class="number">06</span>_sdiis <span class="number">07</span>_arh <span class="number">08</span>_mix <span class="number">09</span>_shift </span><br><span class="line"></span><br><span class="line"><span class="attribute">for</span> i in <span class="number">01</span> <span class="number">02</span> <span class="number">03</span> <span class="number">04</span> <span class="number">05</span> <span class="number">06</span> <span class="number">07</span> <span class="number">08</span> <span class="number">09</span> ;do cp <span class="number">00</span>*/*run <span class="number">00</span>*/adf* <span class="variable">$&#123;i&#125;</span>*; done</span><br><span class="line"></span><br><span class="line"><span class="attribute">sed</span> -i &#x27;s/SCF/SCF\nAccelerationMethod listi/&#x27; <span class="number">01</span>*/*.run </span><br><span class="line"><span class="attribute">sed</span> -i &#x27;s/SCF/SCF\nAccelerationMethod listb/&#x27; <span class="number">02</span>*/*.run </span><br><span class="line"><span class="attribute">sed</span> -i &#x27;s/SCF/SCF\nAccelerationMethod fdiis/&#x27; <span class="number">03</span>*/*.run </span><br><span class="line"><span class="attribute">sed</span> -i &#x27;s/SCF/SCF\nAccelerationMethod listf/&#x27; <span class="number">04</span>*/*.run</span><br><span class="line"><span class="attribute">sed</span> -i &#x27;s/SCF/SCF\nAccelerationMethod mesa/&#x27; <span class="number">05</span>*/*.run</span><br><span class="line"><span class="attribute">sed</span> -i &#x27;s/SCF/SCF\nAccelerationMethod sdiis/&#x27; <span class="number">06</span>*/*.run</span><br><span class="line"><span class="attribute">sed</span> -i &#x27;s/SCF/SCF\narh\nend/&#x27; <span class="number">07</span>*/*.run</span><br><span class="line"><span class="attribute">sed</span> -i &#x27;s/SCF/SCF\nDIIS\nN <span class="number">25</span>\nCyc <span class="number">30</span>\nEnd\nMixing <span class="number">0</span>.<span class="number">015</span>\n Mixing<span class="number">1</span> <span class="number">0</span>.<span class="number">09</span>/&#x27; <span class="number">08</span>*/*.run</span><br><span class="line"><span class="attribute">sed</span> -i &#x27;s/SCF/SCF\nLshift <span class="number">0</span>.<span class="number">01</span>/&#x27; <span class="number">09</span>*/*.run</span><br><span class="line"></span><br><span class="line"><span class="attribute">for</span> i in <span class="number">01</span> <span class="number">02</span> <span class="number">03</span> <span class="number">04</span> <span class="number">05</span> <span class="number">06</span> <span class="number">07</span> <span class="number">08</span> <span class="number">09</span>;do cd <span class="variable">$&#123;i&#125;</span>*; qsub adf*; cd ..; done</span><br></pre></td></tr></table></figure>
<h1 id="对称性的设置"><a href="#对称性的设置" class="headerlink" title="对称性的设置"></a>对称性的设置</h1><p>除了在AMS中<code>System</code>块中指定，<code>Engine ADF</code>中也可以设置对称性：</p>
<ul>
<li><code>Symmetry</code>：默认是<code>AUTO</code>，默认为<code>auto</code>，可以通过<code>nosym</code>、<code>C(LIN)</code>……等来指定对称性</li>
<li><code>SymmetryTolerance</code>：用于检测系统对称性的容差。默认是<code>1e-07</code></li>
</ul>
<blockquote>
<p>即使在<code>System</code>中设置了 <code>Symmetry nosym</code>，ADF中也可能会检测出对称性。因此要在ADF中也设置<code>nosym</code>。</p>
</blockquote>
<h1 id="指定占据IrrepOccupations"><a href="#指定占据IrrepOccupations" class="headerlink" title="指定占据IrrepOccupations"></a>指定占据<code>IrrepOccupations</code></h1><figure class="highlight mipsasm"><table><tr><td class="code"><pre><span class="line">IrrepOccupations</span><br><span class="line">  irrep <span class="keyword">orbitalnumbers</span></span><br><span class="line"><span class="keyword"> </span> irrep <span class="keyword">orbitalnumbers</span></span><br><span class="line"><span class="keyword"> </span> ...</span><br><span class="line">End</span><br></pre></td></tr></table></figure>
<ul>
<li><p><code>irrep</code>是不可约表示</p>
</li>
<li><p><code>orbitalnumbers</code>：</p>
<ul>
<li><p>可以是一个或者一系列数字，会按能量顺序排序，高于这些数字的占据都是0、</p>
</li>
<li><p>对于简并的对称性，要给出电子的总数。</p>
</li>
<li><p>在unrestricted的计算中【在使用（非）共线近似的无限制自旋轨道耦合计算中没有意义，在这种情况下，应该为每个不可约的占用数使用一个序列】，要用两个数字序列，通过<code>//</code>分隔开。前一组是α电子，后一组是β电子。如：</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">IrrepOccupations</span><br><span class="line">   A <span class="number">28</span> <span class="comment">// 26</span></span><br><span class="line">End</span><br><span class="line">SpinPolarization <span class="number">2</span></span><br><span class="line">Symmetry NOSYM</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<p>注意事项：</p>
<ul>
<li>电子总数不包括冻芯里的电子。</li>
<li>如果数字序列比较长，可以组合内层的电子数，程序会自动拆分，比如对于单个原子，<code>P 17 3</code>会自动变成<code>P 6 6 5 3</code></li>
<li>可以用分数占据</li>
<li>在数值频率计算中，程序内部默认使用nosym，因此只能识别不可约表示A。</li>
</ul>
<h1 id="NumericalQuality"><a href="#NumericalQuality" class="headerlink" title="NumericalQuality"></a><code>NumericalQuality</code></h1><ul>
<li>设置ADF计算的质量，包括BeckeGrid（数值积分）和 ZlmFit（密度拟合）。</li>
<li>选项有<code>Basic</code>、<code>Normal</code>（默认）、<code>Good</code>、<code>VeryGood</code>、<code>Excellent</code></li>
</ul>
<h1 id="BeckeGrid"><a href="#BeckeGrid" class="headerlink" title="BeckeGrid"></a><code>BeckeGrid</code></h1><p>数值积分格点的选项。</p>
<figure class="highlight coq"><table><tr><td class="code"><pre><span class="line">BECKEGRID</span><br><span class="line">  Quality [basic|<span class="type">normal</span>|<span class="type">good</span>|<span class="type">verygood</span>|<span class="type">excellent</span>]</span><br><span class="line">  &#123;QualityPerRegion</span><br><span class="line">     Region myregion</span><br><span class="line">     Quality &#123;Basic|<span class="type">Normal</span>|<span class="type">Good</span>|<span class="type">VeryGood</span>|<span class="type">Excellent</span>&#125;</span><br><span class="line">  <span class="keyword">End</span>&#125;</span><br><span class="line">  &#123;qpnear qpnear&#125;</span><br><span class="line">  &#123;RadialGridBoost boost&#125;</span><br><span class="line"><span class="keyword">End</span></span><br></pre></td></tr></table></figure>
<ul>
<li><p><code>Quality</code>：选项有<code>auto</code>（默认）、<code>Basic</code>、<code>Normal</code>、<code>Good</code>、<code>VeryGood</code>、<code>Excellent</code>。会覆盖<code>NumericalQuality</code>中的设置。</p>
</li>
<li><p><code>QualityPerRegion</code>：设置特定区域的原子的积分格点质量。</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">BeckeGrid</span><br><span class="line">  QualityPerRegion <span class="attribute">Region</span>=Accurate <span class="attribute">Quality</span>=Good</span><br><span class="line">  QualityPerRegion <span class="attribute">Region</span>=Far      <span class="attribute">Quality</span>=Basic</span><br><span class="line">End</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>qpnear</code>：默认为<code>4</code>Å。当在输入文件中指定了点电荷时，ADF 仅围绕那些接近原子的点电荷生成网格。<code>qpnear</code>指定的是最近的距离。</p>
</li>
<li><p><code>RadialGridBoost</code>：默认为<code>1.0</code>。增加径向积分点的数量。一些 XC 泛函需要非常精确的径向积分网格，因此 ADF 会自动将径向网格提升 3 倍用于一些数值敏感泛函。</p>
</li>
</ul>
<h1 id="红外光谱"><a href="#红外光谱" class="headerlink" title="红外光谱"></a>红外光谱</h1><p>所需的 Hessian 可以通过数值计算或解析计算。这可以在输入的 AMS 部分设置。</p>
<h2 id="解析频率"><a href="#解析频率" class="headerlink" title="解析频率"></a>解析频率</h2><p>对于相同的积分精度，解析 Hessian 与数值 Hessian 一样准确，但计算速度最多可提高 3 到 5 倍，具体取决于分子、积分网格参数和基组选择。但是解析Hessian目前只支持（包括 PW91 和 Hartree-Fock都不支持）：</p>
<ul>
<li><strong>LDA:</strong> XONLY, VWN, STOLL, PW92</li>
<li><strong>Exchange GGA:</strong> Becke88, OPTx, PBEx, rPBEx, revPBEx, S12g</li>
<li><strong>Correlation GGA:</strong> LYP, Perdew86, PBEc</li>
<li><strong>XC GGA shortcuts:</strong> BP86, PBE, RPBE, revPBE, BLYP, OLYP, OPBE</li>
</ul>
<figure class="highlight properties"><table><tr><td class="code"><pre><span class="line"><span class="attr">AnalyticalFreq</span></span><br><span class="line">   <span class="attr">B1Size</span> <span class="string">float</span></span><br><span class="line">   <span class="attr">B1Thresh</span> <span class="string">float</span></span><br><span class="line">   <span class="attr">Check_CPKS_From_Iteration</span> <span class="string">integer</span></span><br><span class="line">   <span class="attr">Debug</span> <span class="string">string</span></span><br><span class="line">   <span class="attr">Hessian</span> <span class="string">[reflect | average]</span></span><br><span class="line">   <span class="attr">Max_CPKS_Iterations</span> <span class="string">integer</span></span><br><span class="line">   <span class="attr">Print</span> <span class="string">string</span></span><br><span class="line">   <span class="attr">PrintNormalModeAnalysis</span> <span class="string">Yes/No</span></span><br><span class="line">   <span class="attr">U1_Accuracy</span> <span class="string">float</span></span><br><span class="line"><span class="attr">End</span></span><br></pre></td></tr></table></figure>
<ul>
<li><code>Max_CPKS_Iterations</code>：解析频率的计算需要求解Coupled Perturbed Kohn-Sham (CPKS)  (CPKS)方程，这是一个迭代过程。如果没有实现收敛（输出中会打印警告” CPKS failed to converge. Frequencies may be wrong”)，可以增加迭代次数（收敛不能保证）。默认为<code>20</code></li>
</ul>
]]></content>
      <categories>
        <category>计算化学</category>
        <category>软件</category>
      </categories>
      <tags>
        <tag>AMS</tag>
        <tag>ADF</tag>
        <tag>基组</tag>
        <tag>SCF</tag>
        <tag>对称性</tag>
        <tag>占据</tag>
        <tag>相对论</tag>
      </tags>
  </entry>
  <entry>
    <title>【CP2K】02.计算力和能量</title>
    <url>/2020/11/21/%E3%80%90CP2K%E3%80%9102.%E8%AE%A1%E7%AE%97%E5%8A%9B%E5%92%8C%E8%83%BD%E9%87%8F/</url>
    <content><![CDATA[<h1 id="输入文件"><a href="#输入文件" class="headerlink" title="输入文件"></a>输入文件</h1><p>输入文件需要准备：</p>
<ul>
<li>BASIS_SET和GTH_POTENTIALS：该文件包含CP2K可用于此计算的基组和赝势的参数，在cp2k/data/中有相应的基组和赝势，它们包含大多数常用的元素，用户需要针对给定的计算选择自己需要的文件</li>
<li>Si_bulk8.inp中主要包含<code>&amp;GLOBAL</code>和<code>&amp;FORCE_EVAL</code>两部分：·</li>
</ul>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&amp;GLOBAL</span></span><br><span class="line">  <span class="string">PROJECT</span> <span class="string">Si_bulk8</span></span><br><span class="line">  <span class="string">RUN_TYPE</span> <span class="string">ENERGY_FORCE</span></span><br><span class="line">  <span class="string">PRINT_LEVEL</span> <span class="string">LOW</span></span><br><span class="line"><span class="string">&amp;END</span> <span class="string">GLOBAL</span></span><br><span class="line"><span class="meta">&amp;FORCE_EVAL</span></span><br><span class="line">  <span class="string">METHOD</span> <span class="string">Quickstep</span></span><br><span class="line">  <span class="meta">&amp;SUBSYS</span></span><br><span class="line">    <span class="string">&amp;KIND</span> <span class="string">Si</span></span><br><span class="line">      <span class="string">ELEMENT</span> <span class="string">Si</span></span><br><span class="line">      <span class="string">BASIS_SET</span> <span class="string">DZVP-GTH-PADE</span></span><br><span class="line">      <span class="string">POTENTIAL</span> <span class="string">GTH-PADE-q4</span></span><br><span class="line">    <span class="string">&amp;END</span> <span class="string">KIND</span></span><br><span class="line">    <span class="meta">&amp;CELL</span></span><br><span class="line">      <span class="string">A</span>     <span class="number">5.430697500</span>    <span class="number">0.000000000</span>    <span class="number">0.000000000</span></span><br><span class="line">      <span class="string">B</span>     <span class="number">0.000000000</span>    <span class="number">5.430697500</span>    <span class="number">0.000000000</span></span><br><span class="line">      <span class="string">C</span>     <span class="number">0.000000000</span>    <span class="number">0.000000000</span>    <span class="number">5.430697500</span></span><br><span class="line">    <span class="string">&amp;END</span> <span class="string">CELL</span></span><br><span class="line">    <span class="meta">&amp;COORD</span></span><br><span class="line">      <span class="string">Si</span>    <span class="number">0.000000000</span>    <span class="number">0.000000000</span>    <span class="number">0.000000000</span></span><br><span class="line">      <span class="string">Si</span>    <span class="number">0.000000000</span>    <span class="number">2.715348700</span>    <span class="number">2.715348700</span></span><br><span class="line">      <span class="string">Si</span>    <span class="number">2.715348700</span>    <span class="number">2.715348700</span>    <span class="number">0.000000000</span></span><br><span class="line">      <span class="string">Si</span>    <span class="number">2.715348700</span>    <span class="number">0.000000000</span>    <span class="number">2.715348700</span></span><br><span class="line">      <span class="string">Si</span>    <span class="number">4.073023100</span>    <span class="number">1.357674400</span>    <span class="number">4.073023100</span></span><br><span class="line">      <span class="string">Si</span>    <span class="number">1.357674400</span>    <span class="number">1.357674400</span>    <span class="number">1.357674400</span></span><br><span class="line">      <span class="string">Si</span>    <span class="number">1.357674400</span>    <span class="number">4.073023100</span>    <span class="number">4.073023100</span></span><br><span class="line">      <span class="string">Si</span>    <span class="number">4.073023100</span>    <span class="number">4.073023100</span>    <span class="number">1.357674400</span></span><br><span class="line">    <span class="string">&amp;END</span> <span class="string">COORD</span></span><br><span class="line">  <span class="string">&amp;END</span> <span class="string">SUBSYS</span></span><br><span class="line">  <span class="meta">&amp;DFT</span></span><br><span class="line">    <span class="string">BASIS_SET_FILE_NAME</span>  <span class="string">BASIS_SET</span></span><br><span class="line">    <span class="string">POTENTIAL_FILE_NAME</span>  <span class="string">GTH_POTENTIALS</span></span><br><span class="line">    <span class="meta">&amp;QS</span></span><br><span class="line">      <span class="string">EPS_DEFAULT</span> <span class="number">1.0E-10</span></span><br><span class="line">    <span class="string">&amp;END</span> <span class="string">QS</span></span><br><span class="line">    <span class="meta">&amp;MGRID</span></span><br><span class="line">      <span class="string">NGRIDS</span> <span class="number">4</span></span><br><span class="line">      <span class="string">CUTOFF</span> <span class="number">300</span></span><br><span class="line">      <span class="string">REL_CUTOFF</span> <span class="number">60</span></span><br><span class="line">    <span class="string">&amp;END</span> <span class="string">MGRID</span></span><br><span class="line">    <span class="meta">&amp;XC</span></span><br><span class="line">      <span class="string">&amp;XC_FUNCTIONAL</span> <span class="string">PADE</span></span><br><span class="line">      <span class="string">&amp;END</span> <span class="string">XC_FUNCTIONAL</span></span><br><span class="line">    <span class="string">&amp;END</span> <span class="string">XC</span></span><br><span class="line">    <span class="meta">&amp;SCF</span></span><br><span class="line">      <span class="string">SCF_GUESS</span> <span class="string">ATOMIC</span></span><br><span class="line">      <span class="string">EPS_SCF</span> <span class="number">1.0E-7</span></span><br><span class="line">      <span class="string">MAX_SCF</span> <span class="number">300</span></span><br><span class="line">      <span class="string">&amp;DIAGONALIZATION</span>  <span class="string">ON</span></span><br><span class="line">        <span class="string">ALGORITHM</span> <span class="string">STANDARD</span></span><br><span class="line">      <span class="string">&amp;END</span> <span class="string">DIAGONALIZATION</span></span><br><span class="line">      <span class="string">&amp;MIXING</span>  <span class="string">T</span></span><br><span class="line">        <span class="string">METHOD</span> <span class="string">BROYDEN_MIXING</span></span><br><span class="line">        <span class="string">ALPHA</span> <span class="number">0.4</span></span><br><span class="line">        <span class="string">NBROYDEN</span> <span class="number">8</span></span><br><span class="line">      <span class="string">&amp;END</span> <span class="string">MIXING</span></span><br><span class="line">    <span class="string">&amp;END</span> <span class="string">SCF</span></span><br><span class="line">  <span class="string">&amp;END</span> <span class="string">DFT</span></span><br><span class="line">  <span class="meta">&amp;PRINT</span></span><br><span class="line">    <span class="string">&amp;FORCES</span> <span class="string">ON</span></span><br><span class="line">    <span class="string">&amp;END</span> <span class="string">FORCES</span></span><br><span class="line">  <span class="string">&amp;END</span> <span class="string">PRINT</span></span><br><span class="line"><span class="string">&amp;END</span> <span class="string">FORCE_EVAL</span></span><br></pre></td></tr></table></figure>
<h2 id="amp-GLOBAL-修改任务类型"><a href="#amp-GLOBAL-修改任务类型" class="headerlink" title="&amp;GLOBAL 修改任务类型"></a>&amp;GLOBAL 修改任务类型</h2><figure class="highlight armasm"><table><tr><td class="code"><pre><span class="line">&amp;<span class="meta">GLOBAL</span></span><br><span class="line">  PROJECT Si_bulk8</span><br><span class="line">  RUN_TYPE ENERGY_FORCE</span><br><span class="line">  PRINT_LEVEL LOW</span><br><span class="line">&amp;<span class="meta">END</span> <span class="meta">GLOBAL</span></span><br></pre></td></tr></table></figure>
<ul>
<li><code>PROJECT</code>：任务名称，等同于<code>PROJECT_NAME</code>，CP2K自动生成的所有输出文件都将以这个名称开头。</li>
<li><code>RUN_TYPE</code>：任务类型，<code>ENERGY_FORCE</code>进行静态能量和力的计算</li>
<li><code>PRINT_LEVEL</code>：全局的输出内容级别，可以是<code>SILENT</code>、<code>MEDIUM</code>（默认）、<code>LOW</code>、<code>HIGH</code>等。还可以在输入文件中的每个小节来控制单独的输出级别。</li>
</ul>
<h2 id="amp-FORCE-EVAL"><a href="#amp-FORCE-EVAL" class="headerlink" title="&amp;FORCE_EVAL"></a>&amp;FORCE_EVAL</h2><ul>
<li><code>METHOD</code>：使用哪种方法来计算力<ul>
<li><code>QS</code>：默认，同<code>QUICKSTEP</code>，即使用高斯和平面波（GPW）方法的密度泛函理论。与<code>&amp;DFT</code>一起使用。</li>
</ul>
</li>
</ul>
<h3 id="amp-SUBSYS"><a href="#amp-SUBSYS" class="headerlink" title="&amp;SUBSYS"></a>&amp;SUBSYS</h3><figure class="highlight 1c"><table><tr><td class="code"><pre><span class="line"><span class="meta">&amp;SUBSYS</span></span><br><span class="line">……</span><br><span class="line"><span class="meta">&amp;END SUBSYS</span></span><br></pre></td></tr></table></figure>
<p>定义模拟晶胞和计算中原子的初始坐标。</p>
<h4 id="amp-KIND-修改基组"><a href="#amp-KIND-修改基组" class="headerlink" title="&amp;KIND 修改基组"></a>&amp;KIND 修改基组</h4><p>定义计算中的元素，每个元素必须有一个<code>&amp;KIND</code>。</p>
<figure class="highlight fortran"><table><tr><td class="code"><pre><span class="line">&amp;<span class="keyword">KIND</span> Si</span><br><span class="line">  ELEMENT   Si</span><br><span class="line">  BASIS_SET DZVP-GTH-PADE</span><br><span class="line">  POTENTIAL GTH-PADE-q4</span><br><span class="line">&amp;<span class="keyword">END</span> <span class="keyword">KIND</span></span><br></pre></td></tr></table></figure>
<ul>
<li><code>BASIS_SET</code>：定义基组，如DZVP-GTH-PADE（双 ζ 带有极化基础的ζ，针对Geodecker-Teter-Hutter PADE LDA赝势进行了优化），同<code>BASIS_SET_FILE_NAME</code></li>
<li><code>POTENTIAL</code>：定义赝势GTH-PADE-q4（具有4个价电子的Geodecker-Teter-Hutter PADE LDA赝势），同<code>POTENTIAL_FILE_NAME</code></li>
</ul>
<p>可以在 BASIS_SET和GTH_POTENTIALS文件中查找到<code>Si DZVP-GTH-PADE</code>和<code>Si GTH-PADE-q4 GTH-LDA-q4</code></p>
<h4 id="amp-CELL"><a href="#amp-CELL" class="headerlink" title="&amp;CELL"></a>&amp;CELL</h4><p>定义了计算中使用的模拟单位。Angstrom是默认的晶格向量单位，  <code>A</code>，<code>B</code>和<code>C</code>是第一，第二和第三晶格（单元）矢量。</p>
<figure class="highlight dns"><table><tr><td class="code"><pre><span class="line">&amp;CELL</span><br><span class="line">  <span class="keyword">A</span>     <span class="number">5</span>.<span class="number">430697500</span>    <span class="number">0</span>.<span class="number">000000000</span>    <span class="number">0</span>.<span class="number">000000000</span></span><br><span class="line">  B     <span class="number">0</span>.<span class="number">000000000</span>    <span class="number">5</span>.<span class="number">430697500</span>    <span class="number">0</span>.<span class="number">000000000</span></span><br><span class="line">  C     <span class="number">0</span>.<span class="number">000000000</span>    <span class="number">0</span>.<span class="number">000000000</span>    <span class="number">5</span>.<span class="number">430697500</span></span><br><span class="line">&amp;END CELL</span><br></pre></td></tr></table></figure>
<ul>
<li><code>ABC</code>：指定晶格向量A，B和C的长度，它们定义正交晶胞的h矩阵的对角元素。对于非斜方细胞，可以通过<code>ALPHA_BETA_GAMMA</code>关键字指定角度ALPHA，BETA，GAMMA，也可以使用关键字<code>A</code>，<code>B</code>和<code>C</code>。约定是<code>A</code>沿X轴放置，<code>B</code>在XY平面上。</li>
<li><code>PERIODIC</code>：指定将应用周期性边界条件（PBC）的方向。默认是<code>XYZ</code>。</li>
<li><code>MULTIPLE_UNIT_CELL</code>：指定已定义单元格在空间（X，Y，Z）中的重复次数（假设其为单位单元格）。此关键字仅影响晶胞。默认为<code>1 1 1</code></li>
</ul>
<h4 id="amp-COORD"><a href="#amp-COORD" class="headerlink" title="&amp;COORD"></a>&amp;COORD</h4><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&amp;COORD</span></span><br><span class="line">  <span class="string">Si</span>    <span class="number">0.000000000</span>    <span class="number">0.000000000</span>    <span class="number">0.000000000</span></span><br><span class="line">  <span class="string">Si</span>    <span class="number">0.000000000</span>    <span class="number">2.715348700</span>    <span class="number">2.715348700</span></span><br><span class="line">  <span class="string">Si</span>    <span class="number">2.715348700</span>    <span class="number">2.715348700</span>    <span class="number">0.000000000</span></span><br><span class="line">  <span class="string">Si</span>    <span class="number">2.715348700</span>    <span class="number">0.000000000</span>    <span class="number">2.715348700</span></span><br><span class="line">  <span class="string">Si</span>    <span class="number">4.073023100</span>    <span class="number">1.357674400</span>    <span class="number">4.073023100</span></span><br><span class="line">  <span class="string">Si</span>    <span class="number">1.357674400</span>    <span class="number">1.357674400</span>    <span class="number">1.357674400</span></span><br><span class="line">  <span class="string">Si</span>    <span class="number">1.357674400</span>    <span class="number">4.073023100</span>    <span class="number">4.073023100</span></span><br><span class="line">  <span class="string">Si</span>    <span class="number">4.073023100</span>    <span class="number">4.073023100</span>    <span class="number">1.357674400</span></span><br><span class="line"><span class="string">&amp;END</span> <span class="string">COORD</span></span><br></pre></td></tr></table></figure>
<ul>
<li><p>定义初始原子单位，默认输入格式为：</p>
<figure class="highlight tp"><table><tr><td class="code"><pre><span class="line">&lt;ATOM_KIND&gt; <span class="keyword">X</span> <span class="keyword">Y</span> <span class="keyword">Z</span></span><br></pre></td></tr></table></figure>
<ul>
<li><code>X</code>，<code>Y</code>和<code>Z</code>是埃的笛卡尔坐标</li>
<li><code>&lt;ATOM_KIND&gt;</code>应该是与<code>&amp;KIND</code>小节中元素的定义相对应的标签。</li>
</ul>
</li>
<li><p><code>SCALED</code>：使坐标输入相对于晶格矢量为分数，默认是<code>.FALSE.</code>，可以改为<code>.TRUE.</code></p>
</li>
<li><p><code>UNIT</code>：更改笛卡尔坐标的单位，默认是 <code>ANGSTROM</code></p>
</li>
</ul>
<h4 id="amp-TOPOLOGY"><a href="#amp-TOPOLOGY" class="headerlink" title="&amp;TOPOLOGY"></a>&amp;TOPOLOGY</h4><ul>
<li><p><code>COORD_FILE_NAME</code>：指定包含坐标的文件名。</p>
</li>
<li><p><code>COORDINATE</code>：等同于<code>COORD_FILE_FORMAT</code>，设置读取坐标的方式:</p>
<ul>
<li><code>off</code>：在输入文件的＆COORD部分中读取的坐标</li>
<li><code>XYZ</code>：通过XYZ文件格式提供的坐标</li>
<li><code>PDB</code>：通过PDB文件格式提供的坐标</li>
</ul>
</li>
<li><code>CONN_FILE_NAME</code>：指定包含分子连接性的文件名。</li>
<li><code>CONNECTIVITY</code>：等同<code>CONN_FILE_FORMAT</code>，确定和生成分子的方法：<ul>
<li><code>GENERATE</code>：默认。使用简单的距离标准。</li>
<li><code>OFF</code>：不产生分子。用于QS或定义不明确的系统。</li>
</ul>
</li>
<li><code>MULTIPLE_UNIT_CELL</code>：指定已定义单元格在空间（X，Y，Z）中的重复次数（假设其为单位晶胞）。此关键字仅影响坐标规范。默认为<code>1 1 1</code></li>
</ul>
<h3 id="amp-DFT"><a href="#amp-DFT" class="headerlink" title="&amp;DFT"></a>&amp;DFT</h3><figure class="highlight 1c"><table><tr><td class="code"><pre><span class="line"><span class="meta">&amp;DFT</span></span><br><span class="line">  BASIS_SET_FILE_NAME  BASIS_SET</span><br><span class="line">  POTENTIAL_FILE_NAME  GTH_POTENTIALS</span><br><span class="line">  ……</span><br><span class="line"><span class="meta">&amp;END DFT</span></span><br></pre></td></tr></table></figure>
<p>该部分控制自洽的Kohn-Sham密度泛函理论计算的所有方面。仅当且仅当<code>FORCE_EVAL</code>中的<code>METHOD</code>关键字设置为<code>QUICKSTEP</code>时，<code>&amp;DFT</code>才有意义。</p>
<ul>
<li><code>BASIS_SET_FILE_NAME</code>设定基组文件</li>
<li><code>POTENTIAL_FILE_NAME</code>设定赝势文件</li>
<li><p><code>WFN_RESTART_FILE_NAME</code>：wavefunction重新启动文件的名称和路径，如果未指定文件，则默认为打开由wfn restart打印键生成的文件。</p>
</li>
<li><p><code>CHARGE</code>：设定系统的总电荷，默认为<code>0</code></p>
</li>
<li><code>MULTIPLICITY</code>：与<code>MULTIP</code>相同，为2S+1，偶数个电子默认是<code>1</code>，奇数个默认为<code>2</code>。</li>
</ul>
<h4 id="amp-QS"><a href="#amp-QS" class="headerlink" title="&amp;QS"></a>&amp;QS</h4><p>包含QUICKSTEP使用的常规控制参数。</p>
<figure class="highlight 1c"><table><tr><td class="code"><pre><span class="line"><span class="meta">&amp;QS</span></span><br><span class="line">  EPS_DEFAULT <span class="number">1.0</span>E-<span class="number">10</span></span><br><span class="line"><span class="meta">&amp;END QS</span></span><br></pre></td></tr></table></figure>
<ul>
<li><code>EPS_DEFAULT</code>：QUICKSTEP中使用的所有公差设置默认值。默认为<script type="math/tex">10^{-10}</script>。在进行比较高精度计算时，需要将EPS_DEFAULT 设为1.0E-14。</li>
<li><code>EPS_ *</code>：设置各类公差，覆盖EPS_DEFAULT值。<ul>
<li><code>EPS_CORE_CHARGE</code>：核电荷映射精度，默认为<code>EPS_DEFAULT</code>/100.0</li>
<li><code>EPS_GVG_RSPACE</code>：实空间KS 矩阵元积分精度。默认为SQRT(EPS_DEFAULT)</li>
<li><code>EPS_PGF_ORB</code>：重叠矩阵元精度，默认为SQRT(EPS_DEFAULT)</li>
<li><code>EPS_KG_ORB</code>：使用Kim-Gordon 方法时的精度,默认为SQRT(EPS_DEFAULT)</li>
</ul>
</li>
<li><code>METHOD</code>：指定应采用的电子结构方法<ul>
<li><code>GBW</code>：默认。高斯和平面波方法。</li>
</ul>
</li>
</ul>
<h4 id="amp-MGRID"><a href="#amp-MGRID" class="headerlink" title="&amp;MGRID"></a>&amp;MGRID</h4><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&amp;MGRID</span></span><br><span class="line">  <span class="string">NGRIDS</span> <span class="number">4</span></span><br><span class="line">  <span class="string">CUTOFF</span> <span class="number">300</span></span><br><span class="line">  <span class="string">REL_CUTOFF</span> <span class="number">60</span></span><br><span class="line"><span class="string">&amp;END</span> <span class="string">MGRID</span></span><br></pre></td></tr></table></figure>
<p>定义了QUICKSTEP计算中使用的积分网格。设置4个级别的多重网格。</p>
<h4 id="amp-XC-修改泛函"><a href="#amp-XC-修改泛函" class="headerlink" title="&amp;XC 修改泛函"></a>&amp;XC 修改泛函</h4><p>使用的交换相关密度泛函的参数</p>
<figure class="highlight 1c"><table><tr><td class="code"><pre><span class="line"><span class="meta">&amp;XC</span></span><br><span class="line">……</span><br><span class="line"><span class="meta">&amp;END XC</span></span><br></pre></td></tr></table></figure>
<h5 id="amp-XC-FUNCTIONAL"><a href="#amp-XC-FUNCTIONAL" class="headerlink" title="&amp;XC_FUNCTIONAL"></a>&amp;XC_FUNCTIONAL</h5><p>注意选择的泛函要与所选择的基组和赝势一致</p>
<figure class="highlight 1c"><table><tr><td class="code"><pre><span class="line"><span class="meta">&amp;XC_FUNCTIONAL PADE</span></span><br><span class="line"><span class="meta">&amp;END XC_FUNCTIONAL</span></span><br></pre></td></tr></table></figure>
<ul>
<li><code>PADE</code>：使用的PADE，即LDA泛函</li>
<li><code>PBE</code>：使用PBE泛函</li>
<li><code>BLYP</code></li>
</ul>
<h5 id="amp-XC-GRID"><a href="#amp-XC-GRID" class="headerlink" title="&amp;XC_GRID"></a>&amp;XC_GRID</h5><ul>
<li><code>XC_SMOOTH_RHO</code>：用于xc计算的密度平滑，默认为<code>NONE</code>。还有<code>NN10</code>、<code>NN4</code>、<code>NN50</code>、<code>NN6</code>、<code>SPLINE2</code>、<code>SPLINE3</code></li>
<li><code>XC_DERIV</code>：用于计算导数的方法。默认为<code>PW</code>，还有<code>COLLOCATE</code>、<code>NN10_SMOOTH</code>、<code>NN4_SMOOTH</code>、<code>NN50_SMOOTH</code>、<code>NN6_SMOOTH</code>、<code>SPLINE2</code>、<code>SPLINE2_SMOOTH</code>、<code>SPLINE3</code>、<code>SPLINE3_SMOOTH</code></li>
</ul>
<h4 id="amp-SCF"><a href="#amp-SCF" class="headerlink" title="&amp;SCF"></a>&amp;SCF</h4><p>定义自洽场方法的设置</p>
<figure class="highlight properties"><table><tr><td class="code"><pre><span class="line"><span class="attr">&amp;SCF</span></span><br><span class="line">  <span class="attr">SCF_GUESS</span> <span class="string">ATOMIC</span></span><br><span class="line">  <span class="attr">EPS_SCF</span> <span class="string">1.0E-7</span></span><br><span class="line">  <span class="attr">MAX_SCF</span> <span class="string">300</span></span><br><span class="line">  <span class="attr">……</span></span><br><span class="line"><span class="meta">&amp;END</span> <span class="string">SCF</span></span><br></pre></td></tr></table></figure>
<ul>
<li><p><code>SCF_GUESS</code>设置初始试验电子密度泛函<script type="math/tex">\rho(\vec{r})</script>。自洽场迭代中，初猜对于快速收敛比较重要。</p>
<ul>
<li><code>ATOMIC</code>：将使用原子电荷密度的重叠来生成初始密度。</li>
<li><code>RESTART</code>：将RESTART文件用作初始猜测（如果不存在，则使用<code>ATOMIC</code>）</li>
</ul>
</li>
<li><code>EPS_SCF</code>：设置电荷密度剩余量的公差。这将覆盖<code>&amp;QS</code>小节中设置的<code>EPS_DEFAULT</code>值。 默认为<script type="math/tex">10^{-5}</script>。如果要<br>进行比较高精度的计算，可以将SCF 收敛精度设置为<code>1E-6</code>。对于频率计算等精度要求更高的计算，SCF 收敛精度可以设置为<code>1E-7</code>。</li>
<li><code>MAX_SCF</code>：设置允许QUICKSTEP执行的每次基态能量计算的最大自洽循环数。</li>
<li><code>ADDED_MOS</code>：每个自旋附加的MOS数量，默认为<code>0</code>，在使用对角化方法<code>&amp;DIAGONALIZATION</code>的时候必须使用。</li>
</ul>
<h5 id="amp-DIAGONALIZATION"><a href="#amp-DIAGONALIZATION" class="headerlink" title="&amp;DIAGONALIZATION"></a>&amp;DIAGONALIZATION</h5><p>告诉代码使用传统的对角化方法来查找基态Kohn-Sham能量和电子密度。如果该节中有参数，就应当设置为<code>ON</code>或<code>.TRUE.</code>或<code>T</code>。对角化的替代方法是使用轨道变换（OT）方法，在这种情况下，用户应删除<code>&amp;DIAGONALIZATION</code>块或改为<code>OFF</code>或<code>.FALSE.</code>，然后添加<code>&amp;OT</code>代替。</p>
<figure class="highlight sas"><table><tr><td class="code"><pre><span class="line"><span class="variable">&amp;DIAGONALIZATION</span>  <span class="meta">ON</span></span><br><span class="line">  ALGORITHM STANDARD</span><br><span class="line"><span class="variable">&amp;END</span> DIAGONALIZATION</span><br></pre></td></tr></table></figure>
<ul>
<li><code>ALGORITHM</code>用于对角化的算法<ul>
<li><code>STANDARD</code>：标准对角化：LAPACK/SCALAPACK方法或Jacobi。</li>
</ul>
</li>
</ul>
<h5 id="amp-MIXING"><a href="#amp-MIXING" class="headerlink" title="&amp;MIXING"></a>&amp;MIXING</h5><p>包含自一致性计算中与电荷混合相关的所有参数。可以通过<code>.TRUE.</code>（<code>T</code>）或者<code>.FALSE.</code>（<code>F</code>）来打开或者关闭，默认是打开。仅适用于传统的对角线化方法， OT方法使用不同的方法进行电荷混合。</p>
<figure class="highlight oxygene"><table><tr><td class="code"><pre><span class="line">&amp;MIXING  T</span><br><span class="line">  <span class="function"><span class="keyword">METHOD</span> <span class="title">BROYDEN_MIXING</span></span></span><br><span class="line"><span class="function">  <span class="title">ALPHA</span> 0.4</span></span><br><span class="line"><span class="function">  <span class="title">NBROYDEN</span> 8</span></span><br><span class="line"><span class="function">&amp;<span class="title">END</span> <span class="title">MIXING</span></span></span><br></pre></td></tr></table></figure>
<ul>
<li><p><code>METHOD</code>：设置混合方法</p>
<ul>
<li><code>BROYDEN_MIXING</code>：使用Broyden混合</li>
<li><code>PULAY_MIXING</code>：使用Pulay混合法</li>
</ul>
</li>
<li><p><code>ALPHA</code>：设置混合参数，默认是<code>0.4</code>。比如<code>0.4</code>是将0.4的输出密度与0.6的输入密度混合，以在下一个SCF迭代中形成新的输入密度。</p>
</li>
<li><p><code>NBUFFER</code>：实际混合方案存储的先前步骤数，等同于<code>NBROYDEN</code>、<code>NPULAY</code>、<code>NMULTISECANT</code>，设置在Broyden混合算法、Pulay混合法中使用的历史记录数。</p>
</li>
<li><p><code>&amp;SMEAR</code>：不使用Smearing对于金属或间隙很小的系统，这可能会导致计算不稳定，并且由于电子占据函数的不连续性，自洽迭代可能永远不会收敛。因此可以添加</p>
<figure class="highlight oxygene"><table><tr><td class="code"><pre><span class="line">&amp;SMEAR <span class="keyword">ON</span></span><br><span class="line">  <span class="function"><span class="keyword">METHOD</span> <span class="title">FERMI_DIRAC</span></span></span><br><span class="line"><span class="function">  <span class="title">ELECTRONIC_TEMPERATURE</span> [<span class="title">K</span>] 300</span></span><br><span class="line"><span class="function">&amp;<span class="title">END</span> <span class="title">SMEA</span></span></span><br></pre></td></tr></table></figure>
<ul>
<li><code>METHOD</code>：使用的Smearing方法，<code>FERMI_DIRAC</code>即Fermi-Dirac smearing function</li>
<li><code>ELECTRONIC_TEMPERATURE</code>：电子温度</li>
</ul>
</li>
<li><p><code>ADDED_MOS</code>：如果不使用该关键词，仅使用<code>&amp;SMEAR</code>，会导致导带中的分子轨道被占用，必须告诉CP2K在计算中包括多余的，空的分子轨道，否则为了以减少计算成本将被省略。</p>
<ul>
<li><p>比如在计算中不要忽略10个最低的空分子轨道。应该注意的是，给定选定的基组，会有一个分子轨道最大数量，即Hamiltonian的特征向量数量。理论上，最大值应为在计算中生成的Hamiltonian的范围内。</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">ADDED_MOS <span class="number">10</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h5 id="amp-PRINT"><a href="#amp-PRINT" class="headerlink" title="&amp;PRINT"></a>&amp;PRINT</h5><p>在SCF期间打印信息：</p>
<ul>
<li><code>&amp;RESTART</code>在SCF期间控制MO重新启动文件的转储。默认情况下，保留简短的三次重新启动的历史记录。</li>
</ul>
<h5 id="amp-OT"><a href="#amp-OT" class="headerlink" title="&amp;OT"></a>&amp;OT</h5><p>如果体系有较大带隙的，如为半导体或者绝缘体等，推荐使用OT 算法，收敛速度比较快。但是对预处理敏感。好的预处理器可能很昂贵。不能<code>smearing</code>或进行高级<code>SCF mixing</code> ，HOMO-LUMO 带隙很小或者几乎没有的系统，如金属系统，收敛性较差（此时应该使用<code>&amp;DIAGONALIZATION</code>和<code>&amp;Smear</code>）。设置轨道变换（OT）方法的各种选项：</p>
<ul>
<li><code>PRECONDITIONER</code>：<ul>
<li><code>FULL_KINETIC</code>：默认。S和T的Cholesky反转，快速构建，强大且相对较好，可用于超大型系统。</li>
<li><code>FULL_ALL</code>：基于对角化的最有效的状态选择性预处理器，要求ENERGY_GAP参数低估HOMO-LUMO间隙。对于几乎所有系统，都建议使用此预处理器，但在大型系统中，make_preconditioner将主导总计算成本。</li>
</ul>
</li>
<li><code>MINIMIZER</code>：<ul>
<li><code>CG</code>：默认，共轭梯度：最可靠，适用于困难的系统。如果合适的话，总能量应该在每个OT CG步骤减少。</li>
<li><code>DIIS</code>：迭代子空间中的直接反演，也称为Pulay混合，是一种外推技术。由Peter Pulay在计算量子化学领域开发，旨在加速和稳定Hartree-Fock自洽场方法的收敛。不如CG可靠，但有时快约50％。</li>
<li><code>BROYDEN</code>：如果<code>CG</code>和<code>DIIS</code>都有问题，可以使用这个方法。</li>
</ul>
</li>
<li><code>ENERGY_GAP</code>：默认是-1。应该是能隙[a.u.]（HOMO-LUMO）的估计值，并应在预处理中使用，尤其是对<code>FULL_ALL</code>预处理器有效，在这种情况下，它应该比能隙小。（可以为小数，例如0.002） 。 <code>FULL_SINGLE_INVERSE</code>将其作为下限（值小于0.05可能会导致稳定性问题）。通常，在初始猜测很差的情况下，heigher值会驯服预处理器。负值将取决于预调节器的类型，使选择留给CP2K。</li>
<li></li>
</ul>
<h5 id="amp-OUTER-SCF"><a href="#amp-OUTER-SCF" class="headerlink" title="&amp;OUTER_SCF"></a>&amp;OUTER_SCF</h5><p><code>OUTER_SCF</code> 为加速收敛的一种方法，如果SCF 经过100 次优化依然没有收敛，则进入OUTER_SCF 过程，对前一次计算的波函数进行调整，重新进行SCF 迭代。每次OUTER_SCF 中优化的次数依然是100 次，比如最多可以进行5次OUTER_SCF，那么最多可以进行500 次SCF 计算。</p>
<ul>
<li><code>EPS_SCF</code>： outer SCF变量的目标梯度。默认为<script type="math/tex">10^{-5}</script>。内部循环的<code>EPS_SCF</code>还确定了外部循环可以达到的值，通常，外部循环的<code>EPS_SCF</code>必须小于或等于内部循环的EPS_SCF。</li>
<li><code>MAX_SCF</code>：最大循环数</li>
</ul>
<h3 id="amp-PRINT-1"><a href="#amp-PRINT-1" class="headerlink" title="&amp;PRINT"></a>&amp;PRINT</h3><ul>
<li><code>&amp;FORCES</code>，在主要的输出中输出原子受力。<code>GLOBAL</code> 部分的<code>RUN_TYPE</code> 必须设置为<code>ENERGY_FORCE</code> 或者<code>GEO_OPT</code>。如果要将受力信息存储到文件中，则需要设定文件的名称；否则受力信息将会打印到out 文件中。</li>
<li></li>
</ul>
<h1 id="输出文件"><a href="#输出文件" class="headerlink" title="输出文件"></a>输出文件</h1><h2 id="out"><a href="#out" class="headerlink" title=".out"></a>.out</h2><p>主要的输出文件</p>
<ul>
<li><p>自洽的Kohn-Sham基态计算的典型输出。它说明正在使用对角化方法和Broyden电荷混合，并且花了10个Broyden混合步骤（每个步骤都包含对角化过程以获得波函数），以达到所需的自洽公差。</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">Number of electrons:</span>                                                         <span class="number">32</span></span><br><span class="line"><span class="attr">Number of occupied orbitals:</span>                                                 <span class="number">16</span></span><br><span class="line"><span class="attr">Number of molecular orbitals:</span>                                                <span class="number">16</span></span><br><span class="line"></span><br><span class="line"><span class="attr">Number of orbital functions:</span>                                                <span class="number">104</span></span><br><span class="line"><span class="attr">Number of independent orbital functions:</span>                                    <span class="number">104</span></span><br><span class="line"></span><br><span class="line"><span class="attr">Extrapolation method:</span> <span class="string">initial_guess</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">SCF</span> <span class="string">WAVEFUNCTION</span> <span class="string">OPTIMIZATION</span></span><br><span class="line"></span><br><span class="line"> <span class="string">Step</span>     <span class="string">Update</span> <span class="string">method</span>      <span class="string">Time</span>    <span class="string">Convergence</span>         <span class="string">Total</span> <span class="string">energy</span>    <span class="string">Change</span></span><br><span class="line"> <span class="string">------------------------------------------------------------------------------</span></span><br><span class="line">    <span class="number">1</span> <span class="string">NoMix/Diag.</span> <span class="number">0.40E+00</span>    <span class="number">0.6</span>     <span class="number">0.75558724</span>       <span class="number">-32.2320848878</span> <span class="number">-3.22E+01</span></span><br><span class="line">    <span class="number">2</span> <span class="string">Broy./Diag.</span> <span class="number">0.40E+00</span>    <span class="number">1.1</span>     <span class="number">0.05667976</span>       <span class="number">-31.1418135481</span>  <span class="number">1.09E+00</span></span><br><span class="line">    <span class="number">3</span> <span class="string">Broy./Diag.</span> <span class="number">0.40E+00</span>    <span class="number">1.1</span>     <span class="number">0.09691469</span>       <span class="number">-31.1974003416</span> <span class="number">-5.56E-02</span></span><br><span class="line">    <span class="number">4</span> <span class="string">Broy./Diag.</span> <span class="number">0.40E+00</span>    <span class="number">1.1</span>     <span class="number">0.00245608</span>       <span class="number">-31.3378474040</span> <span class="number">-1.40E-01</span></span><br><span class="line">    <span class="number">5</span> <span class="string">Broy./Diag.</span> <span class="number">0.40E+00</span>    <span class="number">1.1</span>     <span class="number">0.00235460</span>       <span class="number">-31.3009654398</span>  <span class="number">3.69E-02</span></span><br><span class="line">    <span class="number">6</span> <span class="string">Broy./Diag.</span> <span class="number">0.40E+00</span>    <span class="number">1.1</span>     <span class="number">0.00007565</span>       <span class="number">-31.2972158934</span>  <span class="number">3.75E-03</span></span><br><span class="line">    <span class="number">7</span> <span class="string">Broy./Diag.</span> <span class="number">0.40E+00</span>    <span class="number">1.1</span>     <span class="number">0.00009004</span>       <span class="number">-31.2977293749</span> <span class="number">-5.13E-04</span></span><br><span class="line">    <span class="number">8</span> <span class="string">Broy./Diag.</span> <span class="number">0.40E+00</span>    <span class="number">1.1</span>     <span class="number">0.00000186</span>       <span class="number">-31.2978454163</span> <span class="number">-1.16E-04</span></span><br><span class="line">    <span class="number">9</span> <span class="string">Broy./Diag.</span> <span class="number">0.40E+00</span>    <span class="number">1.1</span>     <span class="number">0.00000252</span>       <span class="number">-31.2978835492</span> <span class="number">-3.81E-05</span></span><br><span class="line">   <span class="number">10</span> <span class="string">Broy./Diag.</span> <span class="number">0.40E+00</span>    <span class="number">1.1</span>     <span class="number">5.6405E-09</span>       <span class="number">-31.2978852054</span> <span class="number">-1.66E-06</span></span><br><span class="line"></span><br><span class="line"> <span class="string">***</span> <span class="string">SCF</span> <span class="string">run</span> <span class="string">converged</span> <span class="string">in</span>    <span class="number">10</span> <span class="string">steps</span> <span class="string">***</span></span><br></pre></td></tr></table></figure>
<ul>
<li>如果使用了<code>&amp;SMEAR</code>和<code>ADDED_MOS</code>，分子轨道数目为26个，在计算中总共使用了104个基函数（由笛卡尔高斯分布的原子中心轨道），26在计算范围之内。</li>
</ul>
</li>
<li><p>最终能量和力的结果，应当检查最终电子密度计算出的电子总数<code>Electronic density on regular grids</code>是否正确。比如此例中为-31.9999999889。</p>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">Electronic</span> density <span class="literal">on</span> regular grids:        -<span class="number">31</span>.<span class="number">9999999889</span>        <span class="number">0</span>.<span class="number">0000000111</span></span><br><span class="line"> <span class="attribute">Core</span> density <span class="literal">on</span> regular grids:               <span class="number">31</span>.<span class="number">9999999939</span>       -<span class="number">0</span>.<span class="number">0000000061</span></span><br><span class="line"> <span class="attribute">Total</span> charge density <span class="literal">on</span> r-space grids:        <span class="number">0</span>.<span class="number">0000000051</span></span><br><span class="line"> <span class="attribute">Total</span> charge density g-space grids:           <span class="number">0</span>.<span class="number">0000000051</span></span><br><span class="line"></span><br><span class="line"> <span class="attribute">Overlap</span> energy of the core charge distribution:               <span class="number">0</span>.<span class="number">00000000005320</span></span><br><span class="line"> <span class="attribute">Self</span> energy of the core charge distribution:                -<span class="number">82</span>.<span class="number">06393942512820</span></span><br><span class="line"> <span class="attribute">Core</span> Hamiltonian energy:                                     <span class="number">18</span>.<span class="number">06858429706010</span></span><br><span class="line"> <span class="attribute">Hartree</span> energy:                                              <span class="number">42</span>.<span class="number">41172824581682</span></span><br><span class="line"> <span class="attribute">Exchange</span>-correlation energy:                                 -<span class="number">9</span>.<span class="number">71425832315952</span></span><br><span class="line"></span><br><span class="line"> <span class="attribute">Total</span> energy:                                               -<span class="number">31</span>.<span class="number">29788520535761</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">ENERGY</span>| Total FORCE_EVAL ( QS ) energy (a.u.):              -<span class="number">31</span>.<span class="number">297885372811002</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="attribute">ATOMIC</span> FORCES in<span class="meta"> [a.u.]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Atom   Kind   Element          X              Y              Z</span></span><br><span class="line">     <span class="attribute">1</span>      <span class="number">1</span>      Si          <span class="number">0</span>.<span class="number">00000000</span>     <span class="number">0</span>.<span class="number">00000000</span>     <span class="number">0</span>.<span class="number">00000000</span></span><br><span class="line">     <span class="attribute">2</span>      <span class="number">1</span>      Si          <span class="number">0</span>.<span class="number">00000000</span>     <span class="number">0</span>.<span class="number">00000001</span>     <span class="number">0</span>.<span class="number">00000001</span></span><br><span class="line">     <span class="attribute">3</span>      <span class="number">1</span>      Si          <span class="number">0</span>.<span class="number">00000001</span>     <span class="number">0</span>.<span class="number">00000001</span>     <span class="number">0</span>.<span class="number">00000000</span></span><br><span class="line">     <span class="attribute">4</span>      <span class="number">1</span>      Si          <span class="number">0</span>.<span class="number">00000001</span>     <span class="number">0</span>.<span class="number">00000000</span>     <span class="number">0</span>.<span class="number">00000001</span></span><br><span class="line">     <span class="attribute">5</span>      <span class="number">1</span>      Si         -<span class="number">0</span>.<span class="number">00000001</span>    -<span class="number">0</span>.<span class="number">00000001</span>    -<span class="number">0</span>.<span class="number">00000001</span></span><br><span class="line">     <span class="attribute">6</span>      <span class="number">1</span>      Si         -<span class="number">0</span>.<span class="number">00000001</span>    -<span class="number">0</span>.<span class="number">00000001</span>    -<span class="number">0</span>.<span class="number">00000001</span></span><br><span class="line">     <span class="attribute">7</span>      <span class="number">1</span>      Si         -<span class="number">0</span>.<span class="number">00000001</span>    -<span class="number">0</span>.<span class="number">00000001</span>    -<span class="number">0</span>.<span class="number">00000001</span></span><br><span class="line">     <span class="attribute">8</span>      <span class="number">1</span>      Si         -<span class="number">0</span>.<span class="number">00000001</span>    -<span class="number">0</span>.<span class="number">00000001</span>    -<span class="number">0</span>.<span class="number">00000001</span></span><br><span class="line"><span class="attribute">SUM</span> OF ATOMIC FORCES          -<span class="number">0</span>.<span class="number">00000000</span>    -<span class="number">0</span>.<span class="number">00000000</span>    -<span class="number">0</span>.<span class="number">00000000</span>     <span class="number">0</span>.<span class="number">00000000</span></span><br></pre></td></tr></table></figure>
<ul>
<li><p>如果使用了<code>&amp;SMEAR</code>和<code>ADDED_MOS</code>，在<code>Exchange-correlation energy</code>后面会多出</p>
<ul>
<li><p>熵entrop（TS）项：为了使计算成为零电子温度结果的可靠近似值，该值应该很小。</p>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">Electronic</span> entropic energy:                                  -<span class="number">0</span>.<span class="number">00001687947145</span> </span><br><span class="line"><span class="attribute">Fermi</span> energy:                                                 <span class="number">0</span>.<span class="number">20867150262130</span> </span><br></pre></td></tr></table></figure>
</li>
<li><p>最终的自由能是DFT总能量与熵能量之和。 </p>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">Total</span> energy:                                               -<span class="number">31</span>.<span class="number">29788686349247</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>外推到TS→0，最终自由能为：（这是最终结果所引用的能量）</p>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">ENERGY</span>| Total FORCE_EVAL ( QS ) energy (a.u.):              -<span class="number">31</span>.<span class="number">297887031736590</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="wfn"><a href="#wfn" class="headerlink" title=".wfn"></a>.wfn</h2><ul>
<li><p>计算得出的最终Kohn-Sham波函数。</p>
</li>
<li><p>.wfn.bak-n文件记录了从第n个先前的SCF步骤获得的Kohn-Sham波函数，.wfn.bak-1包含从上一个SCF步骤获得的波函数。如果希望从先前计算的波函数开始新的计算，则需要：</p>
<ul>
<li>将<code>FORCE_EVAL</code>部分的<code>SCF</code>子部分中的<code>SCF_GUESS</code>关键字更改为<code>RESTART</code></li>
<li>新计算与生成波函数的计算的<code>PROJECT_NAME</code>相同，否则需要重命名重新启动wavefunction文件以与新计算的项目名称相对应。</li>
</ul>
</li>
</ul>
]]></content>
      <categories>
        <category>计算化学</category>
        <category>软件</category>
      </categories>
      <tags>
        <tag>CP2K</tag>
      </tags>
  </entry>
  <entry>
    <title>【CP2K】03.&amp;MGRID中的CUTOFF和RELEL_CUTOFF</title>
    <url>/2020/11/21/%E3%80%90CP2K%E3%80%9103.MGRID%E4%B8%AD%E7%9A%84CUTOFF%E5%92%8CRELEL-CUTOFF/</url>
    <content><![CDATA[<h1 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h1><ul>
<li><code>&amp;MGRID</code>属于<code>&amp;FORCE_EVAL</code>的<code>&amp;DFT</code>。</li>
<li><p><code>QUICKSTEP</code>要求使用实空间（RS）积分网格来表示某些函数，例如电子密度和乘积高斯函数。 <code>QUICKSTEP</code>使用多网格系统将乘积高斯映射到RS网格上，因此宽而平滑的高斯函数比窄而锐利的高斯函数映射到更粗糙的网格上。（电子密度始终映射到最精细的网格上。）</p>
</li>
<li><p>在这种情况下，从粗糙到精细，需要设置多个级别（默认为4）的多重网格。</p>
</li>
<li><code>CUTOFF</code>：定义了多网格最高级的平面波截止（默认单位为Ry），即控制整体网格精度的最高值。平面波截止频率越高，网格越精细。</li>
<li>后续网格级别（从更精细到更粗糙）的相应平面波截止由<script type="math/tex">E_{\mathrm{cut}}^{i}=\frac{E_{\mathrm{cut}}^{1}}{\alpha^{(i-1)}}</script>定义，α默认值为<code>3.0</code>。对于所有多网格级别，<code>CUTOFF</code>的值越高，网格越细。</li>
<li>构建了多网格后，<code>QUICKSTEP</code>需要将高斯模型映射到网格上。<code>REL_CUTOFF</code>该关键词控制将哪个乘积高斯映射到多网格的哪个级别。 CP2K尝试将每个高斯映射到网格上，以使高斯覆盖的网格点数（无论宽或窄）都大致相同。<code>REL_CUTOFF</code>定义由高斯覆盖的参考网格的平面波截止，其单位标准偏差为<script type="math/tex">e^{|\vec{r}|^{2}}</script>。高斯映射到多网格最粗糙的级别，该函数将覆盖大于或等于由<code>REL_CUTOFF</code>定义的参考网格上<script type="math/tex">e^{|\vec{r}|^{2}}</script>覆盖的网格点数。</li>
<li>因此，影响积分网格和计算准确性的两个最重要的关键字是<code>CUTOFF</code>和<code>REL_CUTOFF</code>。<ul>
<li>如果<code>CUTOFF</code>太低，则所有网格将变得粗糙，计算可能会变得不准确；</li>
<li>如果<code>REL_CUTOFF</code>太低，即使<code>CUTOFF</code>较高，所有高斯也将映射到多网格的最粗糙级别，因此用于计算的有效积分网格可能仍然太粗糙。</li>
</ul>
</li>
</ul>
<h1 id="参数"><a href="#参数" class="headerlink" title="参数"></a>参数</h1><ul>
<li><p><code>NGRIDS</code>：定义要使用的多重网格数 ，默认为<code>4</code>。</p>
</li>
<li><p><code>CUTOFF</code>：默认值为280Ry。SE或DFTB计算的默认值为1.0Ry。</p>
<ul>
<li><p><code>CUTOFF</code>的设置取决于体系中元素的种类。CP2K论坛中建议给不同的原子使用不同的<code>CUTOFF</code>：</p>
<p><img src="1.png" alt=""></p>
</li>
<li><p>对包含Na\N\O\F\Ne\Ni\Ga等元素的计算，需要设置高达1000Ry的<code>CUTOFF</code>来确保计算精度。</p>
</li>
</ul>
</li>
<li><p><code>PROGRESSION_FACTOR</code>：通过该关键词可以修改α。</p>
</li>
<li><p><code>REL_CUTOFF</code>：默认为40Ry。一般设置为50±10Ry的值。</p>
</li>
</ul>
<h1 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h1><h2 id="Si"><a href="#Si" class="headerlink" title="Si"></a>Si</h2><p>以面心立方晶胞中具有8个原子的硅为例，用脚本寻找合适<code>CUTOFF</code>和<code>REL_CUTOFF</code>。</p>
<h3 id="建立模板文件"><a href="#建立模板文件" class="headerlink" title="建立模板文件"></a>建立模板文件</h3><ul>
<li><code>RUN_TYPE</code>中设置为<code>ENERGY</code>，因为只对积分网格的收敛感兴趣，只需要查看能量。</li>
<li><code>CUTOFF</code>和<code>REL_CUTOFF</code>设置为 <code>LT_cutoff</code> 和 <code>LT_rel_cutoff</code> 是标记，自动化脚本将搜索它们并将其替换为相关值。</li>
<li>因为只检查积分网格，与自洽性无关，具有足够精细网格应该提供一致的能量。因此<code>MAX_SCF</code>设置为1。</li>
</ul>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&amp;GLOBAL</span></span><br><span class="line">  <span class="string">PROJECT</span> <span class="string">Si_bulk8</span></span><br><span class="line">  <span class="string">RUN_TYPE</span> <span class="string">ENERGY</span></span><br><span class="line">  <span class="string">PRINT_LEVEL</span> <span class="string">MEDIUM</span></span><br><span class="line"><span class="string">&amp;END</span> <span class="string">GLOBAL</span></span><br><span class="line"><span class="meta">&amp;FORCE_EVAL</span></span><br><span class="line">  <span class="string">METHOD</span> <span class="string">Quickstep</span></span><br><span class="line">  <span class="meta">&amp;DFT</span></span><br><span class="line">    <span class="string">BASIS_SET_FILE_NAME</span>  <span class="string">BASIS_SET</span></span><br><span class="line">    <span class="string">POTENTIAL_FILE_NAME</span>  <span class="string">GTH_POTENTIALS</span></span><br><span class="line">    <span class="meta">&amp;MGRID</span></span><br><span class="line">      <span class="string">NGRIDS</span> <span class="number">4</span></span><br><span class="line">      <span class="string">CUTOFF</span> <span class="string">LT_cutoff</span></span><br><span class="line">      <span class="string">REL_CUTOFF</span> <span class="string">LT_rel_cutoff</span></span><br><span class="line">    <span class="string">&amp;END</span> <span class="string">MGRID</span></span><br><span class="line">    <span class="meta">&amp;QS</span></span><br><span class="line">      <span class="string">EPS_DEFAULT</span> <span class="number">1.0E-10</span></span><br><span class="line">    <span class="string">&amp;END</span> <span class="string">QS</span></span><br><span class="line">    <span class="meta">&amp;SCF</span></span><br><span class="line">      <span class="string">SCF_GUESS</span> <span class="string">ATOMIC</span></span><br><span class="line">      <span class="string">EPS_SCF</span> <span class="number">1.0E-6</span></span><br><span class="line">      <span class="string">MAX_SCF</span> <span class="number">1</span></span><br><span class="line">      <span class="string">ADDED_MOS</span> <span class="number">10</span></span><br><span class="line">      <span class="string">CHOLESKY</span> <span class="string">INVERSE</span></span><br><span class="line">      <span class="string">&amp;SMEAR</span> <span class="string">ON</span></span><br><span class="line">        <span class="string">METHOD</span> <span class="string">FERMI_DIRAC</span></span><br><span class="line">        <span class="string">ELECTRONIC_TEMPERATURE</span> [<span class="string">K</span>] <span class="number">300</span></span><br><span class="line">      <span class="string">&amp;END</span> <span class="string">SMEAR</span></span><br><span class="line">      <span class="meta">&amp;DIAGONALIZATION</span></span><br><span class="line">        <span class="string">ALGORITHM</span> <span class="string">STANDARD</span></span><br><span class="line">      <span class="string">&amp;END</span> <span class="string">DIAGONALIZATION</span></span><br><span class="line">      <span class="meta">&amp;MIXING</span></span><br><span class="line">        <span class="string">METHOD</span> <span class="string">BROYDEN_MIXING</span></span><br><span class="line">        <span class="string">ALPHA</span> <span class="number">0.4</span></span><br><span class="line">        <span class="string">BETA</span> <span class="number">0.5</span></span><br><span class="line">        <span class="string">NBROYDEN</span> <span class="number">8</span></span><br><span class="line">      <span class="string">&amp;END</span> <span class="string">MIXING</span></span><br><span class="line">    <span class="string">&amp;END</span> <span class="string">SCF</span></span><br><span class="line">    <span class="meta">&amp;XC</span></span><br><span class="line">      <span class="string">&amp;XC_FUNCTIONAL</span> <span class="string">PADE</span></span><br><span class="line">      <span class="string">&amp;END</span> <span class="string">XC_FUNCTIONAL</span></span><br><span class="line">    <span class="string">&amp;END</span> <span class="string">XC</span></span><br><span class="line">  <span class="string">&amp;END</span> <span class="string">DFT</span></span><br><span class="line">  <span class="meta">&amp;SUBSYS</span></span><br><span class="line">    <span class="string">&amp;KIND</span> <span class="string">Si</span></span><br><span class="line">      <span class="string">ELEMENT</span>   <span class="string">Si</span></span><br><span class="line">      <span class="string">BASIS_SET</span> <span class="string">SZV-GTH-PADE</span></span><br><span class="line">      <span class="string">POTENTIAL</span> <span class="string">GTH-PADE-q4</span></span><br><span class="line">    <span class="string">&amp;END</span> <span class="string">KIND</span></span><br><span class="line">    <span class="meta">&amp;CELL</span></span><br><span class="line">      <span class="string">SYMMETRY</span> <span class="string">CUBIC</span></span><br><span class="line">      <span class="string">A</span>     <span class="number">5.430697500</span>    <span class="number">0.000000000</span>    <span class="number">0.000000000</span></span><br><span class="line">      <span class="string">B</span>     <span class="number">0.000000000</span>    <span class="number">5.430697500</span>    <span class="number">0.000000000</span></span><br><span class="line">      <span class="string">C</span>     <span class="number">0.000000000</span>    <span class="number">0.000000000</span>    <span class="number">5.430697500</span></span><br><span class="line">    <span class="string">&amp;END</span> <span class="string">CELL</span></span><br><span class="line">    <span class="meta">&amp;COORD</span></span><br><span class="line">      <span class="string">Si</span>    <span class="number">0.000000000</span>    <span class="number">0.000000000</span>    <span class="number">0.000000000</span></span><br><span class="line">      <span class="string">Si</span>    <span class="number">0.000000000</span>    <span class="number">2.715348700</span>    <span class="number">2.715348700</span></span><br><span class="line">      <span class="string">Si</span>    <span class="number">2.715348700</span>    <span class="number">2.715348700</span>    <span class="number">0.000000000</span></span><br><span class="line">      <span class="string">Si</span>    <span class="number">2.715348700</span>    <span class="number">0.000000000</span>    <span class="number">2.715348700</span></span><br><span class="line">      <span class="string">Si</span>    <span class="number">4.073023100</span>    <span class="number">1.357674400</span>    <span class="number">4.073023100</span></span><br><span class="line">      <span class="string">Si</span>    <span class="number">1.357674400</span>    <span class="number">1.357674400</span>    <span class="number">1.357674400</span></span><br><span class="line">      <span class="string">Si</span>    <span class="number">1.357674400</span>    <span class="number">4.073023100</span>    <span class="number">4.073023100</span></span><br><span class="line">      <span class="string">Si</span>    <span class="number">4.073023100</span>    <span class="number">4.073023100</span>    <span class="number">1.357674400</span></span><br><span class="line">    <span class="string">&amp;END</span> <span class="string">COORD</span></span><br><span class="line">  <span class="string">&amp;END</span> <span class="string">SUBSYS</span></span><br><span class="line">  <span class="meta">&amp;PRINT</span></span><br><span class="line">    <span class="string">&amp;TOTAL_NUMBERS</span>  <span class="string">ON</span></span><br><span class="line">    <span class="string">&amp;END</span> <span class="string">TOTAL_NUMBERS</span></span><br><span class="line">  <span class="string">&amp;END</span> <span class="string">PRINT</span></span><br><span class="line"><span class="string">&amp;END</span> <span class="string">FORCE_EVAL</span></span><br></pre></td></tr></table></figure>
<h3 id="分析CUTOFF"><a href="#分析CUTOFF" class="headerlink" title="分析CUTOFF"></a>分析CUTOFF</h3><p>通过cutoff_inputs.sh脚本生成输入文件:</p>
<ul>
<li><code>cutoff</code>的范围为50~500Ry，步长为50Ry。</li>
<li>除了 <code>template.inp</code>，还需要确保基组和赝势文件 <code>BASIS_SET</code> 、 <code>GTH_POTENTIALS</code>在当前目录下</li>
<li>将新脚本文件的权限设置为可执行，再输入命令行</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line"> </span><br><span class="line">cutoffs=&quot;50 100 150 200 250 300 350 400 450 500&quot;</span><br><span class="line"> </span><br><span class="line">basis_file=BASIS_SET</span><br><span class="line">potential_file=GTH_POTENTIALS</span><br><span class="line">template_file=template.inp</span><br><span class="line">input_file=Si_bulk8.inp</span><br><span class="line"> </span><br><span class="line">rel_cutoff=60</span><br><span class="line"> </span><br><span class="line">for ii in $cutoffs ; do</span><br><span class="line">    work_dir=cutoff_$&#123;ii&#125;Ry</span><br><span class="line">    if [ ! -d $work_dir ] ; then</span><br><span class="line">        mkdir $work_dir</span><br><span class="line">    else</span><br><span class="line">        rm -r $work_dir/*</span><br><span class="line">    fi</span><br><span class="line">    sed -e &quot;s/LT_rel_cutoff/$&#123;rel_cutoff&#125;/g&quot; \</span><br><span class="line">        -e &quot;s/LT_cutoff/$&#123;ii&#125;/g&quot; \</span><br><span class="line">        $template_file &gt; $work_dir/$input_file</span><br><span class="line">    cp $basis_file $work_dir</span><br><span class="line">    cp $potential_file $work_dir</span><br><span class="line">done</span><br></pre></td></tr></table></figure>
<p>再通过cutoff_run.sh脚本运行一系列输入文件（根据自己服务器的情况重新编写）：</p>
<ul>
<li><code>cp2k_bin</code>定义CP2K二进制文件的路径</li>
<li><code>no_proc_per_calc</code>设置每个作业并行使用的MPI进程数</li>
<li><code>no_proc_to_use</code> 设置用于运行所有作业的处理器总数，比如该脚本的意思是，在24核本地工作站上运行，总共16个核用于执行整个测试计算，每个计算使用2个核，最多可以运行8个作业，直到计算完毕。</li>
<li>增加权限后，通过<code>./cutoff_run.sh &amp;</code>运行。</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line"> </span><br><span class="line">cutoffs=&quot;50 100 150 200 250 300 350 400 450 500&quot;</span><br><span class="line"> </span><br><span class="line">cp2k_bin=cp2k.popt</span><br><span class="line">input_file=Si_bulk8.inp</span><br><span class="line">output_file=Si_bulk8.out</span><br><span class="line">no_proc_per_calc=2</span><br><span class="line">no_proc_to_use=16</span><br><span class="line"> </span><br><span class="line">counter=1</span><br><span class="line">max_parallel_calcs=$(expr $no_proc_to_use / $no_proc_per_calc)</span><br><span class="line">for ii in $cutoffs ; do</span><br><span class="line">    work_dir=cutoff_$&#123;ii&#125;Ry</span><br><span class="line">    cd $work_dir</span><br><span class="line">    if [ -f $output_file ] ; then</span><br><span class="line">        rm $output_file</span><br><span class="line">    fi</span><br><span class="line">    mpirun -np $no_proc_per_calc $cp2k_bin -o $output_file $input_file &amp;</span><br><span class="line">    cd ..</span><br><span class="line">    mod_test=$(echo &quot;$counter % $max_parallel_calcs&quot; | bc)</span><br><span class="line">    if [ $mod_test -eq 0 ] ; then</span><br><span class="line">        wait</span><br><span class="line">    fi</span><br><span class="line">    counter=$(expr $counter + 1)</span><br><span class="line">done</span><br><span class="line">wait</span><br></pre></td></tr></table></figure>
<p>输出结果:</p>
<ul>
<li><p>能量：</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="string">SCF</span> <span class="string">WAVEFUNCTION</span> <span class="string">OPTIMIZATION</span></span><br><span class="line"></span><br><span class="line"> <span class="string">Step</span>     <span class="string">Update</span> <span class="string">method</span>      <span class="string">Time</span>    <span class="string">Convergence</span>         <span class="string">Total</span> <span class="string">energy</span>    <span class="string">Change</span></span><br><span class="line"> <span class="string">------------------------------------------------------------------------------</span></span><br><span class="line"></span><br><span class="line"> <span class="string">Trace(PS):</span>                                   <span class="number">32.0000000000</span></span><br><span class="line"> <span class="attr">Electronic density on regular grids:</span>        <span class="number">-31.9999999980</span>        <span class="number">0.0000000020</span></span><br><span class="line"> <span class="attr">Core density on regular grids:</span>               <span class="number">31.9999999944</span>       <span class="number">-0.0000000056</span></span><br><span class="line"> <span class="attr">Total charge density on r-space grids:</span>       <span class="number">-0.0000000036</span></span><br><span class="line"> <span class="attr">Total charge density g-space grids:</span>          <span class="number">-0.0000000036</span></span><br><span class="line"></span><br><span class="line">    <span class="number">1</span> <span class="string">NoMix/Diag.</span> <span class="number">0.40E+00</span>    <span class="number">0.4</span>     <span class="number">1.10090760</span>       <span class="number">-32.3804557631</span> <span class="number">-3.24E+01</span></span><br><span class="line">    <span class="number">1</span> <span class="string">NoMix/Diag.</span> <span class="number">0.40E+00</span>    <span class="number">0.4</span>     <span class="number">1.10090760</span>       <span class="number">-32.3804557631</span> <span class="number">-3.24E+01</span></span><br><span class="line"></span><br><span class="line"> <span class="string">***</span> <span class="string">SCF</span> <span class="string">run</span> <span class="string">NOT</span> <span class="string">converged</span> <span class="string">***</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> <span class="attr">Electronic density on regular grids:</span>        <span class="number">-31.9999999980</span>        <span class="number">0.0000000020</span></span><br><span class="line"> <span class="attr">Core density on regular grids:</span>               <span class="number">31.9999999944</span>       <span class="number">-0.0000000056</span></span><br><span class="line"> <span class="attr">Total charge density on r-space grids:</span>       <span class="number">-0.0000000036</span></span><br><span class="line"> <span class="attr">Total charge density g-space grids:</span>          <span class="number">-0.0000000036</span></span><br><span class="line"></span><br><span class="line"> <span class="attr">Overlap energy of the core charge distribution:</span>               <span class="number">0.00000000005320</span></span><br><span class="line"> <span class="attr">Self energy of the core charge distribution:</span>                <span class="number">-82.06393942512820</span></span><br><span class="line"> <span class="attr">Core Hamiltonian energy:</span>                                     <span class="number">16.92855916540793</span></span><br><span class="line"> <span class="attr">Hartree energy:</span>                                              <span class="number">42.17635056223367</span></span><br><span class="line"> <span class="attr">Exchange-correlation energy:</span>                                 <span class="number">-9.42142606564066</span></span><br><span class="line"> <span class="attr">Electronic entropic energy:</span>                                   <span class="number">0.00000000000000</span></span><br><span class="line"> <span class="attr">Fermi energy:</span>                                                 <span class="number">0.00000000000000</span></span><br><span class="line"></span><br><span class="line"> <span class="attr">Total energy:</span>                                               <span class="number">-32.38045576307407</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>高斯分布在多网格上的信息</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="string">-------------------------------------------------------------------------------</span></span><br><span class="line"><span class="string">----</span>                             <span class="string">MULTIGRID</span> <span class="string">INFO</span>                            <span class="string">----</span></span><br><span class="line"><span class="string">-------------------------------------------------------------------------------</span></span><br><span class="line"><span class="attr">count for grid        1:</span>           <span class="number">2720          </span><span class="string">cutoff</span> [<span class="string">a.u.</span>]           <span class="number">50.00</span></span><br><span class="line"><span class="attr">count for grid        2:</span>           <span class="number">5000          </span><span class="string">cutoff</span> [<span class="string">a.u.</span>]           <span class="number">16.67</span></span><br><span class="line"><span class="attr">count for grid        3:</span>           <span class="number">2760          </span><span class="string">cutoff</span> [<span class="string">a.u.</span>]            <span class="number">5.56</span></span><br><span class="line"><span class="attr">count for grid        4:</span>             <span class="number">16</span>          <span class="string">cutoff</span> [<span class="string">a.u.</span>]            <span class="number">1.85</span></span><br><span class="line"><span class="attr">total gridlevel count  :</span>          <span class="number">10496</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>通过脚本分析输出比较容易：</p>
<ul>
<li>正则表达式搜索<code>&quot;^[ \t]*Total energy:&quot;</code>来得到能量</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line"> </span><br><span class="line">cutoffs=&quot;50 100 150 200 250 300 350 400 450 500&quot;</span><br><span class="line"> </span><br><span class="line">input_file=Si_bulk8.inp</span><br><span class="line">output_file=Si_bulk8.out</span><br><span class="line">plot_file=cutoff_data.ssv</span><br><span class="line"> </span><br><span class="line">rel_cutoff=60</span><br><span class="line"> </span><br><span class="line">echo &quot;# Grid cutoff vs total energy&quot; &gt; $plot_file</span><br><span class="line">echo &quot;# Date: $(date)&quot; &gt;&gt; $plot_file</span><br><span class="line">echo &quot;# PWD: $PWD&quot; &gt;&gt; $plot_file</span><br><span class="line">echo &quot;# REL_CUTOFF = $rel_cutoff&quot; &gt;&gt; $plot_file</span><br><span class="line">echo -n &quot;# Cutoff (Ry) | Total Energy (Ha)&quot; &gt;&gt; $plot_file</span><br><span class="line">grid_header=true</span><br><span class="line">for ii in $cutoffs ; do</span><br><span class="line">    work_dir=cutoff_$&#123;ii&#125;Ry</span><br><span class="line">    total_energy=$(grep -e &#x27;^[ \t]*Total energy&#x27; $work_dir/$output_file | awk &#x27;&#123;print $3&#125;&#x27;)</span><br><span class="line">    ngrids=$(grep -e &#x27;^[ \t]*QS| Number of grid levels:&#x27; $work_dir/$output_file | \</span><br><span class="line">             awk &#x27;&#123;print $6&#125;&#x27;)</span><br><span class="line">    if $grid_header ; then</span><br><span class="line">        for ((igrid=1; igrid &lt;= ngrids; igrid++)) ; do</span><br><span class="line">            printf &quot; | NG on grid %d&quot; $igrid &gt;&gt; $plot_file</span><br><span class="line">        done</span><br><span class="line">        printf &quot;\n&quot; &gt;&gt; $plot_file</span><br><span class="line">        grid_header=false</span><br><span class="line">    fi</span><br><span class="line">    printf &quot;%10.2f  %15.10f&quot; $ii $total_energy &gt;&gt; $plot_file</span><br><span class="line">    for ((igrid=1; igrid &lt;= ngrids; igrid++)) ; do</span><br><span class="line">        grid=$(grep -e &#x27;^[ \t]*count for grid&#x27; $work_dir/$output_file | \</span><br><span class="line">               awk -v igrid=$igrid &#x27;(NR == igrid)&#123;print $5&#125;&#x27;)</span><br><span class="line">        printf &quot;  %6d&quot; $grid &gt;&gt; $plot_file</span><br><span class="line">    done</span><br><span class="line">    printf &quot;\n&quot; &gt;&gt; $plot_file</span><br><span class="line">done</span><br></pre></td></tr></table></figure>
<p>最后cutoff_data.ssv中得到</p>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Grid cutoff vs total energy</span></span><br><span class="line"><span class="comment"># Date: Mon Jan 20 21:20:34 GMT 2014</span></span><br><span class="line"><span class="comment"># PWD: /home/tong/tutorials/converging_grid/sample_output</span></span><br><span class="line"><span class="comment"># REL_CUTOFF = 60</span></span><br><span class="line"><span class="comment"># Cutoff (Ry) | Total Energy (Ha) | NG on grid 1 | NG on grid 2 | NG on grid 3 | NG on grid 4</span></span><br><span class="line">     <span class="attribute">50</span>.<span class="number">00</span>   -<span class="number">32</span>.<span class="number">3795329864</span>    <span class="number">5048</span>    <span class="number">5432</span>      <span class="number">16</span>       <span class="number">0</span></span><br><span class="line">    <span class="attribute">100</span>.<span class="number">00</span>   -<span class="number">32</span>.<span class="number">3804557631</span>    <span class="number">2720</span>    <span class="number">5000</span>    <span class="number">2760</span>      <span class="number">16</span></span><br><span class="line">    <span class="attribute">150</span>.<span class="number">00</span>   -<span class="number">32</span>.<span class="number">3804554850</span>    <span class="number">2032</span>    <span class="number">3016</span>    <span class="number">5432</span>      <span class="number">16</span></span><br><span class="line">    <span class="attribute">200</span>.<span class="number">00</span>   -<span class="number">32</span>.<span class="number">3804554982</span>    <span class="number">1880</span>    <span class="number">2472</span>    <span class="number">3384</span>    <span class="number">2760</span></span><br><span class="line">    <span class="attribute">250</span>.<span class="number">00</span>   -<span class="number">32</span>.<span class="number">3804554859</span>     <span class="number">264</span>    <span class="number">4088</span>    <span class="number">3384</span>    <span class="number">2760</span></span><br><span class="line">    <span class="attribute">300</span>.<span class="number">00</span>   -<span class="number">32</span>.<span class="number">3804554843</span>     <span class="number">264</span>    <span class="number">2456</span>    <span class="number">5000</span>    <span class="number">2776</span></span><br><span class="line">    <span class="attribute">350</span>.<span class="number">00</span>   -<span class="number">32</span>.<span class="number">3804554846</span>      <span class="number">56</span>    <span class="number">1976</span>    <span class="number">5688</span>    <span class="number">2776</span></span><br><span class="line">    <span class="attribute">400</span>.<span class="number">00</span>   -<span class="number">32</span>.<span class="number">3804554851</span>      <span class="number">56</span>    <span class="number">1976</span>    <span class="number">3016</span>    <span class="number">5448</span></span><br><span class="line">    <span class="attribute">450</span>.<span class="number">00</span>   -<span class="number">32</span>.<span class="number">3804554851</span>       <span class="number">0</span>    <span class="number">2032</span>    <span class="number">3016</span>    <span class="number">5448</span></span><br><span class="line">    <span class="attribute">500</span>.<span class="number">00</span>   -<span class="number">32</span>.<span class="number">3804554850</span>       <span class="number">0</span>    <span class="number">2032</span>    <span class="number">3016</span>    <span class="number">5448</span></span><br></pre></td></tr></table></figure>
<ul>
<li>数据显示，在<code>REL_CUTOFF</code>为60 Ry的情况下，<code>CUTOFF</code>设置 为250 Ry或更高将产生总能量误差小于<script type="math/tex">10^{-8}</script>Hatree。</li>
<li>随着<code>CUTOFF</code>的增加，分配给最精细网格的高斯数减少。简单地增加<code>CUTOFF</code>而不增加<code>REL_CUTOFF</code>可能最终导致能量收敛缓慢，因为越来越多的高斯被推到更粗糙的网格级别，从而抵消了<code>CUTOFF</code>的增加。</li>
</ul>
<h3 id="分析REL-CUTOFF"><a href="#分析REL-CUTOFF" class="headerlink" title="分析REL_CUTOFF"></a>分析REL_CUTOFF</h3><p>同样的方法，将<code>CUTOFF</code>设置 为250 Ry来测试<code>REL_CUTOFF</code></p>
<p>在已有的 <code>template.inp</code>模板基础上，脚本修改为：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line"> </span><br><span class="line">rel_cutoffs=&quot;10 20 30 40 50 60 70 80 90 100&quot;</span><br><span class="line"> </span><br><span class="line">basis_file=BASIS_SET</span><br><span class="line">potential_file=GTH_POTENTIALS</span><br><span class="line">template_file=template.inp</span><br><span class="line">input_file=Si_bulk8.inp</span><br><span class="line"> </span><br><span class="line">cutoff=250</span><br><span class="line"> </span><br><span class="line">for ii in $rel_cutoffs ; do</span><br><span class="line">    work_dir=rel_cutoff_$&#123;ii&#125;Ry</span><br><span class="line">    if [ ! -d $work_dir ] ; then</span><br><span class="line">        mkdir $work_dir</span><br><span class="line">    else</span><br><span class="line">        rm -r $work_dir/*</span><br><span class="line">    fi</span><br><span class="line">    sed -e &quot;s/LT_cutoff/$&#123;cutoff&#125;/g&quot; \</span><br><span class="line">        -e &quot;s/LT_rel_cutoff/$&#123;ii&#125;/g&quot; \</span><br><span class="line">        $template_file &gt; $work_dir/$input_file</span><br><span class="line">    cp $basis_file $work_dir</span><br><span class="line">    cp $potential_file $work_dir</span><br><span class="line">done</span><br></pre></td></tr></table></figure>
<p>运行计算：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line"> </span><br><span class="line">rel_cutoffs=&quot;10 20 30 40 50 60 70 80 90 100&quot;</span><br><span class="line"> </span><br><span class="line">cp2k_bin=cp2k.popt</span><br><span class="line">input_file=Si_bulk8.inp</span><br><span class="line">output_file=Si_bulk8.out</span><br><span class="line">no_proc_per_calc=2</span><br><span class="line">no_proc_to_use=16</span><br><span class="line"> </span><br><span class="line">counter=1</span><br><span class="line">max_parallel_calcs=$(expr $no_proc_to_use / $no_proc_per_calc)</span><br><span class="line">for ii in $rel_cutoffs ; do</span><br><span class="line">    work_dir=rel_cutoff_$&#123;ii&#125;Ry</span><br><span class="line">    cd $work_dir</span><br><span class="line">    if [ -f $output_file ] ; then</span><br><span class="line">        rm $output_file</span><br><span class="line">    fi</span><br><span class="line">    mpirun -np $no_proc_per_calc $cp2k_bin -o $output_file $input_file &amp;</span><br><span class="line">    cd ..</span><br><span class="line">    mod_test=$(echo &quot;$counter % $max_parallel_calcs&quot; | bc)</span><br><span class="line">    if [ $mod_test -eq 0 ] ; then</span><br><span class="line">        wait</span><br><span class="line">    fi</span><br><span class="line">    counter=$(expr $counter + 1)</span><br><span class="line">done</span><br><span class="line">wait</span><br></pre></td></tr></table></figure>
<p>分析结果</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta"> #</span><span class="bash">!/bin/bash</span></span><br><span class="line"> </span><br><span class="line">rel_cutoffs=&quot;10 20 30 40 50 60 70 80 90 100&quot;</span><br><span class="line"> </span><br><span class="line">input_file=Si_bulk8.inp</span><br><span class="line">output_file=Si_bulk8.out</span><br><span class="line">plot_file=rel_cutoff_data.ssv</span><br><span class="line"> </span><br><span class="line">cutoff=250</span><br><span class="line"> </span><br><span class="line">echo &quot;# Rel Grid cutoff vs total energy&quot; &gt; $plot_file</span><br><span class="line">echo &quot;# Date: $(date)&quot; &gt;&gt; $plot_file</span><br><span class="line">echo &quot;# PWD: $PWD&quot; &gt;&gt; $plot_file</span><br><span class="line">echo &quot;# CUTOFF = $&#123;cutoff&#125;&quot; &gt;&gt; $plot_file</span><br><span class="line">echo -n &quot;# Rel Cutoff (Ry) | Total Energy (Ha)&quot; &gt;&gt; $plot_file</span><br><span class="line">grid_header=true</span><br><span class="line">for ii in $rel_cutoffs ; do</span><br><span class="line">    work_dir=rel_cutoff_$&#123;ii&#125;Ry</span><br><span class="line">    total_energy=$(grep -e &#x27;^[ \t]*Total energy&#x27; $work_dir/$output_file | awk &#x27;&#123;print $3&#125;&#x27;)</span><br><span class="line">    ngrids=$(grep -e &#x27;^[ \t]*QS| Number of grid levels:&#x27; $work_dir/$output_file | \</span><br><span class="line">             awk &#x27;&#123;print $6&#125;&#x27;)</span><br><span class="line">    if $grid_header ; then</span><br><span class="line">        or ((igrid=1; igrid &lt;= ngrids; igrid++)) ; do</span><br><span class="line">            printf &quot; | NG on grid %d&quot; $igrid &gt;&gt; $plot_file</span><br><span class="line">        done</span><br><span class="line">        printf &quot;\n&quot; &gt;&gt; $plot_file</span><br><span class="line">        grid_header=false</span><br><span class="line">    fi</span><br><span class="line">    printf &quot;%10.2f  %15.10f&quot; $ii $total_energy &gt;&gt; $plot_file</span><br><span class="line">    for ((igrid=1; igrid &lt;= ngrids; igrid++)) ; do</span><br><span class="line">        grid=$(grep -e &#x27;^[ \t]*count for grid&#x27; $work_dir/$output_file | \</span><br><span class="line">               awk -v igrid=$igrid &#x27;(NR == igrid)&#123;print $5&#125;&#x27;)</span><br><span class="line">        printf &quot;  %6d&quot; $grid &gt;&gt; $plot_file</span><br><span class="line">    done</span><br><span class="line">    printf &quot;\n&quot; &gt;&gt; $plot_file</span><br><span class="line">done</span><br></pre></td></tr></table></figure>
<p>得到rel_cutoff_data.ssv：</p>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Rel Grid cutoff vs total energy</span></span><br><span class="line"><span class="comment"># Date: Mon Jan 20 00:45:14 GMT 2014</span></span><br><span class="line"><span class="comment"># PWD: /home/tong/tutorials/converging_grid/sample_output</span></span><br><span class="line"><span class="comment"># CUTOFF = 250</span></span><br><span class="line"><span class="comment"># Rel Cutoff (Ry) | Total Energy (Ha) | NG on grid 1 | NG on grid 2 | NG on grid 3 | NG on grid 4</span></span><br><span class="line">     <span class="attribute">10</span>.<span class="number">00</span>   -<span class="number">32</span>.<span class="number">3902980020</span>       <span class="number">0</span>       <span class="number">0</span>    <span class="number">2032</span>    <span class="number">8464</span></span><br><span class="line">     <span class="attribute">20</span>.<span class="number">00</span>   -<span class="number">32</span>.<span class="number">3816384686</span>       <span class="number">0</span>     <span class="number">264</span>    <span class="number">4088</span>    <span class="number">6144</span></span><br><span class="line">     <span class="attribute">30</span>.<span class="number">00</span>   -<span class="number">32</span>.<span class="number">3805115576</span>       <span class="number">0</span>    <span class="number">2032</span>    <span class="number">3016</span>    <span class="number">5448</span></span><br><span class="line">     <span class="attribute">40</span>.<span class="number">00</span>   -<span class="number">32</span>.<span class="number">3805116025</span>      <span class="number">56</span>    <span class="number">1976</span>    <span class="number">3016</span>    <span class="number">5448</span></span><br><span class="line">     <span class="attribute">50</span>.<span class="number">00</span>   -<span class="number">32</span>.<span class="number">3804555002</span>     <span class="number">264</span>    <span class="number">2456</span>    <span class="number">5000</span>    <span class="number">2776</span></span><br><span class="line">     <span class="attribute">60</span>.<span class="number">00</span>   -<span class="number">32</span>.<span class="number">3804554859</span>     <span class="number">264</span>    <span class="number">4088</span>    <span class="number">3384</span>    <span class="number">2760</span></span><br><span class="line">     <span class="attribute">70</span>.<span class="number">00</span>   -<span class="number">32</span>.<span class="number">3804554859</span>    <span class="number">1880</span>    <span class="number">2472</span>    <span class="number">3384</span>    <span class="number">2760</span></span><br><span class="line">     <span class="attribute">80</span>.<span class="number">00</span>   -<span class="number">32</span>.<span class="number">3804554859</span>    <span class="number">1880</span>    <span class="number">2472</span>    <span class="number">3384</span>    <span class="number">2760</span></span><br><span class="line">     <span class="attribute">90</span>.<span class="number">00</span>   -<span class="number">32</span>.<span class="number">3804554848</span>    <span class="number">2032</span>    <span class="number">3016</span>    <span class="number">5432</span>      <span class="number">16</span></span><br><span class="line">    <span class="attribute">100</span>.<span class="number">00</span>   -<span class="number">32</span>.<span class="number">3804554848</span>    <span class="number">2032</span>    <span class="number">3016</span>    <span class="number">5432</span>      <span class="number">16</span></span><br></pre></td></tr></table></figure>
<ul>
<li>随着<code>REL_CUTOFF</code>值的增加，更多的高斯映射到更精细的网格上。总能量误差减少到小于<script type="math/tex">10^{-8}</script></li>
<li>当<code>REL_CUTOFF</code>大于或等于60 Ry 。结果因此表明60 Ry确实是<code>REL_CUTOFF</code>值的合适选择。</li>
</ul>
<p>综上，说明计算中 设置为如下是最合适的：</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&amp;MGRID</span></span><br><span class="line">  <span class="string">CUTOFF</span> <span class="number">250</span></span><br><span class="line">  <span class="string">REL_CUTOFF</span> <span class="number">60</span> </span><br><span class="line"><span class="string">&amp;END</span> <span class="string">MGRID</span></span><br></pre></td></tr></table></figure>
<h2 id="H2O"><a href="#H2O" class="headerlink" title="H2O"></a>H<sub>2</sub>O</h2><p>32个H<sub>2</sub>O水分子的系统</p>
<h3 id="模板文件"><a href="#模板文件" class="headerlink" title="模板文件"></a>模板文件</h3><ul>
<li>与Si相比，这是一个更大的系统，在中小型绝缘系统的良好设置中使用<code>&amp;OT</code>优化。</li>
<li><code>&amp;PRINT</code>中保存了<code>&amp;FORCES</code>。在MD中，力比能量更重要。</li>
</ul>
<figure class="highlight 1c"><table><tr><td class="code"><pre><span class="line"><span class="meta">&amp;GLOBAL</span></span><br><span class="line">  PRINT_LEVEL MEDIUM</span><br><span class="line">  PROJECT cuttoff-test</span><br><span class="line">  RUN_TYPE ENERGY_FORCE</span><br><span class="line"><span class="meta">&amp;END GLOBAL</span></span><br><span class="line">  </span><br><span class="line"><span class="meta">&amp;FORCE_EVAL</span></span><br><span class="line">  METHOD Quickstep</span><br><span class="line">  <span class="meta">&amp;DFT</span></span><br><span class="line">    BASIS_SET_FILE_NAME BASIS_MOLOPT</span><br><span class="line">    POTENTIAL_FILE_NAME GTH_POTENTIALS</span><br><span class="line">    WFN_RESTART_FILE_NAME ../cuttoff-test-RESTART.wfn</span><br><span class="line">    CHARGE <span class="number">0</span></span><br><span class="line">    MULTIPLICITY <span class="number">1</span></span><br><span class="line">    <span class="meta">&amp;MGRID</span></span><br><span class="line">      NGRIDS <span class="number">4</span></span><br><span class="line">      CUTOFF LT_cutoff</span><br><span class="line">      REL_CUTOFF LT_rel_cutoff</span><br><span class="line">    <span class="meta">&amp;END</span></span><br><span class="line">    <span class="meta">&amp;QS</span></span><br><span class="line">      EPS_DEFAULT <span class="number">1.0</span>E-<span class="number">12</span></span><br><span class="line">      METHOD GPW</span><br><span class="line">    <span class="meta">&amp;END</span></span><br><span class="line"> </span><br><span class="line">    <span class="meta">&amp;SCF</span></span><br><span class="line">      SCF_GUESS RESTART</span><br><span class="line">      EPS_SCF <span class="number">5</span>.e-<span class="number">7</span></span><br><span class="line">      MAX_SCF <span class="number">15</span></span><br><span class="line">      <span class="meta">&amp;OT</span></span><br><span class="line">        PRECONDITIONER FULL_ALL</span><br><span class="line">        MINIMIZER DIIS</span><br><span class="line">      <span class="meta">&amp;END OT</span></span><br><span class="line">      <span class="meta">&amp;OUTER_SCF</span></span><br><span class="line">        EPS_SCF <span class="number">5.0</span>E-<span class="number">7</span></span><br><span class="line">        MAX_SCF <span class="number">1</span></span><br><span class="line">      <span class="meta">&amp;END OUTER_SCF</span></span><br><span class="line">    <span class="meta">&amp;END SCF</span></span><br><span class="line"> </span><br><span class="line">    <span class="meta">&amp;XC</span></span><br><span class="line">      <span class="meta">&amp;XC_FUNCTIONAL PBE</span></span><br><span class="line">      <span class="meta">&amp;END XC_FUNCTIONAL</span></span><br><span class="line">      <span class="meta">&amp;XC_GRID</span></span><br><span class="line">        ! defaults</span><br><span class="line">        XC_SMOOTH_RHO NONE</span><br><span class="line">        XC_DERIV PW</span><br><span class="line">      <span class="meta">&amp;END XC_GRID</span></span><br><span class="line">    <span class="meta">&amp;END XC</span></span><br><span class="line"> </span><br><span class="line">  <span class="meta">&amp;END DFT</span></span><br><span class="line">  <span class="meta">&amp;SUBSYS</span></span><br><span class="line">    <span class="meta">&amp;CELL</span></span><br><span class="line">      ABC <span class="number">9.8528</span> <span class="number">9.8528</span> <span class="number">9.8528</span></span><br><span class="line">      PERIODIC XYZ</span><br><span class="line">    <span class="meta">&amp;END CELL</span></span><br><span class="line"> </span><br><span class="line">    <span class="meta">&amp;KIND H</span></span><br><span class="line">      BASIS_SET DZVP-MOLOPT-SR-GTH-q1</span><br><span class="line">      POTENTIAL GTH-PBE-q1</span><br><span class="line">    <span class="meta">&amp;END</span></span><br><span class="line"> </span><br><span class="line">    <span class="meta">&amp;KIND O</span></span><br><span class="line">      BASIS_SET DZVP-MOLOPT-SR-GTH-q6</span><br><span class="line">      POTENTIAL GTH-PBE-q6</span><br><span class="line">    <span class="meta">&amp;END KIND</span></span><br><span class="line"> </span><br><span class="line">    <span class="meta">&amp;TOPOLOGY</span></span><br><span class="line">      COORDINATE XYZ</span><br><span class="line">      COORD_FILE_NAME ../structure.xyz</span><br><span class="line">      CONNECTIVITY OFF</span><br><span class="line">    <span class="meta">&amp;END TOPOLOGY</span></span><br><span class="line">  <span class="meta">&amp;END SUBSYS</span></span><br><span class="line"> </span><br><span class="line">  <span class="meta">&amp;PRINT</span></span><br><span class="line">    <span class="meta">&amp;FORCES</span></span><br><span class="line">    <span class="meta">&amp;END</span></span><br><span class="line">  <span class="meta">&amp;END</span></span><br><span class="line"><span class="meta">&amp;END FORCE_EVAL</span></span><br></pre></td></tr></table></figure>
<h3 id="生成输入"><a href="#生成输入" class="headerlink" title="生成输入"></a>生成输入</h3><p>利用脚本生成输入文件后再提交任务</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line">cutoffs=<span class="string">&quot;100 200 300 400 500 600 700 800 900 1000 1100 1200&quot;</span></span><br><span class="line"></span><br><span class="line">template_file=input_template.inp</span><br><span class="line">input_file=input.inp</span><br><span class="line"></span><br><span class="line">rel_cutoff=60</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> ii <span class="keyword">in</span> <span class="variable">$cutoffs</span> ; <span class="keyword">do</span></span><br><span class="line">    work_dir=cutoff_<span class="variable">$&#123;ii&#125;</span>Ry</span><br><span class="line">    <span class="keyword">if</span> [ ! -d <span class="variable">$work_dir</span> ] ; <span class="keyword">then</span></span><br><span class="line">        mkdir <span class="variable">$work_dir</span></span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        rm -r <span class="variable">$work_dir</span>/*</span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line">    sed -e <span class="string">&quot;s/LT_rel_cutoff/<span class="variable">$&#123;rel_cutoff&#125;</span>/g&quot;</span> \</span><br><span class="line">        -e <span class="string">&quot;s/LT_cutoff/<span class="variable">$&#123;ii&#125;</span>/g&quot;</span> \</span><br><span class="line">    <span class="variable">$template_file</span> &gt; <span class="variable">$work_dir</span>/<span class="variable">$input_file</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>
<p>再比较输出中的CUTOFF-能量、CUTOFF-Force曲线</p>
<h2 id="summary"><a href="#summary" class="headerlink" title="summary"></a>summary</h2><ul>
<li><p>将力的收敛与几何优化的默认收敛标准进行比较决定了是否收敛</p>
</li>
<li><p>基组或赝势决定了<code>CUTOFF</code>，高斯指数越大，需要用越大的网格数。比如O，电负性很强，具有比较收缩的2s，基组中最大的高斯指数为10.4 Bohr<sup>-2</sup>，而相同的基组的：Si中只有2.7，因此可以用比较粗糙的格点表示。</p>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">Normalised</span> Cartesian orbitals:</span><br><span class="line"></span><br><span class="line">                 <span class="attribute">Set</span>   Shell   Orbital            Exponent    Coefficient</span><br><span class="line"></span><br><span class="line">                   <span class="attribute">1</span>       <span class="number">1</span>    <span class="number">2</span>s               <span class="number">10</span>.<span class="number">389228</span>       <span class="number">0</span>.<span class="number">396646</span></span><br><span class="line">                                                  <span class="attribute">3</span>.<span class="number">849621</span>       <span class="number">0</span>.<span class="number">208811</span></span><br><span class="line">                                                  <span class="attribute">1</span>.<span class="number">388401</span>      -<span class="number">0</span>.<span class="number">301641</span></span><br><span class="line">                                                  <span class="attribute">0</span>.<span class="number">496955</span>      -<span class="number">0</span>.<span class="number">274061</span></span><br><span class="line">                                                  <span class="attribute">0</span>.<span class="number">162492</span>      -<span class="number">0</span>.<span class="number">033677</span></span><br></pre></td></tr></table></figure>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">Si</span> DZVP-MOLOPT-GTH DZVP-MOLOPT-GTH-q<span class="number">4</span></span><br><span class="line"><span class="attribute">1</span></span><br><span class="line"><span class="attribute">2</span> <span class="number">0</span> <span class="number">2</span> <span class="number">6</span> <span class="number">2</span> <span class="number">2</span> <span class="number">1</span></span><br><span class="line">     <span class="attribute">2</span>.<span class="number">693604434572</span>  <span class="number">0</span>.<span class="number">015333179500</span> -<span class="number">0</span>.<span class="number">073325401200</span> -<span class="number">0</span>.<span class="number">005800105400</span>  <span class="number">0</span>.<span class="number">023996406700</span>  <span class="number">0</span>.<span class="number">043919650100</span></span><br><span class="line">     <span class="attribute">1</span>.<span class="number">359613855428</span> -<span class="number">0</span>.<span class="number">283798205000</span>  <span class="number">0</span>.<span class="number">484815594600</span> -<span class="number">0</span>.<span class="number">059172026000</span>  <span class="number">0</span>.<span class="number">055459199900</span>  <span class="number">0</span>.<span class="number">134639409600</span></span><br><span class="line">     <span class="attribute">0</span>.<span class="number">513245176029</span> -<span class="number">0</span>.<span class="number">228939692700</span> -<span class="number">0</span>.<span class="number">276015880000</span>  <span class="number">0</span>.<span class="number">121487149900</span> -<span class="number">0</span>.<span class="number">269559268100</span>  <span class="number">0</span>.<span class="number">517732111300</span></span><br><span class="line">     <span class="attribute">0</span>.<span class="number">326563011394</span>  <span class="number">0</span>.<span class="number">728834000900</span> -<span class="number">0</span>.<span class="number">228394679700</span>  <span class="number">0</span>.<span class="number">423382421100</span> -<span class="number">0</span>.<span class="number">259506329000</span>  <span class="number">0</span>.<span class="number">282311245100</span></span><br><span class="line">     <span class="attribute">0</span>.<span class="number">139986977410</span>  <span class="number">0</span>.<span class="number">446205299300</span> -<span class="number">0</span>.<span class="number">018311553000</span>  <span class="number">0</span>.<span class="number">474592116300</span>  <span class="number">0</span>.<span class="number">310318217600</span>  <span class="number">0</span>.<span class="number">281350794600</span></span><br><span class="line">     <span class="attribute">0</span>.<span class="number">068212286977</span>  <span class="number">0</span>.<span class="number">122025292800</span>  <span class="number">0</span>.<span class="number">365245476200</span>  <span class="number">0</span>.<span class="number">250129397700</span>  <span class="number">0</span>.<span class="number">647414251100</span>  <span class="number">0</span>.<span class="number">139066843800</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>另外，收敛主要由GGA功能中的梯度项的计算决定。对于BLYP泛函需要进行平滑处理。平滑可以比默认更快的收敛力。</p>
</li>
</ul>
]]></content>
      <categories>
        <category>计算化学</category>
        <category>软件</category>
      </categories>
      <tags>
        <tag>CP2K</tag>
      </tags>
  </entry>
  <entry>
    <title>【CP2K】04.几何优化</title>
    <url>/2020/12/02/%E3%80%90CP2K%E3%80%9104.%E5%87%A0%E4%BD%95%E4%BC%98%E5%8C%96/</url>
    <content><![CDATA[<h1 id="输入文件"><a href="#输入文件" class="headerlink" title="输入文件"></a>输入文件</h1><figure class="highlight sas"><table><tr><td class="code"><pre><span class="line"><span class="variable">&amp;GLOBAL</span></span><br><span class="line">  PROJECT H2O</span><br><span class="line">  RUN_TYPE GEO_OPT</span><br><span class="line">  PRINT_LEVEL LOW</span><br><span class="line"><span class="variable">&amp;END</span> GLOBAL</span><br><span class="line"><span class="variable">&amp;FORCE_EVAL</span></span><br><span class="line">  METHOD QS</span><br><span class="line">  <span class="variable">&amp;SUBSYS</span></span><br><span class="line">    <span class="variable">&amp;CELL</span></span><br><span class="line">      ABC 12.4138 12.4138 12.4138</span><br><span class="line">    <span class="variable">&amp;END</span> CELL</span><br><span class="line">    <span class="variable">&amp;COORD</span></span><br><span class="line">      O      12.235322       1.376642      10.869880</span><br><span class="line">      H      12.415139       2.233125      11.257611</span><br><span class="line">      H      11.922476       1.573799       9.986994</span><br><span class="line">    <span class="variable">&amp;END</span> COORD</span><br><span class="line">    <span class="variable">&amp;KIND</span> H</span><br><span class="line">      BASIS_SET DZVP-GTH-PADE</span><br><span class="line">      POTENTIAL GTH-PADE-q1</span><br><span class="line">    <span class="variable">&amp;END</span> KIND</span><br><span class="line">    <span class="variable">&amp;KIND</span> O</span><br><span class="line">      BASIS_SET DZVP-GTH-PADE</span><br><span class="line">      POTENTIAL GTH-PADE-q6</span><br><span class="line">    <span class="variable">&amp;END</span> KIND</span><br><span class="line">  <span class="variable">&amp;END</span> SUBSYS</span><br><span class="line">  <span class="variable">&amp;DFT</span></span><br><span class="line">    BASIS_SET_FILE_NAME ./BASIS_SET</span><br><span class="line">    POTENTIAL_FILE_NAME ./POTENTIAL</span><br><span class="line">    <span class="variable">&amp;QS</span></span><br><span class="line">      EPS_DEFAULT 1.0E-7</span><br><span class="line">    <span class="variable">&amp;END</span> QS</span><br><span class="line">    <span class="variable">&amp;MGRID</span></span><br><span class="line">      CUTOFF 200</span><br><span class="line">      NGRIDS 4</span><br><span class="line">      REL_CUTOFF 30</span><br><span class="line">    <span class="variable">&amp;END</span> MGRID</span><br><span class="line">    <span class="variable">&amp;SCF</span></span><br><span class="line">      SCF_GUESS ATOMIC</span><br><span class="line">      EPS_SCF 1.0E-05</span><br><span class="line">      MAX_SCF 200</span><br><span class="line">      <span class="variable">&amp;DIAGONALIZATION</span> T</span><br><span class="line">        ALGORITHM STANDARD</span><br><span class="line">      <span class="variable">&amp;END</span> DIAGONALIZATION</span><br><span class="line">      <span class="variable">&amp;MIXING</span> T</span><br><span class="line">        ALPHA 0.5</span><br><span class="line">        METHOD PULAY_MIXING</span><br><span class="line">        NPULAY 5</span><br><span class="line">      <span class="variable">&amp;END</span> MIXING</span><br><span class="line">      <span class="variable">&amp;PRINT</span></span><br><span class="line">        <span class="variable">&amp;RESTART</span> OFF</span><br><span class="line">        <span class="variable">&amp;END</span> RESTART</span><br><span class="line">      <span class="variable">&amp;END</span> PRINT</span><br><span class="line">    <span class="variable">&amp;END</span> SCF</span><br><span class="line">    <span class="variable">&amp;XC</span></span><br><span class="line">      <span class="variable">&amp;XC_FUNCTIONAL</span> PADE</span><br><span class="line">      <span class="variable">&amp;END</span> XC_FUNCTIONAL</span><br><span class="line">    <span class="variable">&amp;END</span> XC</span><br><span class="line">  <span class="variable">&amp;END</span> DFT</span><br><span class="line"><span class="variable">&amp;END</span> FORCE_EVAL</span><br><span class="line"><span class="variable">&amp;MOTION</span></span><br><span class="line">  <span class="variable">&amp;GEO_OPT</span></span><br><span class="line">    TYPE MINIMIZATION</span><br><span class="line">    MAX_DR    1.0E-03</span><br><span class="line">    MAX_FORCE 1.0E-03</span><br><span class="line">    RMS_DR    1.0E-03</span><br><span class="line">    RMS_FORCE 1.0E-03</span><br><span class="line">    MAX_ITER 200</span><br><span class="line">    OPTIMIZER CG</span><br><span class="line">    <span class="variable">&amp;CG</span></span><br><span class="line">      MAX_STEEP_STEPS  0</span><br><span class="line">      RESTART_LIMIT 9.0E-01</span><br><span class="line">    <span class="variable">&amp;END</span> CG</span><br><span class="line">  <span class="variable">&amp;END</span> GEO_OPT</span><br><span class="line">  <span class="variable">&amp;CONSTRAINT</span></span><br><span class="line">    <span class="variable">&amp;FIXED_ATOMS</span></span><br><span class="line">      COMPONENTS_TO_FIX XYZ</span><br><span class="line">      <span class="meta">LIST</span> 1</span><br><span class="line">    <span class="variable">&amp;END</span> FIXED_ATOMS</span><br><span class="line">  <span class="variable">&amp;END</span> CONSTRAINT</span><br><span class="line"><span class="variable">&amp;END</span> MOTION</span><br></pre></td></tr></table></figure>
<h2 id="amp-GLOBAL-修改任务类型"><a href="#amp-GLOBAL-修改任务类型" class="headerlink" title="&amp;GLOBAL 修改任务类型"></a>&amp;GLOBAL 修改任务类型</h2><ul>
<li>将<code>RUN_TYPE</code>修改为<code>GEO_OPT</code></li>
</ul>
<figure class="highlight armasm"><table><tr><td class="code"><pre><span class="line">&amp;<span class="meta">GLOBAL</span></span><br><span class="line">  PROJECT H2O</span><br><span class="line">  RUN_TYPE GEO_OPT</span><br><span class="line">  PRINT_LEVEL LOW</span><br><span class="line">&amp;<span class="meta">END</span> <span class="meta">GLOBAL</span></span><br></pre></td></tr></table></figure>
<h2 id="其他改动"><a href="#其他改动" class="headerlink" title="其他改动"></a>其他改动</h2><p>相比于计算能量和力的Si例子中的改动：</p>
<ul>
<li><code>&amp;SUBSYS</code>：<ul>
<li><code>&amp;KIND</code>设定H和O的基组</li>
<li><code>&amp;CELL</code>修改晶格向量单位</li>
<li><code>&amp;COORD</code>修改坐标</li>
</ul>
</li>
<li><code>&amp;FORCE_EVAL</code>：<ul>
<li><code>&amp;DFT</code>：<ul>
<li><code>&amp;QS</code>中的<code>EPS_DEFAULT</code>增大为<code>1.0E-7</code></li>
<li><code>&amp;MGRID</code>中修改为<code>CUTOFF 200</code>和<code>REL_CUTOFF 30</code></li>
<li><code>&amp;SCF</code>中：<ul>
<li><code>EPS_SCF</code>增大为<code>1.0E-05</code>，<code>MAX_SCF</code>修改为<code>200</code></li>
<li><code>&amp;MIXING</code>使用Pulay混合法<code>PULAY_MIXING</code>和相应的<code>ALPHA</code>、<code>NBUFFER</code></li>
<li><code>&amp;PRINT</code>中关闭<code>&amp;RESTART</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="amp-MOTION"><a href="#amp-MOTION" class="headerlink" title="&amp;MOTION"></a>&amp;MOTION</h2><p>定义了一组与原子核运动有关的工具</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&amp;MOTION</span></span><br><span class="line">  <span class="meta">&amp;GEO_OPT</span></span><br><span class="line">    <span class="string">TYPE</span> <span class="string">MINIMIZATION</span></span><br><span class="line">    <span class="string">MAX_DR</span>    <span class="number">1.0E-03</span></span><br><span class="line">    <span class="string">MAX_FORCE</span> <span class="number">1.0E-03</span></span><br><span class="line">    <span class="string">RMS_DR</span>    <span class="number">1.0E-03</span></span><br><span class="line">    <span class="string">RMS_FORCE</span> <span class="number">1.0E-03</span></span><br><span class="line">    <span class="string">MAX_ITER</span> <span class="number">200</span></span><br><span class="line">    <span class="string">OPTIMIZER</span> <span class="string">CG</span></span><br><span class="line">    <span class="meta">&amp;CG</span></span><br><span class="line">      <span class="string">MAX_STEEP_STEPS</span>  <span class="number">0</span></span><br><span class="line">      <span class="string">RESTART_LIMIT</span> <span class="number">9.0E-01</span></span><br><span class="line">    <span class="string">&amp;END</span> <span class="string">CG</span></span><br><span class="line">  <span class="string">&amp;END</span> <span class="string">GEO_OPT</span></span><br><span class="line">  <span class="meta">&amp;CONSTRAINT</span></span><br><span class="line">    <span class="meta">&amp;FIXED_ATOMS</span></span><br><span class="line">      <span class="string">COMPONENTS_TO_FIX</span> <span class="string">XYZ</span></span><br><span class="line">      <span class="string">LIST</span> <span class="number">1</span></span><br><span class="line">    <span class="string">&amp;END</span> <span class="string">FIXED_ATOMS</span></span><br><span class="line">  <span class="string">&amp;END</span> <span class="string">CONSTRAINT</span></span><br><span class="line"><span class="string">&amp;END</span> <span class="string">MOTION</span></span><br></pre></td></tr></table></figure>
<h3 id="amp-GEO-OPT"><a href="#amp-GEO-OPT" class="headerlink" title="&amp;GEO_OPT"></a>&amp;GEO_OPT</h3><p> <code>GEO_OPT</code>小节仅适用于晶格尺寸不变的计算：</p>
<ul>
<li><code>TYPE</code>：指定要执行的几何优化类型<ul>
<li><code>MINIMIZATION</code>：执行几何最小化。默认。</li>
<li><code>TRANSITION_STATE</code>：执行过渡状态优化。</li>
</ul>
</li>
<li>设置是否达到优化几何形状的标准：<ul>
<li><code>MAX_DR</code>：先前几何优化迭代中原子位移的最大公差。默认为<script type="math/tex">3\times10^{-3}</script>Bohr</li>
<li><code>MAX_FORCE</code>：对原子力的最大公差，默认为<script type="math/tex">4.5\times10^{-4}</script>Bohr / Hartree</li>
<li><code>RMS_DR</code>：先前几何优化迭代中原子位移的均方根的公差，默认为<script type="math/tex">1.5\times10^{-3}</script>Bohr</li>
<li><code>RMS_FORCE</code>：对原子力的均方根公差，默认为<script type="math/tex">3\times10^{-4}</script>Bohr / Hartree</li>
</ul>
</li>
<li><code>MAX_ITER</code>：置最大几何优化迭代次数</li>
<li><code>OPTIMIZER</code>：设置查找固定点的算法，同<code>MINIMIZER</code><ul>
<li><code>CG</code>：共轭梯度，robust minimizer（取决于线搜索），也适用于大型系统</li>
<li><code>BFGS</code>：默认。最有效的最小化器，但仅适用于“小型”系统，因为它依赖于完整的Hessian矩阵的对角化</li>
<li><code>LBFGS</code>：BFGS的内存有限变体，适用于大型系统。微调效果不佳，但功能更强大。</li>
</ul>
</li>
</ul>
<h4 id="amp-CG"><a href="#amp-CG" class="headerlink" title="&amp;CG"></a>&amp;CG</h4><p>设置共轭梯度算法的选项：</p>
<ul>
<li><code>MAX_STEEP_STEPS</code>：开始共轭梯度优化之前，最陡下降步骤的最大数量。默认是<code>0</code>，即不会执行最陡峭的下降步骤。</li>
<li><code>RESTART_LIMIT</code>：两个连续搜索方向之间的角度的余弦值。如果CG优化过程中的角度小于对应于<code>RESTART_LIMIT</code>的角度，则会重置CG并执行最陡下降步骤。默认为<code>0.9</code>。</li>
</ul>
<h3 id="amp-CONSTRAINT"><a href="#amp-CONSTRAINT" class="headerlink" title="&amp;CONSTRAINT"></a>&amp;CONSTRAINT</h3><p>为原子运动添加约束</p>
<h4 id="amp-FIXED-ATOMS"><a href="#amp-FIXED-ATOMS" class="headerlink" title="&amp;FIXED_ATOMS"></a>&amp;FIXED_ATOMS</h4><p>此部分用于约束整体原子位置（X，Y，Z）。如果指定了约束，则<code>TARGET</code>的值将被视为运行开始时的坐标值，或者是<code>&amp;FIX_ATOM_RESTART</code>节中的相应值。</p>
<ul>
<li><code>COMPONENTS_TO_FIX</code>：指定将在本节中指定的原子的哪些成分（X，Y，Z或组合）受到约束/约束。默认是<code>XYZ</code></li>
<li><code>LIST</code>：指定要冻结的原子列表，对应于<code>&amp;FORCE_EVAL</code>中的<code>&amp;SUBSYS</code>的<code>&amp;COORD</code>中的顺序</li>
</ul>
<h3 id="amp-CELL-OPT"><a href="#amp-CELL-OPT" class="headerlink" title="&amp;CELL_OPT"></a>&amp;CELL_OPT</h3><p>设置用于优化模拟晶胞的环境。有两种可能的方案：（1）零温度优化； （2）有限温度优化。</p>
<ul>
<li><code>KEEP_SYMMETRY</code>：保持要求的初始细胞对称性（例如在细胞优化过程中）。初始对称性必须在<code>＆CELL</code>部分中指定。默认是<code>.FALSE.</code></li>
</ul>
<h1 id="输出文件"><a href="#输出文件" class="headerlink" title="输出文件"></a>输出文件</h1><p>会输出以下文件：</p>
<ul>
<li>H2O.out：包含主要输出</li>
<li>H2O-pos-1.xyz：包含<code>xyz</code>文件格式中每个几何优化步骤的原子坐标轨迹。</li>
<li>H2O-1.restart：类似于输入文件，包含水分子的最新原子坐标。可以直接用于重启任务，也可以直接用其作为模板，使用其中的原子结构进一步计算</li>
<li>H2O-1.restart.bak-1、H2O-1.restart.bak-2、H2O-1.restart.bak-3：H2O-1.restart.bak-*是具有从先前的1、2和3几何优化迭代获得的原子坐标的备份重新启动文件。H2O-1.restart.bak-1应该与 H2O-1.restart相同。</li>
</ul>
<h2 id="out文件"><a href="#out文件" class="headerlink" title=".out文件"></a>.out文件</h2><ul>
<li><p>每一步几何优化都会有如下信息：</p>
<ul>
<li>在几何优化步骤1结束时，系统的总能量为-17.1643447508（Ha），并且未达到优化几何的标准。因此，迭代将继续进行，直到所有条件变为“ YES”为止。</li>
</ul>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="string">--------</span>  <span class="string">Informations</span> <span class="string">at</span> <span class="string">step</span> <span class="string">=</span>     <span class="number">1</span> <span class="string">------------</span></span><br><span class="line"> <span class="string">Optimization</span> <span class="string">Method</span>        <span class="string">=</span>                   <span class="string">SD</span></span><br><span class="line"> <span class="string">Total</span> <span class="string">Energy</span>               <span class="string">=</span>       <span class="number">-17.1643447508</span></span><br><span class="line"> <span class="string">Real</span> <span class="string">energy</span> <span class="string">change</span>         <span class="string">=</span>        <span class="number">-0.0006776683</span></span><br><span class="line"> <span class="string">Decrease</span> <span class="string">in</span> <span class="string">energy</span>         <span class="string">=</span>                  <span class="literal">YES</span></span><br><span class="line"> <span class="string">Used</span> <span class="string">time</span>                  <span class="string">=</span>               <span class="number">90.837</span></span><br><span class="line"></span><br><span class="line"> <span class="attr">Convergence check :</span></span><br><span class="line"> <span class="string">Max.</span> <span class="string">step</span> <span class="string">size</span>             <span class="string">=</span>         <span class="number">0.0336570168</span></span><br><span class="line"> <span class="string">Conv.</span> <span class="string">limit</span> <span class="string">for</span> <span class="string">step</span> <span class="string">size</span>  <span class="string">=</span>         <span class="number">0.0010000000</span></span><br><span class="line"> <span class="string">Convergence</span> <span class="string">in</span> <span class="string">step</span> <span class="string">size</span>   <span class="string">=</span>                   <span class="literal">NO</span></span><br><span class="line"> <span class="string">RMS</span> <span class="string">step</span> <span class="string">size</span>              <span class="string">=</span>         <span class="number">0.0168136889</span></span><br><span class="line"> <span class="string">Conv.</span> <span class="string">limit</span> <span class="string">for</span> <span class="string">RMS</span> <span class="string">step</span>   <span class="string">=</span>         <span class="number">0.0010000000</span></span><br><span class="line"> <span class="string">Convergence</span> <span class="string">in</span> <span class="string">RMS</span> <span class="string">step</span>    <span class="string">=</span>                   <span class="literal">NO</span></span><br><span class="line"> <span class="string">Max.</span> <span class="string">gradient</span>              <span class="string">=</span>         <span class="number">0.0182785685</span></span><br><span class="line"> <span class="string">Conv.</span> <span class="string">limit</span> <span class="string">for</span> <span class="string">gradients</span>  <span class="string">=</span>         <span class="number">0.0010000000</span></span><br><span class="line"> <span class="string">Conv.</span> <span class="string">for</span> <span class="string">gradients</span>        <span class="string">=</span>                   <span class="literal">NO</span></span><br><span class="line"> <span class="string">RMS</span> <span class="string">gradient</span>               <span class="string">=</span>         <span class="number">0.0091312361</span></span><br><span class="line"> <span class="string">Conv.</span> <span class="string">limit</span> <span class="string">for</span> <span class="string">RMS</span> <span class="string">grad.</span>  <span class="string">=</span>         <span class="number">0.0010000000</span></span><br><span class="line"> <span class="string">Conv.</span> <span class="string">for</span> <span class="string">gradients</span>        <span class="string">=</span>                   <span class="literal">NO</span></span><br><span class="line"><span class="string">---------------------------------------------------</span></span><br></pre></td></tr></table></figure>
<ul>
<li>结束时所有标准都已满足:</li>
</ul>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="string">--------</span>  <span class="string">Informations</span> <span class="string">at</span> <span class="string">step</span> <span class="string">=</span>    <span class="number">11</span> <span class="string">------------</span></span><br><span class="line"> <span class="string">Optimization</span> <span class="string">Method</span>        <span class="string">=</span>                   <span class="string">SD</span></span><br><span class="line"> <span class="string">Total</span> <span class="string">Energy</span>               <span class="string">=</span>       <span class="number">-17.1646204766</span></span><br><span class="line"> <span class="string">Real</span> <span class="string">energy</span> <span class="string">change</span>         <span class="string">=</span>        <span class="number">-0.0000000529</span></span><br><span class="line"> <span class="string">Decrease</span> <span class="string">in</span> <span class="string">energy</span>         <span class="string">=</span>                  <span class="literal">YES</span></span><br><span class="line"> <span class="string">Used</span> <span class="string">time</span>                  <span class="string">=</span>               <span class="number">49.893</span></span><br><span class="line"></span><br><span class="line"> <span class="attr">Convergence check :</span></span><br><span class="line"> <span class="string">Max.</span> <span class="string">step</span> <span class="string">size</span>             <span class="string">=</span>         <span class="number">0.0003393150</span></span><br><span class="line"> <span class="string">Conv.</span> <span class="string">limit</span> <span class="string">for</span> <span class="string">step</span> <span class="string">size</span>  <span class="string">=</span>         <span class="number">0.0010000000</span></span><br><span class="line"> <span class="string">Convergence</span> <span class="string">in</span> <span class="string">step</span> <span class="string">size</span>   <span class="string">=</span>                  <span class="literal">YES</span></span><br><span class="line"> <span class="string">RMS</span> <span class="string">step</span> <span class="string">size</span>              <span class="string">=</span>         <span class="number">0.0001493298</span></span><br><span class="line"> <span class="string">Conv.</span> <span class="string">limit</span> <span class="string">for</span> <span class="string">RMS</span> <span class="string">step</span>   <span class="string">=</span>         <span class="number">0.0010000000</span></span><br><span class="line"> <span class="string">Convergence</span> <span class="string">in</span> <span class="string">RMS</span> <span class="string">step</span>    <span class="string">=</span>                  <span class="literal">YES</span></span><br><span class="line"> <span class="string">Max.</span> <span class="string">gradient</span>              <span class="string">=</span>         <span class="number">0.0001787448</span></span><br><span class="line"> <span class="string">Conv.</span> <span class="string">limit</span> <span class="string">for</span> <span class="string">gradients</span>  <span class="string">=</span>         <span class="number">0.0010000000</span></span><br><span class="line"> <span class="string">Conv.</span> <span class="string">in</span> <span class="string">gradients</span>         <span class="string">=</span>                  <span class="literal">YES</span></span><br><span class="line"> <span class="string">RMS</span> <span class="string">gradient</span>               <span class="string">=</span>         <span class="number">0.0000786642</span></span><br><span class="line"> <span class="string">Conv.</span> <span class="string">limit</span> <span class="string">for</span> <span class="string">RMS</span> <span class="string">grad.</span>  <span class="string">=</span>         <span class="number">0.0010000000</span></span><br><span class="line"> <span class="string">Conv.</span> <span class="string">in</span> <span class="string">RMS</span> <span class="string">gradients</span>     <span class="string">=</span>                  <span class="literal">YES</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>最终的Kohn-Sham能量可以在输出的末尾获得：</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="string">*******************************************************************************</span></span><br><span class="line"><span class="string">***</span>                    <span class="string">GEOMETRY</span> <span class="string">OPTIMIZATION</span> <span class="string">COMPLETED</span>                      <span class="string">***</span></span><br><span class="line"><span class="string">*******************************************************************************</span></span><br><span class="line"></span><br><span class="line">                   <span class="string">Reevaluating</span> <span class="string">energy</span> <span class="string">at</span> <span class="string">the</span> <span class="string">minimum</span></span><br><span class="line"></span><br><span class="line"><span class="attr">Number of electrons:</span>                                                          <span class="number">8</span></span><br><span class="line"><span class="attr">Number of occupied orbitals:</span>                                                  <span class="number">4</span></span><br><span class="line"><span class="attr">Number of molecular orbitals:</span>                                                 <span class="number">4</span></span><br><span class="line"></span><br><span class="line"><span class="attr">Number of orbital functions:</span>                                                 <span class="number">23</span></span><br><span class="line"><span class="attr">Number of independent orbital functions:</span>                                     <span class="number">23</span></span><br><span class="line"></span><br><span class="line"> <span class="string">Parameters</span> <span class="string">for</span> <span class="string">the</span> <span class="string">always</span> <span class="string">stable</span> <span class="string">predictor-corrector</span> <span class="string">(ASPC)</span> <span class="attr">method:</span></span><br><span class="line"></span><br><span class="line"> <span class="attr">ASPC order:</span> <span class="number">3</span></span><br><span class="line"></span><br><span class="line"> <span class="string">B(1)</span> <span class="string">=</span>   <span class="number">3.000000</span></span><br><span class="line"> <span class="string">B(2)</span> <span class="string">=</span>  <span class="number">-3.428571</span></span><br><span class="line"> <span class="string">B(3)</span> <span class="string">=</span>   <span class="number">1.928571</span></span><br><span class="line"> <span class="string">B(4)</span> <span class="string">=</span>  <span class="number">-0.571429</span></span><br><span class="line"> <span class="string">B(5)</span> <span class="string">=</span>   <span class="number">0.071429</span></span><br><span class="line"></span><br><span class="line"><span class="attr">Extrapolation method:</span> <span class="string">ASPC</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">SCF</span> <span class="string">WAVEFUNCTION</span> <span class="string">OPTIMIZATION</span></span><br><span class="line"></span><br><span class="line"> <span class="string">Step</span>     <span class="string">Update</span> <span class="string">method</span>      <span class="string">Time</span>    <span class="string">Convergence</span>         <span class="string">Total</span> <span class="string">energy</span>    <span class="string">Change</span></span><br><span class="line"> <span class="string">------------------------------------------------------------------------------</span></span><br><span class="line">    <span class="number">1</span> <span class="string">Pulay/Diag.</span> <span class="number">0.50E+00</span>    <span class="number">0.5</span>     <span class="number">0.00005615</span>       <span class="number">-17.1646204762</span> <span class="number">-1.72E+01</span></span><br><span class="line">    <span class="number">2</span> <span class="string">Pulay/Diag.</span> <span class="number">0.50E+00</span>    <span class="number">1.0</span>     <span class="number">0.00000563</span>       <span class="number">-17.1646347711</span> <span class="number">-1.43E-05</span></span><br><span class="line"></span><br><span class="line"> <span class="string">***</span> <span class="string">SCF</span> <span class="string">run</span> <span class="string">converged</span> <span class="string">in</span>     <span class="number">2</span> <span class="string">steps</span> <span class="string">***</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> <span class="attr">Electronic density on regular grids:</span>         <span class="number">-8.0000016293</span>       <span class="number">-0.0000016293</span></span><br><span class="line"> <span class="attr">Core density on regular grids:</span>                <span class="number">7.9999992554</span>       <span class="number">-0.0000007446</span></span><br><span class="line"> <span class="attr">Total charge density on r-space grids:</span>       <span class="number">-0.0000023739</span></span><br><span class="line"> <span class="attr">Total charge density g-space grids:</span>          <span class="number">-0.0000023739</span></span><br><span class="line"></span><br><span class="line"> <span class="attr">Overlap energy of the core charge distribution:</span>               <span class="number">0.00000004555422</span></span><br><span class="line"> <span class="attr">Self energy of the core charge distribution:</span>                <span class="number">-43.83289054591484</span></span><br><span class="line"> <span class="attr">Core Hamiltonian energy:</span>                                     <span class="number">12.82175605770555</span></span><br><span class="line"> <span class="attr">Hartree energy:</span>                                              <span class="number">17.97395116120845</span></span><br><span class="line"> <span class="attr">Exchange-correlation energy:</span>                                 <span class="number">-4.12745148966141</span></span><br><span class="line"></span><br><span class="line"> <span class="attr">Total energy:</span>                                               <span class="number">-17.16463477110803</span></span><br><span class="line"></span><br><span class="line"><span class="string">ENERGY|</span> <span class="string">Total</span> <span class="string">FORCE_EVAL</span> <span class="string">(</span> <span class="string">QS</span> <span class="string">)</span> <span class="string">energy</span> <span class="string">(a.u.):</span>              <span class="number">-17.164634771108034</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h1 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h1><h2 id="NaCl团簇的几何优化"><a href="#NaCl团簇的几何优化" class="headerlink" title="NaCl团簇的几何优化"></a>NaCl团簇的几何优化</h2><h3 id="输入文件模板template-inp"><a href="#输入文件模板template-inp" class="headerlink" title="输入文件模板template.inp"></a>输入文件模板template.inp</h3><figure class="highlight gams"><table><tr><td class="code"><pre><span class="line">@<span class="keyword">SET</span> NREP <span class="comment">MY_SUPERCELL</span></span><br><span class="line">@<span class="keyword">SET</span> <span class="comment">OPTIMIZER LBFGS # BFGS</span></span><br><span class="line"></span><br><span class="line">&amp;FORCE_EVAL</span><br><span class="line">  METHOD <span class="comment">Fist</span></span><br><span class="line">  &amp;MM</span><br><span class="line">    &amp;FORCEFIELD</span><br><span class="line">      &amp;CHARGE</span><br><span class="line">        ATOM <span class="comment">Na</span></span><br><span class="line">        CHARGE <span class="comment">+1.000</span></span><br><span class="line">      &amp;END <span class="comment">CHARGE</span></span><br><span class="line">      &amp;CHARGE</span><br><span class="line">        ATOM <span class="comment">Cl</span></span><br><span class="line">        CHARGE <span class="comment">-1.000</span></span><br><span class="line">      &amp;END <span class="comment">CHARGE</span></span><br><span class="line">      &amp;NONBONDED</span><br><span class="line">        &amp;BMHFT</span><br><span class="line">          map_atoms <span class="comment">NA NA</span></span><br><span class="line">          atoms <span class="comment">NA NA</span></span><br><span class="line">          RCUT <span class="comment">10.0</span></span><br><span class="line">        &amp;END <span class="comment">BMHFT</span></span><br><span class="line">        &amp;BMHFT</span><br><span class="line">          map_atoms <span class="comment">NA CL</span></span><br><span class="line">          atoms <span class="comment">NA CL</span></span><br><span class="line">          RCUT <span class="comment">10.0</span></span><br><span class="line">        &amp;END <span class="comment">BMHFT</span></span><br><span class="line">        &amp;BMHFT</span><br><span class="line">          map_atoms <span class="comment">CL CL</span></span><br><span class="line">          atoms <span class="comment">CL CL</span></span><br><span class="line">          RCUT <span class="comment">10.0</span></span><br><span class="line">        &amp;END <span class="comment">BMHFT</span></span><br><span class="line">      &amp;END <span class="comment">NONBONDED</span></span><br><span class="line">    &amp;END <span class="comment">FORCEFIELD</span></span><br><span class="line">    &amp;POISSON</span><br><span class="line">      &amp;EWALD</span><br><span class="line">        EWALD_TYPE <span class="comment">spme</span></span><br><span class="line">        ALPHA <span class="comment">.35</span></span><br><span class="line">        GMAX <span class="comment">12*$&#123;NREP&#125;</span></span><br><span class="line">        O_SPLINE <span class="comment">6</span></span><br><span class="line">      &amp;END <span class="comment">EWALD</span></span><br><span class="line">    &amp;END <span class="comment">POISSON</span></span><br><span class="line">  &amp;END <span class="comment">MM</span></span><br><span class="line">  &amp;SUBSYS</span><br><span class="line">    &amp;CELL</span><br><span class="line">      #ABC <span class="comment">5.620 5.620 5.620</span></span><br><span class="line">      ABC <span class="comment">2*5.620 2*5.620 2*5.620</span></span><br><span class="line">      MULTIPLE_UNIT_CELL <span class="comment">$&#123;NREP&#125; $&#123;NREP&#125; $&#123;NREP&#125;</span></span><br><span class="line">    &amp;END <span class="comment">CELL</span></span><br><span class="line">    &amp;TOPOLOGY</span><br><span class="line">      COORD_FILE_NAME <span class="comment">NaCl.pdb</span></span><br><span class="line">      COORDINATE <span class="comment">PDB</span></span><br><span class="line">      CONN_FILE_FORMAT <span class="comment">OFF</span></span><br><span class="line">      MULTIPLE_UNIT_CELL <span class="comment">$&#123;NREP&#125; $&#123;NREP&#125; $&#123;NREP&#125;</span></span><br><span class="line">    &amp;END <span class="comment">TOPOLOGY</span></span><br><span class="line">  &amp;END <span class="comment">SUBSYS</span></span><br><span class="line">&amp;END <span class="comment">FORCE_EVAL</span></span><br><span class="line"></span><br><span class="line">&amp;GLOBAL</span><br><span class="line">  PROJECT <span class="comment">NaCl</span></span><br><span class="line">  RUN_TYPE <span class="comment">GEO_OPT</span></span><br><span class="line">&amp;END <span class="comment">GLOBAL</span></span><br><span class="line"></span><br><span class="line">&amp;MOTION</span><br><span class="line">  &amp;GEO_OPT</span><br><span class="line">    OPTIMIZER <span class="comment">$&#123;OPTIMIZER&#125;</span></span><br><span class="line">  &amp;END</span><br><span class="line">&amp;END <span class="comment">MOTION</span></span><br></pre></td></tr></table></figure>
<ul>
<li><p>可以通过<code>@SET key XX</code>来设定变量</p>
</li>
<li><p>通过脚本来取代<code>MY_SUPERCELL</code>设定一系列不同值的<code>NREP</code>的任务，并通过脚本提交任务</p>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> <span class="built_in">ii</span> <span class="keyword">in</span> <span class="number">2</span> <span class="number">4</span> <span class="number">6</span> <span class="number">8</span> <span class="number">10</span> <span class="number">12</span></span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">   mkdir <span class="variable">$</span>&#123;<span class="built_in">ii</span>&#125;</span><br><span class="line">   sed <span class="literal">-e</span> <span class="string">&quot;s/MY_SUPERCELL/<span class="variable">$</span>&#123;ii&#125;/g&quot;</span> template.inp &gt; <span class="variable">$</span>&#123;<span class="built_in">ii</span>&#125;/NaCl_supercell_<span class="variable">$</span>&#123;<span class="built_in">ii</span>&#125;.inp</span><br><span class="line">   sed <span class="literal">-e</span> <span class="string">&quot;s/filename/NaCl_supercell_<span class="variable">$</span>&#123;ii&#125;/g&quot;</span> cp2k.sub &gt; <span class="variable">$</span>&#123;<span class="built_in">ii</span>&#125;/cp2k.sub</span><br><span class="line">   <span class="built_in">cp</span> NaCl.pdb <span class="variable">$</span>&#123;<span class="built_in">ii</span>&#125;/NaCl.pdb</span><br><span class="line">   <span class="built_in">cd</span> <span class="variable">$</span>&#123;<span class="built_in">ii</span>&#125;</span><br><span class="line">   qsub cp2k.sub</span><br><span class="line">   <span class="built_in">cd</span> ..</span><br><span class="line">done</span><br></pre></td></tr></table></figure>
</li>
<li><p>.pdb文件</p>
</li>
</ul>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">REMARK</span>   <span class="number">4</span> NaCl COMPLIES WITH FORMAT V. <span class="number">2</span>.<span class="number">0</span> </span><br><span class="line"><span class="attribute">CRYST1</span>    <span class="number">5</span>.<span class="number">620</span>    <span class="number">5</span>.<span class="number">620</span>    <span class="number">5</span>.<span class="number">620</span>  <span class="number">90</span>.<span class="number">00</span>  <span class="number">90</span>.<span class="number">00</span>  <span class="number">90</span>.<span class="number">00</span> P <span class="number">1</span>         </span><br><span class="line"><span class="attribute">HETATM</span>    <span class="number">1</span> Na   NMO     <span class="number">0</span>       <span class="number">0</span>.<span class="number">000</span>   <span class="number">0</span>.<span class="number">000</span>   <span class="number">0</span>.<span class="number">000</span>  <span class="number">1</span>.<span class="number">00</span>  <span class="number">0</span>.<span class="number">00</span>      NMO Na</span><br><span class="line"><span class="attribute">HETATM</span>    <span class="number">2</span> Cl   CMO     <span class="number">0</span>       <span class="number">2</span>.<span class="number">810</span>   <span class="number">2</span>.<span class="number">810</span>   <span class="number">2</span>.<span class="number">810</span>  <span class="number">1</span>.<span class="number">00</span>  <span class="number">0</span>.<span class="number">00</span>      CMO Cl</span><br><span class="line"><span class="attribute">HETATM</span>    <span class="number">3</span> Na   NMO     <span class="number">0</span>       <span class="number">0</span>.<span class="number">000</span>   <span class="number">2</span>.<span class="number">810</span>   <span class="number">2</span>.<span class="number">810</span>  <span class="number">1</span>.<span class="number">00</span>  <span class="number">0</span>.<span class="number">00</span>      NMO Na</span><br><span class="line"><span class="attribute">HETATM</span>    <span class="number">4</span> Cl   CMO     <span class="number">0</span>       <span class="number">2</span>.<span class="number">810</span>   <span class="number">0</span>.<span class="number">000</span>   <span class="number">0</span>.<span class="number">000</span>  <span class="number">1</span>.<span class="number">00</span>  <span class="number">0</span>.<span class="number">00</span>      CMO Cl</span><br><span class="line"><span class="attribute">HETATM</span>    <span class="number">5</span> Na   NMO     <span class="number">0</span>       <span class="number">2</span>.<span class="number">810</span>   <span class="number">0</span>.<span class="number">000</span>   <span class="number">2</span>.<span class="number">810</span>  <span class="number">1</span>.<span class="number">00</span>  <span class="number">0</span>.<span class="number">00</span>      NMO Na</span><br><span class="line"><span class="attribute">HETATM</span>    <span class="number">6</span> Cl   CMO     <span class="number">0</span>       <span class="number">0</span>.<span class="number">000</span>   <span class="number">2</span>.<span class="number">810</span>   <span class="number">0</span>.<span class="number">000</span>  <span class="number">1</span>.<span class="number">00</span>  <span class="number">0</span>.<span class="number">00</span>      CMO Cl</span><br><span class="line"><span class="attribute">HETATM</span>    <span class="number">7</span> Na   NMO     <span class="number">0</span>       <span class="number">2</span>.<span class="number">810</span>   <span class="number">2</span>.<span class="number">810</span>   <span class="number">0</span>.<span class="number">000</span>  <span class="number">1</span>.<span class="number">00</span>  <span class="number">0</span>.<span class="number">00</span>      NMO Na</span><br><span class="line"><span class="attribute">HETATM</span>    <span class="number">8</span> Cl   CMO     <span class="number">0</span>       <span class="number">0</span>.<span class="number">000</span>   <span class="number">0</span>.<span class="number">000</span>   <span class="number">2</span>.<span class="number">810</span>  <span class="number">1</span>.<span class="number">00</span>  <span class="number">0</span>.<span class="number">00</span>      CMO Cl</span><br><span class="line"><span class="attribute">TER</span>       <span class="number">9</span>      UNK     <span class="number">0</span> </span><br><span class="line"><span class="attribute">END</span></span><br></pre></td></tr></table></figure>
<h2 id="amp-FORCE-EVAL"><a href="#amp-FORCE-EVAL" class="headerlink" title="&amp;FORCE_EVAL"></a>&amp;FORCE_EVAL</h2><ul>
<li><code>METHOD</code>中使用<code>FIST</code>，使用分子动力学（MM）方法</li>
</ul>
<h3 id="amp-MM"><a href="#amp-MM" class="headerlink" title="&amp;MM"></a>&amp;MM</h3><ul>
<li>使用分子动力学的相关设定</li>
</ul>
<h4 id="amp-FORCEFIELD"><a href="#amp-FORCEFIELD" class="headerlink" title="&amp;FORCEFIELD"></a>&amp;FORCEFIELD</h4><p>指定有关如何为经典计算正确设置force_field的信息的部分。</p>
<h5 id="amp-CHARGE"><a href="#amp-CHARGE" class="headerlink" title="&amp;CHARGE"></a>&amp;CHARGE</h5><p>指定MM原子的电荷</p>
<ul>
<li><code>ATOM</code>：定义电荷的原子种类。</li>
<li><code>CHARGE</code>：以电子电荷单位定义MM原子的电荷。</li>
</ul>
<h5 id="amp-NONBONDED"><a href="#amp-NONBONDED" class="headerlink" title="&amp;NONBONDED"></a>&amp;NONBONDED</h5><p>指定非键的输入参数</p>
<h6 id="amp-BMHFT"><a href="#amp-BMHFT" class="headerlink" title="&amp;BMHFT"></a>&amp;BMHFT</h6><p>指定BMHFT势能类型的输入参数。只适用于Na / Cl对。函数形式为<script type="math/tex">V(r)=Ae^{-Br}-\frac{C}{r^6}-\frac{D}{r^8}</script></p>
<ul>
<li><code>MAP_ATOMS</code>：定义仅在Na和Cl时内部定义BMHFT非键势的种类。</li>
<li><code>ATOMS</code>：定义BMHFT非键势涉及的原子种类</li>
<li><code>RCUT</code>：定义BMHFT电位的截止参数，默认是4.12758223 angstrom。</li>
</ul>
<h4 id="amp-POISSON"><a href="#amp-POISSON" class="headerlink" title="&amp;POISSON"></a>&amp;POISSON</h4><p>设置泊松解析器。</p>
<h5 id="amp-EWALD"><a href="#amp-EWALD" class="headerlink" title="&amp;EWALD"></a>&amp;EWALD</h5><p>控制CLASSICAL MM静电。</p>
<ul>
<li><code>EWALD_TYPE</code>：要执行的ewald类型<ul>
<li><code>EWALD</code>：默认，标准的基于非fft的ewald</li>
<li><code>NONE</code>：无标准实空间库仑电势与非键合贡献一起计算</li>
<li><code>PME</code>：使用fft插值的粒子网格</li>
<li><code>SPME</code>：使用beta-Euler样条曲线的平滑粒子网格（推荐）</li>
</ul>
</li>
<li><p><code>ALPHA</code>：与Ewald相关的alpha参数（<code>EWALD</code> | <code>PME</code> | <code>SPME</code>）。默认为<code>0.35 angstrom^-1</code>。</p>
<ul>
<li>对于小型系统，建议为<code>3.5</code>/<code>rcut</code>。</li>
<li>对于紧密键合，建议值为<code>1.0</code>。</li>
<li>需要调整<code>alpha</code>，<code>rcut</code>和<code>gmax</code>以获得ewald的O（<script type="math/tex">N^{1.5}</script>）缩放比例。</li>
</ul>
</li>
<li><p><code>GMAX</code>：网格点数（SPME和EWALD）。如果指定一个数字，则网格上所有三个方向都使用相同的点数。如果给出三个数字，则每个方向可以具有不同的点数。点数需要可FFTable（取决于使用的库），对于EWALD，使用奇数。最佳数量取决于Alpha和晶胞的大小。通常每埃1点。</p>
</li>
<li><code>O_SPLINE</code>：beta-Euler样条的顺序（仅<code>SPME</code>）。默认为<code>6</code>。</li>
</ul>
<h2 id="NaCl的晶胞优化"><a href="#NaCl的晶胞优化" class="headerlink" title="NaCl的晶胞优化"></a>NaCl的晶胞优化</h2><h3 id="输入文件模板template-inp-1"><a href="#输入文件模板template-inp-1" class="headerlink" title="输入文件模板template.inp"></a>输入文件模板template.inp</h3><figure class="highlight gams"><table><tr><td class="code"><pre><span class="line">@<span class="keyword">SET</span> SCALE_FACTOR <span class="comment">MY_SCALING</span></span><br><span class="line">@<span class="keyword">SET</span> <span class="comment">NREP 1</span></span><br><span class="line">@<span class="keyword">SET</span> <span class="comment">OPTIMIZER BFGS # LBFGS</span></span><br><span class="line">@<span class="keyword">SET</span> <span class="comment">CUTOFF MY_CUTOFF</span></span><br><span class="line">@<span class="keyword">SET</span> <span class="comment">SAFTEY_CUTOFF 1.1</span></span><br><span class="line"></span><br><span class="line">&amp;FORCE_EVAL</span><br><span class="line">  METHOD <span class="comment">QS</span></span><br><span class="line">  &amp;DFT</span><br><span class="line">    BASIS_SET_FILE_NAME <span class="comment">BASIS_MOLOPT</span></span><br><span class="line">    POTENTIAL_FILE_NAME <span class="comment">GTH_POTENTIALS</span></span><br><span class="line">    &amp;MGRID</span><br><span class="line">      CUTOFF <span class="comment">$&#123;CUTOFF&#125;</span></span><br><span class="line">      REL_CUTOFF <span class="comment">60</span></span><br><span class="line">    &amp;END <span class="comment">MGRID</span></span><br><span class="line">    &amp;QS</span><br><span class="line">      EPS_DEFAULT <span class="comment">1.0E-12</span></span><br><span class="line">    &amp;END <span class="comment">QS</span></span><br><span class="line">    &amp;SCF</span><br><span class="line">      SCF_GUESS <span class="comment">RESTART</span></span><br><span class="line">      &amp;OT <span class="comment">ON</span></span><br><span class="line">        MINIMIZER <span class="comment">DIIS</span></span><br><span class="line">      &amp;END <span class="comment">OT</span></span><br><span class="line">    &amp;END <span class="comment">SCF</span></span><br><span class="line">    &amp;XC</span><br><span class="line">      &amp;XC_FUNCTIONAL <span class="comment">Pade</span></span><br><span class="line">      &amp;END <span class="comment">XC_FUNCTIONAL</span></span><br><span class="line">    &amp;END <span class="comment">XC</span></span><br><span class="line">  &amp;END <span class="comment">DFT</span></span><br><span class="line">  &amp;SUBSYS</span><br><span class="line">    &amp;CELL</span><br><span class="line">      ABC <span class="comment">5.620*$&#123;SCALE_FACTOR&#125; 5.620*$&#123;SCALE_FACTOR&#125; 5.620*$&#123;SCALE_FACTOR&#125;</span></span><br><span class="line">      MULTIPLE_UNIT_CELL <span class="comment">$&#123;NREP&#125; $&#123;NREP&#125; $&#123;NREP&#125;</span></span><br><span class="line">      #&amp;CELL_REF</span><br><span class="line">      #  ABC <span class="comment">5.620*$&#123;SAFETY_FACTOR&#125; 5.620*$&#123;SAFETY_FACTOR&#125; 5.620*$&#123;SAFETY_FACTOR&#125;</span></span><br><span class="line">      #  MULTIPLE_UNIT_CELL <span class="comment">$&#123;NREP&#125; $&#123;NREP&#125; $&#123;NREP&#125;</span></span><br><span class="line">      #&amp;END</span><br><span class="line">    &amp;END <span class="comment">CELL</span></span><br><span class="line">    &amp;COORD</span><br><span class="line">		scaled</span><br><span class="line">		Na <span class="comment">0.000   0.000   0.000</span></span><br><span class="line">		Cl <span class="comment">0.500   0.500   0.500</span></span><br><span class="line">		Na <span class="comment">0.000   0.500   0.500</span></span><br><span class="line">		Cl <span class="comment">0.500   0.000   0.000</span></span><br><span class="line">		Na <span class="comment">0.500   0.000   0.500</span></span><br><span class="line">		Cl <span class="comment">0.000   0.500   0.000</span></span><br><span class="line">		Na <span class="comment">0.500   0.500   0.000</span></span><br><span class="line">		Cl <span class="comment">0.000   0.000   0.500</span></span><br><span class="line">    &amp;END</span><br><span class="line">    &amp;TOPOLOGY</span><br><span class="line">      MULTIPLE_UNIT_CELL <span class="comment">$&#123;NREP&#125; $&#123;NREP&#125; $&#123;NREP&#125;</span></span><br><span class="line">    &amp;END <span class="comment">TOPOLOGY</span></span><br><span class="line">    &amp;KIND <span class="comment">Na</span></span><br><span class="line">      BASIS_SET <span class="comment">DZVP-MOLOPT-SR-GTH</span></span><br><span class="line">      POTENTIAL <span class="comment">GTH-PADE-q9</span></span><br><span class="line">    &amp;END <span class="comment">KIND</span></span><br><span class="line">    &amp;KIND <span class="comment">Cl</span></span><br><span class="line">      BASIS_SET <span class="comment">DZVP-MOLOPT-SR-GTH</span></span><br><span class="line">      POTENTIAL <span class="comment">GTH-PADE-q7</span></span><br><span class="line">    &amp;END <span class="comment">KIND</span></span><br><span class="line">  &amp;END <span class="comment">SUBSYS</span></span><br><span class="line">&amp;END <span class="comment">FORCE_EVAL</span></span><br><span class="line"></span><br><span class="line">&amp;GLOBAL</span><br><span class="line">  PROJECT <span class="comment">NaCl</span></span><br><span class="line">  RUN_TYPE <span class="comment">ENERGY</span></span><br><span class="line">&amp;END <span class="comment">GLOBAL</span></span><br><span class="line"></span><br><span class="line">&amp;MOTION</span><br><span class="line">  &amp;GEO_OPT</span><br><span class="line">    OPTIMIZER <span class="comment">$&#123;OPTIMIZER&#125;</span></span><br><span class="line">  &amp;END</span><br><span class="line">  &amp;CELL_OPT</span><br><span class="line">    KEEP_SYMMETRY</span><br><span class="line">  &amp;END</span><br><span class="line">&amp;END <span class="comment">MOTION</span></span><br></pre></td></tr></table></figure>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">CUTOFF</span>=<span class="string">&quot;280&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">for</span> ii in <span class="number">0</span>.<span class="number">800</span> <span class="number">0</span>.<span class="number">825</span> <span class="number">0</span>.<span class="number">850</span> <span class="number">0</span>.<span class="number">875</span> <span class="number">0</span>.<span class="number">900</span> <span class="number">0</span>.<span class="number">925</span> <span class="number">0</span>.<span class="number">950</span> <span class="number">0</span>.<span class="number">975</span> <span class="number">1</span>.<span class="number">000</span> <span class="number">1</span>.<span class="number">025</span> <span class="number">1</span>.<span class="number">050</span> <span class="number">1</span>.<span class="number">075</span> <span class="number">1</span>.<span class="number">100</span></span><br><span class="line"><span class="attribute">do</span></span><br><span class="line">   <span class="attribute">sed</span> -e <span class="string">&quot;s/MY_SCALING/$&#123;ii&#125;/g&quot;</span> NaCl_QS.inp &gt; temp.inp</span><br><span class="line">   <span class="attribute">sed</span> -e <span class="string">&quot;s/MY_CUTOFF/$&#123;CUTOFF&#125;/g&quot;</span> temp.inp &gt; input_<span class="variable">$&#123;ii&#125;</span>.inp</span><br><span class="line"><span class="attribute">done</span></span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>计算化学</category>
        <category>软件</category>
      </categories>
      <tags>
        <tag>几何优化</tag>
        <tag>CP2K</tag>
      </tags>
  </entry>
  <entry>
    <title>【Jmol】常见的指令</title>
    <url>/2021/08/13/%E3%80%90Jmol%E3%80%91%E5%B8%B8%E8%A7%81%E7%9A%84%E6%8C%87%E4%BB%A4/</url>
    <content><![CDATA[<h1 id="background背景"><a href="#background背景" class="headerlink" title="background背景"></a><code>background</code>背景</h1><p>设置背景颜色或者图像。用法：</p>
<ul>
<li><p><code>background [RGB-color]</code>：设置窗口的背景颜色。</p>
</li>
<li><p><code>background IMAGE &quot;filename&quot;</code>：将窗口的背景设置为指定的图像文件，该文件可以是BMP、JPG、PNG或GIF格式。图像被拉伸以适应窗口的大小。</p>
</li>
<li><code>background LABELS [color-none-CPK]</code>：设置使用“label”命令显示的原子标签的背景颜色。是全局操作，而不是对选定的原子。</li>
</ul>
<blockquote>
<ul>
<li><code>[RGB-color]</code>：<ul>
<li>颜色的名字：<code>white</code>、<code>black</code>……</li>
<li>RGB颜色值：<code>[255, 0, 255]</code>，<code>&#123;255,0,255&#125;</code>，<code>&#123;0.5, 0.5, 1&#125;</code></li>
<li>十六进制颜色码：<code>[xFF00FF]</code></li>
</ul>
</li>
<li><code>[color-none-CPK]</code>：包含<code>[RGB-color]</code>和<code>none</code></li>
</ul>
</blockquote>
<h1 id="boundbox边界框"><a href="#boundbox边界框" class="headerlink" title="boundbox边界框"></a><code>boundbox</code>边界框</h1><p>边界框设置，与<code>boundingbox</code>含义相同。</p>
<ul>
<li><p><code>show BOUNDBOX</code>：中心是模型的几何中心而不是旋转中心（即平均原子位置）。输出格式为：</p>
<figure class="highlight avrasm"><table><tr><td class="code"><pre><span class="line"><span class="symbol">boundbox:</span> (centerX, centerY, centerZ) (vectorX, vectorY, vectorZ)</span><br></pre></td></tr></table></figure>
<ul>
<li>比如边框的长就是2<code>vectorX</code></li>
</ul>
</li>
<li><p>显示边界框：</p>
<figure class="highlight vhdl"><table><tr><td class="code"><pre><span class="line">boundbox [atom-expression] [<span class="literal">line</span>-<span class="literal">width</span>-<span class="keyword">or</span>-<span class="keyword">type</span>]</span><br></pre></td></tr></table></figure>
<ul>
<li><p><code>[atom-expression]</code>见<a href="#[atom-expression]原子表达">原子表达</a>。默认是<code>*</code></p>
</li>
<li><p><code>[line-width-or-type]</code>：<code>ON/OFF/DOTTED</code>（默认是<code>ON</code>，即实线）或<code>整数(1-19)</code>或者<code>小数(&lt;2.0)</code>（后两者似乎与实线的粗细有关）</p>
</li>
</ul>
</li>
<li><p>通过中心和向量设定一个边界框：</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">boundbox</span> <span class="selector-attr">[atom-expression-or-coordinate]</span> <span class="selector-attr">[xyz-coordinate]</span> <span class="selector-attr">[line-width-or-type]</span>&#123;<span class="attribute">default</span>: unchanged&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>通过两个角设定一个边界框：</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">boundbox</span> <span class="selector-tag">CORNERS</span> <span class="selector-attr">[atom-expression-or-coordinate]</span> <span class="selector-attr">[atom-expression-or-coordinate]</span> <span class="selector-attr">[line-width-or-type]</span>&#123;<span class="attribute">default</span>: unchanged&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>getProperty boundBoxInfo</code>：获取边界框的信息</p>
</li>
</ul>
<h1 id="rotate"><a href="#rotate" class="headerlink" title="rotate"></a>rotate</h1><p>默认为以逆时针方式绕 y（垂直）轴每秒旋转 10 度，即：</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">rotate spin y <span class="number">10</span></span><br></pre></td></tr></table></figure>
<p>选项：</p>
<ul>
<li><code>axis</code>：axis可以是<code>x</code>， <code>y</code>， <code>z</code>，<code>-x</code>， <code>-y</code>，<code>-z</code>，绕六个标准轴中的一个旋转。隐含的轴是窗口的轴，而不是分子的轴。如果需要按分子的轴，则需要<code>MOLECULAR</code>关键词。</li>
<li><p><code>axis number</code>：绕着某个轴旋转多少度，可以是负的，如果在前面加上<code>spin</code>，表示每秒旋转多少度。</p>
</li>
<li><p><code>axis num1 num2</code>：围绕某个轴以num2的速度旋转num1度。</p>
</li>
<li><p><code>&#123;atom expression or point&#125; &#123;atom expression or point&#125; number</code>：围绕两个点形成的轴旋转多少度。可以是点，也可以是原子。</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">#rotate x <span class="number">10</span> 等同于</span><br><span class="line">rotate &#123;<span class="number">0</span> <span class="number">0</span> <span class="number">0</span>&#125; &#123;<span class="number">1</span> <span class="number">0</span> <span class="number">0</span>&#125; <span class="number">10</span></span><br><span class="line">spin &#123;atomno=<span class="number">1</span>&#125; &#123;atomno=<span class="number">2</span>&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>INTERNAL</code>等同于<code>MOLECULAR</code>，根据分子的轴旋转。</p>
</li>
<li><code>spin</code>：根据给定的速度自旋。</li>
</ul>
<h1 id="color"><a href="#color" class="headerlink" title="color"></a>color</h1><p>默认的颜色标准：<a href="http://jmol.sourceforge.net/jscolors/#JavaScript%20colors">http://jmol.sourceforge.net/jscolors/#JavaScript%20colors</a></p>
<p>可以通过select选中后，再指定颜色 <code>select \*.N?; color green</code>；也可以通过<code>color &#123;*.N?&#125; green</code>，通常的语法为：</p>
<figure class="highlight qml"><table><tr><td class="code"><pre><span class="line"><span class="built_in">color</span> [object] [translucent/opaque] [<span class="built_in">color</span>, <span class="keyword">property</span><span class="string"></span>, or <span class="built_in">color</span> scheme]</span><br></pre></td></tr></table></figure>
<ul>
<li><code>[object]</code> ：可以是<code>atoms</code>, <code>bonds</code>, <code>backbone</code>, <code>cartoon</code>, <code>stars</code>, <code>rockets</code>, <code>ribbon</code>, <code>dots</code>, <code>label</code>, <code>echo</code>, <code>hbonds</code>, <code>ssbonds</code>, <code>axes</code>, <code>boundbox</code>, <code>measures</code>, <code>polyhedra</code>, <code>isosurface</code>, <code>pmesh</code>, <code>unitcell</code>。</li>
</ul>
<h2 id="透明"><a href="#透明" class="headerlink" title="透明"></a>透明</h2><figure class="highlight dos"><table><tr><td class="code"><pre><span class="line"><span class="built_in">color</span> atoms TRANSLUCENT</span><br></pre></td></tr></table></figure>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">color bonds TRANSLUCENT <span class="number">1</span></span><br></pre></td></tr></table></figure>
<h1 id="select"><a href="#select" class="headerlink" title="select"></a>select</h1><ul>
<li><code>select</code>：默认选中所有原子，=<code>select all</code>=<code>select *</code></li>
<li><code>select none</code>：选中0个原子=<code>select 0</code></li>
<li><code>select [atom-expression]</code>：基于[atom-expression]选择原子</li>
<li><code>select add/remove [atom-expression]</code> ：将指定的原子添加/移除到选定的集合中。</li>
</ul>
<p>例子：</p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line"><span class="section">#选择C元素</span></span><br><span class="line">select <span class="emphasis">_C</span></span><br><span class="line"><span class="emphasis">#选择第一个U元素</span></span><br><span class="line"><span class="emphasis">select (_</span>U)[1]</span><br><span class="line"><span class="section">#选择所有原子中第一个原子</span></span><br><span class="line">select (<span class="emphasis">*)[1]</span></span><br><span class="line"><span class="emphasis">#选择所有原子中第1-6个原子</span></span><br><span class="line"><span class="emphasis">select (*</span>)[<span class="string">1</span>][<span class="symbol">6</span>]</span><br><span class="line"></span><br><span class="line"><span class="section">#选择所有原子中第1，6个原子</span></span><br><span class="line">select (<span class="emphasis">*)[1],(*</span>)[6]</span><br><span class="line"></span><br><span class="line">select (&#123;0 5&#125;)</span><br><span class="line">select (&#123;0 70:74&#125;)</span><br><span class="line"></span><br><span class="line"><span class="section">#选择1-8，65-75原子</span></span><br><span class="line">select (<span class="emphasis">*)[<span class="string">1</span>][<span class="symbol">8</span>], (*</span>)[<span class="string">65</span>][<span class="symbol">75</span>]</span><br><span class="line"></span><br><span class="line"><span class="section">#选择所有成键的原子</span></span><br><span class="line">select bonded</span><br><span class="line"><span class="section">#选择所有连接的原子</span></span><br><span class="line">select connected</span><br><span class="line"><span class="section">#选择已经选择的原子</span></span><br><span class="line">select selected</span><br><span class="line"><span class="section">#选择第1，3，5个原子</span></span><br><span class="line">x = [1,3,5]; select atomno=x</span><br><span class="line"><span class="section">#选择第34、35个原子</span></span><br><span class="line">select @34, @35</span><br><span class="line"><span class="section">#选择元素序号10~110之间的原子</span></span><br><span class="line">select &#123;elemno&gt;=10 and elemno<span class="xml"><span class="tag">&lt;<span class="name">=110&#125;</span></span></span></span><br></pre></td></tr></table></figure>
<h1 id="label"><a href="#label" class="headerlink" title="label"></a>label</h1><ul>
<li>原子的标记参见[atom properties]。</li>
</ul>
<h2 id="相关设置"><a href="#相关设置" class="headerlink" title="相关设置"></a>相关设置</h2><ul>
<li><p><code>set fontScaling OFF</code>：当fontScaling设置为ON时，在此之后创建的任何标签都会在模型缩放时进行缩放。</p>
</li>
<li><p><code>set fontSize [font-size]</code>：为当前选定的原子设置原子标签的字体大小。</p>
</li>
<li><code>set labelOffset [x-offset] [y-offset] [atom-expression]</code>：设置相对于被标记原子的标签偏移量。正数表示原子中心和标签开头之间的像素数。负数表示原子中心和标签末端之间的像素数，整个标签在原子的左侧。任一方向的零表示以该方向为中心。</li>
<li><code>set labelAlignment position</code>：position可以是<code>LEFT</code>, <code>RIGHT</code>,或<code>CENTER</code>。将多行标签内的标签文本对齐方式设置为左对齐、右对齐或居中对齐。</li>
<li>设置<a href="#color">颜色</a>：注意无法和背景颜色设置相同颜色。</li>
</ul>
<h1 id="font"><a href="#font" class="headerlink" title="font"></a>font</h1><p>语法：</p>
<figure class="highlight maxima"><table><tr><td class="code"><pre><span class="line"><span class="built_in">font</span> [object-with-text] [<span class="built_in">font</span>-size] [<span class="built_in">font</span>-face] [<span class="built_in">font</span>-<span class="built_in">style</span>] [scaling <span class="built_in">factor</span>]</span><br></pre></td></tr></table></figure>
<ul>
<li>[object-with-text]有：<code>axes</code>、<code>ECHO</code>、<code>HOVER</code>、<code>LABEL</code>、<code>measure</code></li>
<li>[font-size]：6-63之间的整数</li>
<li>[font-face]字体默认是<code>SansSerif</code>，还有<code>SERIF</code>、<code>monospaced</code></li>
<li>[font-style]默认是<code>Plain</code>，还有<code>BOLD</code>，<code>italic</code>和<code>BOLDitalic</code></li>
</ul>
<h1 id="Spacefill或CPK"><a href="#Spacefill或CPK" class="headerlink" title="Spacefill或CPK"></a>Spacefill或CPK</h1><p>将选定的原子渲染为阴影球体。</p>
<ul>
<li><code>spacefill on/OFF</code>：打开或关闭，默认是<code>ON</code>。</li>
<li><code>spacefill ONLY</code>：关闭其他的渲染，包括标签</li>
<li><code>spacefill 数字</code>：以埃为单位的特定半径的球体。负数<code>=ONLY</code>。</li>
</ul>
<h1 id="键相关"><a href="#键相关" class="headerlink" title="键相关"></a>键相关</h1><h2 id="wireframe"><a href="#wireframe" class="headerlink" title="wireframe"></a>wireframe</h2><ul>
<li><code>wireframe ON/OFF</code>：打开或关闭，默认是<code>ON</code>。</li>
<li><code>wireframe ONLY</code>：关闭其他的渲染，包括标签。</li>
<li><code>wireframe [radius-in-angstroms]</code>：以Å为单位显示给定圆柱体直径的线框，要用小数。负数<code>=ONLY</code>。</li>
</ul>
<h2 id="bondorder"><a href="#bondorder" class="headerlink" title="bondorder"></a>bondorder</h2><ul>
<li><code>bondorder number</code>：数字可以是<code>0.5</code>，<code>1</code>，<code>1.5</code>，<code>2</code>，<code>2.5</code>，<code>3</code>，<code>4</code>， <code>-1</code>，<code>-1.5</code>，<code>-2.5</code>（负数依次是氢键、PARTIALDOUBLE (reverse solid/dash of AROMATIC)，PARTIALTRIPLE2）</li>
</ul>
<h2 id="connect"><a href="#connect" class="headerlink" title="connect"></a>connect</h2><p>connect本身删除所有键，然后创建键基于 Jmol 默认键生成算法，全部为单键，不考虑模型文件中可能指示的键合模式。语法：</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">connect</span> <span class="selector-attr">[minimum and maximum distances]</span> <span class="selector-attr">[source and target atom sets]</span> <span class="selector-attr">[bond type]</span> <span class="selector-attr">[radius option]</span> <span class="selector-attr">[color option]</span> <span class="selector-attr">[modify/create option]</span></span><br></pre></td></tr></table></figure>
<ul>
<li><code>[minimum and maximum distances]</code>：距离以埃为单位，以小数或整数形式给出。如果仅给出一个距离参数，则表示最大距离。如果既没有给出最小距离参数也没有给出最大距离参数，那么两个原子集之间的所有连接都会被建立。可以在距离后使用 % 符号指定基于键合/离子半径百分比范围而不是固定值连接原子的选项。</li>
<li><code>[source and target atom sets]</code>：表示目标的原子集合。如果没有给出，就选择当前选定的原子。</li>
<li><p><code>[bond type]</code>：可以是<code>SINGLE</code>、<code>DOUBLE</code>、<code>TRIPLE</code>、<code>QUADRUPLE</code>、<code>QUINTUPLE</code>、<code>SEXTUPLE</code>、<code>AROMATIC</code>、<code>PARTIAL</code>、<code>PARTIALDOUBLE</code>、<code>HBOND</code>、<code>STRUT</code> 或 <code>UNSPECIFIED</code>。</p>
<ul>
<li>在外观上，<code>AROMATIC</code> 和 <code>PARTIALDOUBLE</code> 是相同的，只是键的哪一侧用虚线表示。</li>
<li><code>PARTIAL</code> 和 <code>HBOND</code> 都是虚线，但它们的模式不同，新产生的氢键只是细线。</li>
<li>其他键类型包括 <code>ATROPISOMER</code>（两个旋转受限的芳环之间的单键）、<code>AROMATICSINGLE</code>、<code>AROMATICDOUBLE</code>、部分数字键顺序（见<code>bondorder</code>）</li>
</ul>
</li>
<li><p><code>partial</code>的语法：<code>connect ... partial N.M</code>，N代表几条线，M为：</p>
</li>
</ul>
<div class="table-container">
<table>
<thead>
<tr>
<th>M</th>
<th>binary</th>
<th>meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>00001</td>
<td>first line dashed</td>
</tr>
<tr>
<td>2</td>
<td>00010</td>
<td>second line dashed</td>
</tr>
<tr>
<td>3</td>
<td>00011</td>
<td>first and second lines dashed</td>
</tr>
<tr>
<td>4</td>
<td>00100</td>
<td>third line dashed</td>
</tr>
<tr>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr>
<td>31</td>
<td>11111</td>
<td>all lines dashed</td>
</tr>
</tbody>
</table>
</div>
<p>例子：</p>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">partial</span> <span class="number">1</span>.<span class="number">0</span>	#single</span><br><span class="line"><span class="attribute">partial</span> <span class="number">1</span>.<span class="number">1</span>	#same as <span class="string">&quot;partial&quot;</span></span><br><span class="line"><span class="attribute">partial</span> <span class="number">2</span>.<span class="number">0</span>	#double</span><br><span class="line"><span class="attribute">partial</span> <span class="number">2</span>.<span class="number">1</span>	#same appearance as <span class="string">&quot;aromatic&quot;</span>, though not <span class="string">&quot;aromatic&quot;</span></span><br><span class="line"><span class="attribute">partial</span> <span class="number">2</span>.<span class="number">2</span>	#partialDouble</span><br><span class="line"><span class="attribute">partial</span> <span class="number">3</span>.<span class="number">0</span>	#triple</span><br><span class="line"><span class="attribute">partial</span> <span class="number">3</span>.<span class="number">1</span>	#partialTriple</span><br><span class="line"><span class="attribute">partial</span> <span class="number">3</span>.<span class="number">4</span>	#parialTriple<span class="number">2</span></span><br></pre></td></tr></table></figure>
<ul>
<li><code>[radius option]</code>：在<code>radius</code>后跟以Å为单位的数字设定宽度。</li>
<li><code>[color option]</code>：在<code>color</code>后跟<code>translucent</code>或<code>opaque</code>设定透明度、颜色等。</li>
<li><code>[modify/create option]</code>：<ul>
<li><code>Create</code>：只会创建新的键，如果已经存在不会受到影响。</li>
<li><code>Modify</code>：修改已经存在的键，不会创造新的键。</li>
<li><code>ModifyOrCreate</code>：符合则会连接。</li>
<li><code>Delete</code>：删除符合的连接。</li>
</ul>
</li>
</ul>
<h1 id="measure"><a href="#measure" class="headerlink" title="measure"></a>measure</h1><h2 id="设置标签和线等"><a href="#设置标签和线等" class="headerlink" title="设置标签和线等"></a>设置标签和线等</h2><ul>
<li><p><code>set measurementUnits (distance unit)</code>：设置测量单位，(distance unit)可以是<code>ANGSTROMS</code>、<code>AU</code>（或 <code>BOHR</code>）、<code>NM</code>（或 <code>NANOMETERS</code>）、（<code>PM</code> 或 <code>PICOMETERS</code>）、<code>VDW</code>、<code>HZ</code> 和 <code>NOE_HZ</code> 之一。</p>
<figure class="highlight gams"><table><tr><td class="code"><pre><span class="line"><span class="keyword">set</span> measurements <span class="comment">angstroms</span></span><br><span class="line"><span class="keyword">set</span> <span class="comment">measurements nm</span></span><br><span class="line"><span class="keyword">set</span> <span class="comment">measurements pm</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><code>set measurementLabels ON</code>：设置为<code>FALSE</code>时仅关闭测量标签，保留线条。</p>
</li>
<li><p><code>set showMeasurements TRUE</code>：设置为<code>FALSE</code>时，测量线和标签都关闭。</p>
</li>
<li><p><code>set measurements DOTTED</code>：设置测量线为虚线。</p>
</li>
<li><p><code>set justifyMeasurements FALSE</code>：将此参数设为 <code>TRUE</code> 可右对齐测量标签</p>
</li>
<li><p><code>set measurements 数字</code>：数字带小数时，是以Å为单位；整数时是以像素为单位。</p>
</li>
<li><p><code>set defaultDistanceLabel &quot;format&quot;</code>、<code>set defaultAngleLabel &quot;format&quot;</code>、<code>set defaultTorsionLabel &quot;format&quot;</code>：分别设置标签的默认格式</p>
</li>
<li><p>设置<a href="#font">字体</a></p>
</li>
</ul>
<p><code>measure</code>的语法：</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line">measure RANGE <span class="tag">&lt;<span class="name">minValue</span>&gt;</span> <span class="tag">&lt;<span class="name">maxValue</span>&gt;</span> ALL|ALLCONNECTED|DELETE (<span class="tag">&lt;<span class="name">atom</span> <span class="attr">expression</span>&gt;</span>) (<span class="tag">&lt;<span class="name">atom</span> <span class="attr">expression</span>&gt;</span>) ...</span><br></pre></td></tr></table></figure>
<ul>
<li><p><code>measure ON/OFF</code>：打开和关闭距离、角度、二面角测量标签和测量线。</p>
</li>
<li><p><code>measure DELETE</code>：删除所有测量</p>
</li>
<li><p><code>measure &quot;n:labelFormat&quot;</code>：测量对象及其单位</p>
<ul>
<li><code>n:</code>为2、3、或4，代表键长、键角、二面角。</li>
<li><p><code>n:</code>和<code>labelFormat</code>之间可以放<code>[atom properties]</code>原子属性来表示</p>
</li>
<li><p><code>label format</code>默认为<code>&quot;%VALUE %UNITS&quot;</code>，<code>%VALUE</code>可以表示小数位数；<code>//unit</code>，代表测量单位等。<code>//A</code>就是Å，还有<code>//nm</code>，<code>//pm</code>等</p>
</li>
<li></li>
</ul>
</li>
</ul>
<p>例子：</p>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">measure</span> RANGE <span class="number">1</span>.<span class="number">5</span> <span class="number">2</span>.<span class="number">5</span> <span class="literal">ALL</span> (_C) (_U) <span class="string">&quot;2://pm&quot;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">measure 1.4 1.5 all (<span class="emphasis">_C)[<span class="string">65</span>][<span class="symbol">72</span>]  (_</span>C)[<span class="string">65</span>][<span class="symbol">72</span>]  &quot;2:%a1-%a2 %0.3VALUE //A&quot;</span><br></pre></td></tr></table></figure>
<h1 id="mo"><a href="#mo" class="headerlink" title="mo"></a>mo</h1><p>可以将fchk文件通过Multiwfn转化成molden文件再进行绘图</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line"><span class="number">100</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="number">6</span></span><br></pre></td></tr></table></figure>
<ul>
<li><code>mo ON/OFF</code>：开启或关闭分子轨道，默认是<code>ON</code></li>
<li><code>mo (integer)</code>：显示指定的分子轨道，序号从1开始。<ul>
<li>注意：Jmol中的轨道是按能量排序的，因此可能和一些fchk文件中的轨道不一致，比如NLMO。可以通过将原始的轨道能量作为标签，保留三位小数，通过<code>MO list</code>去查找相应的序号。</li>
</ul>
</li>
<li><code>mo COLOR [RGB-color] [RGB-color]</code>：第一个颜色为等值面负的颜色，第二个为正等值面的颜色<ul>
<li><code>mo COLOR [RGB-color]</code>：将等值面设置成某个颜色</li>
</ul>
</li>
<li><code>mo CUTOFF (decimal)</code>：设置等值面的值。默认是0.05。</li>
<li><code>mo RESOLUTION (decimal)</code>：等值面的精度，一般范围是4-10。分辨率越高，等值面越光滑，但是生成速度更慢。</li>
</ul>
<h2 id="显示效果"><a href="#显示效果" class="headerlink" title="显示效果"></a>显示效果</h2><ul>
<li><code>mo mesh nofill</code>：除了网格，并且填充。默认是<code>mo mesh nofill</code></li>
<li><code>mo fill nomesh</code>：可以去掉网格线</li>
<li><code>mo translucent</code>：将等值面设置为透明的，后面可以跟0-1的小数设置透明度。</li>
<li><p><code>mo nofill nomesh dots</code>：设置为点填充。</p>
<ul>
<li><code>mo fill nodots</code>：取消点填充。</li>
</ul>
</li>
<li><p><code>mo fill</code>：</p>
</li>
<li><code>mo opaque</code>：</li>
</ul>
<h2 id="标题"><a href="#标题" class="headerlink" title="标题"></a>标题</h2><p>默认生成的分子轨道左上角有标题，标题的格式可以通过<code>mo TITLEFORMAT &quot;format&quot;</code>控制</p>
<ul>
<li><code>%E</code>或者<code>%0.dE</code>：能量，可以控制小数位数</li>
<li><code>%F</code>：文件名字</li>
<li><code>%I</code>：轨道序号</li>
<li><code>%M</code>：模型序号</li>
<li><code>%N</code>：轨道总数</li>
<li><code>%O</code>：占据数</li>
<li><code>%S</code>：对称性</li>
<li><code>%U</code>：能量单位</li>
<li><code>|</code>：换行</li>
<li><code>?</code>：(在行开头)表示如果文件中没有该行的数据，则忽略该行</li>
</ul>
<p>默认的格式是</p>
<figure class="highlight perl"><table><tr><td class="code"><pre><span class="line">mo TITLEFORMAT <span class="string">&quot;%F | Model %M MO %I/%N | Energy = %E %U | ?Symmetry = %S | ?Occupancy = %O&quot;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>如果想关闭可以使用<code>mo TITLEFORMAT &quot;&quot;</code></li>
</ul>
<h1 id="set-lighting"><a href="#set-lighting" class="headerlink" title="set (lighting)"></a>set (lighting)</h1><ul>
<li><code>set zShade OFF</code>：是否启用“雾”或“淡入淡出”效果。根据与观察者的距离对对象进行着色，使远处的对象淡入背景中。<ul>
<li>使用 <code>SLAB</code> 和 <code>DEPTH</code> 设置的值分别确定无效果点和完全效果点（默认为 100 和 0）。当 <code>ZSLAB</code> 不等于 <code>ZDEPTH</code> 时（默认均为0），<code>SLAB</code> 和 <code>DEPTH</code> 的设置被 <code>ZSLAB</code> 和 <code>ZDEPTH</code> 覆盖。</li>
<li><code>set zDepth (integer)</code>和<code>set zSlab (integer)</code>：<code>zDepth</code>是完全透明的点，<code>zSlab</code>是完全不透明的店。</li>
<li><code>set zShadePower (integer)</code>：当zShade设置为 <code>ON</code>时，可以调整此参数（通常为 <code>1</code>、<code>2</code> 或 <code>3</code>）以创建更强的雾效果。如果将此值设置为 <code>0</code>，会显示黑白阴影遮罩。</li>
</ul>
</li>
</ul>
<h1 id="set-perspective-透视"><a href="#set-perspective-透视" class="headerlink" title="set (perspective) 透视"></a>set (perspective) 透视</h1><ul>
<li><code>set cameraDepth (positive number)</code>：设置透视量。默认设置为 <code>3.0</code>。数字越大，透视的影响就越小。</li>
<li><code>set perspectiveDepth ON</code>：关闭此参数将关闭透视深度。</li>
</ul>
<p>缩放相关：</p>
<ul>
<li><code>set zoomEnabled TRUE</code>：当设置为 <code>FALSE</code> 时，禁用缩放。</li>
<li><code>set zoomHeight FALSE</code>：当此设置为 <code>TRUE</code> 时，Jmol 仅在更改高度时调整缩放。设置 zoomHeight TRUE 会禁用zoomLarge。</li>
<li><code>set zoomLarge TRUE</code>：当为 <code>TRUE</code>时，Jmol 根据窗口大小调整缩放。</li>
</ul>
<h1 id="write"><a href="#write" class="headerlink" title="write"></a>write</h1><ul>
<li><p>保存为png格式，语法为：</p>
<figure class="highlight arduino"><table><tr><td class="code"><pre><span class="line"><span class="built_in">write</span> IMAGE <span class="built_in">width</span> <span class="built_in">height</span> PNG n <span class="string">&quot;fileName&quot;</span></span><br></pre></td></tr></table></figure>
<ul>
<li><code>width</code> 和 <code>height</code> 是可选的，默认为当前帧大小。</li>
<li>压缩量<code>n</code> 是一个介于 0 和 10 之间的数字（默认为 2）。</li>
<li>如果 <code>set imageState TRUE</code>（默认设置），则 Jmol 将其状态附加到 PNG 文件，从而允许使用单个图像文件作为 2D 图像查看和使用脚本命令或通过拖动以 3D Jmol 状态读取并加入 Jmol 应用程序。</li>
</ul>
</li>
<li><p>保存为png格式，背景是透明的，语法为：</p>
<figure class="highlight arduino"><table><tr><td class="code"><pre><span class="line"><span class="built_in">write</span> IMAGE <span class="built_in">width</span> <span class="built_in">height</span> PNGT n <span class="string">&quot;fileName&quot;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>最好使用不太寻常的颜色作为背景颜色，比如<code>[x101010]</code>，确保只有背景是透明的。</li>
<li>最好设置<code>set antialiasImages FALSE</code>，以避免图像周围出现参差不齐的边缘。</li>
<li><code>width</code> 和 <code>height</code> 是可选的，默认为当前帧大小。</li>
<li>压缩量<code>n</code> 是一个介于 0 和 10 之间的数字（默认为 2）。</li>
<li>例子：<code>WRITE PNGT xxxx.png</code></li>
</ul>
</li>
<li><p>保存为pov进一步渲染</p>
<figure class="highlight gradle"><table><tr><td class="code"><pre><span class="line"><span class="keyword">write</span> POVRAY D:<span class="regexp">/desktop/m</span>o/<span class="number">10</span>-.pov</span><br></pre></td></tr></table></figure>
<ul>
<li>生成的ini文件可以直接一起拖入到pov-ray中批量渲染</li>
</ul>
</li>
</ul>
<h1 id="atom-expression-原子表达"><a href="#atom-expression-原子表达" class="headerlink" title="[atom-expression]原子表达"></a>[atom-expression]原子表达</h1><p>相关的表达都可以用关键字<code>NOT</code>开头，由<code>and</code>、<code>OR</code>或<code>XOR</code>连接，由<code>&#123;&#125;</code>包围。还可以用比较符号 <code>&lt;</code>，<code>&lt;=</code>，<code>=</code>，<code>&gt;</code>，<code>&gt;=</code>，<code>!=</code>和<code>LIKE</code> 等关键词，<code>!=</code>和<code>=</code>不区分大小写，如果需要，用<code>LIKE</code>。</p>
<h2 id="一般表达"><a href="#一般表达" class="headerlink" title="一般表达"></a>一般表达</h2><ul>
<li><code>all</code>：所有原子，=<code>*</code></li>
<li><code>bonded</code>：共价键合的</li>
<li><code>connected</code>：以任何方式成键，包括氢键</li>
<li><code>none</code>：无原子</li>
<li><code>selected</code>：已选定的原子，当文件首次加载是，默认为<code>all</code></li>
</ul>
<h2 id="化学元素"><a href="#化学元素" class="headerlink" title="化学元素"></a>化学元素</h2><ul>
<li>元素的英文名，如<code>carbon</code></li>
<li><code>_元素符号</code>：如<code>_Cu</code>；还可以在符号前面加上数字表示同位素，<code>_31P</code></li>
<li><code>nonmetal</code>：非金属元素=<code>!metal</code>，即H，He，B，C，N，O，F，Ne，Si，P，S，Cl，Ar，As，Se，Br，Kr，Te，I，Xe，At，Rn</li>
<li><code>metal</code>：金属元素，=<code>!nonmetal</code></li>
<li><code>alkaliMetal</code>：碱金属，Li，Na，K，Rb，Sr，Fr</li>
<li><code>alkalineEarth</code>：碱土金属，Be，Mg，Ca，Sr，Ba，Ra</li>
<li><code>nobleGas</code>：稀有气体，He，Ne，Ar，Kr，Xe，Rn</li>
<li><code>metalloid</code>：准金属，B，Si，Ge，As，Sb，Te</li>
<li><code>transitionmetal</code>：过渡金属，包括La和Ac。</li>
<li><code>lanthanide</code>：镧系元素，不包括La</li>
<li><code>actinide</code>：锕系元素，不包括Ac</li>
</ul>
<h2 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h2><ul>
<li><code>isaromatic</code>：与芳香族、芳香族单键或芳香族双键类型相连的原子</li>
</ul>
<h2 id="选择原子"><a href="#选择原子" class="headerlink" title="选择原子"></a>选择原子</h2><ul>
<li><code>(carbon)[3][5]</code>：选择第三到第五个碳原子</li>
<li><code>(carbon)[3]</code>：选择第三个C原子，[0]表示最后一个原子，负数表示从最后一个原子（0）开始基数。</li>
</ul>
<p>如果需要嵌入到其他表达式中，还需要在外面加<code>&#123;&#125;</code>，比如<code>measure &#123;(_O)[1]&#125; &#123;(_O)[2]&#125;</code></p>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="comment">#z</span></span><br><span class="line"><span class="attribute">select</span> (&#123;<span class="number">4</span> <span class="number">7</span> <span class="number">8</span> <span class="number">12</span>:<span class="number">16</span> <span class="number">25</span>:<span class="number">29</span> <span class="number">32</span> <span class="number">35</span>:<span class="number">40</span> <span class="number">43</span>:<span class="number">84</span>&#125;)</span><br></pre></td></tr></table></figure>
<h1 id="atom-properties-原子属性"><a href="#atom-properties-原子属性" class="headerlink" title="[atom properties]原子属性"></a>[atom properties]原子属性</h1><p><a href="https://chemapps.stolaf.edu/jmol/docs/index.htm?ver=14.31#atomproperties">https://chemapps.stolaf.edu/jmol/docs/index.htm?ver=14.31#atomproperties</a></p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center"><strong>property</strong></th>
<th style="text-align:center"><strong>select xxx=y</strong></th>
<th style="text-align:center"><strong>label %[xxx]</strong></th>
<th style="text-align:center"><strong>label %x</strong></th>
<th style="text-align:center"><strong>print {*}.xxx</strong></th>
<th style="text-align:center"><strong>{*}.xxx = y</strong></th>
<th style="text-align:center"><strong>description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">atomName</td>
<td style="text-align:center">√</td>
<td style="text-align:center">√</td>
<td style="text-align:center">%a</td>
<td style="text-align:center">√</td>
<td style="text-align:center">√</td>
<td style="text-align:center">原子的名字</td>
</tr>
<tr>
<td style="text-align:center">atomno</td>
<td style="text-align:center">√</td>
<td style="text-align:center">√</td>
<td style="text-align:center">%i</td>
<td style="text-align:center">√</td>
<td style="text-align:center">√</td>
<td style="text-align:center">可以用<code>@</code>替代<code>atomno=</code></td>
</tr>
<tr>
<td style="text-align:center">atomType</td>
<td style="text-align:center">√</td>
<td style="text-align:center">√</td>
<td style="text-align:center">%B</td>
<td style="text-align:center">√</td>
<td style="text-align:center">√</td>
<td style="text-align:center">原子类型</td>
</tr>
</tbody>
</table>
</div>
<h1 id="getProperty"><a href="#getProperty" class="headerlink" title="getProperty"></a>getProperty</h1><p>查看分子的长宽高</p>
<p>显示中勾选边界框，在控制台中输入</p>
<figure class="highlight ebnf"><table><tr><td class="code"><pre><span class="line"><span class="attribute">getProperty boundBoxInfo</span></span><br></pre></td></tr></table></figure>
<p>设置边界框的坐标</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">boundbox &#123;<span class="number">0</span> <span class="number">0</span> <span class="number">0</span>&#125;&#123;<span class="number">2</span>,<span class="number">3</span>,<span class="number">3</span>&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <tags>
        <tag>绘图</tag>
        <tag>Jmol</tag>
      </tags>
  </entry>
  <entry>
    <title>【Multiwfn】AIM分析</title>
    <url>/2021/03/02/%E3%80%90Multiwfn%E3%80%91AIM%E5%88%86%E6%9E%90/</url>
    <content><![CDATA[<p><a href="http://bbs.keinsci.com/thread-362-1-1.html">http://bbs.keinsci.com/thread-362-1-1.html</a></p>
<p>AIM（Atoms in molecular）是由已故的R. F. W. Bader从上世纪70年代开始发展的一套波函数分析理论体系。更严格的称为QTAIM (The quantum theory of atoms In molecules)。</p>
<ul>
<li>主要分析的函数：电子密度、电子密度梯度，电子拉普拉斯函数及Hessian、动能密度、势能密度、能量密度、费米穴、源函数等</li>
<li>主要研究手段：绘图分析（曲面图、平面图、等值图）、临界点分析、拓扑路径分析、盆积分、分子间面分析等</li>
<li>具体概念：AIM电荷、键径、键椭率、维里路径、定域化/离域化指数、AIM键级、AOM键级、eta指数、键金属性、盆偶极矩/四极矩、范德华表面、原子极化率等。如今AIM一词的已经被大为扩展，ELF、模糊原子、信息嫡等概念往往也被算进AIM的范畴。</li>
</ul>
<h1 id="拓扑分析"><a href="#拓扑分析" class="headerlink" title="拓扑分析"></a>拓扑分析</h1><p>实空间函数（以三维空间坐标为变量的函数）的拓扑分析主要是需寻找函数的不同类型的临界点，以及获得连接临界点的拓扑路径。</p>
<ul>
<li><strong>电子密度</strong>的拓扑分析是由Bader首先提出的，是AIM理论中的重要组成部分</li>
<li>后来拓扑分析的思路又被Silvi、Savin等人用于分析ELF（<strong>电子定域化函数</strong>）</li>
</ul>
<h2 id="相关数学概念"><a href="#相关数学概念" class="headerlink" title="相关数学概念"></a>相关数学概念</h2><p>电子密度的梯度模：<script type="math/tex">|\nabla \rho(\mathbf{r})|=\sqrt{\left(\frac{\partial \rho(\mathbf{r})}{\partial x}\right)^{2}+\left(\frac{\partial \rho(\mathbf{r})}{\partial y}\right)^{2}+\left(\frac{\partial \rho(\mathbf{r})}{\partial z}\right)^{2}}</script></p>
<p>约化密度梯度（Reduced density gradient）：<script type="math/tex">\operatorname{RDG}(\mathbf{r})=\frac{1}{2\left(3 \pi^{2}\right)^{1 / 3}} \frac{|\nabla \rho(\mathbf{r})|}{\rho(\mathbf{r})^{4 / 3}}</script></p>
<ul>
<li>约化密度梯度是电子密度的梯度是电子密度的梯度一种无量纲的形式，通常用在DFT泛函的表达式中，如今也用来展现弱相互作用区域。</li>
</ul>
<p>电子密度的Hessian矩阵：<script type="math/tex">\mathbf{A}\left(\mathbf{r}_{c}\right)=\left(\begin{array}{ccc}
\frac{\partial^{2} \rho}{\partial x^{2}} & \frac{\partial^{2} \rho}{\partial x \partial y} & \frac{\partial^{2} \rho}{\partial x \partial z} \\
\frac{\partial^{2} \rho}{\partial y \partial x} & \frac{\partial^{2} \rho}{\partial y^{2}} & \frac{\partial^{2} \rho}{\partial y \partial z} \\
\frac{\partial^{2} \rho}{\partial z \partial x} & \frac{\partial^{2} \rho}{\partial z \partial y} & \frac{\partial^{2} \rho}{\partial z^{2}}
\end{array}\right)_{\mathbf{r}=\mathbf{r}_{c}}</script></p>
<ul>
<li><script type="math/tex">\mathbf{A}</script>即临界点，对角元对应于对应方向上的曲率，非对角是混合二阶导数。</li>
</ul>
<p>将<script type="math/tex">\mathbf{A}</script>对角化，相当于把笛卡尔坐标x，y，z进行酉变换（相当于进行了旋转）成为x’，y’，z’，得到<script type="math/tex">\boldsymbol{\Lambda}=\left(\begin{array}{ccc}
\frac{\partial^{2} \rho}{\partial x^{\prime 2}} & 0 & 0 \\
0 & \frac{\partial^{2} \rho}{\partial \gamma^{\prime 2}} & 0 \\
0 & 0 & \frac{\partial^{2} \rho}{\partial z^{\prime 2}}
\end{array}\right)_{\mathbf{r}^{\prime}=\mathbf{r}_{c}}=\left(\begin{array}{ccc}
\lambda_{1} & 0 & 0 \\
0 & \lambda_{2} & 0 \\
0 & 0 & \lambda_{3}
\end{array}\right)</script></p>
<ul>
<li>三个本征值<script type="math/tex">\lambda_{1}</script>、<script type="math/tex">\lambda_{2}</script>、<script type="math/tex">\lambda_{3}</script>对应于临界点处在x’，y’，z’三个方向电子密度的曲率。</li>
</ul>
<h2 id="临界点"><a href="#临界点" class="headerlink" title="临界点"></a>临界点</h2><p>二维中的临界点：</p>
<p><img src="/image-20210521212251604.png" alt="image-20210521212251604" style="zoom: 50%;" /></p>
<p><strong>临界点（Critical point，CP）</strong>是实空间函数的梯度的模为0的点，用（m,n）表示。</p>
<ul>
<li>m是秩，对于临界点处电子密度非零曲率的数目：<ul>
<li>在平衡结构下一般都是3</li>
<li>体系处于不稳定的结构会出现m&lt;3的情况，不考虑。</li>
</ul>
</li>
<li><script type="math/tex; mode=display">n=N_p-Nn</script><ul>
<li><script type="math/tex">N_p</script>是Hessian矩阵正本征值的数目</li>
<li><script type="math/tex">N_n</script>是Hessian矩阵负本征值的数目</li>
</ul>
</li>
</ul>
<p>所以三维的临界点可以分为四类：</p>
<h3 id="3-3"><a href="#3-3" class="headerlink" title="(3,-3)"></a>(3,-3)</h3><p>Hessian矩阵三个本征值都为负。</p>
<ul>
<li><p>对应函数的局部极大点，也称为吸引子（attractor）。</p>
</li>
<li><p>对于电子密度函数，通常出现在离原子核很近的位置。</p>
<ul>
<li>对于重原子，(3,-3)临界点与原子核几乎精确重合，因此也称为核临界点（nuclear critical point，NCP）。氢原子由于电子数较少，受周围环境影响明显，因此(3,-3)临界点与氢核位置有一定偏离。</li>
<li>一般情况下(3,-3)临界点与原子核一一对应，数目与原子数目一致。但是有些情况下原子核没有(3,-3)临界点，比如KrH<sup>+</sup>氢核对应的临界点被电子分布弥散的Kr所吞并。也有的(3,-3)临界点出现在原子核以外的位置，比如Li<sub>2</sub>在两个Li之间有(3,-3)临界点。</li>
</ul>
<blockquote>
<p>电子密度在原子核处的尖峰导数不连续，因此严格讲梯度不为0，但实际计算使用的是高斯基函数，因此原子核处的导数是0</p>
</blockquote>
</li>
<li><p>对于ELF函数，通常出现在共价键区域、孤对电子区域、原子核处。</p>
</li>
</ul>
<h3 id="3-1"><a href="#3-1" class="headerlink" title="(3,-1)"></a>(3,-1)</h3><p>Hessian矩阵两个本征值为负，一个为正。对应函数的二阶鞍点。</p>
<p>如图，箭头代表负梯度（数值最快下降方向），在垂直于键的平面上，此临界点是极大值，在顺着键的方向上，此临界点是极小值：</p>
<p><img src="/image-20210521205948041.png" alt="image-20210521205948041" style="zoom:50%;" /></p>
<ul>
<li>对于电子密度函数，通常出现在有相互作用的两个原子之间，也被称为键临界点（bond critical point，BCP）。</li>
<li>对于ELF函数，位置不甚确定，经常偏离两个相关的(3,-3)的连线很多。</li>
</ul>
<h3 id="3-1-1"><a href="#3-1-1" class="headerlink" title="(3,+1)"></a>(3,+1)</h3><p>Hessian矩阵两个本征值为正，一个为负。对应函数一阶鞍点，如同势能面上的过渡态。</p>
<ul>
<li>对于电子密度函数，通常出现在环体系平面中，如苯环的中心，也被称为环临界点（ring critical point，RCP），表现出位阻效应。在环的平面上，此临界点为电子密度极小值，在垂直于环的方向上为极大值。</li>
<li>对于ELF，(3,+1)和(3,+3)通常较少讨论下。</li>
</ul>
<h3 id="3-3-1"><a href="#3-3-1" class="headerlink" title="(3,+3)"></a>(3,+3)</h3><p>Hessian矩阵三个本征值都为正，对应函数的局部极小点。</p>
<ul>
<li>对于电子密度函数，通常出现在笼状体系中，例如C60的中心。也被称为笼临界点（cage critical point，CCP）</li>
</ul>
<h3 id="Poincare-Hopf关系"><a href="#Poincare-Hopf关系" class="headerlink" title="Poincaré-Hopf关系"></a>Poincaré-Hopf关系</h3><p>n(3,-3) – n(3,-1) + n(3,+1) – n(3,+3) =</p>
<ul>
<li>1：孤立体系</li>
<li>0：周期性体系</li>
</ul>
<p>所有临界点找全一定满足此关系，但是满足此条件不代表所有的临界点找全了。</p>
<h2 id="拓扑路径"><a href="#拓扑路径" class="headerlink" title="拓扑路径"></a>拓扑路径</h2><p>拓扑路径是连接临界点的路径。一般比较关注的是(3,-1)与(3,-3)之间的路径。沿着BCP(3,-1)的Hessian矩阵本征值为正的本征向量方向分别向前和向后出发，顺着梯度方向不断前进就能找到两个(3,-3)，而经过的轨迹就是拓扑路径。（最陡上升法从BCO位置跟踪梯度的最大方向来生成）</p>
<ul>
<li>对于电子密度函数，这样的拓扑路径近似于化学键，因此称为键径（Bond path）。键径可以展示各类原子之间的相互作用的路径，键径的集合称为分子图（molecular graph），是对分子结构的确切描述。</li>
<li>对于ELF，通过生成拓扑路径则可以将(3,-1)与(3,-3)临界点之间的关系清晰地表现出来。</li>
</ul>
<p>也有其他类型的拓扑路径，比如(3,+1)→(3,-1)，(3,+3) →(3,+1)</p>
<h1 id="Multiwfn中的操作"><a href="#Multiwfn中的操作" class="headerlink" title="Multiwfn中的操作"></a>Multiwfn中的操作</h1><p>寻找临界点通常使用牛顿法。给出一个初猜点，通过反复迭代，就能找到与之最邻近的临界点。但牛顿法不一定每次都成功，有可能一直不收敛，也可能迭代过程中碰到Hessian矩阵为奇矩阵的情况，或者收敛到已找到的临界点位置，此时就要尝试从下一个初猜点开始了。初猜点与期望的临界点位置越近越容易成功收敛到相应的临界点。</p>
<h2 id="电子密度"><a href="#电子密度" class="headerlink" title="电子密度"></a>电子密度</h2><p>电子密度函数的结构很简单，一般都是在原子核处像一个山峰耸立，向着四周呈指数降低，典型体系的各种临界点位置都能大致猜出来，正如上面已经提到的。寻找(3,-3)点的时候初猜点都选在原子核位置。寻找(3,-1)点的时候，初猜点都选在两个原子或者两个已找到的(3,-3)点连线的中点，在这个过程中也可能顺便找到(3,+1)和(3,+3)点。另外也常常将三个原子或四个原子的几何中心作为初猜，这分别适合进一步寻找尚未找到的(3,+1)和(3,-3)点。假设利用这几种初猜方式还是没找到一些期望的临界点，但通过经验可以估计出期望的点出现的大致空间范围，那么就应当在这个空间范围内设定一大堆初猜点来尝试寻找那个临界点。</p>
<h3 id="一般情况"><a href="#一般情况" class="headerlink" title="一般情况"></a>一般情况</h3><ul>
<li><p>使用Multiwfn加载fchk文件后：</p>
<figure class="highlight basic"><table><tr><td class="code"><pre><span class="line"><span class="symbol">2 </span> //拓扑分析功能</span><br><span class="line"><span class="symbol">2 </span> //以所有原子核作为初猜点，目的是寻找所有核临界点</span><br><span class="line"><span class="symbol">3 </span> //以每一对距离不很远的原子核连线中点作为初猜点，主要用来寻找键临界点</span><br><span class="line"><span class="symbol">8 </span> //生成键径</span><br><span class="line"><span class="symbol">0 </span> //观看结果</span><br></pre></td></tr></table></figure>
<ul>
<li>此时文本界面会输出所有临界点和键径的信息，最后提示你Fine, Poincare-Hopf relationship is satisfied，这是所有临界点都已找到的必要非充分条件。凭借化学直觉或者如果这个条件没满足，临界点没找全，需要再用选项<code>4</code>（三个原子中心作为初猜）、选项<code>5</code>（四个原子中心作为初猜）或选项<code>6</code>（在某个位置附近随机设一大堆点）来进一步找临界点了。</li>
<li>图形界面中：<ul>
<li>可以选择显示哪种CP，是否显示CP的标签，是否显示原子等。</li>
<li>紫色的球是(3,-3)，与原子核位置基本一致。桔黄色是键临界点，黄色是环临界点。棕色的线是键径。</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="进一步寻找"><a href="#进一步寻找" class="headerlink" title="进一步寻找"></a>进一步寻找</h3><p>有些临界点比较特殊，在默认的设定下，用选项2~5都找不到临界点，需要人为调整一下参数寻找其他临界点的方法：</p>
<ul>
<li><p>重原子和氢连线上的键临界点找不到：在参数设定界面中将Set scale factor for stepsize一项设低，建议设为0.5，然后再重新找临界点。</p>
</li>
<li><p>由于初猜位置不合适：初猜点越接近临界点，就越有可能收敛到临界点。对极个别体系，选项2~5的方式设定的初猜点可能都不合适，故而会漏掉某些临界点，此时建议用选项6的方式设定初猜点。选项6会定义一个球心，然后让指定数目（通常设几百乃至上千）的初猜点随机分布在球体中来寻找临界点，只要能让初猜点随机分布的范围能够包含或者与潜在的临界点位置比较近，通常就能将那些临界点找出来。选项6的子选项1~6以不同方式定义这个球体的中心：</p>
<ul>
<li><code>10</code>：定义球体半径</li>
<li><code>11</code>：设定将有多少个初猜点随机分布在球体中，</li>
<li><code>0</code>：开始执行搜索。</li>
<li><code>-1</code>，则用户不必设定球心，球心会自动依次定义在每个原子核上，也就是说，每个原子附近都会分布一堆初猜点来搜索临界点。</li>
<li><code>-2</code>，则球心会自动依次定义在指定的原子核上，而非所有原子核上。</li>
</ul>
<p>选项6这种搜索方式对于电子密度临界点搜索用得机会不多，它最适合搜索ELF的临界点，因为ELF比电子密度临界点明显多得多，分布更复杂。</p>
</li>
</ul>
<h3 id="分析、编辑结果"><a href="#分析、编辑结果" class="headerlink" title="分析、编辑结果"></a>分析、编辑结果</h3><ul>
<li><p><code>7 Show real space function values at specific CP or all CPs</code>并且输入临界点的编号：可以获知这个临界点的一切信息，包括Multiwfn支持的各种实空间函数的数值（如电子密度、拉普拉斯值、动能密度、势能密度等）和电子密度的梯度以及Hessian矩阵，输出信息例如：</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">CP Position:</span>   <span class="number">-1.54802279321209</span>    <span class="number">1.64407933432874</span>   <span class="number">-0.36311758584834</span></span><br><span class="line"><span class="attr">CP type:</span> <span class="string">(3,-1)</span></span><br><span class="line"><span class="attr">Density of all electrons:</span>  <span class="number">0.3333962073E+00</span></span><br><span class="line"><span class="attr">Density of Alpha electrons:</span>  <span class="number">0.1666981037E+00</span></span><br><span class="line"><span class="attr">Density of Beta electrons:</span>  <span class="number">0.1666981037E+00</span></span><br><span class="line"><span class="attr">Spin density of electrons:</span>  <span class="number">0.0000000000E+00</span></span><br><span class="line"><span class="string">Lagrangian</span> <span class="string">kinetic</span> <span class="string">energy</span> <span class="string">G(r):</span>  <span class="number">0.1055976596E+00</span></span><br><span class="line"><span class="string">Hamiltonian</span> <span class="string">kinetic</span> <span class="string">energy</span> <span class="string">K(r):</span>  <span class="number">0.3702940096E+00</span></span><br><span class="line"><span class="string">Potential</span> <span class="string">energy</span> <span class="string">density</span> <span class="string">V(r):</span> <span class="number">-0.4758916692E+00</span></span><br><span class="line"><span class="attr">Energy density:</span> <span class="number">-0.3702940096E+00</span></span><br><span class="line"><span class="attr">Laplacian of electron density:</span> <span class="number">-0.1058785400E+01</span></span><br><span class="line"><span class="string">Electron</span> <span class="string">localization</span> <span class="string">function</span> <span class="string">(ELF):</span>  <span class="number">0.9499848594E+00</span></span><br><span class="line"><span class="string">Localized</span> <span class="string">orbital</span> <span class="string">locator</span> <span class="string">(LOL):</span>  <span class="number">0.8133846890E+00</span></span><br><span class="line"><span class="string">...略</span></span><br></pre></td></tr></table></figure>
<p>Multiwfn还可以将临界点上的各种函数分解为各个轨道的贡献（可以是分子轨道、定域化轨道等）</p>
</li>
<li><p><code>-9</code>：计算临界点间、原子间的距离、角度。</p>
</li>
<li><code>-4</code>：导入导出已找到的临界点、删除或人为地增加临界点。</li>
<li><code>-5</code>：显示拓扑路径的详细信息（路径轨迹的坐标、路径长度等）并进行编辑和导入、导出，还能绘制各种实空间函数沿着键径上的变化图</li>
</ul>
<h2 id="ELF"><a href="#ELF" class="headerlink" title="ELF"></a>ELF</h2><p>对于ELF、LOL和电子密度拉普拉斯函数，寻找对应原子内核处的临界点（对应高度定域的1s轨道电子）还是用原子核位置作为初猜。但是对于价层的ELF临界点，由于其分布较难预料，而且数目众多，最好的办法就是直接在每个原子附近都设一大堆初猜点来寻找各个临界点。不过，由于ELF临界点太多而且分布太复杂，想找全所有临界点绝非易事，所以，只要看到化学意义显著的临界点（所有的(3,-3)，以及部分(3,-1)）都已经找到了，临界点的搜索就可以停掉了。除了牛顿法，还有一种基于立方格点的临界点搜索方法，可以通过Multiwfn的盆分析实现，见《使用Multiwfn做电子密度、ELF、静电势、密度差等函数的盆分析》（<a href="http://sobereva.com/179），此方法虽然可以保证把(3,-3)搜索全，但定位精度低（精度取决于格点间距）。">http://sobereva.com/179），此方法虽然可以保证把(3,-3)搜索全，但定位精度低（精度取决于格点间距）。</a></p>
<h1 id="AIM盆分析"><a href="#AIM盆分析" class="headerlink" title="AIM盆分析"></a>AIM盆分析</h1><p>加载.fch文件后的总体步骤：</p>
<figure class="highlight basic"><table><tr><td class="code"><pre><span class="line"><span class="symbol">17 </span>//盆分析</span><br><span class="line"><span class="symbol">1 </span> //生成盆并寻找吸引子</span><br><span class="line"><span class="symbol">1 </span> //用电子密度划分盆</span><br><span class="line"><span class="symbol">2 </span> //中等质量格点</span><br><span class="line"></span><br><span class="line"><span class="symbol">7 </span> //用混合格点积分AIM盆</span><br><span class="line"><span class="symbol">2 </span> //对边界进行精确修正</span><br><span class="line"><span class="symbol">1 </span> //积分电子密度，得到AIM电荷</span><br><span class="line"></span><br><span class="line"><span class="symbol">4 </span>//计算DI和LI</span><br></pre></td></tr></table></figure>
<h2 id="生成盆"><a href="#生成盆" class="headerlink" title="生成盆"></a>生成盆</h2><p>以HCN为例：</p>
<ol>
<li><p><code>17</code>：盆分析</p>
</li>
<li><p><code>1</code>：生成盆并寻找吸引子</p>
<ul>
<li>如果内存中已经有格点数据可以直接用，如果没有按下一步选择一个是空间函数</li>
</ul>
</li>
<li><p><code>1</code>：让Multiwfn计算电子密度格点数据，用来得到它的盆和吸引子</p>
</li>
<li><p><code>2</code>：中等质量格点，也就是格点间距为0.1Bohr<a id="生成"></a></p>
<ul>
<li>计算结束后有可能会出现：在某些情况下，在系统之外的区域，一些人为的或物理上无意义的吸引物被放置。这些吸引子具有非常低的功能值，因此被称为”无关紧要“的吸引子，相比之下，其他吸引子可以被称为“重要”吸引子。不重要吸引子的存在是因为在相应的区域内函数值很小，因此函数的行为不是很确定，即使是很小的函数值波动或微不足道的数值扰动都足以产生新的吸引子。当检测到的时候，会提示你处理它们：<ul>
<li><code>1</code>：什么都不做，不删除这些吸引子</li>
<li><code>2</code>：删除这些吸引子，并且相应的格点设置为未赋值的格点</li>
<li><code>3</code>：删除这些吸引子，同时分配相应的格点到最近的重要的吸引子（推荐）</li>
</ul>
</li>
<li>吸引子的坐标以及吸引子位置上的函数值：<ul>
<li>吸引子编号=盆编号，但是不等同于原子编号</li>
</ul>
</li>
</ul>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">DD</span>	Attractor       X,Y,Z coordinate (Angstrom)                Value</span><br><span class="line">      <span class="attribute">1</span>   -<span class="number">0</span>.<span class="number">02645886</span>   -<span class="number">0</span>.<span class="number">02645886</span>   -<span class="number">1</span>.<span class="number">52058663</span>          <span class="number">0</span>.<span class="number">33959944</span></span><br><span class="line">      <span class="attribute">2</span>    <span class="number">0</span>.<span class="number">02645886</span>    <span class="number">0</span>.<span class="number">02645886</span>   -<span class="number">0</span>.<span class="number">51514986</span>         <span class="number">49</span>.<span class="number">48609717</span></span><br><span class="line">      <span class="attribute">3</span>   -<span class="number">0</span>.<span class="number">02645886</span>   -<span class="number">0</span>.<span class="number">02645886</span>    <span class="number">0</span>.<span class="number">64904009</span>         <span class="number">76</span>.<span class="number">55832377</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="观看盆和吸引子"><a href="#观看盆和吸引子" class="headerlink" title="观看盆和吸引子"></a>观看盆和吸引子</h2><p>选<code>0</code>来可视化刚找出来的吸引子和生成的盆。</p>
<ul>
<li>紫色的文字对应吸引子的标号。</li>
<li>每个吸引子用绿色小球表示（位于原子核处的吸引子得取消选择show molecule选项才能看到）</li>
<li>界面右下角是盆列表，一个盆对应一个吸引子，盆的编号和吸引子编号是一致的，选择哪个盆就会显示出哪个盆。位于盆边界的格点通过绿球显示，使得盆的轮廓被勾勒出来。</li>
<li>选show basin interior让盆内部也显示</li>
<li>盆只显示处于电子密度0.001 a.u.等值面内部区域的部分：在图形界面上方选择Set basin drawing method→rho&gt;0.001 region only</li>
</ul>
<p>盆列表中的Unas和Boun：</p>
<ul>
<li>这两类格点一般没有什么物理意义，对分析结果影响甚微，通常出现在离体系较远的地方，在上一步计算结束的时候也会有输出这些点的数量，如果是0，可视化的时候什么也不会出现</li>
</ul>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">The number of unassigned grids:</span>           <span class="number">0</span></span><br><span class="line"><span class="attr">The number of grids travelled to box boundary:</span>           <span class="number">0</span></span><br></pre></td></tr></table></figure>
<ul>
<li>“Unas”（意指Unassigned）是产生盆过程中由于某些数值算法原因没有成功被指认所属吸引子的格点</li>
<li>“Boun”（意指travelled to box boundary）是指产生盆的过程中按照梯度最大方向移动但是最终移动到格点数据范围边界的点。</li>
<li>如果为了节省计算时间，没有让格点数据范围囊括整个分子而是只囊括了局部区域，那么可以得到只位于局部区域的盆，与此同时”Boun”类型的点会大量出现，依然无视它即可。</li>
</ul>
<h2 id="积分盆"><a href="#积分盆" class="headerlink" title="积分盆"></a>积分盆</h2><h3 id="使用均匀格点"><a href="#使用均匀格点" class="headerlink" title="使用均匀格点"></a>使用均匀格点</h3><p>这种积分方式可以用于任何函数：</p>
<ol>
<li><p>在生成盆之后，选择<code>2 Integrate real space functions in the basins</code>做盆积分</p>
</li>
<li><p><code>1</code>：积电子密度：</p>
<ul>
<li>前面已经生成过电子密度格点数据，可以选择<code>0 The values of the grid data stored in memory</code></li>
</ul>
</li>
<li><p>输出的每个盆的积分值还有盆的体积：</p>
<ul>
<li>盆体积对于当前体系没什么意义，因为三个盆的总和就是整个格点数据空间范围，故格点数据空间范围取得越大盆的体积就越大。</li>
</ul>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="comment">#Basin        Integral(a.u.)      Volume(a.u.^3)</span></span><br><span class="line">      <span class="attribute">1</span>          <span class="number">0</span>.<span class="number">7356142812</span>        <span class="number">441</span>.<span class="number">70000000</span></span><br><span class="line">      <span class="attribute">2</span>          <span class="number">5</span>.<span class="number">3511710147</span>        <span class="number">566</span>.<span class="number">31900000</span></span><br><span class="line">      <span class="attribute">3</span>          <span class="number">7</span>.<span class="number">9020060745</span>        <span class="number">830</span>.<span class="number">25600000</span></span><br><span class="line"><span class="attribute">Sum</span> of above values:         <span class="number">13</span>.<span class="number">98879137</span></span><br></pre></td></tr></table></figure>
<ul>
<li>可以通过<code>Sum of above values</code>看积分精度，一般这样不会很理想，因为电子密度在重原子的原子核附近衰减速度较快，用均匀格点对这部分没法积分得很准。</li>
</ul>
</li>
</ol>
<h3 id="使用混合格点积分（更精确）"><a href="#使用混合格点积分（更精确）" class="headerlink" title="使用混合格点积分（更精确）"></a>使用混合格点积分（更精确）</h3><p>只能积分AIM盆：</p>
<ol>
<li><p>在生成盆之后，选择<code>7</code>：混合格点进行积分</p>
</li>
<li><p><code>1</code>：原子中心+均匀格点，忽略边界修正（<a href="#精度">并不精确</a>）。</p>
</li>
<li><p><code>1</code>：电子密度</p>
</li>
<li><p>输出盆中的电子布居数、盆体积、密度＞0.001的体积、分子的范德华体积</p>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">Total</span> result:</span><br><span class="line">  <span class="comment">#Basin        Integral(a.u.)      Vol(Bohr^3)    Vol(rho&gt;0.001)</span></span><br><span class="line">      <span class="attribute">1</span>          <span class="number">0</span>.<span class="number">7356461193</span>         <span class="number">441</span>.<span class="number">700</span>          <span class="number">34</span>.<span class="number">884</span></span><br><span class="line">      <span class="attribute">2</span>          <span class="number">5</span>.<span class="number">3552270393</span>         <span class="number">566</span>.<span class="number">319</span>         <span class="number">102</span>.<span class="number">832</span></span><br><span class="line">      <span class="attribute">3</span>          <span class="number">7</span>.<span class="number">9086504198</span>         <span class="number">830</span>.<span class="number">256</span>         <span class="number">134</span>.<span class="number">228</span></span><br><span class="line"><span class="attribute">Sum</span> of above integrals:         <span class="number">13</span>.<span class="number">99952358</span></span><br><span class="line"><span class="attribute">Sum</span> of basin volumes (rho&gt;<span class="number">0</span>.<span class="number">001</span>):     <span class="number">271</span>.<span class="number">944</span> Bohr^<span class="number">3</span></span><br></pre></td></tr></table></figure>
<ul>
<li>还输出了归一化因子、每个原子的AIM电荷，以及原子体积<ul>
<li>因为数值积分有误差，根据总电子数重新校正盆布居数（乘以归一化因子）得到AIM电荷</li>
<li>Volume等同于上面的Vol(rho&gt;0.001)，代表的是盆中电子密度大于0.001的体积，按照Bader对范德华表面的定义，这相当于分子范德华表面内原子所占的体积，是有确切物理意义的，可认为是原子的尺寸。</li>
</ul>
</li>
</ul>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">Normalization</span> factor of the integral of electron density is    <span class="number">0</span>.<span class="number">999966</span></span><br><span class="line"><span class="attribute">The</span> atomic charges after normalization and atomic volumes:</span><br><span class="line">     <span class="attribute">1</span> (C )    Charge:    <span class="number">0</span>.<span class="number">644591</span>     Volume:   <span class="number">102</span>.<span class="number">832</span> Bohr^<span class="number">3</span></span><br><span class="line">     <span class="attribute">2</span> (N )    Charge:   -<span class="number">0</span>.<span class="number">908920</span>     Volume:   <span class="number">134</span>.<span class="number">228</span> Bohr^<span class="number">3</span></span><br><span class="line">     <span class="attribute">3</span> (H )    Charge:    <span class="number">0</span>.<span class="number">264329</span>     Volume:    <span class="number">34</span>.<span class="number">884</span> Bohr^<span class="number">3</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="提升精度"><a href="#提升精度" class="headerlink" title="提升精度"></a>提升精度</h3><p><a id="精度"></a>实际上这样原子盆的积分值并非很精确，对应的AIM电荷也不是非常精确。为了得到更准确的积分结果，还得对盆边界进一步修正，因此第二部中可以选择（精度有所提升，但会更耗时得多）：</p>
<ul>
<li><code>2</code>：原子中心+均匀格点，精确优化边界</li>
<li><p><code>3</code>：</p>
</li>
<li><p>这三种模式的精度、耗时、内存消耗量：</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">Accuracy: <span class="number">2</span>&gt;=<span class="number">3</span>&gt;&gt;<span class="number">1</span>     Time spent: <span class="number">2</span>&gt;<span class="number">3</span>&gt;&gt;<span class="number">1</span>     Memory requirement: <span class="number">3</span>&gt;<span class="number">2</span>=<span class="number">1</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>果想进一步提升精度，可以在生成盆的时候<a href="#生成">用更好的格点</a>，比如High quality grid，乃至Lunatic quality grid。然而，对于大体系，High quality grid已经很耗时、很占内存了。</p>
<h2 id="分析定域化指数-LI-和离域化指数-DI"><a href="#分析定域化指数-LI-和离域化指数-DI" class="headerlink" title="分析定域化指数(LI)和离域化指数(DI)"></a>分析定域化指数(LI)和离域化指数(DI)</h2><ul>
<li><p>选择功能<code>4</code>，Multiwfn就会输出盆之间的DI矩阵和盆内的LI值：</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">************ Total delocalization index matrix ************</span><br><span class="line">            <span class="number">1</span>             <span class="number">2</span>             <span class="number">3</span></span><br><span class="line">    <span class="number">1</span>    <span class="number">0.97290584</span>    <span class="number">0.90037924</span>    <span class="number">0.07252660</span></span><br><span class="line">    <span class="number">2</span>    <span class="number">0.90037924</span>    <span class="number">3.49303265</span>    <span class="number">2.59265341</span></span><br><span class="line">    <span class="number">3</span>    <span class="number">0.07252660</span>    <span class="number">2.59265341</span>    <span class="number">2.66518001</span></span><br><span class="line"></span><br><span class="line">Total localization index:</span><br><span class="line">    <span class="number">1</span>:  <span class="number">0.259</span>     <span class="number">2</span>:  <span class="number">3.496</span>     <span class="number">3</span>:  <span class="number">6.658</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>还同时输出了行和列序号对应于原子序号的DI矩阵和LI值。</p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line"><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span><span class="strong">** Total delocalization index matrix (atom index) **</span><span class="strong">****</span><span class="strong">****</span><span class="strong">****</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>各个含义：</p>
<ul>
<li><p>键级：DI就是一种共价键级的衡量标准，随着键的极性的增强DI值一般会降低。</p>
<ul>
<li>比如DI(2,3)=2.593，表明2号盆（C的AIM原子空间）和3号盆（N的AIM原子空间）之间平均来说共享了2.593个电子，这和HCN中C与N的形式键级3.0挺接近。</li>
</ul>
</li>
<li><p>DI矩阵的对角元是相应的列（或行）的矩阵元的加和，对于闭壳层体系，DI矩阵的对角元便是原子价。</p>
<ul>
<li>此体系N原子的原子价是2.66。</li>
</ul>
</li>
<li>LI与原子布居数的差值就是从原子盆中离域到别处去的电子数<ul>
<li>1号盆（H的AIM原子空间）的定域化指数为0.259，说明平均有0.259个电子定域在这个盆内，这个数值远小于此盆内电子布居数，表明在HCN体系内，电子很容易从H的AIM空间中离域出去，外界的电子也容易离域进来，换句话说，盆内外的电子容易相互交换。</li>
</ul>
</li>
</ul>
]]></content>
      <categories>
        <category>计算化学</category>
        <category>软件</category>
      </categories>
      <tags>
        <tag>键级</tag>
        <tag>Multiwfn</tag>
        <tag>AIM</tag>
        <tag>电荷</tag>
        <tag>临界点</tag>
        <tag>键径</tag>
        <tag>拓扑分析</tag>
      </tags>
  </entry>
  <entry>
    <title>【ORCA】02.几何坐标输入</title>
    <url>/2020/05/28/%E3%80%90ORCA%E3%80%9102.%E5%87%A0%E4%BD%95%E5%9D%90%E6%A0%87%E8%BE%93%E5%85%A5/</url>
    <content><![CDATA[<ul>
<li>可以是笛卡尔坐标（x，y，z）或内坐标（键，角度，二面角），也可以是xyz文件形式。</li>
<li>可用<code>%coords</code>标记的block来表示，也可用两个<code>*</code>来封装，包含体系的电荷、多重度和原子坐标。</li>
</ul>
<h1 id="下的三种坐标形式"><a href="#下的三种坐标形式" class="headerlink" title="*下的三种坐标形式"></a>*下的三种坐标形式</h1><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">* CType Charge Multiplicity</span><br><span class="line">...</span><br><span class="line">coordinate specifications</span><br><span class="line">...</span><br><span class="line">*</span><br></pre></td></tr></table></figure>
<ul>
<li><code>ctype</code>中可以是<code>xyz</code>，<code>int</code>或<code>internal</code>，<code>gzmt</code></li>
</ul>
<h2 id="笛卡尔坐标形式"><a href="#笛卡尔坐标形式" class="headerlink" title="笛卡尔坐标形式"></a>笛卡尔坐标形式</h2><ul>
<li><p>默认是Ångström为单位，如果需要用<code>Bohrs</code>，需要在关键词中或者<code>%coords</code>中指定 <code>Bohrs</code>，或者直接<code>! Bohrs</code></p>
</li>
<li><p>eg：</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">* xyz <span class="number">1</span> <span class="number">2</span></span><br><span class="line">C <span class="number">0.0</span> <span class="number">0.0</span> <span class="number">0.0</span></span><br><span class="line">O <span class="number">0.0</span> <span class="number">0.0</span> <span class="number">1.1105</span></span><br><span class="line">*</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="内坐标"><a href="#内坐标" class="headerlink" title="内坐标"></a>内坐标</h2><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">*<span class="keyword">int</span> charge multiplicity</span><br><span class="line">Atom1 <span class="number">0</span> <span class="number">0</span> <span class="number">0</span>		<span class="number">0.0</span> <span class="number">0.0</span> <span class="number">0.0</span></span><br><span class="line">Atom2 <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> 	R1  <span class="number">0.0</span> <span class="number">0.0</span></span><br><span class="line">Atom3 <span class="number">1</span> <span class="number">2</span> <span class="number">0</span> 	R2  A1  <span class="number">0.0</span></span><br><span class="line">Atom4 <span class="number">1</span> <span class="number">2</span> <span class="number">3</span> 	R3  A2  D1</span><br><span class="line">. . .</span><br><span class="line">AtomN NA NB NC RN AN DN</span><br><span class="line">(R = actual distance (Angström <span class="keyword">or</span> Bohr)</span><br><span class="line">(A = Angle in degrees)</span><br><span class="line">(D = dihedral angle in degree)</span><br><span class="line">*</span><br></pre></td></tr></table></figure>
<ul>
<li>角度单位是<code>degree</code></li>
<li>NA= atom for distance NA-NB</li>
<li>NB= atom for angle- this atom-NA-NB</li>
<li>NC= dihedral angle- this atom-NA-NB-NC</li>
<li><strong>orca原子序数是从1开始计数的</strong></li>
<li><p>eg：</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">* <span class="keyword">int</span> <span class="number">0</span> <span class="number">1</span></span><br><span class="line">C <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0.0000</span> <span class="number">0.000</span> <span class="number">0.00</span></span><br><span class="line">O <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1.2500</span> <span class="number">0.000</span> <span class="number">0.00</span></span><br><span class="line">H <span class="number">1</span> <span class="number">2</span> <span class="number">0</span> <span class="number">1.1075</span> <span class="number">122.016</span> <span class="number">0.00</span></span><br><span class="line">H <span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">1.1075</span> <span class="number">122.016</span> <span class="number">180.00</span></span><br><span class="line">*</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="笛卡尔坐标和内坐标混合使用"><a href="#笛卡尔坐标和内坐标混合使用" class="headerlink" title="笛卡尔坐标和内坐标混合使用"></a>笛卡尔坐标和内坐标混合使用</h3><ul>
<li>对原子使用<code>0 0 0</code>来代表是笛卡尔坐标，但是由于内坐标的第一个原子也是<code>0 0 0</code>，因此第一个原子如果是笛卡尔坐标，需要使用<code>1 1 1</code></li>
<li>内坐标和笛卡尔坐标可以以任意顺序，但是最好先用笛卡尔坐标固定前三个原子的位置，这样才有唯一的框架。</li>
</ul>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">UKS B3LYP SV(P) TightSCF Opt SlowConv</span><br><span class="line">%geom scan B <span class="number">4</span> <span class="number">0</span> = <span class="number">2.0</span>, <span class="number">1.0</span>, <span class="number">15</span> end end</span><br><span class="line">* <span class="built_in">int</span> <span class="number">0</span> <span class="number">2</span></span><br><span class="line">	# First atom - <span class="built_in">ref</span>erence atoms <span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span> mean Cartesian coordinates</span><br><span class="line">	C <span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">-0.865590</span> <span class="number">1.240463</span> <span class="number">-2.026957</span></span><br><span class="line">	# Next atoms - <span class="built_in">ref</span>erence atoms <span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span> mean Cartesian coordinates</span><br><span class="line">	H <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">-1.141534</span> <span class="number">2.296757</span> <span class="number">-1.931942</span></span><br><span class="line">	H <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">-1.135059</span> <span class="number">0.703085</span> <span class="number">-2.943344</span></span><br><span class="line">	H <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">-0.607842</span> <span class="number">0.670110</span> <span class="number">-1.127819</span></span><br><span class="line">	# Actual <span class="built_in">int</span>ernal coordinates</span><br><span class="line">	H <span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">1.999962</span> <span class="number">100.445</span> <span class="number">96.050</span></span><br><span class="line">	O <span class="number">5</span> <span class="number">1</span> <span class="number">2</span> <span class="number">0.984205</span> <span class="number">164.404</span> <span class="number">27.073</span></span><br><span class="line">	H <span class="number">6</span> <span class="number">5</span> <span class="number">1</span> <span class="number">0.972562</span> <span class="number">103.807</span> <span class="number">10.843</span></span><br><span class="line">*</span><br></pre></td></tr></table></figure>
<h2 id="Gaussian-Z-matrix-format"><a href="#Gaussian-Z-matrix-format" class="headerlink" title="Gaussian Z-matrix format"></a>Gaussian Z-matrix format</h2><ul>
<li><p>eg：</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">* gzmt <span class="number">0</span> <span class="number">1</span></span><br><span class="line">C</span><br><span class="line">O <span class="number">1</span> <span class="number">4.454280</span></span><br><span class="line">Si <span class="number">2</span> <span class="number">1.612138</span> <span class="number">1</span> <span class="number">56.446186</span></span><br><span class="line">O <span class="number">3</span> <span class="number">1.652560</span> <span class="number">2</span> <span class="number">114.631525</span> <span class="number">1</span> <span class="number">-73.696925</span></span><br><span class="line">C <span class="number">4</span> <span class="number">1.367361</span> <span class="number">3</span> <span class="number">123.895399</span> <span class="number">2</span> <span class="number">-110.635060</span></span><br><span class="line">...</span><br><span class="line">*</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h1 id="用block-coords表示"><a href="#用block-coords表示" class="headerlink" title="用block %coords表示"></a>用block <code>%coords</code>表示</h1><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">%coords</span><br><span class="line">	CTyp xyz <span class="meta"># the type of coordinates = xyz or internal</span></span><br><span class="line">	Charge <span class="number">0</span> <span class="meta"># the total charge of the molecule</span></span><br><span class="line">	Mult <span class="number">2</span> <span class="meta"># the multiplicity = 2S+1</span></span><br><span class="line">	Units Angs <span class="meta"># the unit of length = angs or bohrs</span></span><br><span class="line">	<span class="meta"># the subblock coords is for the actual coordinates</span></span><br><span class="line">	<span class="meta"># for CTyp=xyz</span></span><br><span class="line">	coords</span><br><span class="line">		Atom1 x1 y1 z1</span><br><span class="line">		Atom2 x2 y2 z2</span><br><span class="line">	end</span><br><span class="line">	<span class="meta"># for CTyp=internal</span></span><br><span class="line">	coords</span><br><span class="line">		Atom1 <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0.0</span> <span class="number">0.0</span> <span class="number">0.0</span></span><br><span class="line">		Atom2 <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> R1 <span class="number">0.0</span> <span class="number">0.0</span></span><br><span class="line">		Atom3 <span class="number">1</span> <span class="number">2</span> <span class="number">0</span> R2 A1 <span class="number">0.0</span></span><br><span class="line">		Atom4 <span class="number">1</span> <span class="number">2</span> <span class="number">3</span> R3 A2 D1</span><br><span class="line">		. . .</span><br><span class="line">		AtomN NA NB NC RN AN DN</span><br><span class="line">	end</span><br><span class="line">end</span><br></pre></td></tr></table></figure>
<h1 id="文件形式输入"><a href="#文件形式输入" class="headerlink" title="文件形式输入"></a>文件形式输入</h1><ul>
<li><p>.xyz坐标为埃，文件中第一行是原子数量，第二行是描述行，接着是坐标</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line">*<span class="selector-tag">xyzfile</span> <span class="selector-tag">charge</span> <span class="selector-tag">multiplicity</span> <span class="selector-tag">myCoordinateFile</span><span class="selector-class">.xyz</span></span><br></pre></td></tr></table></figure>
<ul>
<li><p>file.xyz是XMol格式的xyz文件，坐标为Ångström，两行标题包含原子数和描述行：</p>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">4</span> </span><br><span class="line"><span class="attribute">description</span> line</span><br><span class="line"><span class="attribute">C</span>        <span class="number">0</span>.<span class="number">000000000</span>      <span class="number">0</span>.<span class="number">000000000</span>      <span class="number">0</span>.<span class="number">000000000</span></span><br><span class="line"><span class="attribute">O</span>        <span class="number">2</span>.<span class="number">362157486</span>      <span class="number">0</span>.<span class="number">000000000</span>      <span class="number">0</span>.<span class="number">000000000</span></span><br><span class="line"><span class="attribute">H</span>       -<span class="number">1</span>.<span class="number">109548835</span>      <span class="number">1</span>.<span class="number">774545300</span>      <span class="number">0</span>.<span class="number">000000000</span></span><br><span class="line"><span class="attribute">H</span>       -<span class="number">1</span>.<span class="number">109548835</span>     -<span class="number">1</span>.<span class="number">774545300</span>      <span class="number">0</span>.<span class="number">000000000</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>.gzmt通常在Gabedit，molden or Jmol中使用</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">* gzmtfile <span class="number">1</span> <span class="number">2</span> mycoords.gzmt</span><br></pre></td></tr></table></figure>
</li>
<li><p>注意，如果在同一个输入文件中指定了多个作业，那么新作业可以从以前的作业读取坐标。如果第四个参数没有提供文件名，则自动使用实际作业的名称。这样，优化和单点作业就可以非常方便地组合在一个简单的输入文件中。</p>
<figure class="highlight gams"><table><tr><td class="code"><pre><span class="line">.. specification <span class="keyword">for</span> the first job</span><br><span class="line"><span class="meta"><span class="meta-keyword">$new</span>_job</span></span><br><span class="line">! keywords</span><br><span class="line"><span class="comment">* xyzfile 1 2</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h1 id="特殊指定"><a href="#特殊指定" class="headerlink" title="特殊指定"></a>特殊指定</h1><h2 id="Dummy-atoms"><a href="#Dummy-atoms" class="headerlink" title="Dummy atoms"></a>Dummy atoms</h2><ul>
<li>使用“DA”作为符号并给适当的坐标。虚拟原子不是真正的原子，它们没有电子、原子核或基函数。它们通常用于定义约束。</li>
</ul>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">*xyz <span class="number">0</span> <span class="number">1</span></span><br><span class="line">C        <span class="number">0.000000000</span>      <span class="number">0.000000000</span>      <span class="number">0.000000000</span></span><br><span class="line">O        <span class="number">2.362157486</span>      <span class="number">0.000000000</span>      <span class="number">0.000000000</span></span><br><span class="line">H       <span class="number">-1.109548835</span>      <span class="number">1.774545300</span>      <span class="number">0.000000000</span></span><br><span class="line">DA        <span class="number">1.000000000</span>      <span class="number">0.000000000</span>      <span class="number">0.000000000</span> </span><br><span class="line">*</span><br></pre></td></tr></table></figure>
<h2 id="ghost-atoms"><a href="#ghost-atoms" class="headerlink" title="ghost atoms"></a>ghost atoms</h2><ul>
<li>在一个原子的元素符号后面加上”：”使其成为ghost atoms，ghost atoms没有电子或原子核，但有指定的基函数。ghost atoms通常用于校正基集叠加误差(BSSE)。</li>
</ul>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="string">*xyz</span> <span class="number">0</span> <span class="number">1</span></span><br><span class="line"><span class="string">C</span>        <span class="number">0.000000000</span>      <span class="number">0.000000000</span>      <span class="number">0.000000000</span></span><br><span class="line"><span class="string">O</span>        <span class="number">2.362157486</span>      <span class="number">0.000000000</span>      <span class="number">0.000000000</span></span><br><span class="line"><span class="string">H</span>       <span class="number">-1.109548835</span>      <span class="number">1.774545300</span>      <span class="number">0.000000000</span></span><br><span class="line"><span class="attr">H:</span>       <span class="number">-1.109548835</span>     <span class="number">-1.774545300</span>      <span class="number">0.000000000</span>  </span><br><span class="line"><span class="string">*</span></span><br></pre></td></tr></table></figure>
<h2 id="点电荷"><a href="#点电荷" class="headerlink" title="点电荷"></a>点电荷</h2><ul>
<li><p>可以通过指定电荷和坐标以及使用符号<code>Q</code>添加。</p>
<ul>
<li>点电荷没有基函数，但有一个固定的电荷，可以是负的或正的，点电荷基本上与核电荷处理相同。</li>
<li>注意，当添加点电荷作为<code>Q</code>原子时，点电荷之间的自相互作用<strong>被计算并包含在最终能量中</strong>。</li>
</ul>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">*xyz <span class="number">0</span> <span class="number">1</span></span><br><span class="line">O        <span class="number">0.000000000</span>     <span class="number">-0.005910000</span>      <span class="number">0.000000000</span></span><br><span class="line">H        <span class="number">0.765973000</span>      <span class="number">0.587955000</span>      <span class="number">0.000000000</span></span><br><span class="line">H       <span class="number">-0.765973000</span>      <span class="number">0.587955000</span>      <span class="number">0.000000000</span></span><br><span class="line">Q    <span class="number">-0.834</span>      <span class="number">1.374158484</span>     <span class="number">-2.145897424</span>      <span class="number">0.000000000</span>  </span><br><span class="line">Q     <span class="number">0.417</span>       <span class="number">2.328008170</span>     <span class="number">-1.973964147</span>      <span class="number">0.000000000</span> </span><br><span class="line">Q     <span class="number">0.417</span>       <span class="number">0.980357969</span>     <span class="number">-1.270385486</span>      <span class="number">0.000000000</span> </span><br><span class="line">*</span><br></pre></td></tr></table></figure>
</li>
<li><p>当存在许多点电荷时，例如在QM/MM计算中，从文件中读取点电荷通常更方便</p>
<ul>
<li>注意，当通过点电荷文件读取点电荷来添加点电荷时，<strong>不会计算点电荷之间的自相互作用</strong>。</li>
</ul>
<figure class="highlight lsl"><table><tr><td class="code"><pre><span class="line">%pointcharges <span class="string">&quot;pointcharges.pc&quot;</span></span><br><span class="line">*xyz <span class="number">0</span> <span class="number">1</span></span><br><span class="line">O        <span class="number">0.000000000</span>     <span class="number">-0.005910000</span>      <span class="number">0.000000000</span></span><br><span class="line">H        <span class="number">0.765973000</span>      <span class="number">0.587955000</span>      <span class="number">0.000000000</span></span><br><span class="line">H       <span class="number">-0.765973000</span>      <span class="number">0.587955000</span>      <span class="number">0.000000000</span></span><br><span class="line">*</span><br></pre></td></tr></table></figure>
<ul>
<li><p>pc文件格式：第一行是点电荷数目，后面是电荷和坐标（）Å</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line"><span class="number">3</span></span><br><span class="line"><span class="number">-0.834</span>      <span class="number">1.374158484</span>     <span class="number">-2.145897424</span>      <span class="number">0.000000000</span></span><br><span class="line"><span class="number">0.417</span>       <span class="number">2.328008170</span>     <span class="number">-1.973964147</span>      <span class="number">0.000000000</span></span><br><span class="line"><span class="number">0.417</span>       <span class="number">0.980357969</span>     <span class="number">-1.270385486</span>      <span class="number">0.000000000</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>如果需要将外部电荷的自相互作用加进去，可以用<code>! DoEQ</code>关键词或者在<code>%method</code>部分指定  </p>
<figure class="highlight monkey"><table><tr><td class="code"><pre><span class="line">% pointcharges <span class="string">&quot;pointcharges.pc&quot;</span></span><br><span class="line">%<span class="function"><span class="keyword">method</span></span></span><br><span class="line">	DoEQ <span class="literal">true</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h2 id="Embedding-potential"><a href="#Embedding-potential" class="headerlink" title="Embedding potential"></a>Embedding potential</h2><p>计算簇模型有时候需要Embedding potential来解释边界处被忽略的排斥项</p>
<ul>
<li>因为Embedding ECP被当作一个点电荷，所以要给定电荷。</li>
<li>也需要指定坐标，可选择给定ECP</li>
<li>一般来说应该执行的是单点计算，如果需要几何优化，需要coreless ECP中心设置明确的笛卡尔约束</li>
</ul>
<figure class="highlight lsl"><table><tr><td class="code"><pre><span class="line">* ...</span><br><span class="line"># atom&gt; charge x y z optional ECP declaration</span><br><span class="line">Zr&gt; <span class="number">4.0</span> <span class="number">0.0</span> <span class="number">0.0</span> <span class="number">0.0</span> NewECP <span class="string">&quot;SDD&quot;</span> end</span><br><span class="line">...</span><br><span class="line">*</span><br></pre></td></tr></table></figure>
<p>这样一个没有核心的ECP中心的声明是在坐标部分通过在元素符号后面附加一个括号<code>&gt;</code>来实现的。注意，嵌入ECPs在ORCA中被视为点电荷。所以接下来要给出电荷。没有芯的ECP中心的坐标必须像往常一样指定，然后可能会有一个可选的ECP分配。一般来说，采用ECP嵌入程序的计算应该是单点计算。然而，如果需要执行几何优化，请确保为无芯ECP中心设置明确的笛卡尔约束。</p>
<h2 id="None-standard-非标准同位素"><a href="#None-standard-非标准同位素" class="headerlink" title="None-standard 非标准同位素"></a>None-standard 非标准同位素</h2><p>在后面加M= Z=</p>
<h2 id="Fragments"><a href="#Fragments" class="headerlink" title="Fragments"></a>Fragments</h2><ul>
<li><p>片段可以通过在元素符号后面的括号<code>(n)</code>中声明一个给定原子所属的片段号来方便地定义。片段的序号是从1开始的</p>
</li>
<li><p>例子：利用片段将分子分成金属和配体的片段，打印每个MOs中金属和配体的占据</p>
</li>
</ul>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">%coords</span><br><span class="line">	CTyp xyz</span><br><span class="line">	Charge <span class="number">-2</span></span><br><span class="line">	Mult <span class="number">2</span> </span><br><span class="line">	coords</span><br><span class="line">		Cu(<span class="number">1</span>) <span class="number">0</span> <span class="number">0</span> <span class="number">0</span></span><br><span class="line">		Cl(<span class="number">2</span>) <span class="number">2.25</span> <span class="number">0</span> <span class="number">0</span></span><br><span class="line">		Cl(<span class="number">2</span>) <span class="number">-2.25</span> <span class="number">0</span> <span class="number">0</span></span><br><span class="line">		Cl(<span class="number">2</span>) <span class="number">0</span> <span class="number">2.25</span> <span class="number">0</span></span><br><span class="line">		Cl(<span class="number">2</span>) <span class="number">0</span> <span class="number">-2.25</span> <span class="number">0</span></span><br><span class="line">	end</span><br><span class="line">end</span><br></pre></td></tr></table></figure>
<ul>
<li>或者通过<code>%geom</code>部分指定：<ul>
<li><code>%geom</code>部分必须写在坐标之后</li>
</ul>
</li>
</ul>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">*xyz <span class="number">-2</span> <span class="number">2</span></span><br><span class="line">	Cu <span class="number">0</span> <span class="number">0</span> <span class="number">0</span></span><br><span class="line">	Cl <span class="number">2.25</span> <span class="number">0</span> <span class="number">0</span></span><br><span class="line">	Cl <span class="number">-2.25</span> <span class="number">0</span> <span class="number">0</span></span><br><span class="line">	Cl <span class="number">0</span> <span class="number">2.25</span> <span class="number">0</span></span><br><span class="line">	Cl <span class="number">0</span> <span class="number">-2.25</span> <span class="number">0</span></span><br><span class="line">*</span><br><span class="line">%geom</span><br><span class="line">	Fragments</span><br><span class="line">		<span class="number">1</span> f0g end # atom <span class="number">0</span> <span class="keyword">for</span> fragment <span class="number">1</span></span><br><span class="line">		<span class="number">2</span> f1:<span class="number">4</span>g end # atoms <span class="number">1</span> to <span class="number">4</span> <span class="keyword">for</span> fragment <span class="number">2</span></span><br><span class="line">	end</span><br><span class="line">end</span><br></pre></td></tr></table></figure>
<ul>
<li>几何和碎片也可以通过外部文件指定，另外，如果没有指定，所有的原子都是fragment 1。</li>
</ul>
<h1 id="对称性和取向"><a href="#对称性和取向" class="headerlink" title="对称性和取向"></a>对称性和取向</h1><ul>
<li><p>需要将分子摆成某个取向计算，可以先在其他软件中摆好了再计算。但是几何优化中这个取向会发生变化（因为笛卡尔坐标到内坐标信息会丢失），因此最好是几何优化完后导出结构，摆成某个朝向再算单点。</p>
</li>
<li><p>ORCA对分子对称性的利用有限，主要用于SCF/CASSCF中的轨道和状态分析，以及MRCI代码中的计算优势。使用<code>UseSym</code>关键字，可以让ORCA检测点群，对坐标进行对称化，改变原点，并产生适合于对称的轨道，用于SCF/CASSCF计算。目前只支持D2h和较低点群。</p>
</li>
<li><p>为了使自动点群检测工作，分子需要被正确地对称，也可以更改点组检测的<code>treshold</code>，但是阈值过高可能会出现问题</p>
<figure class="highlight oxygene"><table><tr><td class="code"><pre><span class="line">! Usesym</span><br><span class="line">%<span class="function"><span class="keyword">method</span> <span class="title">SymThresh</span> 5.0<span class="title">e</span>-2 <span class="title">end</span></span></span><br></pre></td></tr></table></figure>
</li>
<li><p>有时候希望得到基态，但是初猜比较糟糕，计算会收敛到激发态，此时可以用：</p>
<ul>
<li>当且仅当空轨道的能量低于已占据轨道时，每一个不可约表示中的占据数就会发生变化。</li>
</ul>
<figure class="highlight oxygene"><table><tr><td class="code"><pre><span class="line">%<span class="function"><span class="keyword">method</span> <span class="title">SymRelax</span> <span class="title">True</span></span></span><br><span class="line"><span class="function"><span class="title">end</span></span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>例子：计算水分子阳离子</p>
<ul>
<li><p>输入：</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="type">!SVP</span> <span class="string">UseSym</span></span><br><span class="line"></span><br><span class="line"><span class="string">*</span> <span class="string">xyz</span> <span class="number">1</span> <span class="number">2</span></span><br><span class="line"><span class="string">O</span> <span class="number">0.000000</span> <span class="number">0.000000</span> <span class="number">0.068897</span></span><br><span class="line"><span class="string">H</span> <span class="number">0.000000</span> <span class="number">0.788011</span> <span class="number">-0.546765</span></span><br><span class="line"><span class="string">H</span> <span class="number">0.000000</span> <span class="number">-0.788011</span> <span class="number">-0.546765</span></span><br><span class="line"><span class="string">*</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>程序将识别出C<sub>2v</sub>：</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">------------------------------------------------------------------------------</span><br><span class="line">                            SYMMETRY HANDLING SETUP</span><br><span class="line">------------------------------------------------------------------------------</span><br><span class="line"></span><br><span class="line">------------------</span><br><span class="line">SYMMETRY DETECTION</span><br><span class="line">------------------</span><br><span class="line">Preparing Data                    <span class="built_in">..</span>. done</span><br><span class="line">Detection Threshold:    SymThresh <span class="built_in">..</span>. 1.0000e-04</span><br><span class="line"></span><br><span class="line">Point<span class="built_in"> Group </span>will now be determined:</span><br><span class="line">Moving molecule <span class="keyword">to</span> center of mass <span class="built_in">..</span>. done</span><br><span class="line"></span><br><span class="line">POINT<span class="built_in"> GROUP </span>                      <span class="built_in">..</span>. C2v</span><br><span class="line"></span><br><span class="line">The coordinates will now be cleaned:</span><br><span class="line">Moving <span class="keyword">to</span> standard coord frame    <span class="built_in">..</span>. done</span><br><span class="line">(Changed main axis <span class="keyword">to</span> z <span class="keyword">and</span> one of the symmetry planes <span class="keyword">to</span> xz plane)</span><br><span class="line">Structure cleanup requested       <span class="built_in">..</span>. <span class="literal">yes</span></span><br><span class="line">Selected point<span class="built_in"> group </span>             <span class="built_in">..</span>. C2v</span><br><span class="line">Cleaning Tolerance      SymThresh <span class="built_in">..</span>. 1.0000e-04</span><br><span class="line"></span><br><span class="line">Some missing point<span class="built_in"> group </span>data is constructed:</span><br><span class="line">Constructing symmetry operations  <span class="built_in">..</span>. done</span><br><span class="line">Creating atom transfer table      <span class="built_in">..</span>. done</span><br><span class="line">Creating asymmetric unit          <span class="built_in">..</span>. done</span><br><span class="line"></span><br><span class="line">Cleaning coordinates              <span class="built_in">..</span>. done</span><br><span class="line"></span><br><span class="line">-----------------------------------------------</span><br><span class="line">SYMMETRY-PERFECTED CARTESIAN COORDINATES (A.U.)</span><br><span class="line">-----------------------------------------------</span><br><span class="line">   0 O     0.00000000   0.00000000   0.13019595 </span><br><span class="line">   1 H     0.00000000   1.48912498  -1.03323662 </span><br><span class="line">   2 H     0.00000000  -1.48912498  -1.03323662 </span><br><span class="line"></span><br><span class="line">------------------</span><br><span class="line">SYMMETRY REDUCTION</span><br><span class="line">------------------</span><br><span class="line">ORCA supports only abelian point groups.</span><br><span class="line">It is now checked, <span class="keyword">if</span> the determined point<span class="built_in"> group </span>is supported:</span><br><span class="line">Point<span class="built_in"> Group </span>( C2v   ) is          <span class="built_in">..</span>. supported</span><br><span class="line"></span><br><span class="line">(Re)building abelian point group:</span><br><span class="line">Creating Character Table          <span class="built_in">..</span>. done</span><br><span class="line">Making direct product table       <span class="built_in">..</span>. done</span><br><span class="line"></span><br><span class="line">----------------------</span><br><span class="line">ASYMMETRIC UNIT <span class="keyword">IN</span> C2v</span><br><span class="line">----------------------</span><br><span class="line">  #  AT     MASS              COORDS (A.U.)             BAS</span><br><span class="line">   0 O   15.9990   0.00000000   0.00000000   0.13019595   0</span><br><span class="line">   1 H    1.0080   0.00000000   1.48912498  -1.03323662   0</span><br><span class="line"></span><br><span class="line">----------------------</span><br><span class="line">SYMMETRY ADAPTED BASIS</span><br><span class="line">----------------------</span><br><span class="line">The coefficients <span class="keyword">for</span> the symmetry adapted linear combinations (SALCS)</span><br><span class="line">of basis functions will now be computed:</span><br><span class="line">Number of basis functions         <span class="built_in">..</span>.    24</span><br><span class="line">Preparing memory                  <span class="built_in">..</span>. done</span><br><span class="line">Constructing Gamma(red)           <span class="built_in">..</span>. done</span><br><span class="line">Reducing Gamma(red)               <span class="built_in">..</span>. done</span><br><span class="line">Constructing SALCs                <span class="built_in">..</span>. done</span><br><span class="line">Checking SALC integrity           <span class="built_in">..</span>. <span class="literal">nothing</span> suspicious</span><br><span class="line">Normalizing SALCs                 <span class="built_in">..</span>. done</span><br><span class="line"></span><br><span class="line">Storing the symmetry object:</span><br><span class="line">Symmetry file                     <span class="built_in">..</span>. /tmp/tmp.Hph6rKnPOv/test-sym-h2o+.sym.tmp</span><br><span class="line">Writing symmetry information      <span class="built_in">..</span>. done</span><br></pre></td></tr></table></figure>
</li>
<li><p>SCF程序中的初猜将识别并冻结C2v点群的每个不可约表示中的占据数：</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">The symmetry of the initial guess <span class="keyword">is</span> <span class="number">2</span>-B1</span><br><span class="line">Irrep occupations <span class="keyword">for</span> operator <span class="number">0</span></span><br><span class="line">    A1 -    <span class="number">3</span></span><br><span class="line">    A2 -    <span class="number">0</span></span><br><span class="line">    B1 -    <span class="number">1</span></span><br><span class="line">    B2 -    <span class="number">1</span></span><br><span class="line">Irrep occupations <span class="keyword">for</span> operator <span class="number">1</span></span><br><span class="line">    A1 -    <span class="number">3</span></span><br><span class="line">    A2 -    <span class="number">0</span></span><br><span class="line">    B1 -    <span class="number">0</span></span><br><span class="line">    B2 -    <span class="number">1</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>计算收敛得到：</p>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">Total</span> Energy       :          -<span class="number">75</span>.<span class="number">56349635</span> Eh           -<span class="number">2056</span>.<span class="number">18727</span> eV</span><br></pre></td></tr></table></figure>
</li>
<li><p>轨道：</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="string">----------------</span></span><br><span class="line"><span class="string">ORBITAL</span> <span class="string">ENERGIES</span></span><br><span class="line"><span class="string">----------------</span></span><br><span class="line">                 <span class="string">SPIN</span> <span class="string">UP</span> <span class="string">ORBITALS</span></span><br><span class="line">  <span class="literal">NO</span>   <span class="string">OCC</span>          <span class="string">E(Eh)</span>            <span class="string">E(eV)</span>    <span class="string">Irrep</span></span><br><span class="line">   <span class="number">0</span>   <span class="number">1.0000</span>     <span class="number">-21.127828</span>      <span class="number">-574.9174</span>    <span class="number">1</span><span class="string">-A1</span></span><br><span class="line">   <span class="number">1</span>   <span class="number">1.0000</span>      <span class="number">-1.867577</span>       <span class="number">-50.8194</span>    <span class="number">2</span><span class="string">-A1</span></span><br><span class="line">   <span class="number">2</span>   <span class="number">1.0000</span>      <span class="number">-1.192140</span>       <span class="number">-32.4398</span>    <span class="number">1</span><span class="string">-B2</span></span><br><span class="line">   <span class="number">3</span>   <span class="number">1.0000</span>      <span class="number">-1.124658</span>       <span class="number">-30.6035</span>    <span class="number">1</span><span class="string">-B1</span></span><br><span class="line">   <span class="number">4</span>   <span class="number">1.0000</span>      <span class="number">-1.085063</span>       <span class="number">-29.5261</span>    <span class="number">3</span><span class="string">-A1</span></span><br><span class="line">   <span class="number">5</span>   <span class="number">0.0000</span>      <span class="number">-0.153303</span>        <span class="number">-4.1716</span>    <span class="number">4</span><span class="string">-A1</span></span><br><span class="line">   <span class="number">6</span>   <span class="number">0.0000</span>      <span class="number">-0.071325</span>        <span class="number">-1.9408</span>    <span class="number">2</span><span class="string">-B2</span></span><br><span class="line"><span class="string">...</span></span><br><span class="line">                 <span class="string">SPIN</span> <span class="string">DOWN</span> <span class="string">ORBITALS</span></span><br><span class="line">  <span class="literal">NO</span>   <span class="string">OCC</span>          <span class="string">E(Eh)</span>            <span class="string">E(eV)</span>    <span class="string">Irrep</span></span><br><span class="line">   <span class="number">0</span>   <span class="number">1.0000</span>     <span class="number">-21.081197</span>      <span class="number">-573.6485</span>    <span class="number">1</span><span class="string">-A1</span></span><br><span class="line">   <span class="number">1</span>   <span class="number">1.0000</span>      <span class="number">-1.710192</span>       <span class="number">-46.5367</span>    <span class="number">2</span><span class="string">-A1</span></span><br><span class="line">   <span class="number">2</span>   <span class="number">1.0000</span>      <span class="number">-1.152853</span>       <span class="number">-31.3707</span>    <span class="number">1</span><span class="string">-B2</span></span><br><span class="line">   <span class="number">3</span>   <span class="number">1.0000</span>      <span class="number">-1.032555</span>       <span class="number">-28.0972</span>    <span class="number">3</span><span class="string">-A1</span></span><br><span class="line">   <span class="number">4</span>   <span class="number">0.0000</span>      <span class="number">-0.306683</span>        <span class="number">-8.3453</span>    <span class="number">1</span><span class="string">-B1</span></span><br><span class="line">   <span class="number">5</span>   <span class="number">0.0000</span>      <span class="number">-0.139418</span>        <span class="number">-3.7937</span>    <span class="number">4</span><span class="string">-A1</span></span><br><span class="line">   <span class="number">6</span>   <span class="number">0.0000</span>      <span class="number">-0.062261</span>        <span class="number">-1.6942</span>    <span class="number">2</span><span class="string">-B2</span></span><br><span class="line">   <span class="number">7</span>   <span class="number">0.0000</span>       <span class="number">0.374726</span>        <span class="number">10.1968</span>    <span class="number">3</span><span class="string">-B2</span></span><br><span class="line"><span class="string">...</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h1 id="定义几何参数和扫描势能面"><a href="#定义几何参数和扫描势能面" class="headerlink" title="定义几何参数和扫描势能面"></a>定义几何参数和扫描势能面</h1><ul>
<li><p>可以将坐标定义为参数或者一系列的值（此时会做势能面扫描）。在这种情况下，变量<code>RunTyp</code>被自动更改为<code>Scan</code>。格式如下：</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="string">%coords</span></span><br><span class="line">	<span class="string">CTyp</span> <span class="string">internal</span></span><br><span class="line">	<span class="string">Charge</span> <span class="number">0</span></span><br><span class="line">	<span class="string">Mult</span> <span class="number">1</span></span><br><span class="line">	<span class="string">pardef</span></span><br><span class="line">    	<span class="string">rCH</span> <span class="string">=</span> <span class="number">1.09</span><span class="string">;</span> </span><br><span class="line">    	<span class="string">ACOH</span> <span class="string">=</span> <span class="number">120.0</span><span class="string">;</span> </span><br><span class="line">    	<span class="string">rCO</span> <span class="string">=</span> <span class="number">1.35</span><span class="string">,</span> <span class="number">1.10</span><span class="string">,</span> <span class="number">26</span><span class="string">;</span> <span class="comment"># a C-O distance that will be scanned</span></span><br><span class="line">	<span class="string">end</span></span><br><span class="line">	<span class="string">coords</span></span><br><span class="line">    	<span class="string">C</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span></span><br><span class="line">    	<span class="string">O</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> &#123;<span class="string">rCO</span>&#125; <span class="number">0</span> <span class="number">0</span></span><br><span class="line">    	<span class="string">H</span> <span class="number">1</span> <span class="number">2</span> <span class="number">0</span> &#123;<span class="string">rCH</span>&#125; &#123;<span class="string">ACOH</span>&#125; <span class="number">0</span></span><br><span class="line">    	<span class="string">H</span> <span class="number">1</span> <span class="number">2</span> <span class="number">3</span> &#123;<span class="string">rCH</span>&#125; &#123;<span class="string">ACOH</span>&#125; <span class="number">180</span></span><br><span class="line">	<span class="string">end</span></span><br><span class="line"><span class="string">end</span></span><br></pre></td></tr></table></figure>
<ul>
<li><p>参数也可以在笛卡尔坐标中实现</p>
</li>
<li><p>每个几何参数都可以通过封装函数大括号作为几何参数的函数来赋值，比如<script type="math/tex">\{0.5×cos(Theta)×rML+R\}</script>（注意orca的三角函数中是度数不是弧度）。几何参数的长度默认是Å，角度是°</p>
</li>
<li><p>在上面的例子中，变量<code>rCO</code>被定义为一个“扫描参数”。它的值将在从1.3到1.1的26步中改变，并且在每个点上进行单点计算。在运行结束时，程序将汇总每个点的总能量。就可以绘制出势能表面。如果不想用均匀的点，而是用自定义的，则可以：这样可以在接近最大值或最小值多设一些点，其他地方少一些</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="string">rCO</span> [<span class="number">1.3</span> <span class="number">1.25</span> <span class="number">1.22</span> <span class="number">1.20</span> <span class="number">1.18</span> <span class="number">1.15</span> <span class="number">1.10</span>]<span class="string">;</span> <span class="comment"># a C-O distance that will be scanned</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>扫描参数最多可以有三个，可以构造三维势能面扫描</p>
</li>
</ul>
</li>
<li><p>orca中参数也可以参数的参数，比如：</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">%coords</span><br><span class="line">	CTyp <span class="built_in">int</span>ernal</span><br><span class="line">	Charge <span class="number">0</span></span><br><span class="line">	Mult <span class="number">1</span></span><br><span class="line">	pardef</span><br><span class="line">    	rCOHalf= <span class="number">0.6</span>;</span><br><span class="line">    	rCO = &#123; <span class="number">2.0</span>*rCOHalf &#125;;</span><br><span class="line">	end</span><br><span class="line">	coords</span><br><span class="line">    	C <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span></span><br><span class="line">    	O <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> &#123;rCO&#125; <span class="number">0</span> <span class="number">0</span></span><br><span class="line">    	O <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> &#123;rCO&#125; <span class="number">180</span> <span class="number">0</span></span><br><span class="line">	end</span><br><span class="line">end</span><br></pre></td></tr></table></figure>
</li>
<li><p>orca的一些关于势能面扫描的设置：</p>
<figure class="highlight oxygene"><table><tr><td class="code"><pre><span class="line">%<span class="function"><span class="keyword">method</span></span></span><br><span class="line"><span class="function">	<span class="title">SwitchToSOSCF</span> <span class="title">true</span></span></span><br><span class="line"><span class="function">	<span class="title">ReducePrint</span> <span class="title">true</span></span></span><br><span class="line"><span class="function">	<span class="title">ScanGuess</span> <span class="title">MORead</span></span></span><br><span class="line"><span class="function"><span class="title">end</span></span></span><br></pre></td></tr></table></figure>
<ul>
<li><code>SwitchToSOSCF true表示</code>在第一个点后，换成SOSCF，如果起始轨道正确，<code>SOSCF</code>可能比<code>DIIS</code>收敛得更好。默认是<code>false</code></li>
<li><code>ReducePrint true</code>表示减少第一个点后的输出，默认是<code>true</code></li>
<li>第一点后可以改变初猜方法，默认是<code>MOread</code>，一般来说前一个点是下一个点的初猜，但是有些情况，可以使用更一般的初猜<ul>
<li><code>OneElec</code> 单电子矩阵</li>
<li><code>Hueckel</code> </li>
<li><code>PAtom</code></li>
<li><code>PModel</code></li>
<li><code>MORead</code></li>
</ul>
</li>
</ul>
</li>
</ul>
]]></content>
      <categories>
        <category>计算化学</category>
        <category>软件</category>
      </categories>
      <tags>
        <tag>输入</tag>
        <tag>ORCA</tag>
        <tag>内存</tag>
      </tags>
  </entry>
  <entry>
    <title>【ORCA】03.基组</title>
    <url>/2020/09/05/%E3%80%90ORCA%E3%80%9103.%E5%9F%BA%E7%BB%84/</url>
    <content><![CDATA[<h1 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h1><ul>
<li>orca中的标准基组列于<strong>6.3.1 Standard basis set library</strong>中的<strong>Table 6.3</strong>，可以直接作为关键词输入，没有的也可以在输入中用多种方法指定。</li>
<li>辅助基组用于RI-J RI-MP2的列于<strong>6.3.1 Standard basis set library</strong>中的<strong>Table 6.4</strong>，也可以直接作为关键词输入。</li>
<li>在<strong>9.4.1 Built-in Basis Sets</strong>的<strong>Table 9.8: Basis sets availability</strong>中也列出了所有的基组和适用的元素。</li>
</ul>
<ul>
<li>大多数HF/DFT计算推荐 Karlsruhe group的def2系列。能量和几何通常在DFT水平上用a balanced polarized triple-zeta basis set (such as def2-TZVP) 相当收敛，但是MP2和其他post-HF波函数理论方法收敛速度较慢。</li>
<li>对于某些分子性质，可能需要特殊的基组和/或uncontracted basis sets ：化学位移，自旋-自旋耦合，电场梯度，超精细耦合等。</li>
<li><p>坚持使用一个族中并适用于系统中所有元素的基组。来自不同族的混合和匹配基组可能会导致问题。推荐涵盖大部分元素周期表的 <a href="http://dx.doi.org/10.1039/B508541A">Ahlrichs def2 basis set family</a> 进行DFT计算。该基组在DFT计算中比旧的Ahlrichs系列（文献中称为XVP或def-XVP，其中X可以是S，TZ，QZ）或分裂价Pople基组（6-31G，6-311G）更可靠。优点还在于，可以容易地获得针对该基组系列（与RI-J，RI-JK和RIJCOSX近似值一起使用）进行适当设计和测试的辅助基组。</p>
</li>
<li><p>ORCA始终<strong>使用纯d和f函数（5d函数和7f函数</strong>，而不是6d函数和10r函数）。与与其他程序（默认值为6d函数和10f函数）的结果进行比较时很重要。</p>
</li>
</ul>
<p>通常建议：</p>
<p><img src="image-20210130180255629.png" alt=""></p>
<ul>
<li><p>自己指定的时候应使用<code>Printbasis</code>关键字来确检查分子的最终基组是否正确。orca接受不规范的基组格式并规范，可以用<code>!printbasis</code>来输出，也可以用</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">%output print[p basis] <span class="number">2</span> end</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h1 id="指定方法"><a href="#指定方法" class="headerlink" title="指定方法"></a>指定方法</h1><h2 id="通过-关键词指定"><a href="#通过-关键词指定" class="headerlink" title="通过!关键词指定"></a>通过<code>!关键词</code>指定</h2><p>关键词比如：</p>
<ul>
<li>def2-SVP, def2-TZVP, def2-TZVPP, def2-QZVPP,</li>
<li>ma-def2-SVP, ma-def2-TZVP, ma-def2-TZVPP, ma-def2-QZVPP,</li>
<li>cc-pVnZ, aug-cc-pVnZ, cc-pCVnZ, aug-cc-pCVnZ (n= D,T,Q,5,6)</li>
</ul>
<h2 id="通过-basis"><a href="#通过-basis" class="headerlink" title="通过%basis"></a>通过<code>%basis</code></h2><ul>
<li>注意有双引号</li>
</ul>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">%basis</span><br><span class="line">    Basis  <span class="string">&quot;Def2-TZVP&quot;</span></span><br><span class="line">    AuxJ   <span class="string">&quot;Def2/]&quot;</span></span><br><span class="line">    AuxJK  <span class="string">&quot;Def2/〕K&quot;</span></span><br><span class="line">    AuxC   <span class="string">&quot;Def2-TZVP/C&quot;</span></span><br><span class="line">    CABS    <span class="string">&quot;cc-pVDZ-F12-OptRI&quot;</span> <span class="meta">#for F12 calculations</span></span><br><span class="line">end</span><br></pre></td></tr></table></figure>
<h3 id="基组decontract"><a href="#基组decontract" class="headerlink" title="基组decontract"></a><del>基组decontract</del></h3><ul>
<li><p>ORCA will delete duplicate primitives if the basis set comes from a general contraction scheme：if your basis set arises from general contraction it will contain duplicate primitives in several contractions and these will be removed such that only unique primitives remain and there is no problem with redundancy.</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">%basis</span><br><span class="line">	DecontractBas <span class="literal">false</span> <span class="meta"># <span class="meta-keyword">if</span> chosen <span class="meta-string">&quot;true&quot;</span> the program will decontract the orbital basis set</span></span><br><span class="line">	DecontractAuxJ <span class="literal">false</span> <span class="meta"># <span class="meta-keyword">if</span> <span class="meta-string">&quot;true&quot;</span> - decontract the AuxJ basis set</span></span><br><span class="line">	DecontractAuxJK <span class="literal">false</span> <span class="meta"># <span class="meta-keyword">if</span> <span class="meta-string">&quot;true&quot;</span> - decontract the AuxJK basis set</span></span><br><span class="line">	DecontractAuxC <span class="literal">false</span> <span class="meta"># <span class="meta-keyword">if</span> <span class="meta-string">&quot;true&quot;</span> - decontract the AuxC basis set</span></span><br><span class="line">	DecontractCABS <span class="literal">true</span> <span class="meta"># <span class="meta-keyword">if</span> <span class="meta-string">&quot;false&quot;</span> - do not decontract the CABS</span></span><br><span class="line">	Decontract <span class="literal">false</span> <span class="meta"># <span class="meta-keyword">if</span> <span class="meta-string">&quot;true&quot;</span> - decontract all basis sets</span></span><br><span class="line">end</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="为不同元素指定不同基组"><a href="#为不同元素指定不同基组" class="headerlink" title="为不同元素指定不同基组"></a>为不同元素指定不同基组</h3><ul>
<li><p><code>newgto</code>和<code>addgto</code>关键字需要单独的<code>end</code>语句</p>
</li>
<li><p><code>newgto</code>中的元素符号也可以用元素序号，比如<code>C</code>用<code>6</code> </p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">! BP86 def2-SVP def2/J TIGHTSCF printbasis</span><br><span class="line">%basis</span><br><span class="line">	newgto C <span class="string">&quot;def2-TZVP&quot;</span> end</span><br><span class="line">end</span><br></pre></td></tr></table></figure>
</li>
<li><p>如果要在<code>％basis</code>块中手动指定基组，基组输入文件的格式基本上是来自Gamess-US的EMSL库的格式</p>
<ul>
<li>第一行是第一角动量（s、p、d、f、g、h、i、j）和原始基函数的数目，接着每个原始基函数为一行<ul>
<li>第一列（1，2……）是原始基函数的序号，第二列是原始基函数的指数，第三列是没有归一化的收缩系数</li>
<li>ORCA总是使用球谐高斯函数。<a href="#LShell">L壳层(不要与角动量等于9混淆)是具有相同指数的s壳层和p壳层</a></li>
</ul>
</li>
<li>还有可能在第一行的原始基函数的数目之后包含一个<code>SCALE X</code>语句，以指示基函数指数应该被收缩 </li>
</ul>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">! BP86 def2-SVP def2/J TIGHTSCF printbasis</span><br><span class="line">%basis</span><br><span class="line">newgto C</span><br><span class="line">S   <span class="number">6</span></span><br><span class="line">  <span class="number">1</span>  <span class="number">13575.3496820</span>              <span class="number">0.22245814352E-03</span>      </span><br><span class="line">  <span class="number">2</span>   <span class="number">2035.2333680</span>              <span class="number">0.17232738252E-02</span>      </span><br><span class="line">  <span class="number">3</span>    <span class="number">463.22562359</span>             <span class="number">0.89255715314E-02</span>      </span><br><span class="line">  <span class="number">4</span>    <span class="number">131.20019598</span>             <span class="number">0.35727984502E-01</span>      </span><br><span class="line">  <span class="number">5</span>     <span class="number">42.853015891</span>            <span class="number">0.11076259931</span>    </span><br><span class="line">  <span class="number">6</span>     <span class="number">15.584185766</span>            <span class="number">0.24295627626</span>    </span><br><span class="line">S   <span class="number">2</span></span><br><span class="line">  <span class="number">1</span>      <span class="number">6.2067138508</span>           <span class="number">0.41440263448</span>    </span><br><span class="line">  <span class="number">2</span>      <span class="number">2.5764896527</span>           <span class="number">0.23744968655</span>    </span><br><span class="line">S   <span class="number">1</span></span><br><span class="line">  <span class="number">1</span>      <span class="number">0.57696339419</span>          <span class="number">1.0000000</span></span><br><span class="line">...etc...</span><br><span class="line">end</span><br><span class="line">end #Don<span class="number">&#x27;</span>t forget the two <span class="string">&quot;end&quot;</span> keywords!</span><br></pre></td></tr></table></figure>
</li>
</ul>
<ul>
<li><p>还可以使用<code>AddGTO</code>关键字添加基函数，比如不想使用标准极化函数</p>
<ul>
<li><p>例子：向所有碳原子添加指数为0.101的d极化函数</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">! BP86 def2-SVP def2/J TIGHTSCF printbasis</span><br><span class="line">%basis</span><br><span class="line">	addgto C </span><br><span class="line">		D   <span class="number">1</span></span><br><span class="line">  		<span class="number">1</span>      <span class="number">0.1010000</span>              <span class="number">1.0000000</span></span><br><span class="line">	end</span><br><span class="line">end</span><br></pre></td></tr></table></figure>
</li>
<li><p>也可以用基组的名称：</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">#给O指定<span class="number">6</span><span class="number">-31</span>G，然后再加入一个指数为<span class="number">0.4</span>的极化函数</span><br><span class="line">%basis</span><br><span class="line">    NewGTO <span class="number">8</span> <span class="meta"># new basis for oxygen</span></span><br><span class="line">    	<span class="string">&quot;6-31G&quot;</span></span><br><span class="line">    	D <span class="number">1</span></span><br><span class="line">    	<span class="number">1</span> <span class="number">0.4</span> <span class="number">1.0</span></span><br><span class="line">	end</span><br><span class="line">end</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>使用<code>NewGTO</code>不会改变元素的<code>ECP</code>，需要使用<code>NewECP</code>或者<code>DelECP</code>，  </p>
</li>
<li><p>辅助基组<code>NewAuxJGTO</code>的用法类似，关键词还有：<code>NewAuxCGTO</code><strong>, </strong><code>AddAuxCGTO</code>, <code>NewAuxJKGTO</code><strong>, </strong><code>AddAuxJKGTO</code>, <code>NewCABSGTO</code><strong>, </strong><code>AddCABSGTO</code></p>
<ul>
<li><code>NewAuxGTO</code>和<code>AddAuxGTO</code>与<code>NewAuxJGTO</code>和<code>AddAuxJGTO</code>一样，只影响库伦辅助基组（/J）</li>
</ul>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">%basis</span><br><span class="line">    NewAuxJGTO <span class="number">8</span> <span class="meta"># new auxiliary basis for oxygen</span></span><br><span class="line">        s <span class="number">1</span></span><br><span class="line">        <span class="number">1</span> <span class="number">350</span> <span class="number">1.0</span></span><br><span class="line">        ... etc</span><br><span class="line">    end</span><br><span class="line">    AddAuxJGTO <span class="number">8</span> <span class="meta"># add a shell to the auxiliary basis for oxygen</span></span><br><span class="line">        D <span class="number">1</span></span><br><span class="line">        <span class="number">1</span> <span class="number">0.8</span> <span class="number">1.0</span></span><br><span class="line">    end</span><br><span class="line">end</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="通过坐标部分为不同原子指定"><a href="#通过坐标部分为不同原子指定" class="headerlink" title="通过坐标部分为不同原子指定"></a>通过坐标部分为不同原子指定</h2><ul>
<li>如果要在特定原子（而不是元素）上放置不同的基组，则可以通过将<code>newgto</code>关键字添加到坐标部分来做到这一点<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">! BP86 ZORA ZORA-def2-SVP SARC/J TIGHTSCF printbasis</span><br><span class="line">*xyz <span class="number">0</span> <span class="number">1</span></span><br><span class="line">H <span class="number">0.0</span> <span class="number">0.0</span> <span class="number">0.0</span></span><br><span class="line">H <span class="number">0.0</span> <span class="number">0.0</span> <span class="number">1.0</span> newgto <span class="string">&quot;ZORA-def2-TZVP&quot;</span> end </span><br><span class="line">*</span><br></pre></td></tr></table></figure></li>
<li><p>类似的方式使用<code>AddGTO</code>关键字，向特定原子添加额外的基函数</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">! BP86 ZORA def2-SVP SARC/J TIGHTSCF printbasis</span><br><span class="line">*xyz <span class="number">0</span> <span class="number">1</span></span><br><span class="line">H <span class="number">0.0</span> <span class="number">0.0</span> <span class="number">0.0</span></span><br><span class="line">H <span class="number">0.0</span> <span class="number">0.0</span> <span class="number">1.0</span> </span><br><span class="line">addgto</span><br><span class="line">P   <span class="number">1</span></span><br><span class="line">  <span class="number">1</span>      <span class="number">0.0356900</span>              <span class="number">1.0000000</span></span><br><span class="line">end</span><br><span class="line">*</span><br></pre></td></tr></table></figure></li>
<li>也可以在<code>%coords</code>中指定：<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">#为C增加指数为<span class="number">1</span>的d层，为O新指定<span class="number">6</span><span class="number">-311</span>G基组并增加指数为<span class="number">1.2</span>的d层</span><br><span class="line">%coords</span><br><span class="line">    CTyp = Internal; </span><br><span class="line">    Units = Angs;</span><br><span class="line">    Charge = <span class="number">0</span>; </span><br><span class="line">    Mult = <span class="number">1</span>;</span><br><span class="line">    Coords <span class="meta"># start coordinate assignments</span></span><br><span class="line">        C(<span class="number">1</span>) <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0.00</span> <span class="number">0.0</span> <span class="number">0.00</span></span><br><span class="line">            AddGTO</span><br><span class="line">            D <span class="number">1</span></span><br><span class="line">            <span class="number">1</span> <span class="number">1.0</span> <span class="number">1.0</span></span><br><span class="line">       end;</span><br><span class="line">        O(<span class="number">2</span>) <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1.13</span> <span class="number">0.0</span> <span class="number">0.00</span></span><br><span class="line">            NewGTO</span><br><span class="line">               <span class="string">&quot;6-311G&quot;</span></span><br><span class="line">               D <span class="number">1</span></span><br><span class="line">                <span class="number">1</span> <span class="number">1.2</span> <span class="number">1.0</span></span><br><span class="line">             end;</span><br><span class="line">     end;</span><br><span class="line">end</span><br></pre></td></tr></table></figure></li>
<li>类似的辅助基组<code>NewAuxJGTO</code>,<code>AddAuxJGTO</code>,<code>NewAuxCGTO</code>, <code>AddAuxCGTO</code>, <code>NewAuxJKGTO</code>, <code>AddAuxJKGTO</code>, <code>NewCABSGTO</code>, <code>AddCABSGTO</code>也是相同用法：</li>
<li><p>如果给一个指定原子改变了基组，并且想自动AutoAux，即使AutoAux已经在<code>%basis</code>中指定了，也必须重新在<code>%coords</code>部分重新指定。</p>
<ul>
<li>eg，O指定了Def2-SVP和Def2/JK，第一个H指定了Def2-SVP和自动的”AutoAux”，第二个H指定了Def2-SVP和两个增加的极化函数，和一个更大的对所有这些函数自动辅助基组。</li>
</ul>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">! Def2-SVP Def2/JK</span><br><span class="line">%basis</span><br><span class="line">    NewAuxJKGTO H <span class="string">&quot;AutoAux&quot;</span> end</span><br><span class="line">end</span><br><span class="line">%coords</span><br><span class="line">    Coords</span><br><span class="line">    	O <span class="number">0.00</span> <span class="number">0.00</span> <span class="number">0.00</span></span><br><span class="line">    	H <span class="number">-0.25</span> <span class="number">0.93</span> <span class="number">0.00</span></span><br><span class="line">    	H <span class="number">0.96</span> <span class="number">0.00</span> <span class="number">0.00</span></span><br><span class="line">    	AddGTO</span><br><span class="line">        	P <span class="number">1</span></span><br><span class="line">        	<span class="number">1</span> <span class="number">1.6</span> <span class="number">1.0</span></span><br><span class="line">        	D <span class="number">1</span></span><br><span class="line">        	<span class="number">1</span> <span class="number">1.0</span> <span class="number">1.0</span></span><br><span class="line">        end</span><br><span class="line">   		NewAuxJKGTO </span><br><span class="line">    		<span class="string">&quot;AutoAux&quot;</span> </span><br><span class="line">    	end</span><br><span class="line">    end</span><br><span class="line">end</span><br></pre></td></tr></table></figure>
<h2 id="从文件中读取基组"><a href="#从文件中读取基组" class="headerlink" title="从文件中读取基组"></a>从文件中读取基组</h2></li>
<li><p>缺点是不能给同一元素的不同原子分配不同的基组</p>
</li>
<li><p>通过复制和粘贴使用<code>printbasis</code>关键字打印的基组输出，可以方便地创建基组文件。</p>
</li>
<li><p>可以用<code>GTOName</code>, <code>GTOAuxJName</code>（=<code>GTOAuxName</code>）, <code>GTOAuxJKName</code>，<code>GTOAuxCName</code>：</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">%basis</span><br><span class="line">    GTOName = <span class="string">&quot;MyBasis.bas&quot;</span></span><br><span class="line">    GTOAuxJName = <span class="string">&quot;MyAuxJBasis.bas&quot;</span></span><br><span class="line">    GTOAuxJKName = <span class="string">&quot;MyAuxJKBasis.bas&quot;</span></span><br><span class="line">    GTOAuxCName = <span class="string">&quot;MyAuxCBasis.bas&quot;</span></span><br><span class="line">    STOName = <span class="string">&quot;MySTOBasis.bas&quot;</span></span><br><span class="line">end</span><br></pre></td></tr></table></figure>
</li>
<li><p>文件格式是”GAMESS-US“ in the EMSL library，也可以自己编辑基组，辅助基组的格式也相同。</p>
<ul>
<li><p>比如Buenker的3-21GSP：<a id="LShell"></a></p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="number">3</span><span class="number">-21</span>GSP</span><br><span class="line">! !开头的都是注释</span><br><span class="line">! BASIS=<span class="string">&quot;3-21GSP&quot;</span></span><br><span class="line">!Elements References</span><br><span class="line">!-------- ----------</span><br><span class="line">! H - Ne: A.V. Mitin, G. Hirsch, R. J. Buenker, Chem. Phys. Lett. <span class="number">259</span>, <span class="number">151</span> (<span class="number">1996</span>)</span><br><span class="line">! Na - Ar: A.V. Mitin, G. Hirsch, R. J. Buenker, J. Comp. Chem. <span class="number">18</span>, <span class="number">1200</span> (<span class="number">1997</span>).</span><br><span class="line">!</span><br><span class="line">HYDROGEN ! (<span class="number">3</span>s) -&gt; [<span class="number">2</span>s]</span><br><span class="line">	S <span class="number">2</span></span><br><span class="line">		<span class="number">1</span> <span class="number">4.50036231</span> <span class="number">0.15631167</span></span><br><span class="line">		<span class="number">2</span> <span class="number">0.68128924</span> <span class="number">0.90466909</span></span><br><span class="line">	S <span class="number">1</span></span><br><span class="line">		<span class="number">1</span> <span class="number">0.15137639</span> <span class="number">1.00000000</span></span><br><span class="line">CARBON ! (<span class="number">6</span>s,<span class="number">3</span>p) -&gt; [<span class="number">3</span>s,<span class="number">2</span>p]</span><br><span class="line">	S <span class="number">3</span></span><br><span class="line">		<span class="number">1</span> <span class="number">499.24042249</span> <span class="number">0.03330322</span></span><br><span class="line">		<span class="number">2</span> <span class="number">75.25419194</span> <span class="number">0.23617745</span></span><br><span class="line">		<span class="number">3</span> <span class="number">16.86538669</span> <span class="number">0.81336259</span></span><br><span class="line">	L <span class="number">2</span> （L是一个具有相同指数的s和p壳层）</span><br><span class="line">		<span class="number">1</span> <span class="number">0.89739483</span> <span class="number">0.24008573</span> <span class="number">0.46214684</span></span><br><span class="line">		<span class="number">2</span> <span class="number">0.21746772</span> <span class="number">0.81603757</span> <span class="number">0.66529098</span></span><br><span class="line">	L <span class="number">1</span></span><br><span class="line">		<span class="number">1</span> <span class="number">4.52660451</span> <span class="number">1.00000000</span> <span class="number">1.00000000</span></span><br><span class="line">STOP</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h2 id="弥散基组"><a href="#弥散基组" class="headerlink" title="弥散基组"></a>弥散基组</h2><h1 id="辅助基组"><a href="#辅助基组" class="headerlink" title="辅助基组"></a>辅助基组</h1><ul>
<li>ORCA包含许多近似，这些近似旨在显着加快计算速度，同时由于这些近似值而在计算中引入非常小的误差（通常小于基本集误差，并且小于电子结构方法误差）。这些近似通常近似各种积分，例如库仑，HF交换，MP2积分等。大多数近似都是基于 Resolution of Identity（RI）近似值（也称为密度拟合）。使用这些近似值将大大加快ORCA计算速度，因此通常建议使用。通常可以在有或没有这些近似值的情况下执行计算。</li>
<li>RI近似的使用总是需要一个辅助基组，它的选择取决于被近似的积分和被使用的基组。</li>
<li>如果不想使用RI近似，可以先计算一个RI-J近似计算，再使用该轨道作为初猜去计算精确的库伦项，SCF也会很快收敛，比直接精确计算库伦项耗时会更短。</li>
</ul>
<h2 id="只存在库仑积分的RI-J近似"><a href="#只存在库仑积分的RI-J近似" class="headerlink" title="只存在库仑积分的RI-J近似"></a>只存在库仑积分的RI-J近似</h2><ul>
<li>RI-J近似用于近似库仑积分（J）。因为在所有计算中都存在库仑积分时，通常可以始终使用RI-J近似。纯泛函应该用RI加速而不是RIJCOSX。GGA-DFT计算默认情况下启用RI-J近似，因此不需要再指定。<code>NORI</code>关键字可用于关闭近似。</li>
<li><p>Split-RI-J算法是RI-J算法的改进版本，通常更快，对内存的需求仅稍微多一点。仅用于SCF过程（不用于梯度，耦合的扰动方程式和TD-DFT）。要关闭<code>!NoSplit-RI-J</code>。</p>
</li>
<li><p>指定辅助基组：</p>
<ul>
<li><p>def2/J：通用辅助基组by Weigend</p>
</li>
<li><p>SARC/J：用于ZORA/DKH中</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">! BP86 def2-TZVP def2/J</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h2 id="同时存在库仑和交换积分的HF和杂化泛函方法（以及post-HF中的HF步）"><a href="#同时存在库仑和交换积分的HF和杂化泛函方法（以及post-HF中的HF步）" class="headerlink" title="同时存在库仑和交换积分的HF和杂化泛函方法（以及post-HF中的HF步）"></a>同时存在库仑和交换积分的HF和杂化泛函方法（以及post-HF中的HF步）</h2><ul>
<li>HF和杂化泛函方法（例如B3LYP）的默认值为：<code>NORI</code>，即对库仑或交换积分均不近似。</li>
</ul>
<h3 id="RIJONX库仑近似（对交换无近似）"><a href="#RIJONX库仑近似（对交换无近似）" class="headerlink" title="RIJONX库仑近似（对交换无近似）"></a>RIJONX库仑近似（对交换无近似）</h3><ul>
<li><p>使用<code>RIJONX</code>用于库伦积分近似，对HF交换不使用。加快库仑积分的速度，但仍保留昂贵的HF交换积分。如今通常不常用。</p>
</li>
<li><p>基组：</p>
<ul>
<li>def2/J</li>
<li>对于ZORA/DKH计算：使用 <code>SARC/J</code> 关键字代替decontracted 辅助基组</li>
</ul>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">! B3LYP  def2-QZVP def2/J RIJONX</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="RI-JK近似（对库伦和交换近似）"><a href="#RI-JK近似（对库伦和交换近似）" class="headerlink" title="RI-JK近似（对库伦和交换近似）"></a>RI-JK近似（对库伦和交换近似）</h3><ul>
<li><code>!RIJK</code>可以用于库仑和HF交换积分，从而比<code>RIJONX</code>更快，可用于用SCF能量和梯度（即几何优化）。</li>
<li><p>对于中小型分子，<code>RIJK</code>比<code>RIJCOSX</code>近似更快，但是随着分子变大，<code>RIJCOSX</code>的效率更高。 但是与<code>RIJCOSX</code>相比，误差更小，更平滑（通常低于1 mEh）。缺点是非限制（UHF / UKS）RIJK比限制（RHF / RKS）RIJK的贵两倍，而RIJCOSX则不。</p>
</li>
<li><p>需要一个较大的辅助基组（def2/J太小），仅使用旨在与RIJK近似配合使用的辅助基组（否则将获得相当大的RIJK误差）：</p>
<ul>
<li><code>def2/JK</code>, <code>cc-pVnZ/JK</code>, <code>aug-cc-pVnZ/JK</code> (n=T,Q,5)</li>
</ul>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">! B3LYP  def2-QZVP def2/JK RIJK</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="RIJCOSX近似（库伦用RI-J近似，交换用COSX数值积分）"><a href="#RIJCOSX近似（库伦用RI-J近似，交换用COSX数值积分）" class="headerlink" title="RIJCOSX近似（库伦用RI-J近似，交换用COSX数值积分）"></a>RIJCOSX近似（库伦用RI-J近似，交换用COSX数值积分）</h3><ul>
<li><p><code>！RIJCOSX</code>对HF交换用numerical chain-of-sphere integration（COSX），大大加快速度。用于COSX数值积分默认的COSX网格可以通过<code>!GridXn</code>更改。</p>
</li>
<li><p>通常推荐（但对于小分子，RIJK可能更好）。</p>
</li>
<li><p>需要<code>RI-J</code> 的辅助基组：</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">! B3LYP  def2-QZVP def2/J RIJCOSX</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="RI-MP2近似（对MP2积分）相关C"><a href="#RI-MP2近似（对MP2积分）相关C" class="headerlink" title="RI-MP2近似（对MP2积分）相关C"></a>RI-MP2近似（对MP2积分）相关C</h2><ul>
<li><p>传统的MP2计算可能非常昂贵，一般不推荐使用。对于MP2积分使用RI近似<code>!RI-MP2</code>可以大大加快计算速度</p>
</li>
<li><p>需要RI-C辅助基组（/C）用于<strong>相关拟合</strong>（MP2和耦合簇），注意，不同于一般的def2/J和def2/JK辅助基组，有多个RI-C辅助基组可用，应该根据所使用的轨道基组(或可能使用更大的/C辅助基组)来选择：</p>
<p><img src="image-20210205163145343.png" alt=""></p>
</li>
<li><p>注意，因为一个MP2计算(post-HF方法)是以HF开始的（含有库伦和HF交换积分），因此前述(RIJONX / RIJK / RIJCOSX)也可以使用进行加速，这就需要指定多个关键字：</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">#常规MP2</span><br><span class="line">! MP2 def2-TZVP</span><br><span class="line"></span><br><span class="line">#对HF没有近似</span><br><span class="line">! RI-MP2 def2-TZVP def2-TZVP/C</span><br><span class="line"></span><br><span class="line">#对HF使用RIJK近似</span><br><span class="line">! RI-MP2 def2-TZVP def2-TZVP/C RIJK def2/JK</span><br><span class="line"></span><br><span class="line">#对HF使用RIJCOSX近似</span><br><span class="line">! RI-MP2 def2-TZVP def2-TZVP/C RIJCOSX def2/J</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="积分变换中的RI"><a href="#积分变换中的RI" class="headerlink" title="积分变换中的RI"></a>积分变换中的RI</h2><ul>
<li>RI近似被用于ORCA的积分变换，特别是在波函数理论方法中，例如DLPNO耦合簇。需要使用用户提供的辅助基组。一般建议使用/C辅助基组。</li>
</ul>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">! DLPNO-CCSD(T) def2-TZVP def2-TZVP/C</span><br></pre></td></tr></table></figure>
<h2 id="误差和准确性"><a href="#误差和准确性" class="headerlink" title="误差和准确性"></a>误差和准确性</h2><ul>
<li><p>会引入RI error ，受限于辅助基组的大小。</p>
</li>
<li><p>由于始终存在一些RI error，因此RI和NORI计算得出的绝对能量可能会有所不同。</p>
</li>
<li><p>RI 误差是系统ing的，在计算相对能量会抵消。但是有些分子性质可能是绝对值，对RI误差很敏感。</p>
</li>
<li><p>RIJCOSX不仅有RI误差，还有COSX误差，这取决于COSX的格点大小、</p>
</li>
<li><p>测试RI类型错误是否为提供了不可忽略的错误的最简单方法是进行测试计算，有或没有近似值来计算。删除所有RI类型的关键字和所有辅助基组（对于GGA DFT计算，要使用 <code>NORI</code>关键字，其中RI为默认值），还可以选择更大的辅助基组或解压缩辅助基组（<strong>DecontractAux</strong>），这将减少RI误差，特别是对于核性质。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">! BP86 def2-TZVP def2/J DecontractAux</span><br></pre></td></tr></table></figure>
</li>
<li><p>通常，RI近似值在以最小误差加速计算方面做得很好。注意，比较有RI近似和没有RI近似的绝对总能量有时会告诉你很少的东西(总能量中总会有相当大的RI误差)。通常最好比较直接的能量差(如:反应能量)，几何或分子性质，来看看近似的效果有多好。</p>
</li>
</ul>
<h2 id="自动生成辅助基组"><a href="#自动生成辅助基组" class="headerlink" title="自动生成辅助基组"></a>自动生成辅助基组</h2><ul>
<li><p>AutoAux会根据您选择的轨道基组创建一个大型辅助基组，它旨在为没有优化辅助基组的情况提供准确的辅助基组。不确定或非标准轨道基的安全选择。</p>
</li>
<li><p>自动构造一种通用辅助基组，可同时进行库仑拟合、交换和相关计算，和优化后的辅助基组精度相同，但是花费会是优化后的两倍。</p>
</li>
<li><p>AutoAux的辅助基组通常比优化后的基组大，所以AutoAux最好是在优化后的辅助基组不可用的情况下使用(例如，一个特殊的外来元素)，或者可能用于检查辅助基组的依赖性。</p>
</li>
<li><p>可以直接使用关键词，也可以在<code>%basis</code>中指定</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">! AutoAux</span><br></pre></td></tr></table></figure>
</li>
<li><p>AutoAux的一些附加设置及其默认值：</p>
<ul>
<li><code>AutoAuxSize</code>中：<ul>
<li>1：默认，增加低角动量壳层的最大指数</li>
<li>2：增加所有壳层的最大指数</li>
<li>3：直接使用原始产生最大的拟合基组</li>
</ul>
</li>
</ul>
</li>
</ul>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">%basis</span><br><span class="line">    Aux <span class="string">&quot;AutoAux&quot;</span> #使用自动生成辅助基组</span><br><span class="line">    AutoAuxSize <span class="number">1</span> </span><br><span class="line">    AutoAuxLmax <span class="literal">false</span> #True则将拟合基组的最大角动量增加到ORCA和轨道基组允许的最大值。</span><br><span class="line">    OldAutoAux <span class="literal">false</span>  #Ture则选择orca3<span class="number">.1</span>的生成过程</span><br><span class="line">	</span><br><span class="line">    # Only change the defaults below <span class="keyword">if</span> you know what you are doing</span><br><span class="line">    </span><br><span class="line">    AutoAuxF[<span class="number">0</span>] <span class="number">20.0</span>  # 增加最大s指数的因子</span><br><span class="line">    AutoAuxF[<span class="number">1</span>] <span class="number">7.0</span>   # Same <span class="keyword">for</span> the p-shell</span><br><span class="line">    AutoAuxF[<span class="number">2</span>] <span class="number">4.0</span>   <span class="meta"># d-shell</span></span><br><span class="line">    AutoAuxF[<span class="number">3</span>] <span class="number">4.0</span>  <span class="meta"># f-shell</span></span><br><span class="line">    AutoAuxF[<span class="number">4</span>] <span class="number">3.5</span>  <span class="meta"># g-shell</span></span><br><span class="line">    AutoAuxF[<span class="number">5</span>] <span class="number">2.5</span>  <span class="meta"># h-shell</span></span><br><span class="line">    AutoAuxF[<span class="number">6</span>] <span class="number">2.0</span>  <span class="meta"># i-shell</span></span><br><span class="line">    AutoAuxF[<span class="number">7</span>] <span class="number">2.0</span>  <span class="meta"># j-shell</span></span><br><span class="line">    </span><br><span class="line">    AutoAuxB[<span class="number">0</span>] <span class="number">1.8</span> <span class="meta"># s壳层的均匀膨胀系数</span></span><br><span class="line">    AutoAuxB[<span class="number">1</span>] <span class="number">2.0</span> # Same <span class="keyword">for</span> the p-shell</span><br><span class="line">    AutoAuxB[<span class="number">2</span>] <span class="number">2.2</span> <span class="meta"># d-shell</span></span><br><span class="line">    AutoAuxB[<span class="number">3</span>] <span class="number">2.2</span> <span class="meta"># f-shell</span></span><br><span class="line">    AutoAuxB[<span class="number">4</span>] <span class="number">2.2</span> <span class="meta"># g-shell</span></span><br><span class="line">    AutoAuxB[<span class="number">5</span>] <span class="number">2.3</span> <span class="meta"># h-shell</span></span><br><span class="line">    AutoAuxB[<span class="number">6</span>] <span class="number">3.0</span> <span class="meta"># i-shell</span></span><br><span class="line">    AutoAuxB[<span class="number">7</span>] <span class="number">3.0</span> <span class="meta"># j-shell</span></span><br><span class="line">    </span><br><span class="line">    AutoAuxTightB <span class="literal">true</span> # 对于高l的壳只使用B[l]，对于其余壳只使用B[<span class="number">0</span>]</span><br><span class="line">end</span><br></pre></td></tr></table></figure>
<h2 id="弥散轨道基组的基组"><a href="#弥散轨道基组的基组" class="headerlink" title="弥散轨道基组的基组"></a>弥散轨道基组的基组</h2><ul>
<li>如果要结合RI-J，RI-JK或RIJCOSX近似使用弥散基组，诸如def2 / J或def2 / JK之类的非增强辅助基组将不再适用。这将取决于系统（阴离子最有可能出现问题）。为了安全起见，前面提到的<code>!AutoAux</code>通常会提供准确但昂贵的辅助基基组。或者可以向辅助基组添加弥散功能，但AutoAux应该是一种更安全，更轻松的选择。</li>
<li><p>但是有时AutoAux过程会生成一个与线性相关的辅助基组，这将导致ORCA崩溃（’Error in Cholesky Decomposition of V Matrix’）。在这种情况下，可以尝试使用可能足够大的常规辅助基组def2 / J或def2 / JK（可以通过与NORI计算进行比较来进行检查），将弥散手动添加到def2 / J或def2 / JK或修改辅助基组的AutoAux创建，例如像下面这样可以减少线性依赖性：</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">%basis</span><br><span class="line">AutoAuxB[<span class="number">0</span>] <span class="number">2.0</span></span><br><span class="line">end</span><br></pre></td></tr></table></figure>
</li>
<li><p>同样重要的是如果使用的是RIJCOSX近似值，那么使用扩散基组时默认的COSX格点有时可能不够用。</p>
</li>
<li>对于ma-def2系列，由于没有标配的辅助基组，所以会自动用autoaux关键词来自动构建。仅B97-3c和CCSD(T)-F12/cc-pVDZ with RI没法加弥散函数。</li>
</ul>
<h1 id="ECP"><a href="#ECP" class="headerlink" title="ECP"></a>ECP</h1><ul>
<li>如果涉及重元素，是标量相对论全电子计算的一个很好的替代方法。但是ECP并不是计算重元素的最准确方法，更精确的是标量相对论全电子方法。如果想要对重元素进行全电子描述，则建议使用标量相对论近似（ZORA或DKH）。对ECP进行参数化以隐式地考虑相对论效应不一定很准确，只有小核ECP较准。</li>
<li>化学上不相关的核电子不是电子问题的明确组成部分，可以由ECP代替。主要用于几何优化和能量计算，在性质计算中可能会出错。</li>
</ul>
<h2 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h2><ul>
<li>为了减少计算量，通常高度收缩和化学惰性的核基组可以使用ECP，ECP计算只包含价层，因此符合冻核近似。核轨道的贡献被一个单电子算符<script type="math/tex">U^{core}</script>所解释，它取代了核和价电子之间的相互作用，并解释了电子的不可区分性。其径向部分<script type="math/tex">U_l(r)</script>一般表示为高斯函数的线性组合，而角动量算符<script type="math/tex">\left|S_{m}^{l}\right\rangle</script>则包含了角依赖关系。</li>
</ul>
<script type="math/tex; mode=display">
\begin{array}{c}
U^{\text {core }}=U_{L}(r)+\sum_{l=0}^{L-1} \sum_{m=-l}^{l}\left|S_{m}^{l}\right\rangle\left[U_{l}(r)-U_{L}(r)\right]\left\langle S_{m}^{l}\right| \\
U_{l}=\sum_{k} d_{k l} r^{n_{k l}} \exp \left(-\alpha_{k l} r^{2}\right)
\end{array}</script><ul>
<li>最大角动量<script type="math/tex">L</script>通常被定义为<script type="math/tex">l^{atom}_{max}+1</script>，评估ECP积分所必需的参数<script type="math/tex">n_{kl}</script>、<script type="math/tex">\alpha_{kl}</script>和<script type="math/tex">d_{kl}</script>参数有许多作者发表，其中著名的Los Alamos (LANL)和Stuttgart-Dresden (SD)参数集。依赖于ECP的具体参数化，相对论效应可以包括在半经验的方式，否则是非相对论计算。将<script type="math/tex">U^{core}</script>引入电子哈密顿量可以得到两种类型的ECP积分，一种是由最大角动量势<script type="math/tex">U_L</script>产生的局部积分，另一种是由投影势项产生的半局部积分。</li>
</ul>
<h2 id="适用范围"><a href="#适用范围" class="headerlink" title="适用范围"></a>适用范围</h2><ul>
<li>如果分子不包含重于Kr的元素，那么通常不应该使用ECP，应该使用全电子方法。对元素H-Kr使用def2-XVP或cc-pVnZ基本集，不会自动分配任何ECP。</li>
<li><p>不建议对第一个TM行原子使用LANL2DZ和SDD基组ECP组合，因为它们的准确性较差，非相对论/相对论全电子计算要好得多。</p>
</li>
<li><p>如果分子中含有一种重元素(比Kr重)，例如在典型的过渡金属配合物中，使用ECP可能没有太大的优势。使用全电子相对论近似可以获得更准确的结果，并且几乎一样快。</p>
</li>
<li>如果分子中含有很多重元素(比Kr重)，那么ECPs就有最大的优势(尽管梯度会变得昂贵)。使用全电子标量相对论方法的单点计算对于更精确的能量或性质计算更好。</li>
<li>在某些情况下要处理很重的元素以至于在使用全电子标量相对论方法（ZORA，DKH）时会遇到数值问题。使用ECP更好，特别是对于几何优化步骤。</li>
<li>对不同ECP的评估发现，一些流行的ECP不太准确。通常推荐the Stuttgart ECPs (e.g. the ones called ECPXXMWB in the <a href="http://www.theochem.uni-stuttgart.de/pseudopotentials/clickpse.en.html">Stuttgart library</a>, also called SDD or def2-SD)以及def2基组一起使用。另外，应该始终使用推荐的基组ECP组合，不要混合使用。</li>
<li>注意:Ahlrichs等人在def2基组论文中描述的def2-ECPs是Stuttgart ECPXXMWB potentials，只是跳过了ECPs的g-和更高的投影(因为此类投影在Turbomole中不可用)。而orca没有这个限制，所以全部的Stuttgart ECPs都被实现了。在比较相对能量时，这应该不会产生明显的差异，但是不同代码之间的绝对能量可能会不同。</li>
</ul>
<h2 id="指定方式"><a href="#指定方式" class="headerlink" title="指定方式"></a>指定方式</h2><ul>
<li><strong>各种指定方式 只包含了核，不包含价层，价层基组不要漏</strong></li>
</ul>
<h3 id="关键词"><a href="#关键词" class="headerlink" title="关键词"></a>关键词</h3><ul>
<li><p>用关键词指定ECP，orca中可用的ECP关键词列于<strong>6.3.3 Eective Core Potentials</strong>的<strong>Table 6.5</strong></p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">! def2-TZVP def2-SD</span><br></pre></td></tr></table></figure>
</li>
<li><p>对于<code>def2-X</code>基组，<code>def2-ECP</code>会自动用于重于Kr的元素，自动用的是Stuttgart-Dresden effective core potentials for elements Rb-Rn。上例中如果没有<code>def2-SD</code>，会自动分配<code>Def2-ECP</code></p>
</li>
<li><p>cc-pvnz-pp中也会自动分配ECP</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">! B3LYP def2-SVP printbasis</span><br><span class="line">* xyz <span class="number">0</span> <span class="number">1</span></span><br><span class="line">Mo <span class="number">0</span> <span class="number">0</span> <span class="number">0</span></span><br><span class="line">F  <span class="number">0</span> <span class="number">0</span> <span class="number">1</span></span><br><span class="line">C  <span class="number">0</span> <span class="number">0</span> <span class="number">2</span></span><br><span class="line">H <span class="number">0</span> <span class="number">0</span> <span class="number">3</span></span><br><span class="line">*</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>printbasis</code>关键字对于检查是否向每个元素添加了正确的基组和ECP非常有用。ORCA输出显示ECP被分配是：</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">Your calculation utilizes the basis: def2-SVP</span><br><span class="line">   F. Weigend <span class="keyword">and</span> R. Ahlrichs, Phys. Chem. Chem. Phys. <span class="number">7</span>, <span class="number">3297</span> (<span class="number">2005</span>).</span><br><span class="line"></span><br><span class="line">cite the ECPs <span class="keyword">for</span> Mo [Def2-ECP] as follows:</span><br><span class="line">Ce-Yb(ecp<span class="number">-28</span>): M. Dolg, H. Stoll, H.Preuss, J. Chem. Phys., <span class="number">1989</span>, <span class="number">90</span>, <span class="number">1730</span><span class="number">-1734.</span></span><br><span class="line">Y-Cd(ecp<span class="number">-28</span>), Hf-Hg(ecp<span class="number">-46</span>): D. Andrae,U. Haeussermann, M. Dolg, H. Stoll, H. Preuss, Theor. Chim. Acta, <span class="number">1990</span>, <span class="number">77</span>, <span class="number">123</span><span class="number">-141.</span></span><br><span class="line">In-Sb(ecp<span class="number">-28</span>), Tl-Bi(ecp<span class="number">-46</span>): B. Metz, H. Stoll, M. Dolg, J. Chem. Phys., <span class="number">2000</span>, <span class="number">113</span>, <span class="number">2563</span><span class="number">-2569.</span></span><br><span class="line">Te-Xe(ecp<span class="number">-28</span>), Po-Rn(ecp<span class="number">-46</span>): K. A. Peterson, D. Figgen, E. Goll, H. Stoll, M. Dolg, J. Chem. Phys., <span class="number">2003</span>, <span class="number">119</span>, <span class="number">11113</span><span class="number">-11123.</span></span><br><span class="line">Rb(ecp<span class="number">-28</span>), Cs(ecp<span class="number">-46</span>): T. Leininger, A. Nicklass, W. Kuechle, H. Stoll, M. Dolg, A. Bergner, Chem. Phys. Lett., <span class="number">1996</span>, <span class="number">255</span>, <span class="number">274</span><span class="number">-280.</span></span><br><span class="line">Sr(ecp<span class="number">-28</span>), Ba(ecp<span class="number">-46</span>): M. Kaupp, P. V. Schleyer, H. Stoll <span class="keyword">and</span> H. Preuss, J. Chem. Phys., <span class="number">1991</span>, <span class="number">94</span>, <span class="number">1360</span><span class="number">-1366.</span></span><br><span class="line">La(ecp<span class="number">-46</span>): M. Dolg, H. Stoll, A. Savin, H. Preuss, Theor. Chim. Acta, <span class="number">1989</span>, <span class="number">75</span>, <span class="number">173</span><span class="number">-194.</span></span><br><span class="line">Lu(ecp<span class="number">-28</span>): X. Cao, M. Dolg, J. Chem. Phys., <span class="number">2001</span>, <span class="number">115</span>, <span class="number">7348</span><span class="number">-7355.</span></span><br><span class="line"></span><br><span class="line">ECP parameters <span class="keyword">for</span> Mo [Def2-ECP] have been obtained from:</span><br><span class="line">TURBOMOLE (<span class="number">7.0</span><span class="number">.2</span>)</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line">-------------------------</span><br><span class="line">ECP PARAMETER INFORMATION</span><br><span class="line">-------------------------</span><br><span class="line"></span><br><span class="line"> Group <span class="number">1</span>, Type Mo ECP Def2-ECP (replacing <span class="number">28</span> core electrons, lmax=<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">Atom   <span class="number">0</span>Mo   ECP group =&gt;   <span class="number">1</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="basis"><a href="#basis" class="headerlink" title="%basis"></a>%basis</h3><ul>
<li><p>例子：在轻原子上指定较小的def2-SVP，在重元素上指定更大的基组和ECP：</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">! BP def2-SVP def2/J  printbasis</span><br><span class="line"></span><br><span class="line">%basis</span><br><span class="line">	newgto Mo <span class="string">&quot;def2-TZVP&quot;</span> end</span><br><span class="line">end</span><br><span class="line">    </span><br><span class="line">* xyz <span class="number">0</span> <span class="number">1</span></span><br><span class="line">Mo <span class="number">0</span> <span class="number">0</span> <span class="number">0</span></span><br><span class="line">F  <span class="number">0</span> <span class="number">0</span> <span class="number">1</span></span><br><span class="line">C  <span class="number">0</span> <span class="number">0</span> <span class="number">2</span></span><br><span class="line">H <span class="number">0</span> <span class="number">0</span> <span class="number">3</span></span><br><span class="line">*</span><br></pre></td></tr></table></figure>
</li>
<li><p>通过在<code>%basis</code>中通过<code>ECP</code>和<code>newECP</code>指定，只作用于ECP而不作用于价层上。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">%basis</span><br><span class="line">    ECP <span class="string">&quot;def2-ECP&quot;</span> # <span class="function">All <span class="title">elements</span> <span class="params">(<span class="keyword">for</span> which the ECP is defined)</span></span></span><br><span class="line">    NewECP Pt &quot;def2-SD&quot; end # Different ECP for Pt</span><br><span class="line">end</span><br></pre></td></tr></table></figure>
</li>
<li><p>也可以为单个原子指定</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">* xyz ...</span><br><span class="line">    ...</span><br><span class="line">    S <span class="number">0.0</span> <span class="number">0.0</span> <span class="number">0.0</span> NewECP <span class="string">&quot;SDD&quot;</span> end</span><br><span class="line">    ...</span><br><span class="line">*</span><br></pre></td></tr></table></figure>
</li>
<li><p>为单个原子用<code>NewGTO</code>的时候，可能需要用<code>DelECP</code>移除ECP再添加新的：</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">! LANL2DZ # Uses HayWadt ECPs by <span class="keyword">default</span>, starting from Na</span><br><span class="line">%basis</span><br><span class="line">    NewGTO S <span class="string">&quot;Def2-TZVP&quot;</span> end # All-electron up to Kr</span><br><span class="line">    DelECP S # Remove HayWadt ECP</span><br><span class="line">end</span><br><span class="line">* xyz ...</span><br><span class="line">    ...</span><br><span class="line">    Cu <span class="number">0.0</span> <span class="number">0.0</span> <span class="number">0.0</span></span><br><span class="line">    DelECP # Remove HayWadt ECP</span><br><span class="line">    NewGTO <span class="string">&quot;Def2-QZVPP&quot;</span> end # All-electron up to Kr</span><br><span class="line">...</span><br><span class="line">*</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="手动输入ECP参数"><a href="#手动输入ECP参数" class="headerlink" title="手动输入ECP参数"></a>手动输入ECP参数</h3><ul>
<li><p>首先用<code>NewECP</code>，然后再跟上要指定的元素，核电子数，最大的角动量</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">%basis</span><br><span class="line">    NewECP element</span><br><span class="line">        N_core (number of core electrons)</span><br><span class="line">        lmax (max. angular momentum)</span><br><span class="line">        [shells]</span><br><span class="line">    end</span><br><span class="line">end</span><br></pre></td></tr></table></figure>
</li>
<li><p>ECP的指定通过给出构成依赖于角度的电势<script type="math/tex">U_l</script>的各个壳的定义来完成。</p>
<ul>
<li>首先要给出角动量，然后跟着原始基函数的数目</li>
<li>原始基函数通过一个序号和指数<script type="math/tex">a_{kl}</script>l、扩展系数dkl<script type="math/tex">d_{kl}</script>和径向指数<script type="math/tex">n_{kl}</script>来指定</li>
</ul>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"># ECP shell</span><br><span class="line">    l (number of primitives)</span><br><span class="line">    <span class="number">1</span> a1l d1l n1l</span><br><span class="line">    <span class="number">2</span> a2l d2l n3l</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
</li>
<li><p>例子：V的SD(10,MDF)</p>
<ul>
<li>名称表明一个Stuttgart-Dresden型ECP，取代10核心电子和派生自中性原子的相对论计算.它由角动量s p d f的4个壳层组成。注意f壳层的扩展系数为0.0，因此对有效核势没有任何贡献。</li>
</ul>
</li>
</ul>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"># <span class="function">ECP <span class="title">SD</span><span class="params">(<span class="number">10</span>,MDF)</span> <span class="keyword">for</span> V</span></span><br><span class="line"># M. Dolg, U. Wedig, H. Stoll, H. Preuss,</span><br><span class="line"># J. Chem. Phys. <span class="number">86</span>, <span class="number">866</span> (<span class="number">1987</span>).</span><br><span class="line">NewECP V</span><br><span class="line">    N_core <span class="number">10</span></span><br><span class="line">    lmax f</span><br><span class="line">    s <span class="number">2</span></span><br><span class="line">        <span class="number">1</span> <span class="number">14.4900000000</span> <span class="number">178.4479710000</span> <span class="number">2</span></span><br><span class="line">        <span class="number">2</span> <span class="number">6.5240000000</span> <span class="number">19.8313750000</span> <span class="number">2</span></span><br><span class="line">    p <span class="number">2</span></span><br><span class="line">        <span class="number">1</span> <span class="number">14.3000000000</span> <span class="number">109.5297630000</span> <span class="number">2</span></span><br><span class="line">        <span class="number">2</span> <span class="number">6.0210000000</span> <span class="number">12.5703100000</span> <span class="number">2</span></span><br><span class="line">    d <span class="number">2</span></span><br><span class="line">        <span class="number">1</span> <span class="number">17.4800000000</span> <span class="number">-19.2196570000</span> <span class="number">2</span></span><br><span class="line">        <span class="number">2</span> <span class="number">5.7090000000</span> <span class="number">-0.6427750000</span> <span class="number">2</span></span><br><span class="line">    f <span class="number">1</span></span><br><span class="line">        <span class="number">1</span> <span class="number">1.0000000000</span> <span class="number">0.0000000000</span> <span class="number">2</span></span><br><span class="line">end</span><br></pre></td></tr></table></figure>
<h1 id="相对论基组"><a href="#相对论基组" class="headerlink" title="相对论基组"></a>相对论基组</h1><ul>
<li><p>使用Ahlrichs def2基组时，ORCA默认会为定义了def2-ECP（元素&gt; Kr）的重元素查找ECP。但是，如果要求进行全电子相对论计算（ZORA或DKH），则需要选择正确的相对论基组。</p>
</li>
<li><p>如果使用推荐的基组，在ORCA的DFT计算中使用标量相对论方法很容易</p>
</li>
<li>Ahlrichs def2基组系列已重新收缩来用于ZORA或DKH2计算，应选择def2-XVP基的相对论性收缩。</li>
<li>对于相对论WFT计算，可以使用相对论Douglas-Kroll相关一致基组cc-pVnZ-DK基组。</li>
<li><p>对于仅使用ECP（第三行过渡金属行等）才能使用标准def2-XVP基组的元素，应该使用分段的全电子相对论收缩（SARC）基组</p>
</li>
<li><p>随着元素变得越来越重，对于DFT中的交换相关项，ZORA或DKH2方法需要甚至更密的格点。</p>
<ul>
<li>对于非常重的元素（第三行及以下）的计算，有时需要指定最大的角度格点（Grid7），然后大幅增加径向格点（甚至是IntAcc 10-20）。因此可能需要对新分子系统的格点依赖性进行手动探索</li>
</ul>
</li>
</ul>
<h2 id="DFT中的单点ZORA-DKH2计算和Ahlrichs-amp-SARC基组"><a href="#DFT中的单点ZORA-DKH2计算和Ahlrichs-amp-SARC基组" class="headerlink" title="DFT中的单点ZORA/DKH2计算和Ahlrichs &amp; SARC基组"></a>DFT中的单点ZORA/DKH2计算和Ahlrichs &amp; SARC基组</h2><h3 id="H-Kr"><a href="#H-Kr" class="headerlink" title="H-Kr"></a>H-Kr</h3><ul>
<li>使用<strong>ZORA或DKH2方法</strong>：<ul>
<li>基组ZORA-def2-TZVP是全电子def2-TZVP Ahlrichs基组的相对论版，直接在前面加入<code>DKH-</code>或者<code>ZORA-</code></li>
<li>注意，对于其他非相对论基组(例如Pople-style基础)没有执行重缩，因此计算会不一致</li>
</ul>
</li>
</ul>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">! B3LYP ZORA ZORA-TZVP ...</span><br></pre></td></tr></table></figure>
<ul>
<li>如果需要使用辅助基组，建议使用解压缩的def2/J辅基组，通过<code>! SARC/J</code>定义，对于相对论ZORA / DKH计算更准确</li>
</ul>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">! BP86 ZORA ZORA-def2-SVP SARC/J</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">! BP86 DKH2 DKH-def2-SVP SARC/J</span><br><span class="line"></span><br><span class="line">*xyz <span class="number">0</span> <span class="number">1</span></span><br><span class="line">H <span class="number">0</span> <span class="number">0</span> <span class="number">0</span></span><br><span class="line">F <span class="number">0</span> <span class="number">0</span> <span class="number">1</span></span><br><span class="line">*</span><br></pre></td></tr></table></figure>
<h3 id="Rb-I"><a href="#Rb-I" class="headerlink" title="Rb-I"></a>Rb-I</h3><ul>
<li>周期表中的这一行def2-XVP仅仅是价基组+core的def2-ECP</li>
<li>在ORCA 4.0中没有有效的<code>ZORA-def2-TZVP</code>或  <code>DKH-def2-TZVP</code>关键字。为了大致再现旧的ORCA行为，可以使用关键字 <code>old-ZORA-TZVP</code>和<code>old-DKH-TZVP</code>。</li>
</ul>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">! BP86 ZORA ZORA-def2-TZVP SARC/J  </span><br><span class="line">%basis </span><br><span class="line">NewGTO Mo <span class="string">&quot;old-ZORA-TZVP&quot;</span> end</span><br><span class="line">end</span><br><span class="line"></span><br><span class="line">*xyz <span class="number">0</span> <span class="number">1</span></span><br><span class="line">H <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> </span><br><span class="line">F <span class="number">0</span> <span class="number">0</span> <span class="number">1</span></span><br><span class="line">Mo <span class="number">0</span> <span class="number">0</span> <span class="number">2</span></span><br><span class="line">*</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">! BP86 DKH DKH-def2-TZVP SARC/J  </span><br><span class="line">%basis </span><br><span class="line">NewGTO Mo <span class="string">&quot;old-DKH-TZVP&quot;</span> end</span><br><span class="line">end</span><br><span class="line"></span><br><span class="line">*xyz <span class="number">0</span> <span class="number">1</span></span><br><span class="line">H <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> </span><br><span class="line">F <span class="number">0</span> <span class="number">0</span> <span class="number">1</span></span><br><span class="line">Mo <span class="number">0</span> <span class="number">0</span> <span class="number">2</span></span><br><span class="line">*</span><br></pre></td></tr></table></figure>
<h3 id="Xe-Rn、Ac-Lr"><a href="#Xe-Rn、Ac-Lr" class="headerlink" title="Xe-Rn、Ac-Lr"></a>Xe-Rn、Ac-Lr</h3><ul>
<li>如果包含重元素，例如第三过渡金属行原子、镧系、锕系和6p元素，必须明确定义<strong>SARC基组</strong>和<code>SARC/J</code></li>
<li>例子：为所有内容定义<code>ZORA-def2-TZVP</code>（对于H和F，由于Pt没有可用的<code>ZORA-def2-TZVP</code>，因此将忽略Pt）；然后使用<code>％basis</code>块定义Pt的<code>SARC-ZORA-TZVP</code>基组</li>
</ul>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">! BP86 ZORA ZORA-def2-TZVP SARC/J  </span><br><span class="line">%basis </span><br><span class="line">NewGTO Pt <span class="string">&quot;SARC-ZORA-TZVP&quot;</span> end</span><br><span class="line">end</span><br><span class="line"></span><br><span class="line">*xyz <span class="number">0</span> <span class="number">1</span></span><br><span class="line">H <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> </span><br><span class="line">F <span class="number">0</span> <span class="number">0</span> <span class="number">1</span></span><br><span class="line">Pt <span class="number">0</span> <span class="number">0</span> <span class="number">2</span></span><br><span class="line">*</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">! BP86 DKH DKH-def2-TZVP SARC/J  </span><br><span class="line">%basis </span><br><span class="line">NewGTO Pt <span class="string">&quot;SARC-DKH-TZVP&quot;</span> end</span><br><span class="line">end</span><br><span class="line"></span><br><span class="line">*xyz <span class="number">0</span> <span class="number">1</span></span><br><span class="line">H <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> </span><br><span class="line">F <span class="number">0</span> <span class="number">0</span> <span class="number">1</span></span><br><span class="line">Pt <span class="number">0</span> <span class="number">0</span> <span class="number">2</span></span><br><span class="line">*</span><br></pre></td></tr></table></figure>
<h2 id="用弥散函数和ZORA、DKH"><a href="#用弥散函数和ZORA、DKH" class="headerlink" title="用弥散函数和ZORA、DKH"></a>用弥散函数和ZORA、DKH</h2><p>如果ZORA / DKH2 DFT计算中需要弥散函数，则建议使用最小扩展的def2 ZORA / DKH基组：</p>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">ma<span class="literal">-ZORA</span><span class="literal">-def2</span><span class="literal">-SV</span>（P）（<span class="built_in">H</span><span class="literal">-Rn</span>）</span><br><span class="line">ma<span class="literal">-ZORA</span><span class="literal">-def2</span><span class="literal">-SVP</span> （<span class="built_in">H</span><span class="literal">-Rn</span>）</span><br><span class="line">ma<span class="literal">-ZORA</span><span class="literal">-def2</span><span class="literal">-TZVP</span> （<span class="built_in">H</span><span class="literal">-Rn</span>）</span><br><span class="line">ma<span class="literal">-ZORA</span><span class="literal">-def2</span><span class="literal">-TZVP</span>（<span class="operator">-f</span>） （<span class="built_in">H</span><span class="literal">-Rn</span>）</span><br><span class="line">ma<span class="literal">-ZORA</span><span class="literal">-def2</span><span class="literal">-TZVPP</span> （<span class="built_in">H</span><span class="literal">-Rn</span>）</span><br><span class="line">ma<span class="literal">-ZORA</span><span class="literal">-def2</span><span class="literal">-QZVP</span> （<span class="built_in">H</span><span class="literal">-Rn</span>）</span><br><span class="line">ma<span class="literal">-ZORA</span><span class="literal">-def2</span><span class="literal">-QZVPP</span> （<span class="built_in">H</span><span class="literal">-Rn</span>）</span><br></pre></td></tr></table></figure>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">ma<span class="literal">-DKH</span><span class="literal">-def2</span><span class="literal">-SV</span>（P） （<span class="built_in">H</span><span class="literal">-Rn</span>）</span><br><span class="line">ma- DKH <span class="literal">-def2</span><span class="literal">-SVP</span> （<span class="built_in">H</span><span class="literal">-Rn</span>）</span><br><span class="line">ma- DKH <span class="literal">-def2</span><span class="literal">-TZVP</span> （<span class="built_in">H</span><span class="literal">-Rn</span>）</span><br><span class="line">ma- DKH <span class="literal">-def2</span><span class="literal">-TZVP</span>（<span class="operator">-f</span>） （<span class="built_in">H</span><span class="literal">-Rn</span>）</span><br><span class="line">ma- DKH <span class="literal">-def2</span><span class="literal">-TZVPP</span> （<span class="built_in">H</span><span class="literal">-Rn</span>）</span><br><span class="line">ma- DKH <span class="literal">-def2</span><span class="literal">-QZVP</span> （<span class="built_in">H</span><span class="literal">-Rn</span>）</span><br><span class="line">ma- DKH <span class="literal">-def2</span><span class="literal">-QZVPP</span> （<span class="built_in">H</span><span class="literal">-Rn</span>）</span><br></pre></td></tr></table></figure>
<p><strong>对于WFT计算</strong>，aug-cc-VnZ-DK系列更好：</p>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">aug<span class="literal">-cc</span><span class="literal">-pVDZ</span><span class="literal">-DK</span>（<span class="built_in">H</span><span class="literal">-Ar</span>，<span class="built_in">Sc</span><span class="literal">-Kr</span>）</span><br><span class="line">aug<span class="literal">-cc</span><span class="literal">-pVTZ</span><span class="literal">-DK</span> （<span class="built_in">H</span><span class="literal">-Ar</span>，<span class="built_in">Sc</span><span class="literal">-Kr</span>，Y<span class="literal">-Xe</span>，Hf<span class="literal">-Rn</span>） </span><br><span class="line">aug<span class="literal">-cc</span><span class="literal">-pVQZ</span><span class="literal">-DK</span> （<span class="built_in">H</span><span class="literal">-Ar</span>，<span class="built_in">Sc</span><span class="literal">-Kr</span>，<span class="keyword">In</span><span class="literal">-Xe</span>，Tl<span class="literal">-Rn</span>） </span><br><span class="line">aug<span class="literal">-cc</span><span class="literal">-pV5Z</span><span class="literal">-DK</span> （<span class="built_in">H</span><span class="literal">-Ar</span>，<span class="built_in">Sc</span><span class="literal">-Kr</span>）</span><br></pre></td></tr></table></figure>
<h2 id="几何优化with-ZORA-DKH"><a href="#几何优化with-ZORA-DKH" class="headerlink" title="几何优化with ZORA/DKH"></a>几何优化with ZORA/DKH</h2><ul>
<li><p>由于在几何优化中使用了单中心近似，因此ZORA / DKH2几何优化产生的能量与单点计算产生的能量不同。注意不要混淆优化和单点相对论工作的能量。</p>
</li>
<li><p>请注意，重元素分子的几何优化通常使用ZORA比使用DKH更稳定。这似乎是由于ZORA的格点灵敏度降低所致。因此通常建议使用ZORA。</p>
<figure class="highlight armasm"><table><tr><td class="code"><pre><span class="line">! BP86 def2-TZVP SARC/J ZORA <span class="meta">Opt</span></span><br></pre></td></tr></table></figure>
<figure class="highlight armasm"><table><tr><td class="code"><pre><span class="line">! BP86 def2-TZVP SARC/J DKH2 <span class="meta">Opt</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="相对论分子性质"><a href="#相对论分子性质" class="headerlink" title="相对论分子性质"></a>相对论分子性质</h2><ul>
<li><p>由于所谓的 picturechange效应，使用标量相对论哈密顿量计算的分子特性可能会变得复杂</p>
</li>
<li><ul>
<li><p>ZORA中， 磁性不需要picture change</p>
</li>
<li><p>ZORA中，电性质原则上需要picture change，但是由于ZORA缺乏gauge invariance，结果不好。一种解决方法是使用van Lenthe定义的所谓的ZORA-4密度。这是在ORCA中将<strong>picturechange</strong>设置为<strong>true</strong>时得到的。但是，这似乎并没有通过完全相对论的四分量计算来改善一致性。</p>
</li>
<li><p>DKH中，电性质的picture change相对容易，应该包括</p>
</li>
<li><p>DKH中，变换依赖于矢量电视，因此picture change对磁的影响很复杂，orca也实现了picture change的效果</p>
<figure class="highlight livecodeserver"><table><tr><td class="code"><pre><span class="line">%<span class="built_in">rel</span> picturechange  <span class="literal">true</span> <span class="keyword">end</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>如果基组接近完整，则所有相对论计算都将变为奇异，因为相对论轨道会随着点原子核发散。解决方法是使用有限核。有限核模型：</p>
<figure class="highlight livecodeserver"><table><tr><td class="code"><pre><span class="line">%<span class="built_in">rel</span> FiniteNuc <span class="literal">true</span>/<span class="literal">false</span> <span class="keyword">end</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
]]></content>
      <categories>
        <category>计算化学</category>
        <category>软件</category>
      </categories>
      <tags>
        <tag>输入</tag>
        <tag>基组</tag>
        <tag>ORCA</tag>
        <tag>辅助基组</tag>
        <tag>RI近似</tag>
        <tag>赝势</tag>
        <tag>相对论基组</tag>
      </tags>
  </entry>
  <entry>
    <title>【ORCA】05.HF&amp;SCF部分</title>
    <url>/2020/09/04/%E3%80%90ORCA%E3%80%9105.HF&amp;SCF%E9%83%A8%E5%88%86/</url>
    <content><![CDATA[<h1 id="预估SCF的内存"><a href="#预估SCF的内存" class="headerlink" title="预估SCF的内存"></a>预估SCF的内存</h1><ul>
<li><p>当所需的内存大于<code>MaxCore</code>时，ORCA会中止计算，可以计算估计的内存：</p>
<figure class="highlight llvm"><table><tr><td class="code"><pre><span class="line"><span class="symbol">%scf</span> DryRun <span class="keyword">true</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>如果需要所估计的内存，并进行计算：</p>
<figure class="highlight coq"><table><tr><td class="code"><pre><span class="line">%scf <span class="keyword">Print</span>[P_SCFMemInfo] <span class="number">1</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>预估是每个核的内存，如果是并行计算，还需要×核数目。</p>
</li>
</ul>
<h1 id="收敛限"><a href="#收敛限" class="headerlink" title="收敛限"></a>收敛限</h1><ul>
<li><p>收敛不仅仅是影响收敛限，还有积分精度。如果积分误差大于收敛准则，则直接的SCF计算不可能收敛</p>
</li>
<li><p>首先可以在<code>%scf</code>中定义scf的收敛级别，也可以直接简单的用类似于<code>!TightSCF</code>指定，可选择：</p>
<ul>
<li><code>Sloppy</code>：<code>TolE 3.0e-05</code></li>
<li><code>Loose</code>：<code>TolE 1.0e-05</code></li>
<li><code>Normal</code>：单点默认，<code>TolE 1.0e-06</code></li>
<li><code>Medium</code> ：</li>
<li><code>Strong</code>：<code>TolE 3.0e-07</code>【</li>
<li><code>Tight</code>：默认几何优化，<code>TolE 1.0e-08</code></li>
<li><code>VeryTight</code>：<code>TolE 1.0e-09</code></li>
<li><code>Extreme</code>：<code>TolE  1.0e-14</code>。在双精度算术中接近计算机的数值零</li>
</ul>
<figure class="highlight erlang"><table><tr><td class="code"><pre><span class="line"><span class="comment">%scf</span></span><br><span class="line">    Convergence Sloppy </span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>ORCA中用于单点计算的默认SCF收敛标准由关键字<code>NormalSCF</code>给出。对于能量，分子特性，几何优化等而言，这可能并不总是可靠的设置。执行几何优化时，默认的SCF收敛会自动从<code>NormalSCF</code>更改为<code>TightSCF</code>，以减少梯度中的噪声。只有很少的情况下才需要超过<code>TightSCF</code>的设置，对于一些敏感的分子性质可能需要。</p>
</li>
<li><p>收敛不仅仅是由能量决定，是多种共同决定的，收敛准则总是打印在输出中，比如常常用于过渡金属的<code>TightSCF</code>：</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="string">%scf</span></span><br><span class="line">    <span class="string">TolE</span> <span class="number">1e-8</span> <span class="comment"># 两轮能量变化</span></span><br><span class="line">    <span class="string">TolRMSP</span> <span class="number">5e-9</span> <span class="comment"># 均方根密度变化</span></span><br><span class="line">    <span class="string">TolMaxP</span> <span class="number">1e-7</span> <span class="comment"># 最大密度变化</span></span><br><span class="line">    <span class="string">TolErr</span> <span class="number">5e-7</span> <span class="comment"># DIIS error convergence</span></span><br><span class="line">    <span class="string">TolG</span> <span class="number">1e-5</span> <span class="comment"># 轨道梯度收敛</span></span><br><span class="line">    <span class="string">TolX</span> <span class="number">1e-5</span> <span class="comment"># 轨道旋转角收敛</span></span><br><span class="line">    <span class="string">ConvCheckMode</span> <span class="number">2</span> </span><br><span class="line">    <span class="string">ConvForced</span> <span class="number">1</span></span><br><span class="line"><span class="string">end</span></span><br></pre></td></tr></table></figure>
<ul>
<li><code>ConvCheckMode</code>：<ul>
<li><code>0</code>：必须满足所有收敛标准。这是一个非常严格的标准。在这种模式下，即使一个收敛准则没有被满足，但是其他的收敛准则超额完成，程序也有机制来决定一个计算是否收敛</li>
<li><code>1</code>：只要满足一个就收敛，非常粗糙</li>
<li><code>2</code>：默认。检查总能量的变化和单电子能量的变化，如果总能量和单电子能量的比值恒定，delta（Etot）&lt;TolE，delta（E1）&lt;1e3 * TolE，自洽场是不再波动，计算可以认为是收敛的。如果重叠矩阵的特征值很小，密度可能未收敛到<code>TolMaxP</code>和<code>TolRMSP</code>要求的收敛。</li>
</ul>
</li>
<li><code>ConvForced</code>：<ul>
<li><code>0</code>或者<code>false</code>：对于下一个计算步骤，收敛不是必须的</li>
<li><code>1</code>或者<code>True</code>或直接<code>!SCFConvergenceForced</code>：如果不满足收敛条件，程序停止。避免非收敛波函数计算费时，强制收敛在后HF（MP2，CCSD等）和激发态计算中（TDDFT，CIS，ROCIS）是默认的，可以修改为0。</li>
<li>无论选择的<code>ConvForced</code>是多少，性质或数值计算(<code>NumGrad</code>, <code>NumFreq</code>)都不会对非收敛波函数执行。</li>
</ul>
</li>
</ul>
</li>
</ul>
<h1 id="收敛情况"><a href="#收敛情况" class="headerlink" title="收敛情况"></a>收敛情况</h1><ul>
<li><p>Orca SCF收敛与否的情况有三种【取决于收敛限 和<code>iterations</code>（默认是125）】：</p>
<ul>
<li><p>完全SCF收敛</p>
</li>
<li><p>接近SCF收敛：没有完全收敛，但是 deltaE  &lt; 3e-3、MaxP &lt; 1e-2、RMSP &lt; 1e-3，否则是没有收敛。如果单点或几何优化接近收敛发生了，会出现</p>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">FINAL</span> SINGLE POINT ENERGY      -<span class="number">137</span>.<span class="number">654063943692</span>   (SCF not fully converged!)</span><br></pre></td></tr></table></figure>
</li>
<li><p>没有SCF收敛</p>
</li>
</ul>
</li>
<li><p>当没有SCF收敛或接近SCF收敛时，单点计算的默认行为是ORCA在SCF完成后立即停止（在MaxIter）。ORCA不会继续进行后HF的计算，计算分子性质或激发（例如TDDFT）。</p>
</li>
<li><p>当在指定的的优化先循环内发生接近SCF收敛时，几何优化（或 gradient job）的默认行为是ORCA继续进行几何优化的默认行为。可以通过ConvForced修改。</p>
<ul>
<li>此行为旨在防止ORCA由于次要的SCF收敛问题而导致ORCA停止长时间的优化工作，该问题通常发生在优化开始时，并且通常会在以后的优化周期中得到解决（因为几何结构得到了改进，ORCA重复使用了先前的轨道作为猜测每个SCF）。当在优化周期中没有SCF收敛时，ORCA会停止计算。</li>
</ul>
</li>
</ul>
<h1 id="相关算法"><a href="#相关算法" class="headerlink" title="相关算法"></a>相关算法</h1><h2 id="动静阻尼Damp"><a href="#动静阻尼Damp" class="headerlink" title="动静阻尼Damp"></a>动静阻尼Damp</h2><ul>
<li><p>阻尼是最古老和最简单的收敛方法。它是Douglas Hartree在进行原子计算时发明的。阻尼是将旧密度和新密度混合为：<script type="math/tex">P_{new,damped}=(1-\alpha) P_{new}+\alpha P_{old}</script></p>
<ul>
<li>α是阻尼系数，必须小于1（0-1之间都可，程序不会检查）。如果大于1，计算无法继续，因为没有新的密度加上并混合。</li>
</ul>
</li>
<li><p>早期计算中新密度和旧密度之间很不相同而且波动很大时，阻尼非常重要。许多方案已提出动态改变阻尼因子，使之在开始时具有强阻尼，而在结束时无阻尼。ORCA中通过使用<code>CNVZerner</code>=true【默认是false】。静态阻尼用<code>CNVDamp</code>=true【默认】。这两个是互斥的。当不在DIIS或SOSCF的收敛半径内时，可以在计算开始时使用它们。</p>
<figure class="highlight delphi"><table><tr><td class="code"><pre><span class="line">%scf</span><br><span class="line">    # control <span class="keyword">of</span> the Damping <span class="function"><span class="keyword">procedure</span></span></span><br><span class="line"><span class="function">    <span class="title">CNVDamp</span> <span class="title">true</span> </span></span><br><span class="line"><span class="function">    <span class="title">CNVZerner</span> <span class="title">false</span> </span></span><br><span class="line"><span class="function">    <span class="title">DampFac</span> 0.98 # <span class="title">default</span>:</span> <span class="number">0.7</span></span><br><span class="line">    DampErr <span class="number">0.05</span> </span><br><span class="line">    DampMin <span class="number">0.1</span> # <span class="keyword">default</span>: <span class="number">0.0</span></span><br><span class="line">    DampMax <span class="number">0.99</span> # <span class="keyword">default</span>: <span class="number">0.98</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>更方便的是：</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">%scf</span><br><span class="line">    Damp fac <span class="number">0.98</span> ErrOff <span class="number">0.05</span> Min <span class="number">0.1</span> Max <span class="number">0.99</span> end</span><br><span class="line">end    </span><br></pre></td></tr></table></figure>
</li>
<li><p>如果与DIIS或SOSCF结合使用阻尼，<code>DampErr</code>值非常重要。默认是<code>0.1</code> Eh:</p>
<ul>
<li>一旦DIIS误差低于DampErr，就会关闭阻尼。</li>
<li>在使用SOSCF时，DampErr是指关闭阻尼时的轨道梯度值。</li>
<li>在比较困难的情况下，看可以将其调到很小，比如0.001，在某种程度上就是<code>!SlowConv</code></li>
</ul>
</li>
</ul>
<h2 id="能级移动Shift"><a href="#能级移动Shift" class="headerlink" title="能级移动Shift"></a>能级移动Shift</h2><ul>
<li><p>能级移动基本思想是改变虚轨道的能量，这样在对角化后，虚轨道和已占据轨道混合的强度就会降低，计算就会更顺利地收敛到期望的状态。在近简并的情况下，能级移动可以防止电子状态的翻转。在特殊情况下等价于阻尼。</p>
</li>
<li><p>与<code>DampErr</code>相似，<code>ShiftErr</code>指的是在能级移动被关闭时的DIIS误差</p>
<figure class="highlight oxygene"><table><tr><td class="code"><pre><span class="line">%scf</span><br><span class="line">    # control <span class="keyword">of</span> the level shift <span class="function"><span class="keyword">procedure</span></span></span><br><span class="line"><span class="function">    <span class="title">CNVShift</span> <span class="title">true</span> # <span class="title">default</span>:</span> <span class="keyword">true</span></span><br><span class="line">    LShift <span class="number">0.1</span> # <span class="keyword">default</span>: <span class="number">0.25</span>, energy <span class="keyword">unit</span> <span class="keyword">is</span> Eh.</span><br><span class="line">    ShiftErr <span class="number">0.1</span> # <span class="keyword">default</span>: <span class="number">0.0</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>更方便的用法是：</p>
<figure class="highlight erlang"><table><tr><td class="code"><pre><span class="line"><span class="comment">%scf</span></span><br><span class="line">    Shift Shift <span class="number">0.1</span> ErrOff <span class="number">0.1</span> <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="迭代子空间的直接反演-DIIS"><a href="#迭代子空间的直接反演-DIIS" class="headerlink" title="迭代子空间的直接反演(DIIS)"></a>迭代子空间的直接反演(DIIS)</h2><ul>
<li><p>Direct Inversion in Iterative Subspace (DIIS)</p>
</li>
<li><p>DIIS使用一个标准来判断给定的密度与自洽有多远。Fock和密度矩阵的对易[F,P]是一种方便的测量这种误差的方法。利用这些信息，从现有的和以前的Fock矩阵中构造出一个更接近自洽的外推Fock矩阵，会比用DIIS观察到的线性收敛性更好。然而，在一些罕见的(开壳)情况下，DIIS的收敛速度很慢，或者在经过一些初步的计算后就不收敛了。</p>
<figure class="highlight oxygene"><table><tr><td class="code"><pre><span class="line">%scf</span><br><span class="line">    # control <span class="keyword">of</span> the DIIS <span class="function"><span class="keyword">procedure</span></span></span><br><span class="line"><span class="function">    <span class="title">CNVDIIS</span> <span class="title">true</span> # <span class="title">default</span>:</span> <span class="keyword">true</span></span><br><span class="line">    DIISStart <span class="number">0.1</span> </span><br><span class="line">    DIISMaxIt <span class="number">5</span> # <span class="keyword">default</span>: <span class="number">12</span></span><br><span class="line">    DIISMaxEq <span class="number">7</span> </span><br><span class="line">    DIISBFac <span class="number">1.2</span> </span><br><span class="line">    DIISMaxC <span class="number">15.0</span> # <span class="keyword">default</span>: <span class="number">10.0</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<ul>
<li><code>DIISBFac</code>：默认<code>1.05</code>。当接近自洽时，用于求解DIIS的线性方程组趋向于线性依赖，利用因子DIISBfac使DIIS偏向于具有最低能量的SCF循环，如果Fock矩阵/密度没有最低的能量，就将DIIS矩阵的所有对角元素与这个因子相乘来实现。</li>
<li><code>DIISMaxEq</code>：默认<code>5</code>。DIIS外推需要记住的旧的Fock矩阵的最大数目。建议5-7的值。如果标准DIIS不能达到收敛，一些计算用改参数的可以用。</li>
<li><code>DIISStart</code>：如果DIIS在SCF开始时导致问题，则可能需要在稍后的阶段调用它。DIISStart控制DIIS程序的开始。默认是<code>0.2</code>eh，通常在0-3个周期之后启动DIIS。</li>
<li><code>DIISMaxIt</code>：控制DIIS启动的另一种方法是调整DIISMaxIt值，该值设置了最大的周期数，之后无论误差值如何，都将启动DIIS。</li>
</ul>
</li>
<li><p>更方便的写法：</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">%scf</span><br><span class="line">    DIIS Start <span class="number">0.1</span> MaxIt <span class="number">5</span> MaxEq <span class="number">7</span> BFac <span class="number">1.2</span> MaxC <span class="number">15.0</span> end</span><br><span class="line">end</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="另一种DIIS算法-KDIIS"><a href="#另一种DIIS算法-KDIIS" class="headerlink" title="另一种DIIS算法:KDIIS"></a>另一种DIIS算法:KDIIS<a id="KDIIS"></a></h2><ul>
<li>KDIIS算法的目的是利用DIIS外推法和一阶微扰理论将任意能量表达式的轨道梯度降至零。因此，该方法是无对角化的。它在许多情况下优于标准的DIIS算法，但并不总是如此。该算法用关键字<code>!KDIIS</code>，可用于RHF, UHF和CASSCF。</li>
</ul>
<h2 id="近似二阶SCF-SOSCF"><a href="#近似二阶SCF-SOSCF" class="headerlink" title="近似二阶SCF (SOSCF)"></a>近似二阶SCF (SOSCF)</h2><ul>
<li><p>SOSCF是SCF程序的一种近似二次收敛的变体。SOSCF对反轨道Hessian进行初始猜测，然后递归使用BFGS公式更新轨道旋转角度。随着信息从几次迭代积累，对反轨道Hessian的猜测越来越好，计算达到超线性收敛的状态。比DIIS稍微好一点，花费的时间稍微少一些。当DIIS卡在0.001和0.0001的误差时可以用。</p>
</li>
<li><p>缺点如下：在SCF的开始阶段，轨道梯度(描述已占据和虚MOs混合的总能量对旋转的导数)很大，因此离二次区间还远。在这种情况下，计算会不成功的，甚至可能出现严重错误。因此，建议只在 DIIS可能导致的不完全“收敛”的SCF中的最后调用SOSCF过程</p>
<figure class="highlight oxygene"><table><tr><td class="code"><pre><span class="line">%scf</span><br><span class="line">    # control <span class="keyword">of</span> the SOSCF <span class="function"><span class="keyword">procedure</span></span></span><br><span class="line"><span class="function">    <span class="title">CNVSOSCF</span> <span class="title">true</span> # <span class="title">default</span>:</span> <span class="keyword">false</span></span><br><span class="line">    SOSCFStart <span class="number">0.1</span> # <span class="keyword">default</span>: <span class="number">0.01</span></span><br><span class="line">    SOSCFMaxIt <span class="number">5</span> # <span class="keyword">default</span>: <span class="number">1000</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<ul>
<li><code>SOSCFStart</code>：轨道梯度的阈值。当轨道梯度，或者说DIIS误差低于SOSCFStart时，启动SOSCF程序。</li>
<li><code>SOSCFMaxIt</code>：即使轨道梯度仍然高于SOSCFStart, 仍然是启动SOSCF的迭代处。</li>
</ul>
</li>
<li><p>简单写法：</p>
<figure class="highlight erlang"><table><tr><td class="code"><pre><span class="line"><span class="comment">%scf</span></span><br><span class="line">    SOSCFStart <span class="number">0.1</span> MaxIt <span class="number">5</span> <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>对于许多过渡金属配合物的计算，SOSCF的启动标准最好保持保守，否则可能会产生错误。推荐0.01或更低</p>
</li>
</ul>
<h2 id="全二阶SCF-Newton-Raphson-SCF"><a href="#全二阶SCF-Newton-Raphson-SCF" class="headerlink" title="全二阶SCF(Newton-Raphson SCF)"></a>全二阶SCF(Newton-Raphson SCF)</h2><ul>
<li><p>NR一旦计算在其收敛半径内,它通常收敛非常快和高精度。NR迭代比常规SCF计算所需的时间要高得多，但是这可能会被减少的周期数补偿。对于一个正常的表现良好的分子，在DIIS过程中经过10-15次迭代收敛，不需要调用NR。</p>
<ul>
<li>在比较复杂的体系中可能可以用。</li>
<li>当需要精确的SCF解，例如用于数值频率计算可以使用。</li>
<li>这些情况也可以降低CP-SCF的收敛阈值(Z_Tol)来实现。</li>
</ul>
</li>
<li><p>一旦使用NR，其他所有方法都会被关闭。达到收敛后，通过Fock算符的单一对角化，轨道再次被规范化。为了帮助CP-SCF过程的收敛，轨道在两次迭代之间是准规范的。这意味着在轨道更新后，将Fock算符的occ-occ和virt-virt块分别对角化，选取已占据轨道和虚轨道作为这部分Fock算符的特征函数。</p>
</li>
<li><p>NR有两个选项，和SOSCF比较相似：</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">%scf</span><br><span class="line">    # <span class="literal">no</span> Newton-Raphson by default</span><br><span class="line">    NRMaxIt 10 # iteration at which NR is switched on,<span class="built_in"> default </span>150</span><br><span class="line">    NRStart 0.05 # DIIS <span class="builtin-name">error</span> at which NR is switched on,<span class="built_in"> default </span>0.0033</span><br><span class="line">    end</span><br><span class="line">end</span><br></pre></td></tr></table></figure>
</li>
<li><p>更方便的方式是直接用<code>! NRSCF</code>，这将在DIIS误差低于<code>0.0033</code>(默认值)时调用NRSCF。如果还指定了<code>SLowConv</code>，NR收敛将在DIIS误差低于<code>0.002</code>(默认值)时调用</p>
</li>
<li><p>某些情况下，轨道Hessian是奇异的或近乎奇异的，NR可能会失败。那么可以采取更谨慎的方法augmented-Hessian。通过！AHSCF指定。它和NRSCF的设定值先沟通，但是引入了扩充的Hessian。</p>
</li>
<li><p>从技术上讲，该程序在每次NR迭代中求解大量的线性方程组。结果表明，所要求解的方程与类电场方程的CP-SCF方程是完全等价的，只是右边在MO的基础上被Fock算子的占据/虚轨道块所取代。因此，该实现在每次SCF迭代中调用CP-SCF程序。然后使用收敛的CP-SCF一阶波函数系数更新当前轨道。因此，每次NR迭代的花费与用于相同体系的一阶微扰单电子场型的CP-SCF计算相同。</p>
</li>
<li><p>NR实现的一个重要方面是NR自身检查收敛性。轨道梯度在CP-SCF程序调用之前计算。如果轨道梯度低于它的阈值(TolG)，不管其他收敛指标是什么，收敛中止。道梯度是一个严格的标准，因此结果被认为是可靠的。如果需要更严格的收敛，阈值TolG和TolX应该降低。</p>
</li>
<li><p>例子：</p>
<ul>
<li>一个HF几何优化5圈收敛的正常体系<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">! RHF TZVPP Opt VeryTightSCF</span><br><span class="line">* xyz <span class="number">0</span> <span class="number">1</span></span><br><span class="line">N <span class="number">0</span> <span class="number">0</span> <span class="number">0</span></span><br><span class="line">N <span class="number">0</span> <span class="number">0</span> <span class="number">1</span></span><br><span class="line">*</span><br></pre></td></tr></table></figure></li>
<li>用可选的一阶SCF也是5全，但是每个优化步需要更多的SCF迭代。<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">! RHF TZVPP Opt TightSCF</span><br><span class="line">! NRSCF</span><br><span class="line">* xyz <span class="number">0</span> <span class="number">1</span></span><br><span class="line">N <span class="number">0</span> <span class="number">0</span> <span class="number">0</span></span><br><span class="line">N <span class="number">0</span> <span class="number">0</span> <span class="number">1</span></span><br><span class="line">*</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>CP-SCF程序与收敛和方法标志一起调用，这些标志也在z向量计算中使用。通过%<code>method</code></p>
<figure class="highlight oxygene"><table><tr><td class="code"><pre><span class="line">%<span class="function"><span class="keyword">method</span> </span></span><br><span class="line"><span class="function">    <span class="title">Z_solver</span>    <span class="title">Pople</span> # <span class="title">Pople</span>&#x27;<span class="title">s</span> <span class="title">solver</span>. <span class="title">Usually</span> <span class="title">great</span>!</span></span><br><span class="line"><span class="function">                <span class="title">CG</span> # <span class="title">conjugate</span> <span class="title">gradient</span></span></span><br><span class="line"><span class="function">                <span class="title">DIIS</span> # <span class="title">Pulays</span> <span class="title">DIIS</span></span></span><br><span class="line"><span class="function">    <span class="title">AugHess</span> # <span class="title">Augmented</span> <span class="title">Hessian</span> <span class="params">(<span class="keyword">for</span> SCF only)</span></span></span><br><span class="line"><span class="function">    <span class="title">Z_MaxIter</span> 64 # <span class="title">maximum</span> <span class="title">number</span> <span class="title">of</span> <span class="title">CP</span>-<span class="title">SCF</span> <span class="title">iterations</span></span></span><br><span class="line"><span class="function">    <span class="title">Z_MaxDIIS</span> 10 # <span class="title">for</span> <span class="title">DIIS</span>:</span> maximum number <span class="keyword">of</span> expansion vectors</span><br><span class="line">    Z_Shift <span class="number">0.3</span> # <span class="keyword">for</span> DIIS: level shift</span><br><span class="line">    Z_Tol <span class="number">1</span>e-<span class="number">6</span> # convergence tolerance <span class="keyword">on</span> residual</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>NR方法的适用范围与CP-SCF程序的适用范围完全一致，SCF程序将立即受益于CP-SCF模块的任何改进。</p>
</li>
</ul>
<h1 id="SCF问题"><a href="#SCF问题" class="headerlink" title="SCF问题"></a>SCF问题</h1><h2 id="SCF的能量或性质很奇怪"><a href="#SCF的能量或性质很奇怪" class="headerlink" title="SCF的能量或性质很奇怪"></a>SCF的能量或性质很奇怪</h2><ul>
<li>例如与先前的计算或其他程序不同，或者电荷，自旋布局或轨道很奇怪</li>
<li>在任何SCF计算(DFT或HF)中可能发生的情况是，它会收敛到一个激发态(即不同的轨道占据)，甚至是轨道空间的一个鞍点，而不是最小值。这种情况很少见，但更可能发生在高度对称的情况下(如原子、双原子或其他高度对称的几何结构，如苯和二茂铁)。这个问题随后会影响 post-HF 的计算，如MP2、耦合簇。</li>
</ul>
<p>方法：</p>
<ul>
<li><p>尝试不同的SCF收敛：默认是DIIS一般比较好，<a href="#KDIIS">使用KDIIS</a>等可能会导致收敛到其他情况</p>
</li>
<li><p><strong>对初始轨道尝试不同的猜测</strong>：Guess可以用HCore、Hueckel、PAtom、PModel 、MORead。</p>
</li>
<li><p><strong>尝试改变初猜MO的轨道顺序</strong>：错误的SCF解决方案的常见原因是，位于最高位置的电子占据了错误的轨道。 通过读取先前收敛解的轨道并交换HOMO和LUMO轨道（或者可能是：HOMO和LUMO + 1，HOMO和LUMO + 2，HOMO-1和LUMO等），可以将SCF重新收敛到正确的位置解。</p>
</li>
<li><p>通过人工检查电子结构，人们通常可以知道是否有问题。通常，Mulliken电荷或自旋居数已经可以揭示出是否有什么地方出了问题</p>
</li>
<li><p>在SCF之上执行TDDFT计算：通过求解TDDFT方程并分析第一个跃迁能量，可以揭示出您是否已经收敛到某种奇怪的事物：鞍点或激发态（不同的电子配置）。在输入文件中：</p>
<figure class="highlight haml"><table><tr><td class="code"><pre><span class="line"><span class="tag">%<span class="selector-tag">tddft</span></span> nroots 4 end</span><br></pre></td></tr></table></figure>
<ul>
<li>在基态上执行的TDDFT计算应该为正，如果第一激发态具有负的跃迁能量就是明显错误，表明收敛到了激发态或者鞍点</li>
<li>另外，即使没有负跃迁能量也并不排除SCF是激发态，根据在当前SCF解决方案上执行的TDDFT线性响应方程式，可能根本无法获得真实的基态。</li>
</ul>
</li>
<li><p>对SCF波函数进行稳定性分析</p>
<figure class="highlight llvm"><table><tr><td class="code"><pre><span class="line"><span class="symbol">%scf</span> Stabperform <span class="keyword">true</span> <span class="keyword">end</span>  </span><br></pre></td></tr></table></figure>
<ul>
<li><p>一旦SCF收敛，将计算电子Hessian，并且ORCA将报告SCF是否收敛到轨道空间的鞍点</p>
<figure class="highlight livecodeserver"><table><tr><td class="code"><pre><span class="line">SCF STABILITY ANALYSIS RESULT</span><br><span class="line"><span class="comment">-----------------------------</span></span><br><span class="line">RHF/RKS-&gt;UHF/UKS - triplet - external</span><br><span class="line"></span><br><span class="line">   Root    Eigenvalue (au)</span><br><span class="line">     <span class="number">0</span>      <span class="number">-0.132711</span></span><br><span class="line">     <span class="number">1</span>      <span class="number">-0.045713</span></span><br><span class="line">     <span class="number">2</span>      <span class="number">-0.021069</span></span><br><span class="line"></span><br><span class="line">Stability Analysis indicates <span class="keyword">an</span> UNSTABLE HF/KS wave <span class="function"><span class="keyword">function</span> <span class="title">with</span> <span class="title">SEVERAL</span> <span class="title">negative</span> <span class="title">eigenvalues</span>.</span></span><br><span class="line">     <span class="comment">--------------------------------------------------------------------</span></span><br><span class="line">                                      WARNING</span><br><span class="line">     Although your wave <span class="function"><span class="keyword">function</span> <span class="title">is</span> <span class="title">converged</span>, <span class="title">the</span> <span class="title">stability</span> <span class="title">analysis</span></span></span><br><span class="line">     revealed <span class="keyword">an</span> instability towards <span class="keyword">an</span> UHF/UKS solution.</span><br><span class="line">     It is up <span class="built_in">to</span> you <span class="built_in">to</span> decide whether <span class="built_in">to</span> use <span class="keyword">the</span> wave function.</span><br><span class="line">     If you want <span class="built_in">to</span>, <span class="keyword">it</span> can be retrieved through <span class="keyword">the</span> gbw <span class="built_in">file</span> <span class="keyword">for</span></span><br><span class="line">     use <span class="keyword">as</span> <span class="keyword">a</span> guess <span class="keyword">for</span> <span class="keyword">an</span> UHF/UKS calculation <span class="keyword">or</span> <span class="keyword">for</span> RHF/RKS <span class="built_in">post</span>-SCF.</span><br><span class="line">     <span class="comment">--------------------------------------------------------------------</span></span><br></pre></td></tr></table></figure>
<ul>
<li>此处的稳定性分析清楚地表明，SCF已收敛到n阶鞍点，而不是最小值。 </li>
<li>对于UHF / UKS波函数，程序可以在与负特征值关联的特征向量方向上移动解，并尝试重新收敛。</li>
<li>对于RHF / RKS，这是不可能的，必须通过其他方式找到正确的解决方案（如上所述）。</li>
<li>注意：稳定性分析只能告诉您是否已经收敛到鞍点。它无法显示是否已收敛到激发态。从稳定性分析的角度来看，通过求解SCF方程而找到的激发态可能看起来完全正确。</li>
<li>注意，该关键词不能与RIJK等加速一起使用</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="SCF不收敛"><a href="#SCF不收敛" class="headerlink" title="SCF不收敛"></a>SCF不收敛</h2><h3 id="解决收敛的一般方法"><a href="#解决收敛的一般方法" class="headerlink" title="解决收敛的一般方法"></a>解决收敛的一般方法</h3><ul>
<li><p>首先检查基本问题：</p>
<ul>
<li>检查几何结构是否合理或者微调到更合理的结构</li>
<li>单位是Å还是Bohr</li>
<li>电荷和自选多重度</li>
<li>重元素的基组和ECPs</li>
<li>是否有一个复杂的具有多个开壳的开壳结构，也许需要一个对称的DFT策略</li>
<li>阴离子有时在气相中不稳定，因此可能需要使用连续模型（CPCM）来稳定最高的占据轨道。</li>
</ul>
</li>
<li><p>如果SCF几乎收敛（监控DeltaE和orbital gradient），但在最大迭代次数之前未能收敛，则只需增加最大迭代次数即可，而且还可以重启计算使用前面的gbw文件初猜</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">％scf MaxIter <span class="number">500</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>改变初猜，可以用 <code>PAtom</code>，<code>Hueckel</code>和<code>HCore</code>代替默认PModel猜测</p>
</li>
<li><p>尝试收敛1或2电子的氧化态（理想情况下为<strong>闭壳态</strong>），读取轨道重试。</p>
</li>
<li><p>尝试从一个较小的基组开始计算。较小的基组收敛更好。可以选择<code>GuessMode=CMatrix</code>还是<code>GuessMode=FMatrix</code>影响收敛行为。</p>
</li>
<li><p>如果SCF在第一次迭代中剧烈振荡或只是缓慢收敛，格点（DFT或COSX）可能有问题，可以增加格点精度。</p>
<ul>
<li><p>也可能表示需要阻尼，<code>SlowConv</code> /<code>veryslowconv</code></p>
</li>
<li><p>或者使用level shiting</p>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">shift</span> shift <span class="number">0</span>.<span class="number">5</span> erroff <span class="number">0</span> end</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>如果计算DIIS误差非常接近收敛，但是接着收敛非常慢：</p>
<ul>
<li>可以使用<code>!SOSCF</code>打开SOSCF（在UHF/UKS中这个是默认关闭的），但是SOSCF不总是对开壳层有用</li>
<li>或者用二阶方法<code>! NRSCF</code>或<code>! AHSCF</code>。</li>
<li>也可以使用level shiting</li>
</ul>
</li>
<li><p>如果SOSCF于到了问题（”HUGE, UNRELIABLE STEP WAS ABOUT TO BE TAKEN”），可以、用!<code>NOSOSCF</code>关闭SOSCF或者通过在SOSCF启动之前为轨道梯度选择一个较低的值来延迟SOSCF的启动（通常对于TM复合物而言是必需的）</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">%scf </span><br><span class="line">    SOSCFStart <span class="number">0.00033</span> ＃轨道梯度的默认值为<span class="number">0.0033</span>。在这里减少了<span class="number">10</span>倍。</span><br><span class="line">end</span><br></pre></td></tr></table></figure>
</li>
<li><p>尝试收敛一个更简单的计算（例如BP86 / def2-SVP或HF / def2-SVP），并从该计算中读取轨道作为猜测：</p>
<figure class="highlight autohotkey"><table><tr><td class="code"><pre><span class="line"> MORead</span><br><span class="line">%moinp <span class="string">&quot;bp-orbitals.gbw&quot;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>如果是DFT，可以尝试HF计算：HF会比DFT更好的收敛，因为有更大的HOMO-LUMO gap</p>
</li>
<li>如果是UHF计算，可以先尝试ROHF（尤其是SAHF 或者CAHF），再进行UHF</li>
</ul>
<h3 id="收敛TM复合物和其他困难的分子体系"><a href="#收敛TM复合物和其他困难的分子体系" class="headerlink" title="收敛TM复合物和其他困难的分子体系"></a>收敛TM复合物和其他困难的分子体系</h3><p>过渡金属配合物可能难以收敛，尤其是开壳物种。 ORCA具有一些内置关键字，可以为此类困难的系统选择适当的SCF算法设置。使用这些关键字将减慢SCF过程，因此仅应在必要时使用。对于闭壳有机分子，默认的SCF程序或KDIIS + SOSCF通常会导致SCF收敛更快。</p>
<ul>
<li><p><code>! SlowConv</code>、<code>! VerySlowConv</code>主要修改有助于收敛的阻尼参数，尤其是在第一次SCF迭代中存在较大波动时，使用较大的阻尼因子和阻尼，直到DIIS进入收敛域</p>
<ul>
<li>使用<code>Slowconv</code>有时会收敛太慢，一旦达到特定阈值，就可以使用SOSCF加快收敛速度。请注意，对于开壳层，SOSCF会自动关闭。根据需要使用SOSCF关键字将其重新打开（尽管它并不总是适用于开壳层），或延迟启动（如上所述）。</li>
</ul>
</li>
<li><p>修改 level shift也可以加快收敛速度：</p>
<figure class="highlight erlang"><table><tr><td class="code"><pre><span class="line">! SlowConv</span><br><span class="line"></span><br><span class="line"><span class="comment">%scf</span></span><br><span class="line">Shift Shift <span class="number">0.1</span> ErrOff <span class="number">0.1</span> <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="KDIIS-SOSCF"><a href="#KDIIS-SOSCF" class="headerlink" title="KDIIS+SOSCF"></a>KDIIS+SOSCF</h3><ul>
<li><p>使用KDIIS算法结合和不结合SOSCF，通常都可以比其他SCF过程更快地收敛。</p>
<figure class="highlight diff"><table><tr><td class="code"><pre><span class="line"><span class="addition">! KDIIS SOSCF</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="非常有问题的系统，比如金属团簇"><a href="#非常有问题的系统，比如金属团簇" class="headerlink" title="非常有问题的系统，比如金属团簇"></a>非常有问题的系统，比如金属团簇</h3><p>以下SCF设置通常会导致SCF收敛，同时极大地减慢计算速度（即，既需要更昂贵的SCF迭代，也通常需要更多的SCF迭代），其他都不行可以试试</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">! Slowconv</span><br><span class="line">%scf </span><br><span class="line">MaxIter <span class="number">1500</span>     # 在此将MaxIter设置为一个很高的数字。适用于有时需要<span class="number">1000</span>次迭代才能收敛的系统（非常少见）。</span><br><span class="line">DIISMaxEq <span class="number">15</span>  #默认值为<span class="number">5</span>。<span class="number">15</span><span class="number">-40</span>的值更适合DIIS收敛很难的情况</span><br><span class="line">directresetfreq <span class="number">1</span> </span><br><span class="line">end</span><br></pre></td></tr></table></figure>
<ul>
<li><code>directresetfreq</code>决定了计算全Fock矩阵的频率。值为1意味着在每次迭代中都要进行重新构建，虽然代价非常昂贵，但可以消除可能阻碍收敛的数值噪声。默认值是15。可以将<code>directresetfreq</code>设置为1到15之间的值。</li>
</ul>
<h3 id="收敛带弥散函数的共轭自由基阴离子"><a href="#收敛带弥散函数的共轭自由基阴离子" class="headerlink" title="收敛带弥散函数的共轭自由基阴离子"></a>收敛带弥散函数的共轭自由基阴离子</h3><ul>
<li><p>当计算带弥散函数的共轭自由基阴离子（例如ma-def2-SVP）时，发现Fock矩阵的完全重建可以帮助收敛以及尽早启动SOSCF。</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">%scf</span><br><span class="line">soscfmaxit <span class="number">12</span></span><br><span class="line">directresetfreq <span class="number">1</span></span><br><span class="line">end</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="处理线性依赖性"><a href="#处理线性依赖性" class="headerlink" title="处理线性依赖性"></a>处理线性依赖性</h3><ul>
<li><p>对于大基组或者弥散基组（例如aug-cc-pVTZ），有时会在计算中发生该系统存在一些冗余（依赖于线性的函数）的情况。这可能会引起数值不稳定性，例如SCF收敛问题：重叠(或相关的矩阵)的逆用于正交化目的，如果接近零的特征值没有得到正确处理，逆会变得不明确，SCF过程就会在数值上不稳定。</p>
</li>
<li><p>可以通过检查重叠矩阵的最小特征值来确定这种线性相关性。</p>
<ul>
<li><p>比如这个就表明了基组的线性相关性，因为最小特征值远小于阈值1e-08，最好检查基组是否合理，是不是真的需要加弥散等。如果基组是非标准的，则可能值得检查一下是否正确组合了（例如，重复的基函数）。否则，在ORCA中会自动处理小于1e-08的值的线性相关性，其中将这些特征值设置为零以消除数值不稳定性问题。</p>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">Diagonalization</span> of the overlap matrix:</span><br><span class="line"><span class="attribute">Smallest</span> eigenvalue                 ... <span class="number">4</span>.<span class="number">956</span>e-<span class="number">12</span>  </span><br><span class="line"><span class="attribute">Time</span> for diagonalization            ... <span class="number">0</span>.<span class="number">313</span> sec</span><br><span class="line"><span class="attribute">Threshold</span> for overlap eigenvalues   ... <span class="number">1</span>.<span class="number">000</span>e-<span class="number">08</span></span><br><span class="line"><span class="attribute">Number</span> of eigenvalues below threshold ... <span class="number">1</span></span><br><span class="line"><span class="attribute">Time</span> for construction of square roots ... <span class="number">0</span>.<span class="number">073</span> sec</span><br><span class="line"><span class="attribute">Total</span> time needed ... <span class="number">0</span>.<span class="number">387</span> sec</span><br></pre></td></tr></table></figure>
<ul>
<li>最小的特征值和阈值都在结果中，以及小于阈值的函数的数目（会被舍弃），最好在SCF收敛后检查是否有一样的0数目的轨道能量。对于特征值是0的函数，level shift不会被应用。</li>
</ul>
</li>
</ul>
</li>
<li><p>阈值没有严格规定，但是应该介于1e-5至1e-之间，可以手动增加阈值。</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">%scf</span><br><span class="line">sthresh 1e-7 #<span class="built_in"> default </span>1e-8</span><br><span class="line">end</span><br></pre></td></tr></table></figure>
<ul>
<li>设得过低即使SCF收敛，结果会被近零的向量噪声所污染。而一般在1e-7也能得到结果，但是大于这个，就可能有太多函数被舍弃掉，从而应i像计算结果。</li>
</ul>
</li>
<li><p>如果从基组中移除了冗余的向量，不应该用<code>！moread noiter</code>来读取SCF轨道，由于重新正交化问题，SCF可能会爆炸。可以用<code>！Rescue moread</code>可以防止这种情况。</p>
</li>
</ul>
<ul>
<li><p>升格点到 <code>!Grid5 FinalGrid6</code>水平</p>
<figure class="highlight erlang"><table><tr><td class="code"><pre><span class="line"><span class="comment">%scf</span></span><br><span class="line">    convergence loose</span><br><span class="line">    maxiter <span class="number">500</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h1 id="高斯SCF关键词对应"><a href="#高斯SCF关键词对应" class="headerlink" title="高斯SCF关键词对应"></a>高斯SCF关键词对应</h1><p><img src="image-20210211104532293.png" alt="image-20210211104532293"></p>
<p><img src="image-20210211104550547.png" alt="image-20210211104550547"></p>
<p><img src="image-20210211104603056.png" alt="image-20210211104603056"></p>
]]></content>
      <categories>
        <category>计算化学</category>
        <category>软件</category>
      </categories>
      <tags>
        <tag>SCF</tag>
        <tag>ORCA</tag>
      </tags>
  </entry>
  <entry>
    <title>【Pyscf】01.基本计算设置</title>
    <url>/2021/09/02/%E3%80%90Pyscf%E3%80%9101.%E5%9F%BA%E6%9C%AC%E8%AE%A1%E7%AE%97%E8%AE%BE%E7%BD%AE/</url>
    <content><![CDATA[<p>主要是<a href="https://pyscf.org/pyscf_api_docs/pyscf.gto.html"><code>gto</code>部分</a></p>
<h1 id="定义分子gto-mole部分"><a href="#定义分子gto-mole部分" class="headerlink" title="定义分子gto.mole部分"></a>定义分子<a href="https://pyscf.org/pyscf_api_docs/pyscf.gto.html#module-pyscf.gto.mole"><code>gto.mole</code>部分</a></h1><p>有三种方法可以定义和初始化一个分子：</p>
<ol>
<li><p>使用方法的关键字参数<code>Mole.build()</code>来初始化一个分子：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pyscf <span class="keyword">import</span> gto</span><br><span class="line">mol = gto.Mole()</span><br><span class="line">mol.build(</span><br><span class="line">	atom = <span class="string">&#x27;&#x27;&#x27;O 0 0 0; H  0 1 0; H 0 0 1&#x27;&#x27;&#x27;</span>,</span><br><span class="line">	basis = <span class="string">&#x27;sto-3g&#x27;</span>)</span><br></pre></td></tr></table></figure>
</li>
<li><p>将几何、基础等分配给Mole 对象，然后调用该<code>build()</code>方法：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pyscf <span class="keyword">import</span> gto</span><br><span class="line">mol = gto.Mole()</span><br><span class="line">mol.atom = <span class="string">&#x27;&#x27;&#x27;O 0 0 0; H  0 1 0; H 0 0 1&#x27;&#x27;&#x27;</span></span><br><span class="line">mol.basis = <span class="string">&#x27;sto-3g&#x27;</span></span><br><span class="line">……</span><br><span class="line">mol.build()</span><br></pre></td></tr></table></figure>
</li>
<li><p>使用快捷功能<code>pyscf.M()</code>或<code>Mole.M()</code>。这些函数将所有参数传递给<code>build()</code>方法：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pyscf</span><br><span class="line">mol = pyscf.M(</span><br><span class="line">    atom = <span class="string">&#x27;&#x27;&#x27;O 0 0 0; H  0 1 0; H 0 0 1&#x27;&#x27;&#x27;</span>,</span><br><span class="line">    basis = <span class="string">&#x27;sto-3g&#x27;</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pyscf <span class="keyword">import</span> gto</span><br><span class="line">mol = gto.M(</span><br><span class="line">    atom = <span class="string">&#x27;&#x27;&#x27;O 0 0 0; H  0 1 0; H 0 0 1&#x27;&#x27;&#x27;</span>,</span><br><span class="line">    basis = <span class="string">&#x27;sto-3g&#x27;</span>)</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="几何"><a href="#几何" class="headerlink" title="几何"></a>几何</h2><ul>
<li><p>默认单位为埃（可以通过将属性设置<code>unit</code> 为<code>&#39;Angstrom&#39;</code>或<code>Bohr</code>来指定单位）</p>
<figure class="highlight autoit"><table><tr><td class="code"><pre><span class="line">mol.unit = <span class="string">&#x27;B&#x27;</span> <span class="meta"># 不区分大小写，任何不以<span class="string">&#x27;B&#x27;</span>或<span class="string">&#x27;AU&#x27;</span>开头的字符串都被视为<span class="string">&#x27;Angstrom&#x27;</span></span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="笛卡尔形式"><a href="#笛卡尔形式" class="headerlink" title="笛卡尔形式"></a>笛卡尔形式</h3><figure class="highlight ini"><table><tr><td class="code"><pre><span class="line"><span class="attr">mol</span> = gto.Mole()</span><br><span class="line"><span class="attr">mol.atom</span> = <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    O   0. 0. 0.</span></span><br><span class="line"><span class="string">    H   0. 1. 0.</span></span><br><span class="line"><span class="string">    H   0. 0. 1.</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<ul>
<li><p>分子中的原子由一个元素符号加上三个坐标数字表示。不同的原子应该由<code>;</code>或 换行符分隔 。在同一个原子中，空格或<code>,</code>可以用来分隔列。空行或以 开头的<code>#</code>行将被忽略：</p>
<figure class="highlight awk"><table><tr><td class="code"><pre><span class="line">mol = pyscf.M(</span><br><span class="line">atom = <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">#O 0 0 0</span></span><br><span class="line"><span class="string">H 0 1 0</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">H 0 0 1</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span>)</span><br><span class="line">mol.natm  <span class="comment">#分子的原子个数，会输出2</span></span><br></pre></td></tr></table></figure>
<figure class="highlight ini"><table><tr><td class="code"><pre><span class="line"><span class="attr">mol.atom</span> = <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">8        0,   0, 0             ; h:1 0.0 1 0</span></span><br><span class="line"><span class="string">H@2,0 0 1</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>几何字符串不区分大小写。它还支持输入元素的核电荷：</p>
<figure class="highlight ini"><table><tr><td class="code"><pre><span class="line"><span class="attr">mol</span> = gto.Mole()</span><br><span class="line"><span class="attr">mol.atom</span> = <span class="string">&#x27;&#x27;&#x27;8 0. 0. 0.; h 0. 1. 0; H 0. 0. 1.&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>如果需要标记一个原子以将其与其他原子区分开，可以在原子符号前加上数字<code>1234567890</code>或特殊字符<code>~!@#$%^&amp;*()_+.?:&lt;&gt;[]&#123;&#125;|</code>（非 <code>,</code>和<code>;</code>）作为前缀或后缀 。通过这种修饰，可以在不同的原子上指定不同的基组、质量或核模型：</p>
<figure class="highlight prolog"><table><tr><td class="code"><pre><span class="line">mol = gto.<span class="symbol">Mole</span>()</span><br><span class="line">mol.atom = <span class="string">&#x27;&#x27;</span><span class="string">&#x27;8 0 0 0; h:1 0 1 0; H@2 0 0 1&#x27;</span><span class="string">&#x27;&#x27;</span></span><br><span class="line">mol.unit = <span class="string">&#x27;B&#x27;</span></span><br><span class="line">mol.basis = &#123;<span class="string">&#x27;O&#x27;</span>: <span class="string">&#x27;sto-3g&#x27;</span>, <span class="string">&#x27;H&#x27;</span>: <span class="string">&#x27;cc-pvdz&#x27;</span>, <span class="string">&#x27;H@2&#x27;</span>: <span class="string">&#x27;6-31G&#x27;</span>&#125;</span><br><span class="line">mol.build()</span><br><span class="line">print(mol.<span class="symbol">_atom</span>)</span><br><span class="line">#输出结果为：[[<span class="string">&#x27;O&#x27;</span>, [<span class="number">0.0</span>, <span class="number">0.0</span>, <span class="number">0.0</span>]], [<span class="string">&#x27;H:1&#x27;</span>, [<span class="number">0.0</span>, <span class="number">1.0</span>, <span class="number">0.0</span>]], [<span class="string">&#x27;H@2&#x27;</span>, [<span class="number">0.0</span>, <span class="number">0.0</span>, <span class="number">1.0</span>]]]</span><br></pre></td></tr></table></figure>
</li>
<li><p>还可以指定 xyz 文件的路径，PySCF 将使用该文件中的坐标来构建<code>Mole.atom</code>.</p>
<figure class="highlight ini"><table><tr><td class="code"><pre><span class="line"><span class="attr">mol</span> = gto.M(atom=<span class="string">&quot;my_molecule.xyz&quot;</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight gcode"><table><tr><td class="code"><pre><span class="line">mol = gto.Mole<span class="comment">()</span></span><br><span class="line">mol.atom = <span class="string">&quot;my_molecule.xyz&quot;</span></span><br><span class="line">mol.build<span class="comment">()</span></span><br></pre></td></tr></table></figure>
<figure class="highlight gauss"><table><tr><td class="code"><pre><span class="line">mol.atom = <span class="keyword">open</span>(&#x27;glycine.<span class="built_in">xyz</span>&#x27;).<span class="built_in">read</span>()</span><br></pre></td></tr></table></figure>
</li>
<li><p>可以输入以下内部格式的几何 <code>Mole.atom</code>：</p>
<figure class="highlight gml"><table><tr><td class="code"><pre><span class="line">atom = [[atom1, (<span class="symbol">x</span>, <span class="symbol">y</span>, z)],</span><br><span class="line">        [atom2, (<span class="symbol">x</span>, <span class="symbol">y</span>, z)],</span><br><span class="line">        ...</span><br><span class="line">        [atomN, (<span class="symbol">x</span>, <span class="symbol">y</span>, z)]]</span><br></pre></td></tr></table></figure>
<p>这样可以使用 Python 脚本来构造几何：</p>
<figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line">mol = gto.Mole()</span><br><span class="line">mol<span class="selector-class">.atom</span> = [[<span class="string">&#x27;O&#x27;</span>,(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>)], [<span class="string">&#x27;H&#x27;</span>,(<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>)], [<span class="string">&#x27;H&#x27;</span>,(<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>)]]</span><br><span class="line">mol<span class="selector-class">.atom</span>.extend([[<span class="string">&#x27;H&#x27;</span>, (<span class="selector-tag">i</span>, <span class="selector-tag">i</span>, i)] <span class="keyword">for</span> <span class="selector-tag">i</span> <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">5</span>)])</span><br><span class="line">mol.build()</span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(mol._atom)</span></span></span><br><span class="line">#注意输出的结果单位是Bohr的。</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="Z-matrix-输入格式"><a href="#Z-matrix-输入格式" class="headerlink" title="Z-matrix 输入格式"></a>Z-matrix 输入格式</h3><figure class="highlight ini"><table><tr><td class="code"><pre><span class="line"><span class="attr">mol</span> = gto.Mole()</span><br><span class="line"><span class="attr">mol.atom</span> = <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    O</span></span><br><span class="line"><span class="string">    H  1  1.2</span></span><br><span class="line"><span class="string">    H  1  1.2  2 105</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<h2 id="基组"><a href="#基组" class="headerlink" title="基组"></a>基组</h2><ul>
<li><p>定义基组的最简单方法是将基的名称作为字符串分配给<code>Mole.basis</code>：</p>
<figure class="highlight ini"><table><tr><td class="code"><pre><span class="line"><span class="attr">mol.basis</span> = <span class="string">&#x27;sto-3g&#x27;</span></span><br></pre></td></tr></table></figure>
<p>此输入将指定的基组应用于所有原子。字符串中基组的名称不区分大小写。名称中的空格、破折号和下划线都将被忽略。</p>
</li>
<li><p>如果不同元素需要不同的基组：</p>
<figure class="highlight ini"><table><tr><td class="code"><pre><span class="line"><span class="attr">mol.basis</span> = &#123;<span class="string">&#x27;O&#x27;</span>: <span class="string">&#x27;sto-3g&#x27;</span>, <span class="string">&#x27;H&#x27;</span>: <span class="string">&#x27;6-31g&#x27;</span>&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>与几何输入的要求一样，可以使用原子符号（不区分大小写）或原子核电荷作为<code>Mole.basis</code>字典的关键字 。数字和特殊字符的前缀和后缀是允许的。如果修饰的原子符号出现在 <code>Mole.atom</code>但不在 中<code>Mole.basis</code>，基础解析器将删除所有修饰并在<code>Mole.basis</code>字典中寻找纯原子符号 ：</p>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">mol</span>.atom = &#x27;<span class="number">8</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span>; h<span class="number">1</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span>; H<span class="number">2</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span>&#x27; mol.basis = &#123;&#x27;O&#x27;：&#x27;sto-<span class="number">3</span>g&#x27;，&#x27;H&#x27;：&#x27;sto<span class="number">3</span>g&#x27;，&#x27;H<span class="number">1</span>&#x27;：&#x27;<span class="number">6</span>-<span class="number">31</span>G&#x27;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">#6-31G基组将分配给 atom H1，但STO-3G基将用于 atom H2</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>为所有元素设置默认基组，除了指定的原子</p>
<figure class="highlight awk"><table><tr><td class="code"><pre><span class="line">mol = gto.M(</span><br><span class="line">    atom = <span class="string">&#x27;&#x27;&#x27;O 0 0 0; H1 0 1 0; H2 0 0 1&#x27;&#x27;&#x27;</span>,</span><br><span class="line">    basis = &#123;<span class="string">&#x27;default&#x27;</span>: <span class="string">&#x27;6-31g&#x27;</span>, <span class="string">&#x27;H2&#x27;</span>: <span class="string">&#x27;sto3g&#x27;</span>&#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
</li>
<li><p>使用笛卡尔型GTOs和积分（6d,10f,15g）</p>
<figure class="highlight ini"><table><tr><td class="code"><pre><span class="line"><span class="attr">mol.cart</span> = <span class="literal">True</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="ECP"><a href="#ECP" class="headerlink" title="ECP"></a>ECP</h3><ul>
<li><p>可以使用属性指定有效核心电位 (ECP) <code>Mole.ecp</code>。标量型 ECP 可用于所有分子和晶体方法。<a href="https://pyscf.org/user/gto.html#ecp">内置标量 ECP 数</a>：</p>
<figure class="highlight ini"><table><tr><td class="code"><pre><span class="line"><span class="attr">mol</span> = gto.M(atom=<span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string"> Na 0. 0. 0.</span></span><br><span class="line"><span class="string"> H  0.  0.  1.&#x27;&#x27;&#x27;</span>,</span><br><span class="line">            <span class="attr">basis</span>=&#123;<span class="string">&#x27;Na&#x27;</span>:<span class="string">&#x27;lanl2dz&#x27;</span>, <span class="string">&#x27;H&#x27;</span>:<span class="string">&#x27;sto3g&#x27;</span>&#125;,</span><br><span class="line">            <span class="attr">ecp</span> = &#123;<span class="string">&#x27;Na&#x27;</span>:<span class="string">&#x27;lanl2dz&#x27;</span>&#125;)</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="gto-basis包"><a href="#gto-basis包" class="headerlink" title="gto.basis包"></a><a href="https://pyscf.org/pyscf_api_docs/pyscf.gto.basis.html">gto.basis包</a></h3><ul>
<li><p>还可以使用辅助函数输入自定义基组。函数<code>gto.basis.parse()</code>可以解析 <strong>NWChem</strong> 格式的基础字符串 </p>
<figure class="highlight 1c"><table><tr><td class="code"><pre><span class="line">mol.basis = &#123;&#x27;O&#x27;: gto.basis.parse(&#x27;&#x27;&#x27;</span><br><span class="line">C    S</span><br><span class="line">     71.<span class="number">616837</span>0              0.<span class="number">15432897</span></span><br><span class="line">     13.<span class="number">045096</span>0              0.<span class="number">53532814</span></span><br><span class="line">      3.<span class="number">530512</span>2              0.<span class="number">44463454</span></span><br><span class="line">C    SP</span><br><span class="line">      2.<span class="number">941249</span>4             -0.<span class="number">09996723</span>             0.<span class="number">15591627</span></span><br><span class="line">      0.<span class="number">683483</span>1              0.<span class="number">39951283</span>             0.<span class="number">60768372</span></span><br><span class="line">      0.<span class="number">222289</span>9              0.<span class="number">70011547</span>             0.<span class="number">39195739</span></span><br><span class="line">&#x27;&#x27;&#x27;)&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><p>ECP类似，<code>pyscf.gto.basis.parse_ecp</code>使用 <strong>NWChem 格式</strong>直接在输入脚本中指定</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="string">mol</span> <span class="string">=</span> <span class="string">gto.M(atom=&#x27;&#x27;&#x27;</span></span><br><span class="line"> <span class="string">Na</span> <span class="number">0</span><span class="string">.</span> <span class="number">0</span><span class="string">.</span> <span class="number">0</span><span class="string">.</span></span><br><span class="line"> <span class="string">H</span>  <span class="number">0</span><span class="string">.</span>  <span class="number">0</span><span class="string">.</span>  <span class="number">1</span><span class="string">.&#x27;&#x27;&#x27;,</span></span><br><span class="line">            <span class="string">basis=&#123;&#x27;Na&#x27;:&#x27;lanl2dz&#x27;,</span> <span class="string">&#x27;H&#x27;</span><span class="string">:&#x27;sto3g&#x27;&#125;,</span></span><br><span class="line">            <span class="string">ecp</span> <span class="string">=</span> &#123;<span class="attr">&#x27;Na&#x27;:</span> <span class="string">gto.basis.parse_ecp(&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">Na</span> <span class="string">nelec</span> <span class="number">10</span></span><br><span class="line"><span class="string">Na</span> <span class="string">ul</span></span><br><span class="line"><span class="number">0</span>      <span class="number">2.0000000</span>              <span class="number">6.0000000</span>        </span><br><span class="line"><span class="number">1</span>    <span class="number">175.5502590</span>            <span class="number">-10.0000000</span>        </span><br><span class="line"><span class="number">2</span>      <span class="number">2.3365719</span>             <span class="number">-6.0637782</span>        </span><br><span class="line"><span class="number">2</span>      <span class="number">0.7799867</span>             <span class="number">-0.7299393</span>        </span><br><span class="line"><span class="string">Na</span> <span class="string">S</span></span><br><span class="line"><span class="number">0</span>    <span class="number">243.3605846</span>              <span class="number">3.0000000</span>        </span><br><span class="line"><span class="number">1</span>     <span class="number">41.5764759</span>             <span class="number">36.2847626</span>        </span><br><span class="line"><span class="number">2</span>     <span class="number">13.2649167</span>             <span class="number">72.9304880</span>        </span><br><span class="line"><span class="number">2</span>      <span class="number">0.9764209</span>              <span class="number">6.0123861</span>        </span><br><span class="line"><span class="string">Na</span> <span class="string">P</span></span><br><span class="line"><span class="number">0</span>   <span class="number">1257.2650682              </span><span class="number">5.0000000</span>        </span><br><span class="line"><span class="number">1</span>    <span class="number">189.6248810</span>            <span class="number">117.4495683</span>        </span><br><span class="line"><span class="number">2</span>     <span class="number">54.5247759</span>            <span class="number">423.3986704</span>        </span><br><span class="line"><span class="number">2</span>      <span class="number">0.9461106</span>              <span class="number">7.1241813</span>        </span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;)&#125;)</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>函数<code>gto.basis.load()</code>可以从数据库加载任意基组，即使基组与元素不匹配，<code>pyscf.gto.basis.load_ecp</code>类似</p>
<figure class="highlight ini"><table><tr><td class="code"><pre><span class="line"><span class="attr">mol.basis</span> = &#123;<span class="string">&#x27;H&#x27;</span>: gto.basis.load(<span class="string">&#x27;sto3g&#x27;</span>, <span class="string">&#x27;C&#x27;</span>)&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>指定基组输入的格式：</p>
<ul>
<li>Gaussian：<ul>
<li>加载基组：<code>pyscf.gto.basis.parse_gaussian.load(*basisfile*, *symb*, *optimize=True*)</code></li>
<li>输入基组：<code>pyscf.gto.basis.parse_gaussian.parse(string, optimize=True)</code></li>
</ul>
</li>
<li>molpro：<ul>
<li>加载基组：<code>pyscf.gto.basis.parse_molpro.load(*basisfile*, *symb*, *optimize=True*)</code></li>
<li>输入基组：<code>pyscf.gto.basis.parse_molpro.parse(*string*, *optimize=True*)</code></li>
</ul>
</li>
<li>NWchem部分：<ul>
<li>将内部基组格式转换为 NWChem 格式字符串：<code>pyscf.gto.basis.parse_nwchem.convert_basis_to_nwchem(*symb*, *basis*)</code></li>
<li>将内部ecp格式转换为 NWChem 格式字符串：<code>pyscf.gto.basis.parse_nwchem.convert_ecp_to_nwchem(*symb*, *ecp*)</code></li>
<li>加载基组：<code>pyscf.gto.basis.parse_nwchem.load(*basisfile*, *symb*, *optimize=True*)</code></li>
<li>加载ecp：<code>pyscf.gto.basis.parse_nwchem.load_ecp(*basisfile*, *symb*)</code></li>
<li>输入基组：<code>pyscf.gto.basis.parse_nwchem.parse(*string*, *symb=None*, *optimize=True*)</code></li>
<li>输入ecp：<code>pyscf.gto.basis.parse_nwchem.parse_ecp(*string*, *symb=None*)</code></li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="ghost原子"><a href="#ghost原子" class="headerlink" title="ghost原子"></a>ghost原子</h2><ul>
<li><p>ghost原子的核电荷为0，可以用<code>ghost</code>或者<code>X</code>表示。</p>
<figure class="highlight 1c"><table><tr><td class="code"><pre><span class="line">mol = gto.M(atom=&#x27;&#x27;&#x27;</span><br><span class="line">X-O     0.<span class="number">00000000</span>0     0.<span class="number">00000000</span>0     2.<span class="number">50000000</span>0</span><br><span class="line">X_H    -0.<span class="number">66364100</span>0    -0.<span class="number">38307100</span>0     3.<span class="number">09537700</span>0</span><br><span class="line">X:H     0.<span class="number">66358800</span>0     0.<span class="number">38307200</span>0     3.<span class="number">09537700</span>0</span><br><span class="line">O     1.<span class="number">00000000</span>0     0.<span class="number">00000000</span>0     2.<span class="number">50000000</span>0</span><br><span class="line">H    -1.<span class="number">66364100</span>0    -0.<span class="number">38307100</span>0     3.<span class="number">09537700</span>0</span><br><span class="line">H     1.<span class="number">66358800</span>0     0.<span class="number">38307200</span>0     3.<span class="number">09537700</span>0</span><br><span class="line">&#x27;&#x27;&#x27;, basis=&#x27;631g&#x27;)</span><br></pre></td></tr></table></figure>
</li>
<li><p>如果<code>ghost</code>或者<code>X</code>后面没有跟原子符号的后缀，需要给ghost原子单独指定基组。</p>
<figure class="highlight lua"><table><tr><td class="code"><pre><span class="line">mol = gto.M(</span><br><span class="line">    atom = <span class="string">&#x27;C 0 0 0; ghost 0 0 2&#x27;</span>,</span><br><span class="line">    basis = &#123;<span class="string">&#x27;C&#x27;</span>: <span class="string">&#x27;sto3g&#x27;</span>, <span class="string">&#x27;ghost&#x27;</span>: gto.basis.<span class="built_in">load</span>(<span class="string">&#x27;sto3g&#x27;</span>, <span class="string">&#x27;H&#x27;</span>)&#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<figure class="highlight 1c"><table><tr><td class="code"><pre><span class="line">mol = gto.M(atom=&#x27;&#x27;&#x27;</span><br><span class="line">ghost1     0.<span class="number">00000000</span>0     0.<span class="number">00000000</span>0     2.<span class="number">50000000</span>0</span><br><span class="line">ghost2    -0.<span class="number">66364100</span>0    -0.<span class="number">38307100</span>0     3.<span class="number">09537700</span>0</span><br><span class="line">ghost2     0.<span class="number">66358800</span>0     0.<span class="number">38307200</span>0     3.<span class="number">09537700</span>0</span><br><span class="line">O     1.<span class="number">00000000</span>0     0.<span class="number">00000000</span>0     2.<span class="number">50000000</span>0</span><br><span class="line">H    -1.<span class="number">66364100</span>0    -0.<span class="number">38307100</span>0     3.<span class="number">09537700</span>0</span><br><span class="line">H     1.<span class="number">66358800</span>0     0.<span class="number">38307200</span>0     3.<span class="number">09537700</span>0</span><br><span class="line">&#x27;&#x27;&#x27;,</span><br><span class="line">            basis=&#123;&#x27;ghost1&#x27;:gto.basis.load(&#x27;sto3g&#x27;, &#x27;O&#x27;),</span><br><span class="line">                   &#x27;ghost2&#x27;:gto.basis.load(&#x27;631g&#x27;, &#x27;H&#x27;),</span><br><span class="line">                   &#x27;O&#x27;:&#x27;631g&#x27;, &#x27;H&#x27;:&#x27;631g&#x27;&#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="对称性"><a href="#对称性" class="headerlink" title="对称性"></a>对称性</h2><ul>
<li><p>将属性设置为<code>Mole.symmetry</code>来为分子计算调用点群对称性<code>True</code>：</p>
<figure class="highlight lsl"><table><tr><td class="code"><pre><span class="line">mol = pyscf.M(</span><br><span class="line">     atom = &#x27;B <span class="number">0</span> <span class="number">0</span> <span class="number">0</span>; H <span class="number">0</span> <span class="number">1</span> <span class="number">1</span>; H <span class="number">1</span> <span class="number">0</span> <span class="number">1</span>; H <span class="number">1</span> <span class="number">1</span> <span class="number">0</span>&#x27;,</span><br><span class="line">     symmetry = True</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
</li>
<li><p>PySCF 支持线性分子对称性 D<sub>∞h</sub>（<code>Dooh</code>在程序中标记）和C<sub>∞v</sub> （标记为<code>Coov</code>），D2h群及其子群。有时需要使用较低的对称性而不是检测到的对称性群。子群的对称性可以由<code>Mole.symmetry_subgroup</code>指定（不影响<code>Mole.symmetry</code>） ，程序将首先检测可能的最高对称群，然后将点群对称性降低到指定的子群：</p>
<figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line">mol = gto.Mole()</span><br><span class="line">mol<span class="selector-class">.atom</span> = <span class="string">&#x27;N 0 0 0; N 0 0 1&#x27;</span></span><br><span class="line">mol<span class="selector-class">.symmetry</span> = True</span><br><span class="line">mol<span class="selector-class">.symmetry_subgroup</span> = C2</span><br><span class="line">mol.build()</span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(mol.topgroup)</span></span></span><br><span class="line">#Dooh</span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(mol.groupname)</span></span></span><br><span class="line">#C2</span><br></pre></td></tr></table></figure>
</li>
<li><p>当将特定的对称性分配给 时<code>Mole.symmetry</code>，初始化函数<code>Mole.build()</code>将测试分子几何形状是否符合所需的对称性。如果没有，初始化将停止并发出错误消息：</p>
<figure class="highlight clean"><table><tr><td class="code"><pre><span class="line">mol = gto.Mole()</span><br><span class="line">mol.atom = <span class="string">&#x27;O 0 0 0; C 0 0 1&#x27;</span></span><br><span class="line">mol.symmetry = <span class="string">&#x27;Dooh&#x27;</span></span><br><span class="line">mol.build()</span><br><span class="line"></span><br><span class="line">#RuntimeWarning: Unable to identify input symmetry Dooh.</span><br><span class="line">#Try symmetry=<span class="string">&quot;Coov&quot;</span> <span class="keyword">with</span> geometry (unit=<span class="string">&quot;Bohr&quot;</span>)</span><br><span class="line">#(<span class="string">&#x27;O&#x27;</span>, [<span class="number">0.0</span>, <span class="number">0.0</span>, <span class="number">-0.809882624813598</span>])</span><br><span class="line">#(<span class="string">&#x27;C&#x27;</span>, [<span class="number">0.0</span>, <span class="number">0.0</span>, <span class="number">1.0798434997514639</span>])</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="电荷和自旋"><a href="#电荷和自旋" class="headerlink" title="电荷和自旋"></a>电荷和自旋</h2><ul>
<li><p>属性<code>Mole.charge</code>是定义系统中电子总数的参数。</p>
<ul>
<li>自定义系统中指定电子总数用<code>Mole.nelectron</code>：</li>
</ul>
</li>
<li><p><code>Mole.spin</code>是未成对电子的数量<em>2S</em>，即 alpha 和 beta 电子的数量之差。</p>
</li>
</ul>
<figure class="highlight ini"><table><tr><td class="code"><pre><span class="line"><span class="attr">mol.charge</span> = <span class="number">1</span></span><br><span class="line"><span class="attr">mol.spin</span> = <span class="number">1</span></span><br></pre></td></tr></table></figure>
<ul>
<li>这两个属性不影响<code>Mole.build</code>初始化函数中的任何其他参数。可以在<code>Mole</code>对象初始化后设置或修改它们 ：</li>
</ul>
<figure class="highlight lsl"><table><tr><td class="code"><pre><span class="line">mol = gto.Mole()</span><br><span class="line">mol.atom = &#x27;O <span class="number">0</span> <span class="number">0</span> <span class="number">0</span>; h <span class="number">0</span> <span class="number">1</span> <span class="number">0</span>; h <span class="number">0</span> <span class="number">0</span> <span class="number">1</span>&#x27;</span><br><span class="line">mol.basis = &#x27;sto<span class="number">-6</span>g&#x27;</span><br><span class="line">mol.spin = <span class="number">2</span></span><br><span class="line">mol.build()</span><br><span class="line">print(mol.nelec)</span><br><span class="line">#(<span class="number">6</span>, <span class="number">4</span>)</span><br><span class="line">mol.spin = <span class="number">0</span></span><br><span class="line">print(mol.nelec)</span><br><span class="line">#(<span class="number">5</span>, <span class="number">5</span>)</span><br></pre></td></tr></table></figure>
<h2 id="核模型"><a href="#核模型" class="headerlink" title="核模型"></a>核模型</h2><p><code>Mole.nucmod</code>：</p>
<ul>
<li>0 或 None 表示点核模型。默认。</li>
<li>其他值将启用高斯核模型。</li>
<li>如果为该属性分配了一个函数，则将调用该函数生成核电荷分布值“zeta”，并将相关核模型设置为高斯模型。为点核模型。</li>
</ul>
<h2 id="打印级别"><a href="#打印级别" class="headerlink" title="打印级别"></a>打印级别</h2><ul>
<li><p><code>Mole.verbose</code>全局控制打印级别（打印级别可以是 0（安静，无输出）到 9（非常嘈杂）。最有用的消息在第 4 级（信息）和第 5 级（调试）打印）：</p>
<figure class="highlight ini"><table><tr><td class="code"><pre><span class="line"><span class="attr">mol.verbose</span> = <span class="number">4</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="输出和内存"><a href="#输出和内存" class="headerlink" title="输出和内存"></a>输出和内存</h2><ul>
<li><p><code>Mole.output</code>可以指定写入输出的位置（如果未分配此变量，消息将转储到 <code>sys.stdout</code>.）：</p>
<figure class="highlight ini"><table><tr><td class="code"><pre><span class="line"><span class="attr">mol.output</span> = <span class="string">&#x27;path/to/log.txt&#x27;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>默认情况下，输入文件会在输出的开头，可以通过<code>Mole.dump_input=False</code>关闭</li>
</ul>
</li>
<li><p><code>Mole.max_memory</code>可以全局控制最大内存使用量</p>
<figure class="highlight ini"><table><tr><td class="code"><pre><span class="line"><span class="attr">mol.max_memory</span> = <span class="number">1000</span> <span class="comment"># MB</span></span><br></pre></td></tr></table></figure>
<ul>
<li>默认大小也可以使用 shell 环境变量PYSCF_MAX_MEMORY定义。</li>
</ul>
</li>
<li><p>属性<code>Mole.output</code>和<code>Mole.max_memory</code>也可以从命令行分配：</p>
<figure class="highlight vim"><table><tr><td class="code"><pre><span class="line"><span class="keyword">python</span> <span class="built_in">input</span>.<span class="keyword">py</span> -<span class="keyword">o</span> /path/<span class="keyword">to</span>/my_log.txt -<span class="keyword">m</span> <span class="number">1000</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>默认情况下，命令行具有最高优先级，这意味着脚本中的设置将被命令行参数覆盖。如果想要忽略命令行的参数，可以通过<code>Mole.parse_arg=False</code>关闭。</p>
<figure class="highlight lsl"><table><tr><td class="code"><pre><span class="line">mol = gto.M(</span><br><span class="line">    verbose = <span class="number">5</span>,</span><br><span class="line">    atom = &#x27;H  <span class="number">0</span> <span class="number">0</span> <span class="number">1</span>; H <span class="number">0</span> <span class="number">0</span> <span class="number">2</span>&#x27;,</span><br><span class="line">    dump_input=False,</span><br><span class="line">    parse_arg=False,</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<ul>
<li><p>还可以调用 <code>Mole.build(0,0)</code>，第一个<code>0</code>防止<code>build()</code>转储输入文件。第二个<code>0</code>阻止<code>build()</code>解析命令行参数：</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">mol.build(<span class="number">0</span>, <span class="number">0</span>)</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h1 id="Mole-build"><a href="#Mole-build" class="headerlink" title="Mole.build()"></a><code>Mole.build()</code></h1><ul>
<li><p>设置分子并初始化一些控制参数。每当更改 Mole 的属性值时，都需要调用此函数来刷新 Mole 的内部数据。</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">build(<span class="attribute">dump_input</span>=<span class="literal">True</span>, <span class="attribute">parse_arg</span>=<span class="literal">True</span>, <span class="attribute">verbose</span>=None, <span class="attribute">output</span>=None, <span class="attribute">max_memory</span>=None, <span class="attribute">atom</span>=None, <span class="attribute">basis</span>=None, <span class="attribute">unit</span>=None, <span class="attribute">nucmod</span>=None, <span class="attribute">ecp</span>=None, <span class="attribute">charge</span>=None, <span class="attribute">spin</span>=0, <span class="attribute">symmetry</span>=None, <span class="attribute">symmetry_subgroup</span>=None, <span class="attribute">cart</span>=None)</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>dump_input</code>：布尔值，是否将输入文件的内容转储到输出文件中</p>
</li>
<li><p><code>parse_arg</code>：布尔值，是否读取命令行参数并覆盖相关参数</p>
</li>
<li><p>其余与<code>Mole</code>中类似，如果指定，会覆盖<code>Mole.**</code></p>
</li>
</ul>
<h1 id="属性"><a href="#属性" class="headerlink" title="属性"></a>属性</h1><p>由 <code>Mole.build()</code> 生成的属性</p>
<h2 id="一般属性"><a href="#一般属性" class="headerlink" title="一般属性"></a>一般属性</h2><ul>
<li><p><code>Mole.natm</code>：原子个数 </p>
</li>
<li><p><code>Mole.nelectron</code>或者<code>Mole.nelec</code>：核电荷总和</p>
</li>
<li><p><code>Mole.atom_symbol(*atm_id*)</code>：对于指定的原子ID，输出原子的名称</p>
</li>
<li><p><code>Mole.atom_pure_symbol(*atm_id*)</code>：对于指定的原子ID，输出原子的标砖符号</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>mol.build(atom=<span class="string">&#x27;H^2 0 0 0; H 0 0 1.1&#x27;</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>mol.atom_symbol(<span class="number">0</span>)</span><br><span class="line">H^<span class="number">2</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(mol.atom_pure_symbol(<span class="number">0</span>))</span><br><span class="line">H</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="坐标"><a href="#坐标" class="headerlink" title="坐标"></a>坐标</h2><ul>
<li><p><code>Mole.atom_coord(*atm_id*, *unit=&#39;Bohr&#39;*)</code>：指定的原子ID，输出坐标数组。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>mol.build(atom=<span class="string">&#x27;H 0 0 0; Cl 0 0 1.1&#x27;</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>mol.atom_coord(<span class="number">1</span>)</span><br><span class="line">[ <span class="number">0.</span>          <span class="number">0.</span>          <span class="number">2.07869874</span>]</span><br></pre></td></tr></table></figure>
</li>
<li><p>可以通过该<code>Mole.atom_coords()</code>函数访问分子几何结构。此函数为每个原子的坐标返回一个 (N,3) 数组：</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line"><span class="builtin-name">print</span>(mol.atom_coords(<span class="attribute">unit</span>=<span class="string">&#x27;Bohr&#x27;</span>)) # unit can be <span class="string">&quot;ANG&quot;</span> <span class="keyword">or</span> <span class="string">&quot;Bohr&quot;</span></span><br><span class="line"><span class="comment">#默认单位是Bohr</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="对称性-1"><a href="#对称性-1" class="headerlink" title="对称性"></a>对称性</h2><ul>
<li><p>点群对称信息保存在<code>Mole</code>对象中。PySCF的对称模块 ( <code>symm</code>) 可以检测任意点群。检测到的点组保存在中<code>Mole.topgroup</code>，支持的子组保存在 中<code>Mole.groupname</code>：</p>
<figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="title">print</span><span class="params">(mol.topgroup)</span></span></span><br><span class="line">#C3v</span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(mol.groupname)</span></span></span><br><span class="line">#Cs</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="对称适应轨道"><a href="#对称适应轨道" class="headerlink" title="对称适应轨道"></a>对称适应轨道</h2><p>在<code>Mole</code>对象中启用对称时，点群对称信息将用于构建对称适应轨道基组</p>
<ul>
<li><p><code>Mole.symm_orb</code>：对称适应轨道被保存为二维阵列列表。列表中的每个元素都是不可约表示的 AO（原子轨道）到对称适应轨道<strong>转换矩阵</strong>。</p>
</li>
<li><p><code>Mole.irrep_name</code>：不可约表示的名称，是一个字符串的列表。</p>
</li>
<li><p><code>Mole.irrep_id</code>：不可约表示的内部 ID，是一个整数的列表。</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">mol = gto.Mole()</span><br><span class="line">mol.atom = <span class="string">&#x27;O 0 0 0; O 0 0 1.2&#x27;</span></span><br><span class="line">mol.spin = <span class="number">2</span></span><br><span class="line">mol.symmetry = <span class="string">&quot;D2h&quot;</span></span><br><span class="line">mol.build()</span><br><span class="line"><span class="keyword">for</span> s,i,c <span class="keyword">in</span> zip(mol.irrep_name, mol.irrep_id, mol.symm_orb):</span><br><span class="line">    print(s, i, c.shape)</span><br><span class="line">    </span><br><span class="line"># Ag <span class="number">0</span> (<span class="number">10</span>, <span class="number">3</span>)</span><br><span class="line"># B2g <span class="number">2</span> (<span class="number">10</span>, <span class="number">1</span>)</span><br><span class="line"># B3g <span class="number">3</span> (<span class="number">10</span>, <span class="number">1</span>)</span><br><span class="line"># B1u <span class="number">5</span> (<span class="number">10</span>, <span class="number">3</span>)</span><br><span class="line"># B2u <span class="number">6</span> (<span class="number">10</span>, <span class="number">1</span>)</span><br><span class="line"># B3u <span class="number">7</span> (<span class="number">10</span>, <span class="number">1</span>)</span><br></pre></td></tr></table></figure>
</li>
<li><p>对称适应轨道用作以下 SCF 或后 SCF 计算的基函数：</p>
<figure class="highlight makefile"><table><tr><td class="code"><pre><span class="line">mf = scf.RHF(mol)</span><br><span class="line">mf.kernel()</span><br><span class="line"><span class="comment"># converged SCF energy = -147.631655286561</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>可以检查每个不可约表示中 MO 的占用情况：</p>
<ul>
<li><p>为了标记给定轨道的不可约表示， <code>symm.label_orb_symm()</code>需要在<code>Mole</code>对象中初始化的点群对称性信息，包括不可约表示的 ID ( <code>Mole.irrep_id</code>) 和对称适应基<code>Mole.symm_orb</code>。对于每个<code>irrep_id</code>， <code>Mole.irrep_name</code>给出相关的不可表达符号 (A1, B1 …)。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy</span><br><span class="line"><span class="keyword">from</span> pyscf <span class="keyword">import</span> symm</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">myocc</span>(<span class="params">mf</span>):</span></span><br><span class="line">    mol = mf.mol</span><br><span class="line">    irrep_id = mol.irrep_id</span><br><span class="line">    so = mol.symm_orb</span><br><span class="line">    orbsym = symm.label_orb_symm(mol, irrep_id, so, mf.mo_coeff)</span><br><span class="line">    doccsym = numpy.array(orbsym)[mf.mo_occ==<span class="number">2</span>]</span><br><span class="line">    soccsym = numpy.array(orbsym)[mf.mo_occ==<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">for</span> ir,irname <span class="keyword">in</span> <span class="built_in">enumerate</span>(mol.irrep_name):</span><br><span class="line">        print(<span class="string">&#x27;%s, double-occ = %d, single-occ = %d&#x27;</span> %</span><br><span class="line">              (irname, <span class="built_in">sum</span>(doccsym==ir), <span class="built_in">sum</span>(soccsym==ir)))</span><br><span class="line">myocc(mf)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Ag, double-occ = 3, single-occ = 0</span></span><br><span class="line"><span class="comment"># B2g, double-occ = 0, single-occ = 0</span></span><br><span class="line"><span class="comment"># B3g, double-occ = 0, single-occ = 1</span></span><br><span class="line"><span class="comment"># B1u, double-occ = 0, single-occ = 1</span></span><br><span class="line"><span class="comment"># B2u, double-occ = 0, single-occ = 0</span></span><br><span class="line"><span class="comment"># B3u, double-occ = 2, single-occ = 0</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>在 SCF 计算中，可以通过为不规则分配 alpha 电子和 beta 电子(alpha,beta)的数量来控制波函数的对称性 ：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">mf.irrep_nelec = &#123;<span class="string">&#x27;B2g&#x27;</span>: (<span class="number">1</span>,<span class="number">1</span>), <span class="string">&#x27;B3g&#x27;</span>: (<span class="number">1</span>,<span class="number">1</span>), <span class="string">&#x27;B2u&#x27;</span>: (<span class="number">1</span>,<span class="number">0</span>), <span class="string">&#x27;B3u&#x27;</span>: (<span class="number">1</span>,<span class="number">0</span>)&#125;</span><br><span class="line">mf.kernel()</span><br><span class="line"><span class="comment"># converged SCF energy = -146.97333043702</span></span><br><span class="line">mf.get_irrep_nelec()</span><br><span class="line"><span class="comment"># &#123;&#x27;Ag&#x27;: (3, 3), &#x27;B2g&#x27;: (1, 1), &#x27;B3g&#x27;: (1, 1), &#x27;B1u&#x27;: (2, 2), &#x27;B2u&#x27;: (1, 0), &#x27;B3u&#x27;: (1, 0)&#125;</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
]]></content>
      <categories>
        <category>计算化学</category>
        <category>软件</category>
      </categories>
      <tags>
        <tag>输入</tag>
        <tag>Pyscf</tag>
      </tags>
  </entry>
  <entry>
    <title>【molpro】01.基础</title>
    <url>/2019/11/13/%E3%80%90molpro%E3%80%9101.%E5%9F%BA%E7%A1%80/</url>
    <content><![CDATA[<h1 id="运行molpro"><a href="#运行molpro" class="headerlink" title="运行molpro"></a>运行molpro</h1><h2 id="输入"><a href="#输入" class="headerlink" title="输入"></a>输入</h2><p>在UNIX系统中，MOLPRO通过unix命令molpro访问：</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">molpro</span> <span class="selector-attr">[options]</span> <span class="selector-attr">[datafile]</span></span><br></pre></td></tr></table></figure>
<ul>
<li><p><code>datafile</code>：输入文件，可以取任何名字，但是要避免使用.out作为后缀，一般用.inp。unix中出现在molpro输入文件中的文件名总是转化为小写。</p>
</li>
<li><p>options：大部分选项都有合适的系统默认值，但是也可以在命令行中、环境变量MOLPRO OPTIONS中或文件./molpro.rc，$HOME/.molprorc，和library文件目录下的tuning.rc中（优先级递减）：</p>
<ul>
<li><p><code>-d [directory]</code> ：临时文件是临时的，并在作业结束时消失。默认情况下，此目录的位置为<code>/tmp/$USER</code>，或取自环境变量 TMPDIR。可以通过该选项定义放置临时文件的目录，</p>
</li>
<li><p><code>-m n_scale</code>：<span id=mm>指定分配给程序的工作内存，单位是word=8byte</span></p>
<ul>
<li><code>k</code>，<code>m</code>，<code>g</code>分别为10<sup>3</sup>，10<sup>6</sup>，10<sup>9</sup></li>
<li><code>K</code>，<code>M</code>，<code>G</code>分别为2<sup>10</sup>，2<sup>20</sup>，2<sup>30</sup> </li>
</ul>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">#需要<span class="number">1000</span>word的内存</span><br><span class="line">-m <span class="number">1</span>k</span><br><span class="line">#需要<span class="number">1024</span>word的内存</span><br><span class="line">-M <span class="number">1</span>K</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>用于并行执行的选项（在使用串行MOLPRO时，将忽略这些选项）：</p>
<ul>
<li><p><code>-n</code>：定义设置的并行进程个数</p>
<p>并行内存计算eg. 为具有4个并行计算过程的作业指定100×10<sup>6</sup>个word：100×10<sup>6</sup>×8×4=3.2×10<sup>9</sup>byte</p>
</li>
<li><p><code>-N</code> ：等指定工作节点的主机名</p>
</li>
</ul>
</li>
</ul>
<h2 id="输出文件"><a href="#输出文件" class="headerlink" title="输出文件"></a>输出文件</h2><h3 id="out文件"><a href="#out文件" class="headerlink" title="out文件"></a>out文件</h3><p>执行结果会把输出写到一个名称输入文件截掉扩展名并加上<code>.out</code>产生的文件中。如果输出文件已经存在，防止覆盖文件，会把旧文件重命名为后缀为<code>.out_1</code>的文件中。如果命令行没有给出<code>datafile</code>，那么从标准输入读取数据。在命令行中可以有其他方式：</p>
<ul>
<li><p><code>-o [outfile]</code> ：自定义输出名</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">molpro</span> <span class="selector-tag">-o</span> <span class="selector-tag">water</span><span class="selector-class">.output</span> <span class="selector-tag">h2o</span><span class="selector-class">.inp</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><code>-s</code>：不保存旧的输出文件，只是覆盖。</p>
</li>
</ul>
<h3 id="punch文件"><a href="#punch文件" class="headerlink" title="punch文件"></a>punch文件</h3><p>punch文件是output文件的简易形式，它包含了最重要的数据和结果，例如几何结构，能量，偶极矩等。可以用独立的程序readpun处理，它用关键词选择特定的结果，并根据用户提供的格式产生排列好的表格。</p>
<figure class="highlight autohotkey"><table><tr><td class="code"><pre><span class="line"><span class="built_in">PUNCH,</span>filename,[REWIND]</span><br></pre></td></tr></table></figure>
<ul>
<li><p>指定的<code>filename</code>会在unix中转换成小写</p>
</li>
<li><p>punch文件如果已经存在，则对其添加内容，如果指定了<code>REWIND</code>或者<code>NEW</code>，punch文件中所有以前的信息都被覆盖。</p>
</li>
<li><p>eg.</p>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">PUNCH</span>,H<span class="number">2</span>O.PUN</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="xml文件"><a href="#xml文件" class="headerlink" title="xml文件"></a>xml文件</h3><p>除了生成.out文件外，还用. XML后缀创建结构化XML文件(实际上是.out文件的父文件)。这个文件可以用于结果的自动处理，例如<a href="http://jmol.sourceforge.net/">Jmol程序</a>（需要下载<a href="https://www.java.com/en/download/manual.jsp">java运行环境JRE</a>）的图形化呈现。</p>
<ul>
<li><code>-X</code>或者<code>--xml-output</code>：指定输出文件为格式规范的XML文件，适于自动后期处理。重要的数据如输入，结构，以及结果都被加上标记，通常的大块描述性输出都作为XML注释折叠起来。</li>
<li><code>--no-xml-output</code>：强制产生纯文本输出。</li>
<li><code>--xml2txt</code>：将xml文件转换为纯文本文件，此时molpro的输入文件应该是一个xml文件。</li>
</ul>
<h3 id="9个二进制文件"><a href="#9个二进制文件" class="headerlink" title="9个二进制文件"></a>9个二进制文件</h3><ul>
<li><p>程序通过它们的编号（1到9）可以简单地识别它们。</p>
</li>
<li><p>默认是临时文件，用<a href="#file卡"><code>FILE</code>命令</a>可以把计算出的数据作为轨道和能量保存到永久文件中，并在以后的阶段使用它们重启计算，默认的保存路径为$HOME/wfu，可以使用<code>-W</code>修改路径：</p>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">molpro</span> -W ./ h<span class="number">2</span>o.inp</span><br></pre></td></tr></table></figure>
</li>
<li><p>文件类型：</p>
<ul>
<li>文件1：主文件，存有基组，几何结构，以及单电子和双电子积分。</li>
<li>文件2：默认是转存文件，用于存储波函的信息，即：轨道，轨道能量，可选的CI矢量，以及密度矩阵。</li>
<li>文件3：辅助文件，和文件2一起用于续算</li>
<li>文件4~8：草稿文件空间，用来分类积分，存储转换的积分和CI矢量。这些文件通常无需存为永久文件。</li>
</ul>
<p>通常文件1和2（以及3）被声明为用于续算的永久文件。文件2对于重新启动计算是必不可少的，而文件1上的积分可以重新启动，也可以重新计算。把波函信息存储在文件2中非常有用的，因为对于每个新的结构，积分文件都会被改写，而一个计算中的轨道和CI因子可以用作下一个相近几何结构计算的初始猜测。</p>
</li>
</ul>
<h3 id="记录文件"><a href="#记录文件" class="headerlink" title="记录文件"></a>记录文件</h3><ul>
<li>记录文件的名称是正整数，引用格式为record.file，比如2100.2表示命名为2100的2文件。记录文件的名称比较随意，它们的数值与记录在文件中的顺序无关。</li>
<li><p>不要使用≥2000的记录名字，因为有一些默认的记录为：</p>
<ul>
<li><code>2100</code>：RHF转存记录（闭壳层和开壳层）</li>
<li><code>2200</code>：UHF转存记录</li>
<li><code>2140</code>：MCSCF转存记录</li>
<li><code>4100</code>：CPHF续算信息</li>
<li><code>5000</code>：MCSCF梯度信息</li>
<li><code>5100</code>：CP-MCSCF梯度信息</li>
<li><code>5200</code>：MP2梯度信息</li>
<li><code>5300</code>：Hessian续算信息</li>
<li><code>5400</code>：频率续算信息</li>
<li><code>6300</code>：域的续算信息</li>
</ul>
</li>
<li><p>如果一个输入包含同一类型的几个波函计算，例如不同活性空间的几个MCSCF计算，则对同一类型的每个计算，记录编号加1。比如第一个SCF计算的结果存储在转存记录2100.2中，第二个SCF计算存于2101.2记录，第一个MCSCF计算存于2140.2，第二个MCSCF存于2141.2等等。这些数字和输入中出现的顺序有关，而不是按照计算实际执行的顺序。</p>
</li>
</ul>
<h3 id="put输出其他格式"><a href="#put输出其他格式" class="headerlink" title="put输出其他格式"></a>put输出其他格式</h3><figure class="highlight fortran"><table><tr><td class="code"><pre><span class="line">PUT,style,<span class="keyword">file</span>,<span class="keyword">status</span>,info</span><br></pre></td></tr></table></figure>
<ul>
<li><p><code>style</code>：</p>
<ul>
<li><p><code>GAUSSIAN</code>：写一个完整的GAUSSIAN输入文件，默认为<code># sp</code>计算</p>
</li>
<li><p><code>XYZ</code>：输出xyz文件</p>
</li>
<li><p><code>XYZGRAD</code>：包含能量梯度的XYZ文件（列依次是：x，y，z，charge，gx，gy，gz，梯度为-1*eV/A）</p>
</li>
<li><p><code>CRD</code>：坐标将用CHARMm CRD格式书写</p>
</li>
<li><p><code>MOLDEN</code>：将创建用于MOLDEN可视化程序的接口文件</p>
<ul>
<li>注意：<font color=red>molden文件不支持含h以上角动量的基组，如果仅需要可视化轨道查看，那么可以将基组中的h删去，输出molden文件，结果差别很小。</font></li>
</ul>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">put</span>,molden,h<span class="number">2</span>o.molden;</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>IRSPEC</code>：gnuplot输入文件，该文件可用于绘制IR光谱</p>
</li>
<li><p>忽略则写入当前结构的Z矩阵，可能的话还写入梯度。</p>
</li>
</ul>
</li>
<li>file定义写入数据的文件名；如果为空，数据将写入到输出流中。如果忽略status或设置为NEW，那么文件中所有的旧内容都被清除；否则对文件追加。</li>
</ul>
<h1 id="输入文件格式"><a href="#输入文件格式" class="headerlink" title="输入文件格式"></a>输入文件格式</h1><h2 id="一般结构"><a href="#一般结构" class="headerlink" title="一般结构"></a>一般结构</h2><figure class="highlight erlang-repl"><table><tr><td class="code"><pre><span class="line">***,title			! 标题（可选）</span><br><span class="line">memory,<span class="number">4</span>,m 			! 内存指定（可选）</span><br><span class="line">file,<span class="number">1</span>,name.int 	! 命名永久的积分文件（可选）</span><br><span class="line">file,<span class="number">2</span>,name.wfu 	! 命名永久的波函文件（可选）</span><br><span class="line"></span><br><span class="line">gprint,options 		! 全局打印选项（可选）</span><br><span class="line">gthresh,options 	! 全局阈值（可选）</span><br><span class="line">gdirect[,options] 	! 全局直接积分选项（可选）</span><br><span class="line">gexpec,opnames 		! 单电子算符的全局定义（可选）</span><br><span class="line"></span><br><span class="line">basis=basisname 	! 基的定义。如果不出现，使用cc-pVDZ</span><br><span class="line">geometry=&#123;...&#125; 		! 结构定义。</span><br><span class="line"></span><br><span class="line">var1=value,var2=value,... 	! 设定结构和/或波函定义中的变量</span><br><span class="line"></span><br><span class="line">&#123;command,options 		! 程序或流程的名称</span><br><span class="line">directive,data,option 	! 命令的指令（可选）</span><br><span class="line">...</span><br><span class="line">&#125; 				! 结束命令区</span><br><span class="line">--- 			! 结束输入（可选）</span><br></pre></td></tr></table></figure>
<ul>
<li>输了memory卡应该是紧随标题的第一个以外，其他basis，geometry，gprint，gdirect，gthresh，gexpec，以及变量定义的顺序是任意的。</li>
<li>可以在一个程序后调用其它几个程序。在程序的调用之间还可以重新定义基组和/或分子结构；程序将会自动确认是否需要重新计算积分。</li>
</ul>
<h2 id="一般规则"><a href="#一般规则" class="headerlink" title="一般规则"></a>一般规则</h2><ul>
<li><code>,</code>移到下一个制表位，即用来划定输入范围。</li>
<li><code>;</code>结束记录，开始一个新的记录。用分号隔开的基本命令单位称为卡（card）。一个给定的输入行可以包含多个有效命令（用；隔开），也可以只有一个。</li>
<li><code>!</code>忽略该输入行后面的内容（用于注释）。</li>
<li>内容不区分大小写，统一转换为大写处理。引号中的内容会被认为是字符串，不会进行大小写转换。</li>
<li>整数后面加上<code>.</code>，程序只读取浮点数</li>
</ul>
<p>一般只占用一行的命令：</p>
<ul>
<li><code>***</code>总是第一个数据行，title可以任选，但是如果文件1用于续算，title必须总是相同。这个卡的作用是重新设置所有程序的计数器等。如果忽略<em>*</em>卡，title假定用默认值，全是空格。</li>
<li><code>INCLUDE</code>包含其它的输入文件。使用<code>INCLUDE</code>可以打开辅助输入文件。如果遇到了<code>INCLUDE</code>命令，则打开新的输入文件并读取到结束，然后在第一个输入文件中继续INCLUDE卡之后的输入。<code>INCLUDE</code>也可以嵌套。</li>
<li><code>FILE</code>指定已命名的文件</li>
<li><code>TEXT</code>打印文本</li>
<li><code>TITLE</code>定义运行的标题或表格的标题</li>
<li><code>CON</code>指定轨道组态</li>
<li><code>---</code>结束文件（忽略之后的输入）</li>
</ul>
<h2 id="一般格式"><a href="#一般格式" class="headerlink" title="一般格式"></a>一般格式</h2><p>整体格式一般是：</p>
<figure class="highlight autohotkey"><table><tr><td class="code"><pre><span class="line"><span class="built_in">COMMAND,</span> options</span><br></pre></td></tr></table></figure>
<p>或者</p>
<figure class="highlight haskell"><table><tr><td class="code"><pre><span class="line">&#123; <span class="type">COMMAND</span>,options</span><br><span class="line"><span class="title">directives</span></span><br><span class="line"><span class="class"><span class="keyword">data</span></span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>命令（COMMAND）比如有<code>HF, MP2, CCSD(T), MCSCF, MRCI</code></li>
<li>指令（directives）比如有<code>OCC, CLOSED, WF, PRINT</code>等，格式一般<code>DIRECTIVE,data,options</code></li>
<li>选项（options）的格式一般是<code>NAME[=value]</code><ul>
<li>多个选项以逗号或空格分隔。</li>
<li>如果选项在COMMAND一行或命令块内的指令上给出，则它们仅对相应的程序有效。</li>
</ul>
</li>
</ul>
<h1 id="memory卡"><a href="#memory卡" class="headerlink" title="memory卡"></a>memory卡</h1><figure class="highlight autohotkey"><table><tr><td class="code"><pre><span class="line"><span class="built_in">MEMORY,</span>n,scale<span class="comment">;</span></span><br></pre></td></tr></table></figure>
<ul>
<li><a href="#mm">与命令行中的<code>-m</code>不同</a>，scale中<code>k</code>，<code>m</code>，<code>g</code>不区分大小写，统一按10<sup>3</sup>，10<sup>6</sup>，10<sup>9</sup></li>
<li>优先于命令行中的<code>-m</code>。两者都省略的话，程序将使用默认的内存大小8mw (64 Mb)。</li>
</ul>
<p>MOLPRO可以根据用户的需要动态分配内存。因此不需要保存有不同内存大小的不同版本程序。所需要的内存大小取决于分子的大小、基组、分子的对称性和使用的方法，因此很难提前预测。大多数计算运行在16mw或更少，但在大的情况下，低对称性可能需要更多。一个比较好的选择是64MW（512MB），前提是系统有足够的内存。</p>
<ul>
<li>算到一半但是没有报错就停止了，可以将.sub文件中并行核数设大一些，比如24，再将molpro中的并行设置-n中的设置小一些。</li>
</ul>
<h1 id="file卡"><a href="#file卡" class="headerlink" title="file卡"></a>file卡</h1><p>对所有的永久文件，默认设置是RESTART。所有的临时文件在需要时通常自动分配。I/O缓存分配到动态内存的顶端，缓存的大小会减少可用的内存。因此MEMORY卡必须出现在第一个FILE卡之前。</p>
<figure class="highlight fortran"><table><tr><td class="code"><pre><span class="line"><span class="keyword">FILE</span>,<span class="keyword">file</span>,<span class="keyword">name</span>,[<span class="keyword">status</span>]</span><br></pre></td></tr></table></figure>
<ul>
<li><code>file</code>是逻辑MOLPRO文件序号(1-9)</li>
<li><code>name</code>是文件名（将被转换成小写字母）</li>
<li><code>status</code>可以是：<ul>
<li><code>UNKNOWN</code>打开永久文件。如果存在，自动续算。这是默认的。</li>
<li><code>OLD</code>作用同<code>UNKNOWN</code>。如果该文件不存在，不会发生错误。</li>
<li><code>NEW</code> 打开永久文件。如果已经存在，则清除，不续算。</li>
<li><code>ERASE</code> 作用同<code>NEW</code>。</li>
<li><code>SCRATCH</code> 打开临时文件。如果已经存在，则清除，不续算。任务完成后，文件不<br>再存在。</li>
<li><code>DELETE</code> 作用同<code>SCRATCH</code>。</li>
</ul>
</li>
</ul>
<p>例子：</p>
<ul>
<li><p>分配永久文件1的名称H2O.INT，如果存在会使用它进行续算。比如第一个输入中只计算了hf和ccsd(t)，使用了该指令，后续计算casscf和MRCI的时候，指定了相同的文件，，MOLPRO将自动恢复保存在给定文件中的所有数据，积分和轨道将被重新启动。</p>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">FILE</span>,<span class="number">1</span>,H<span class="number">2</span>O.INT</span><br></pre></td></tr></table></figure>
</li>
<li><p>分配永久文件2的名称H2O.WFU，即禁用自动重启机制</p>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">FILE</span>,<span class="number">2</span>,H<span class="number">2</span>O.WFU,NEW</span><br></pre></td></tr></table></figure>
</li>
<li><p>在大多数情况下，文件1可能非常大(它包含两个电子的积分)，而重新计算积分的成本可能只占总时间的一小部分，因此可以只在输入中只定义文件2，积分会自动重新计算。</p>
</li>
</ul>
<h1 id="print-gprint-全局打印选项"><a href="#print-gprint-全局打印选项" class="headerlink" title="print/gprint 全局打印选项"></a>print/gprint 全局打印选项</h1><p>通常，有两种打印选项：一种是局部的，由print指令指定，仅在一个作业步骤中使用；一种是全局的，在各个程序以外可以用GPRINT命令设置全局打印选项（g可加可不加，加了可以避免与程序特定的PRINT卡相混淆）。局部打印命令是特定方法输入的一部分，因此必须直接遵循相应的命令。全局打印选项作用于所有后续方法。</p>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">GPRINT</span>,key<span class="number">1</span>[=value<span class="number">1</span>],key<span class="number">2</span>[=value<span class="number">2</span>],. . .</span><br><span class="line"><span class="attribute">NOGPRINT</span>,key<span class="number">1</span>,key<span class="number">2</span>,. . .</span><br></pre></td></tr></table></figure>
<ul>
<li>除了<code>DISTANCE</code>，<code>ANGLES</code>，和<code>VARIABLE</code>之外，全部选项默认都不打印。<code>key</code>有：<ul>
<li><code>BASIS</code>：打印基的信息</li>
<li><code>DISTANCE</code>：打印键长（默认）</li>
<li><code>ANGLES</code>：打印键角信息（默认=0）。如果大于0，还打印二面角</li>
<li><code>ORBITAL(=int)</code>：打印SCF和MCSCF的轨道，打印每个对称性下的占据轨道和int个最低空轨道。</li>
<li><code>CIVECTOR</code>：打印MCSCF的CI矢量（注意，默认情况下只打印大于0.05的CI系数。）</li>
<li><code>PAIRS</code>：打印CI和CCSD中的电子对列表</li>
<li><code>CS</code>：打印CI和CCSD中的单激发信息</li>
<li><code>CP</code>：打印CI和CCSD中的对激发信息</li>
<li><code>REF</code>：打印CI中的参考CSF及其因子</li>
<li><code>PSPACE</code>：打印p-空间组态</li>
<li><code>MICRO</code>：打印MCSCF和CI中的微迭代</li>
<li><code>CPU</code>：打印详细的CPU信息</li>
<li><code>IO</code>：打印详细的I/O信息</li>
<li><code>VARIABLE</code>：每当变量设置或改变时，就打印变量（默认）</li>
</ul>
</li>
<li>value可以省略，当values，大于0的值可用于调试，在有些情况下会给出更多的信息。</li>
<li><code>NOGPRINT,key</code>等价于<code>PRINT, key =-1</code>。</li>
</ul>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">gprint,basis             !<span class="builtin-name">print</span> basis <span class="builtin-name">set</span> information</span><br><span class="line">gprint,orbitals          !<span class="builtin-name">print</span> occupied orbitals</span><br><span class="line">gprint,<span class="attribute">orbitals</span>=2        !<span class="builtin-name">print</span> occupied <span class="keyword">and</span> the two lowest virtual orbitals</span><br><span class="line">                         !<span class="keyword">in</span> each symmetry</span><br><span class="line">gprint,civector          !<span class="builtin-name">print</span> configuration coefficients</span><br></pre></td></tr></table></figure>
<h1 id="geometry卡"><a href="#geometry卡" class="headerlink" title="geometry卡"></a>geometry卡</h1><p>定义分子结构可以用标准Z矩阵形式，或XYZ形式。GEOMETRY必须出现在其它修改分子结构的命令之后。</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line"><span class="string">[SYMMETRY, options ]</span></span><br><span class="line"><span class="string">[ORIENT, options ]</span> </span><br><span class="line"><span class="string">[ANGSTROM]</span> </span><br><span class="line"><span class="string">[BOHR]</span></span><br><span class="line">geometry=&#123; </span><br><span class="line">原子说明 </span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<ul>
<li><code>symmetry</code>选项<ul>
<li><code>SYMMETRY,NOSYM</code>禁止使用对称性，也可以只用<code>NOSYM</code></li>
<li><code>SYMMETRY,AUTO</code>允许使用对称性</li>
</ul>
</li>
<li><code>orient</code>选项：（也可以用<code>CENTRE=MASS|CHARGE</code>指定对称中心。）<ul>
<li><code>CHARGE</code>：定位分子，使得电荷中心是原点，轴是四极矩的本征矢。</li>
<li><code>MASS</code>：定位分子，使得质心是原点，轴是惯性张量的本征矢（对Z矩阵输入是默认的）</li>
<li><code>NOORIENT</code>：禁止分子重新定位（对XYZ输入是默认的） </li>
<li><code>SIGNX=±1</code>：强制第一个非零x坐标为正或负。类似地，可以用<code>SIGNY</code>和<code>SIGNZ</code>设置y、 z坐标。这对固定遍及几种不同计算和结构的分子方位非常有用。也可以设定系统变量<code>ZSIGNX</code>，<code>ZSIGNY</code>，<code>ZSIGNZ</code>为正值或负值来获得同样的效果。</li>
<li><code>PLANEXZ</code>：对于C<sub>2v</sub>和D<sub>2h</sub>点群，强制主平面是xz，而不是默认的yz。结构构建程序尝试交换坐标轴，使尽可能多的原子位于主平面中，因此对于平面分子的特殊情况，这意味着所有原子都会位于主平面。也可以指定<code>PLANEYZ</code>和<code>PLANEXY</code>，但是后者目前对C2v点群会发生错误。</li>
</ul>
</li>
<li><code>geometry</code>也可以通过<code>geometry=file</code>从文件中读取</li>
</ul>
<h2 id="xyz输入"><a href="#xyz输入" class="headerlink" title="xyz输入"></a>xyz输入</h2><ul>
<li>第一行是原子个数，第二行是任意的标题，前两行可以省略。坐标中单位默认为Å。</li>
<li>元素符号后面可以加序号，用于对于同一类型不同原子使用不同的基组。</li>
</ul>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">geometry=&#123;</span><br><span class="line">   <span class="number">4</span></span><br><span class="line">  FORMALDEHYDE</span><br><span class="line">C          <span class="number">0.0000000000</span>        <span class="number">0.0000000000</span>       <span class="number">-0.5265526741</span></span><br><span class="line">O          <span class="number">0.0000000000</span>        <span class="number">0.0000000000</span>        <span class="number">0.6555124750</span></span><br><span class="line">H          <span class="number">0.0000000000</span>       <span class="number">-0.9325664988</span>       <span class="number">-1.1133424527</span></span><br><span class="line">H          <span class="number">0.0000000000</span>        <span class="number">0.9325664988</span>       <span class="number">-1.1133424527</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Z矩阵输入"><a href="#Z矩阵输入" class="headerlink" title="Z矩阵输入"></a>Z矩阵输入</h2><ul>
<li>坐标默认为玻尔 bohr，可以使用<code>angstrom</code>关键词改变</li>
</ul>
<figure class="highlight mathematica"><table><tr><td class="code"><pre><span class="line">angstrom</span><br><span class="line">geometry=&#123;</span><br><span class="line"><span class="keyword">C</span></span><br><span class="line"><span class="keyword">O</span>   <span class="keyword">C</span>  <span class="number">1.182</span></span><br><span class="line">H1  <span class="keyword">C</span>  <span class="number">1.102</span>  <span class="keyword">O</span>  <span class="number">122.1789</span></span><br><span class="line">H2  <span class="keyword">C</span>  <span class="number">1.102</span>  <span class="keyword">O</span>  <span class="number">122.1789</span>  H1  <span class="number">180</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>也可以通过Z矩阵输入XYZ形式</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">angstrom</span><br><span class="line">geometry=&#123;</span><br><span class="line">C,,        <span class="number">0.0000000000</span> ,     <span class="number">0.0000000000</span> ,    <span class="number">-0.5265526741</span></span><br><span class="line">O,,        <span class="number">0.0000000000</span> ,     <span class="number">0.0000000000</span> ,     <span class="number">0.6555124750</span></span><br><span class="line">H,,        <span class="number">0.0000000000</span> ,    <span class="number">-0.9325664988</span> ,    <span class="number">-1.1133424527</span></span><br><span class="line">H,,        <span class="number">0.0000000000</span> ,     <span class="number">0.9325664988</span> ,    <span class="number">-1.1133424527</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>也可以使用变量</p>
<figure class="highlight mathematica"><table><tr><td class="code"><pre><span class="line">geometry=&#123;</span><br><span class="line"><span class="keyword">C</span></span><br><span class="line"><span class="keyword">O</span>  , <span class="keyword">C</span> , rco</span><br><span class="line">H1 , <span class="keyword">C</span> , rch , <span class="keyword">O</span> , hco</span><br><span class="line">H2 , <span class="keyword">C</span> , rch , <span class="keyword">O</span> , hco , H1 , <span class="number">180</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">rco=<span class="number">1.182</span> Ang</span><br><span class="line">rch=<span class="number">1.102</span> Ang</span><br><span class="line">hco=<span class="number">122.1789</span> <span class="keyword">Degree</span></span><br></pre></td></tr></table></figure>
<h1 id="基组"><a href="#基组" class="headerlink" title="基组"></a>基组</h1><h2 id="笛卡尔和球谐基函数"><a href="#笛卡尔和球谐基函数" class="headerlink" title="笛卡尔和球谐基函数"></a>笛卡尔和球谐基函数</h2><p>MOLPRO默认使用球谐基函数(5d，7f等)，即使是对Pople基组，如6-31G**，也是如此。可以用<code>CARTESIAN</code>命令使用笛卡尔函数，随后所有的计算都使用笛卡尔基函数，在续算中也是如此，可以通过<code>SPHERICAL</code>换成球谐基函数，但是要在给基组之前给出相应的命令。</p>
<h2 id="基组库"><a href="#基组库" class="headerlink" title="基组库"></a>基组库</h2><p>基组库由一组无格式文本文件以及相应的索引构成，组成了通用的基组（原高斯函数和相应的收缩）和有效芯势数据库。这些文件可以在源文件的目录树中找到，分别为lib/*.libmol和lib/libmol.index，但更方便的方法是从数据库里查找：</p>
<ul>
<li><a href="https://www.basissetexchange.org/">美国太平洋西北国家实验室（Pacic Northwest NationalLaboratory）的基组数据库</a></li>
<li><a href="http://www.tc.uni-koeln.de/PP/clickpse.en.html">Stuttgart 有效芯势和基组</a></li>
<li><a href="https://www.molpro.net/info/basis.php?portal=user&amp;choice=Basis+library">molpro网页的basisi.php脚本</a>，可以本地安装也可以直接在网页中获取</li>
</ul>
<h2 id="默认基组及其调用"><a href="#默认基组及其调用" class="headerlink" title="默认基组及其调用"></a>默认基组及其调用</h2><h3 id="指定"><a href="#指定" class="headerlink" title="指定"></a>指定</h3><ul>
<li><p>对任何对称唯一的原子组都没有定义基组，那么程序假定使用全局默认值（VDZ）</p>
</li>
<li><p>通过一下方法指定基组。</p>
<figure class="highlight autohotkey"><table><tr><td class="code"><pre><span class="line"><span class="built_in">BASIS,</span>basis</span><br></pre></td></tr></table></figure>
<p>或</p>
<figure class="highlight ini"><table><tr><td class="code"><pre><span class="line"><span class="attr">BASIS</span>=basis</span><br></pre></td></tr></table></figure>
</li>
<li><p>默认基组可以在输入文件能量计算前的任何位置定义，并且只能使用一个BASIS卡。默认基组应用于所有类型的原子，但是可以对特定的原子替换成不同的基组。</p>
</li>
<li><p><code>BASIS</code>不能作为变量，比如<code>$BASIS=[AVDZ, AVTZ, AVQZ]</code>，使用遍历的方法为：</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line"><span class="variable">$aobases</span>=[AVDZ, AVTZ, AVQZ]</span><br><span class="line"><span class="keyword">do</span> <span class="attribute">i</span>=1,#aobases</span><br><span class="line"><span class="attribute">basis</span>=aobases(i)</span><br><span class="line"><span class="built_in">..</span>.</span><br><span class="line">enddo</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="可调用的基组"><a href="#可调用的基组" class="headerlink" title="可调用的基组"></a>可调用的基组</h3><ul>
<li><code>basis</code>可以在文件lib/defbas中查找，包含的通用基组有：<ul>
<li>所有的Dunning关联一致基组，用基组的标准名称（cc-pVXZ，aug-cc-pVXZ）或缩写（VXZ，AVXZ）调用。对于Al-Ar，用标准名称cc-pV(X+d)Z，aug-cc-pV(X+d)Z，或VXZ+d，AVXZ+d，可以得到紧凑的d扩充集。X=D,T,Q,5的基组适用于H-Kr，X=6适用于B-Ne和Al-Ar。</li>
<li>用于芯关联的关联一致基组cc-pCVXZ，aug-cc-pCVXZ，或CVXZ，ACVXZ（X=D,T,Q,5），以及更新的“加权集”cc-pwCVXZ，aug-cc-pwCVXZ，或WCVXZ，AWCVXZ（X=D,T,Q,5）。这些基组适用于Li-Kr（CVXZ不包括Sc-Zn）。</li>
<li>Douglas-Kroll-Hess相对论版本的关联一致基组，可以使用加上-DK后缀的标准名称或简称，例如，cc-pVXZ-DK或VXZ-DK。X=D-5适用于H-Kr，X=T适用于YCd和Hf-Hg。三阶DKH收缩集适用于Hf-Hg，需要加上后缀-DK3。</li>
<li>Peterson等人用于用于显关联计算的F12基组：cc-pVXZ-F12，cc-pCVXZ-F12，或VXZ-F12，CVXZ-F12，其中X=D,T,Q。它们适用于H-Ar。</li>
<li>Turbomole def2系列基组：SV(P)，SVP，TZVP，TZVPP，QZVP，QZVPP。它们可用于除了f区元素之外的整个周期表。</li>
<li>对于第一行原子（不是H和He），有旧一些的Dunning/Hay分块收缩双zeta基（DZ和DZP）。</li>
<li>Roos的ANO基组用于H-Ar（ROOS）。</li>
<li>Stuttgart ECP和相应基组（例如ECP10MDF），以及Peterson等人基于ECP的关联一致基组：cc-pVXZ-PP，aug-cc-pVXZ-PP，cc-pwCVXZ-PP，aug-cc-pwCVXZ-PP，或VXZ-PP，AVXZ-PP，WCVXZ-PP，AWCVXZ-PP。后者适用于Cu-Kr，Y-Xe，和Hf-<br>Rn（芯关联集目前仅用于过渡金属）。</li>
<li>Hay ECP和相应基组（ECP1和ECP2）。</li>
<li>其它一些Karslruhe基组（SV，TZV，以及用于某些元素的TZVPPP）。</li>
<li>用于Ga-Kr的Binning/Curtiss集（BINNING-SV，BINNING-SVP，BINNING-VTZ和BINNINGVTZP）</li>
<li>大多数Pople基组使用其标准名称（例如6-31G*，6-311++G(D,P)，等）。在这种情况下需要特别注意，不能使用下面描述的用于限定基组的括弧修饰机制，必须使用被指定的整个标准基组。</li>
</ul>
</li>
<li>此外，还可以使用很多密度拟合和单位分解（resolution of the identity，RI）基组。在密度拟合计算中，对Dunning的关联一致基组自动选择合适的Weigend VXZ/JKFIT，XZ/MP2FIT，或AVXZ/MP2FIT集（还可以用扩充版本的AVXZ/JKFIT 用于拟合Fock矩阵，但默认不使用）。对于def2系列的轨道基组，使用合适的辅助集（例如，TZVPP/JFIT，TZVPP/JKFIT，TZVPP/MP2FIT）。原则上说，这些JKFIT集是通用的，可以与AVXZ基组一起使用。初步结果表明它们也可用于cc-pVXZ-PP和aug-cc-pVXZ-PP系列的基组。</li>
<li>对于使用cc-pVXZ-F12轨道基组的显关联F12计算，默认用相应的VXZ-F12/OPTRI基组构造附加的辅助轨道基（complementary auxiliary orbital basis；CABS）。对于其它轨道基组，默认使用合适的JKFIT集。</li>
</ul>
<h3 id="对于角动量的限制"><a href="#对于角动量的限制" class="headerlink" title="对于角动量的限制"></a>对于角动量的限制</h3><ul>
<li><p>可以使用一些关于最大角动量函数的限制，或是收缩函数的数量限制，比如减少基组的最大角动量：</p>
<ul>
<li>忽略正常情况下出现在VQZ基组中的𝑓和𝑔函数：</li>
</ul>
<figure class="highlight autohotkey"><table><tr><td class="code"><pre><span class="line"><span class="built_in">BASIS,</span>VQZ(D)</span><br></pre></td></tr></table></figure>
<ul>
<li>指定氢的最大角动量是1，也就是忽略氢的𝑑轨道：</li>
</ul>
<figure class="highlight autohotkey"><table><tr><td class="code"><pre><span class="line"><span class="built_in">BASIS,</span>VQZ(D/P)</span><br></pre></td></tr></table></figure>
</li>
<li><p>对于一般收缩基组，可以用扩充的语法直接给出每个角动量收缩函数的数量</p>
<ul>
<li>从Roos的ANO数据集产生6-31G*大小的基组：</li>
</ul>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">BASIS</span>,ROOS(<span class="number">3</span>s<span class="number">2</span>p<span class="number">1</span>d/<span class="number">2</span>s)</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="单个原子的默认基组"><a href="#单个原子的默认基组" class="headerlink" title="单个原子的默认基组"></a>单个原子的默认基组</h2><ul>
<li><p>只需要在默认基组后加上<code>atom1=name1,atom2=name2,...,</code>，<code>atom</code>即元素符号，<code>name</code>为相应的基组名。<strong>默认基组必须在原子特定基组之前指定</strong>。（<font color=red>此外，基组中有的不是名字定义，而是用的原始集和收缩集文本来定义的，应当先写名字定义的，否则可能出错</font>，当计算中出现了比较奇怪的错误，在检查其他地方没有问题之后，可以尝试更换基组区的ECP、单个原子基组、价电子基组的顺序，或者更换文本定义的基组尝试。）</p>
<ul>
<li><p>比如使用cc-pVTZ作为默认的基组，但是对氢原子使用cc-pVDZ：</p>
<figure class="highlight ini"><table><tr><td class="code"><pre><span class="line"><span class="attr">basis</span>=vtz,h=vdz</span><br></pre></td></tr></table></figure>
<p>或</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">basis,vtz,<span class="attribute">h</span>=vdz</span><br></pre></td></tr></table></figure>
<p>或</p>
<figure class="highlight haskell"><table><tr><td class="code"><pre><span class="line"><span class="title">basis</span>,<span class="keyword">default</span>=vtz,h=vdz</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h2 id="基组区"><a href="#基组区" class="headerlink" title="基组区"></a>基组区</h2><p>通过<code>BASIS ... END</code>块或者<code>BASIS=&#123;...&#125;</code>指定，一般形式如下：</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">BASIS</span><br><span class="line">	SET,setname1,[options]</span><br><span class="line">		<span class="attribute">DEFAULT</span>=name</span><br><span class="line">		<span class="attribute">atom1</span>=name1</span><br><span class="line">		<span class="attribute">atom2</span>=name2</span><br><span class="line">		原始基组说明</span><br><span class="line">	SET,setname2,[options]</span><br><span class="line">		<span class="built_in">..</span>.</span><br><span class="line">END</span><br></pre></td></tr></table></figure>
<ul>
<li><p>可以在基组区给出任何数量的基组。每个基组的定义由SET指令开始，其中可以指定基组名和更多选项。</p>
</li>
<li><p>基组区的第一个基组默认是轨道基组，这种情况下可以忽略指令<code>SET,ORBITAL</code></p>
</li>
<li><p><code>DEFAULT</code>指定默认基组，与单行基组输入完全相同。之后可以接各个原子的基组说明。默认基组和原子特定基组也可以合并到一行，之间用逗号隔开。</p>
<figure class="highlight objectivec"><table><tr><td class="code"><pre><span class="line">!对氧和氢分别用<span class="built_in">AVTZ</span>和VDZ覆盖默认基组VTZ</span><br><span class="line">DEFAULT=VTZ,O=<span class="built_in">AVTZ</span>,H=VDZ</span><br></pre></td></tr></table></figure>
</li>
<li><p>SET，DEFAULT，atom=name这些说明都是可选的。如果没有给出DEFAULT，将使用前面最后一个BASIS卡定义的默认基组。</p>
</li>
<li><p>可以先后连续出现几个BASIS卡/区。对给定的原子总是使用最后指定的说明和类型（默认类型为<code>ORBITAL</code>）。</p>
</li>
<li><p>如果对任何唯一原子组都没有指定基组，程序假定为VDZ。</p>
</li>
<li><p>如果<code>setname</code>是<code>JKFIT</code>，这个基在DF- hf或DF- ks中自动使用，除非使用BASIS或DF_BASIS选项进行不同的指定。但是请注意，如果使用了不同的名称(例如<code>JK</code>)，情况就不是这样了。在这种情况下需要给出<code>DF-HF,BASIS=JK</code>以便使用DF-HF中的辅助基。</p>
</li>
</ul>
<h1 id="赝势"><a href="#赝势" class="headerlink" title="赝势"></a>赝势</h1><p>指定方式（<font color=red>最好在<code>basis</code>中首先指定ECP，再指定基组）</font>：</p>
<figure class="highlight autohotkey"><table><tr><td class="code"><pre><span class="line"><span class="built_in">ECP,</span>atom,[ECP specification]</span><br></pre></td></tr></table></figure>
<ul>
<li>ECP specification说明部分可以包含一个关键词，用于引用基组库中存储的赝势，也可以（连续在几个输入卡中）直接定义。</li>
<li>注意：目前molpro对ECP的支持到Db，后面的元素不认，因此用相应元素的ECP则需要修改元素符号，比如将Og修改为Rn，但是此时Rn的内层电子数不满足92，需要改成60。</li>
</ul>
<h3 id="通过ECP库的输入"><a href="#通过ECP库的输入" class="headerlink" title="通过ECP库的输入"></a>通过ECP库的输入</h3><p>一共有两种：</p>
<ul>
<li>Los Alamos小组：<ul>
<li>校正到一个合适原子参考态的轨道能量和密度</li>
<li>关键词是<code>ECP1</code>和<code>ECP2</code>；当对给定的原子有一个以上的赝势时，ECP2用于表示小芯ECP的定义。（例如对Cu，<code>ECP1</code>表示类Ar的18电子芯， 而<code>ECP2</code>模拟类Ne的10电子芯，把3s和3p电子放入到价层）对于包含电子关联的精确计算，推荐把主量子数等于价轨道的所有芯轨道放入到价轨道中。 </li>
</ul>
</li>
<li>Stuttgart/Köln小组：<ul>
<li>用多个原子态的总价电子能量产生。 </li>
<li>关键词的形式为：<code>ECPnXY</code>：<ul>
<li>n是用赝势代替的芯电子数量</li>
<li>X表示用于产生赝势的参考体系（X = S，单价电子离子；X = M，中性原子）</li>
<li>Y 表示参考数据的理论级别（Y=HF：Hartree-Fock；Y=WB：准相对论；Y=DF：相对论） </li>
</ul>
</li>
<li>对于单个或两个价电子的原子而言，X = S，Y=DF是很好的选择，否则推荐X = M，Y=WB （或Y=DF） 。（对于较轻的原子，或者为了讨论相对论效应，相应的Y=HF赝势也可能会有用。）</li>
<li>此外还可以使用自旋轨道（SO）势和芯极化势（CPP），用于b)类ECP，但目前不包含在基组库中，因此需要另外输入</li>
</ul>
</li>
</ul>
<p>在以上两种情况中，<strong>赝势和相应的基组使用相同的关键词</strong>，但对前一种需要使用前缀<code>MBS-</code>…。</p>
<p>例子：AuH分子在r(exp)的CCSD(T)结合能；使用Stuttgart/Koeln小组的标量相对论19价电子赝势</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">***,AuH</span><br><span class="line">gprint,basis,orbitals;</span><br><span class="line">geometry=&#123;au&#125;</span><br><span class="line">basis=&#123;</span><br><span class="line">ecp,au,ECP60MWB;              ! ECP input</span><br><span class="line">spd,au,ECP60MWB;c,<span class="number">1.2</span>;        ! basis <span class="keyword">set</span></span><br><span class="line">f,au,<span class="number">1.41</span>,<span class="number">0.47</span>,<span class="number">0.15</span>;</span><br><span class="line">g,au,<span class="number">1.2</span>,<span class="number">0.4</span>;</span><br><span class="line">spd,h,avtz;c;</span><br><span class="line">&#125;</span><br><span class="line">rhf;</span><br><span class="line">&#123;rccsd(t);core,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,,<span class="number">1</span>;&#125;</span><br><span class="line">e1=energy</span><br><span class="line">geometry=&#123;h&#125;</span><br><span class="line">rhf</span><br><span class="line">e2=energy;</span><br><span class="line">rAuH=<span class="number">1.524</span> ang                ! molecular calculation</span><br><span class="line">geometry=&#123;au;h,au,rAuH&#125;</span><br><span class="line">hf;</span><br><span class="line">&#123;ccsd(t);core,<span class="number">2</span>,<span class="number">1</span>,<span class="number">1</span>;&#125;</span><br><span class="line">e3=energy</span><br><span class="line">de=(e3-e2-e1)*toev            ! binding energy = <span class="number">3.11</span> eV</span><br></pre></td></tr></table></figure>
<h3 id="直接输入ECP"><a href="#直接输入ECP" class="headerlink" title="直接输入ECP"></a>直接输入ECP</h3><p>对每种赝势，必须提供以下信息：</p>
<ul>
<li><p>一个卡，形式为：</p>
<figure class="highlight maxima"><table><tr><td class="code"><pre><span class="line">ECP,<span class="built_in">atom</span>,ncore,<span class="built_in">lmax</span>,l′<span class="built_in">max</span>;</span><br></pre></td></tr></table></figure>
<script type="math/tex; mode=display">V_{ps}= -\frac{Z-n_{core}}{r} + V_{l_{max}}
          +\sum_{l=0}^{l_{max}-1} (V_l-V_{l_{max}}){\cal P}_{l}
          +\sum_{l=1}^{l'{max}} \Delta V_l {\cal P}_{l} \vec{l}\cdot\vec{s} {\cal P}_{l} ;</script><ul>
<li><code>ncore</code>是用赝势$V_{ps}$代替的芯电子数量</li>
<li><code>lmax</code>是$V_{ps}$标量相对论部分的半局域项数量</li>
<li><code>l′max</code>是相应的SO部分的项个数</li>
</ul>
</li>
<li><p>定义$ V<em>{l</em>{max}}$的一些卡：</p>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">m_1</span>,γ_<span class="number">1</span>,c_<span class="number">1</span>;m_<span class="number">2</span>,γ_<span class="number">2</span>,c_<span class="number">2</span>;...</span><br></pre></td></tr></table></figure>
<script type="math/tex; mode=display">V_{l_{max}} = \sum_{j=1}^{n_{l_{max}}} c_j r^{m_j-2} e^{-\gamma _j r^2}</script><ul>
<li>第一个给出展开式长度$n<em>{l</em>{max}}$，接下来的$n<em>{l</em>{max}}$给出参数</li>
</ul>
</li>
<li><p>定义标量相对论半局域项的一些卡:</p>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">ml_1</span>,γl_<span class="number">1</span>,cl_<span class="number">1</span>; ml_<span class="number">2</span>,γl_<span class="number">2</span>,cl_<span class="number">2</span>;... </span><br></pre></td></tr></table></figure>
<script type="math/tex; mode=display">V_l -V_{l_{max}}=\sum_{j=1}^{n_l} c_j^l r^{m_j^l-2} e^{-\gamma _j^l r^2}</script><ul>
<li>顺序是$l=0,1,\ldots , l_{max}-1$</li>
<li>对每一项，必须给出一个展开长度是$n_l$的卡，后面再接$n_l$个卡</li>
</ul>
</li>
<li><p>类似的，是一些径向势$\Delta V<em>l$因子的卡，定义$V</em>{ps}$的SO部分</p>
</li>
</ul>
<p>例子：Cu原子SCF d10s1→d9s2激发能，使用相对论Ne-芯的赝势和Stuttgart/Koeln小组的基组</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">***,CU</span><br><span class="line">gprint,basis,orbitals</span><br><span class="line">geometry=&#123;cu&#125;</span><br><span class="line">basis</span><br><span class="line">ECP,<span class="number">1</span>,<span class="number">10</span>,<span class="number">3</span>;   	! ECP input</span><br><span class="line"> <span class="number">1</span>; 			! NO LOCAL POTENTIAL</span><br><span class="line"> <span class="number">2</span>,<span class="number">1.</span>,<span class="number">0.</span>;</span><br><span class="line"> <span class="number">2</span>; 			! S POTENTIAL</span><br><span class="line"> <span class="number">2</span>,<span class="number">30.22</span>,<span class="number">355.770158</span>;<span class="number">2</span>,<span class="number">13.19</span>,<span class="number">70.865357</span>;</span><br><span class="line"> <span class="number">2</span>; 			! P POTENTIAL</span><br><span class="line"> <span class="number">2</span>,<span class="number">33.13</span>,<span class="number">233.891976</span>;<span class="number">2</span>,<span class="number">13.22</span>,<span class="number">53.947299</span>;</span><br><span class="line"> <span class="number">2</span>; 			! D POTENTIAL</span><br><span class="line"> <span class="number">2</span>,<span class="number">38.42</span>,<span class="number">-31.272165</span>;<span class="number">2</span>,<span class="number">13.26</span>,<span class="number">-2.741104</span>;</span><br><span class="line">! (<span class="number">8</span>s7p6d)/[<span class="number">6</span>s5p3d] BASIS SET</span><br><span class="line">s,<span class="number">1</span>,<span class="number">27.69632</span>,<span class="number">13.50535</span>,<span class="number">8.815355</span>,<span class="number">2.380805</span>,<span class="number">.952616</span>,<span class="number">.112662</span>,<span class="number">.040486</span>,<span class="number">.01</span>;</span><br><span class="line">c,<span class="number">1.3</span>,<span class="number">.231132</span>,<span class="number">-.656811</span>,<span class="number">-.545875</span>;</span><br><span class="line">p,<span class="number">1</span>,<span class="number">93.504327</span>,<span class="number">16.285464</span>,<span class="number">5.994236</span>,<span class="number">2.536875</span>,<span class="number">.897934</span>,<span class="number">.131729</span>,<span class="number">.030878</span>;</span><br><span class="line">c,<span class="number">1.2</span>,<span class="number">.022829</span>,<span class="number">-1.009513</span>;C,<span class="number">3.4</span>,<span class="number">.24645</span>,<span class="number">.792024</span>;</span><br><span class="line">d,<span class="number">1</span>,<span class="number">41.225006</span>,<span class="number">12.34325</span>,<span class="number">4.20192</span>,<span class="number">1.379825</span>,<span class="number">.383453</span>,<span class="number">.1</span>;</span><br><span class="line">c,<span class="number">1.4</span>,<span class="number">.044694</span>,<span class="number">.212106</span>,<span class="number">.453423</span>,<span class="number">.533465</span>;</span><br><span class="line">end</span><br><span class="line">rhf;</span><br><span class="line">e1=energy</span><br><span class="line">&#123;rhf;occ,<span class="number">4</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>;closed,<span class="number">4</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>;wf,<span class="number">19</span>,<span class="number">7</span>,<span class="number">1</span>;&#125;</span><br><span class="line">e2=energy</span><br><span class="line">de=(e2-e1)*toev  ! Delta E = <span class="number">-0.075</span> eV</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>计算化学</category>
        <category>软件</category>
      </categories>
      <tags>
        <tag>输入</tag>
        <tag>基组</tag>
        <tag>内存</tag>
        <tag>molpro</tag>
        <tag>赝势</tag>
        <tag>输出</tag>
        <tag>坐标</tag>
      </tags>
  </entry>
  <entry>
    <title>【Linux】命令</title>
    <url>/2019/09/25/%E3%80%90Linux%E3%80%91%E5%91%BD%E4%BB%A4/</url>
    <content><![CDATA[<h1 id="文件管理"><a href="#文件管理" class="headerlink" title="文件管理"></a>文件管理</h1><h2 id="awk"><a href="#awk" class="headerlink" title="awk"></a>awk</h2><h3 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">awk [options] &#x27;script&#x27; var=value file(s)</span><br><span class="line">awk [options] -f scriptfile var=value file(s)</span><br></pre></td></tr></table></figure>
<ul>
<li>常用选项：<ul>
<li><code>-F fs</code>：<code>fs</code>指定输入分隔符，fs可以是字符串或正则表达式，如<code>-F:</code></li>
<li><code>-v</code>：赋值一个用户定义变量。</li>
</ul>
</li>
<li>内置变量：<ul>
<li><code>$n</code>：当前记录的第n个字段，比如n为1表示第一个字段，n为2表示第二个字段。 </li>
<li><code>$NF</code>：一行中的最后一个字段，<code>$(NF-1)</code>则是打印倒数第二个字段，其他以此类推</li>
<li><code>NR</code>：已经读出的记录数，就是行号，从1开始</li>
</ul>
</li>
</ul>
<h3 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h3><ul>
<li><p>每行按空格或TAB分割，输出文本中的1、4项：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">log.txt 内容</span></span><br><span class="line">2 this is a test</span><br><span class="line">3 Are you like awk</span><br><span class="line"></span><br><span class="line"><span class="meta">$</span><span class="bash"> awk <span class="string">&#x27;&#123;print $1,$4&#125;&#x27;</span> log.txt</span></span><br><span class="line">2 a</span><br><span class="line">3 like</span><br></pre></td></tr></table></figure>
</li>
<li><p>awk运算与判断：将变量给igrid，然后将行号为igrid的第五个字段输出：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">awk -v igrid=$igrid &#x27;(NR == igrid)&#123;print $5&#125;&#x27;</span><br></pre></td></tr></table></figure>
</li>
<li><p>结合管道：</p>
<figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="attribute">uname</span> -a |awk -F <span class="string">&#x27; &#x27;</span> <span class="string">&#x27;&#123;print <span class="variable">$2</span>&#125;&#x27;</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="chmod"><a href="#chmod" class="headerlink" title="chmod"></a>chmod</h2><p>Change mode 修改文件或目录的权限</p>
<h3 id="语法-1"><a href="#语法-1" class="headerlink" title="语法"></a>语法</h3><figure class="highlight cmake"><table><tr><td class="code"><pre><span class="line">chmod [<span class="keyword">OPTION</span>] MODE <span class="keyword">FILE</span></span><br></pre></td></tr></table></figure>
<ul>
<li>OPTION：<ul>
<li><code>-c</code>当文件的权限更改时输出操作信息</li>
<li><code>-f</code>若该文件权限无法被更改也不要显示错误讯息</li>
<li><code>-v</code>显示权限变更的详细资料</li>
<li><code>-R</code>对目录以及目录下的文件递归执行更改权限操作</li>
</ul>
</li>
<li>MODE：<code>[ugoa][[+-=][rwxX]</code>或者<code>abc</code><ul>
<li><code>u</code>符号代表当前用户；<code>g</code>符号代表和当前用户在同一个组的用户；<code>o</code>符号代表其他用户。<code>a</code>符号代表所有用户。</li>
<li><code>+</code>符号代表添加目标用户相应的权限；<code>-</code>符号代表删除目标用户相应的权限；<code>=</code>符号代表添加目标用户相应的权限，删除未提到的权限。</li>
<li><code>r</code>符号代表读权限以及八进制数<code>4</code>；<code>w</code>符号代表写权限以及八进制数<code>2</code>；<code>x</code>符号代表执行权限以及八进制数<code>1</code>；<code>X</code>符号代表如果目标文件是可执行文件或目录，可给其设置可执行权限。</li>
<li>a,b,c各为一个数字，分别表示User、Group、及Other的权限，7代表可读、可写、可执行；0代表无任何权限：<ul>
<li>若要rwx属性则4+2+1=7；</li>
<li>若要rw-属性则4+2=6；</li>
<li>若要r-x属性则4+1=5</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="例子-1"><a href="#例子-1" class="headerlink" title="例子"></a>例子</h3><ul>
<li>将文件 file1.txt 设为所有人皆可读取 <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">chmod ugo+r file1.txt</span><br><span class="line">chmod a+r file1.txt</span><br></pre></td></tr></table></figure></li>
<li>将文件 file1.txt 与 file2.txt 设为该文件拥有者，与其所属同一个群体者可写入，但其他以外的人则不可写入 <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">chmood ug+w,o-w file1.txt file2.txt</span><br></pre></td></tr></table></figure></li>
<li>将 ex1.py 设定为只有该文件拥有者可以执行 <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">chmod u+x ex1.py</span><br></pre></td></tr></table></figure></li>
<li>将目前目录下的所有文件与子目录皆设为任何人可读取 <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">chmod -R a+r *</span><br></pre></td></tr></table></figure></li>
<li>通过数字指定：<ul>
<li><code>700</code>表示User可读可写可执行，其它任何用户（除root外），对此文件不可读不可写不可执行。</li>
<li>如果一个程序被root安装在诸如/opt、/local/user/这样的路径，默认状况下，其它用户对这些路径下的文件、文件夹没有写、执行的权限，因此并不能运行安装的软件。因此root用户需要对整个软件文件夹赋予<code>755</code>的权限。这样普通用户对软件具有读、执行的权限，但不能做任何修改。</li>
<li><code>chmod a=rwx file</code>即<code>chmod 777 file</code></li>
<li><code>chmod ug=rwx,o=x file</code>即<code>chmod 771 file</code></li>
<li>若用<code>chmod 4755 filename</code>可使此程序具有root的权限</li>
</ul>
</li>
</ul>
<h2 id="cp"><a href="#cp" class="headerlink" title="cp"></a>cp</h2><p> Copy file 将源文件或目录复制到目标文件或目录中</p>
<h3 id="语法-2"><a href="#语法-2" class="headerlink" title="语法"></a>语法</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">cp [options] 源 目标</span><br></pre></td></tr></table></figure>
<ul>
<li><code>-a</code>：此选项通常在复制目录时使用，它保留链接、文件属性，并复制目录下的所有内容。其作用等于-dpR参数组合。</li>
<li><code>-d</code>：复制时保留链接，相当于Windows系统中的快捷方式。</li>
<li><code>-f</code>：覆盖已经存在的目标文件而不给出提示。</li>
<li><code>-i</code>：与-f选项相反，在覆盖目标文件之前给出提示，要求用户确认是否覆盖，回答”y”时目标文件将被覆盖。</li>
<li><code>-p</code>：除复制文件的内容外，还把修改时间和访问权限也复制到新文件中。</li>
<li><code>-r</code>：若给出的源文件是一个目录文件，此时将复制该目录下所有的子目录和文件。</li>
<li><code>-l</code>：不复制文件，只是生成链接文件。</li>
</ul>
<h3 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h3><ul>
<li>将文件file1复制为file2，即会将一个已经存在的文件file1复制并重命名为file2   <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">cp file1 file2</span><br></pre></td></tr></table></figure></li>
<li>使用指令”cp”将当前目录”test/“下的所有文件复制到新目录”newtest”下：<ul>
<li>注意：用户使用该指令复制目录时，必须使用参数”-r”或者”-R”  <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">cp –r test/ newtest  </span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li>将一个路径下的多个文件复制到另一路径 <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">cp C2v/&#123;7_C2v.run, adf17.sub&#125; ........</span><br></pre></td></tr></table></figure></li>
<li>交互式地将目录/usr/men中的以m*.c文件复制到目录/usr/zh中<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">cp -i /usr/men m*.c /usr/zh</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="cut"><a href="#cut" class="headerlink" title="cut"></a>cut</h2><p>用于显示每行从开头算起 num1 到 num2 的文字。</p>
<h3 id="语法-3"><a href="#语法-3" class="headerlink" title="语法"></a>语法</h3><figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="title">cut</span><span class="params">(选项)</span><span class="params">(参数)</span></span></span><br></pre></td></tr></table></figure>
<p>选项：</p>
<ul>
<li><code>-b</code> ：以字节为单位进行分割。这些字节位置将忽略多字节字符边界，除非也指定了 <code>-n</code> 标志。</li>
<li><code>-c</code> ：以字符为单位进行分割。</li>
<li><code>-d</code> ：自定义分隔符，默认为制表符。</li>
<li><code>-f</code> ：与-d一起使用，指定显示哪个区域。</li>
<li><code>-n</code> ：与-<code>b</code>选项连用，不分割多字节字符；</li>
<li><code>--complement</code>：补足被选择的字节、字符或字段；</li>
</ul>
<p>配合-<code>b</code>，-<code>c</code>，-<code>f</code>指定字段的字符或者字节范围的方法：</p>
<ul>
<li><code>N-</code>：从第N个字节、字符、字段到结尾；</li>
<li><code>N-M</code>：从第N个字节、字符、字段到第M个（包括M在内）字节、字符、字段；</li>
<li><code>-M</code>：从第1个字节、字符、字段到第M个（包括M在内）字节、字符、字段。</li>
<li><code>N</code>第N个</li>
</ul>
<h3 id="例子-2"><a href="#例子-2" class="headerlink" title="例子"></a>例子</h3><p>test.txt为：</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="literal">No</span> <span class="string">Name</span> <span class="string">Mark</span> <span class="string">Percent</span></span><br><span class="line"><span class="number">01</span> <span class="string">tom</span> <span class="number">69</span> <span class="number">91</span></span><br><span class="line"><span class="number">02</span> <span class="string">jack</span> <span class="number">71</span> <span class="number">87</span></span><br><span class="line"><span class="number">03</span> <span class="string">alex</span> <span class="number">68</span> <span class="number">98</span></span><br></pre></td></tr></table></figure>
<ul>
<li><p>提取指定字段：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> cut -f 1 test.txt </span></span><br><span class="line">No</span><br><span class="line">01</span><br><span class="line">02</span><br><span class="line">03</span><br><span class="line"><span class="meta">$</span><span class="bash"> cut -f2,3 test.txt </span></span><br><span class="line">Name Mark</span><br><span class="line">tom 69</span><br><span class="line">jack 71</span><br><span class="line">alex 68</span><br></pre></td></tr></table></figure>
</li>
<li><p>提取指定字段之外的列（打印除了第二列之外的列）</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> cut -f2 --complement test.txt </span></span><br><span class="line">No Mark Percent</span><br><span class="line">01 69 91</span><br><span class="line">02 71 87</span><br><span class="line">03 68 98</span><br></pre></td></tr></table></figure>
</li>
<li><p>指定字段分隔符，比如字段不是用空格分割，而是用的;分割，则可以用</p>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">cut</span> -f<span class="number">2</span> -d<span class="string">&quot;;&quot;</span> test<span class="number">2</span>.txt </span><br></pre></td></tr></table></figure>
</li>
<li><p>打印第1个到第3个字符：</p>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">cut</span> -c<span class="number">1</span>-<span class="number">3</span> test.txt </span><br></pre></td></tr></table></figure>
</li>
<li><p>打印前2个字符：</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">cut -c<span class="number">-2</span> test.txt </span><br></pre></td></tr></table></figure>
</li>
<li><p>打印从第5个字符开始到结尾：</p>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">cut</span> -c<span class="number">5</span>- test.txt </span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="find"><a href="#find" class="headerlink" title="find"></a>find</h2><p>用来在指定目录下查找文件。</p>
<h3 id="语法-4"><a href="#语法-4" class="headerlink" title="语法"></a>语法</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">find   path   -option   [expression]   [-exec  -ok  command]   &#123;&#125; \;</span><br></pre></td></tr></table></figure>
<ul>
<li>path：<ul>
<li>任何位于参数之前的字符串都将被视为欲查找的目录名</li>
<li>不设置时将在当前目录下查找子目录与文件</li>
</ul>
</li>
<li>-option：<ul>
<li><strong><code>-name name</code>文件名称符合 name 的文件。<code>-iname</code>会忽略大小写</strong></li>
<li><code>-path p</code>路径名称符合 p 的文件，<code>-ipath</code>会忽略大小写</li>
<li>-<code>regex</code>基于正则表达式匹配文件路径，<code>-iregex</code>忽略大小写</li>
<li></li>
<li><strong><code>-type x</code>：文件类型是X的文件，X可以是<code>b</code> 块设备，<code>c</code> 字符设备，<code>d</code>目录，<code>f</code>一般文件，<code>l</code> 符号连接，<code>s</code> 套接字，<code>p</code> Fifo</strong></li>
<li><code>-maxdepth</code>设置最大目录层级；<code>-mindepth</code>设置最小目录层级</li>
<li></li>
<li><code>-amin</code>，<code>-atime</code>分别表示在过去 n 分钟或n天内内被读取过。<code>+n</code>，<code>-n</code>，<code>n</code>分别代表大于，小于和等于。</li>
<li><code>-cmin</code>，<code>-ctime</code>分别表示在过去 n 分钟或n天内被修改过的文件</li>
<li><code>-mmin</code>和<code>-mtime</code>分别表示在过去 n 分钟或n天内被更改过的文件或目录（比如权限）</li>
<li><code>-anewer</code>,<code>-cnewer</code>,<code>-mnewer</code>与文件和目录的时间相比更新的</li>
<li></li>
<li><code>-size</code>查找符合指定的文件大小的文件，<code>b</code>代表512字节，<code>c</code>是字节，<code>w</code>是字（2字节），<code>k</code>是千字节，<code>M</code>是兆字节，<code>G</code>是吉字节。</li>
<li><code>-empty</code>寻找文件大小为0 Byte的文件，或目录下没有任何子目录或文件的空目录；</li>
<li></li>
<li><code>-perm</code>查找符合指定的权限数值的文件或目录</li>
<li><code>-user</code>，<code>-group</code>查找符和指定的拥有者名称的文件或目录</li>
<li></li>
<li><code>-exec</code>假设find指令的回传值为True，就执行该指令。可以用<code>&#123;&#125;</code>来表示find匹配的结果。</li>
<li><code>-ok</code>在执行指令之前会先询问用户，若回答“y”或“Y”，则放弃执行命令</li>
<li></li>
<li>以使用 ( ) 将运算式分隔，并使用下列运算：<ul>
<li>exp1 -and exp2</li>
<li>! expr</li>
<li>-not expr</li>
<li>exp1 -or exp2</li>
<li>exp1, exp2</li>
</ul>
</li>
<li><code>-prune</code>跳过指定目录</li>
</ul>
</li>
<li>expression：<ul>
<li>默认是<code>-print</code>，将文件或目录名称列出到标准输出。格式为每列一个名称，每个名称前皆有“./”字符串；</li>
<li><code>-print0</code>将文件或目录名称列出到标准输出。格式为全部的名称皆在同一行；</li>
<li><code>-printf&lt;输出格式&gt;</code>将文件或目录名称列出到标准输出。格式可以自行指定；</li>
<li><code>-delete</code>删除</li>
</ul>
</li>
</ul>
<h3 id="实例-1"><a href="#实例-1" class="headerlink" title="实例"></a>实例</h3><h4 id="匹配名字"><a href="#匹配名字" class="headerlink" title="匹配名字"></a>匹配名字</h4><ul>
<li>将目前目录及其子目录下所有名字为*.c的文件列出来<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">find . -name &quot;*.c&quot; </span><br><span class="line">find . -iname &quot;*.c&quot; #不区分大小写</span><br></pre></td></tr></table></figure></li>
<li>匹配文件路径或者文件<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">find /usr/ -path &quot;*local*&quot;</span><br></pre></td></tr></table></figure></li>
<li>基于正则表达式匹配文件路径<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">find . -regex &quot;.*\(\.txt\|\.pdf\)$&quot;</span><br></pre></td></tr></table></figure></li>
<li>否定：找出/home下不是以.txt结尾的文件<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">find /home ! -name &quot;*.txt&quot;</span><br></pre></td></tr></table></figure></li>
<li>查找当前目录或者子目录下所有.txt文件，但是跳过子目录sk  <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">find . -path &quot;./sk&quot; -prune -o -name &quot;*.txt&quot; -print</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="根据文件类型"><a href="#根据文件类型" class="headerlink" title="根据文件类型"></a>根据文件类型</h4><ul>
<li>将目前目录其其下子目录中所有一般文件列出：<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">find . -type f</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="根据目录深度"><a href="#根据目录深度" class="headerlink" title="根据目录深度"></a>根据目录深度</h4><ul>
<li>向下最大深度限制为3<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">find . -maxdepth 3 -type f</span><br></pre></td></tr></table></figure></li>
<li>搜索出深度距离当前目录至少2个子目录的所有文件<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">find . -mindepth 2 -type f</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="根据时间戳"><a href="#根据时间戳" class="headerlink" title="根据时间戳"></a>根据时间戳</h4><ul>
<li>搜索最近七天内被访问过的所有文件：<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">find . -type f -atime -7</span><br></pre></td></tr></table></figure></li>
<li>将目前目录及其子目录下所有超过 20 天更新过的文件列出<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">find . -ctime -20</span><br></pre></td></tr></table></figure></li>
<li>找出比file.log修改时间更长的所有文件<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">find . -type f -newer file.log</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="根据文件大小"><a href="#根据文件大小" class="headerlink" title="根据文件大小"></a>根据文件大小</h4><ul>
<li>查找系统中所有文件大于10KB的文件，并列出它们的完整路径<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">find / -type f -size +10k -exec ls -l &#123;&#125; \;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="删除匹配文件"><a href="#删除匹配文件" class="headerlink" title="删除匹配文件"></a>删除匹配文件</h4><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">find . -type f -name &quot;*.txt&quot; -delete</span><br></pre></td></tr></table></figure>
<h4 id="根据文件权限-所有权进行匹配"><a href="#根据文件权限-所有权进行匹配" class="headerlink" title="根据文件权限/所有权进行匹配"></a>根据文件权限/所有权进行匹配</h4><ul>
<li>查找前目录中文件属主具有读、写权限，并且文件所属组的用户和其他用户具有读权限的文件<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">find . -type f -perm 644 -exec ls -l &#123;&#125; \;</span><br></pre></td></tr></table></figure></li>
<li>找出当前目录用户tom拥有的所有文件<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">find . -type f -user tom</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="结合其他命令"><a href="#结合其他命令" class="headerlink" title="结合其他命令"></a>结合其他命令</h4><ul>
<li>查找/var/log目录中更改时间在7日以前的普通文件，并在删除之前询问它们<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">find /var/log -type f -mtime +7 -ok rm &#123;&#125; \;</span><br></pre></td></tr></table></figure></li>
<li>查找当前目录下所有.txt文件并把他们拼接起来写入到all.txt文件中<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">find . -type f -name &quot;*.txt&quot; -exec cat &#123;&#125; \;&gt; all.txt</span><br></pre></td></tr></table></figure></li>
<li>将30天前的.log文件移动到old目录中<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">find . -type f -mtime +30 -name &quot;*.log&quot; -exec cp &#123;&#125; old \;</span><br></pre></td></tr></table></figure></li>
<li>找出当前目录下所有.txt文件并以“File:文件名”的形式打印出来<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">find . -type f -name &quot;*.txt&quot; -exec printf &quot;File: %s\n&quot; &#123;&#125; \;</span><br></pre></td></tr></table></figure></li>
<li>查找名字是Rn*的文件，并将名字中Rn的文件替换成Xe，加-type d表示修改目录<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">find ./ -name &quot;Rn*&quot; -exec rename Rn Xe &#123;&#125; \;</span><br><span class="line">find . -type d -name &quot;Rn*&quot; -exec rename Rn Xe &#123;&#125; \;</span><br></pre></td></tr></table></figure></li>
<li>删除除了名字为<em>run或者adf</em>的其他一般文件  <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">find . -type f -not \( -name &quot;*run&quot; -or -name &quot;adf*&quot; \) -delete</span><br></pre></td></tr></table></figure></li>
<li>将目录下所有一般文件中的_NR换成_SR，也可以用for循环<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">find . -type f | xargs perl -pi -e &#x27;s|_NR|_SR|g&#x27;</span><br><span class="line"></span><br><span class="line">for i in `find . -type f`</span><br><span class="line">do</span><br><span class="line">  sed -i &#x27;s/_NR/_SR/g&#x27; $i</span><br><span class="line">done</span><br></pre></td></tr></table></figure></li>
<li>将目录下所有一般文件中某一句后面加上一句<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">for i in `find ./$path -type f`</span><br><span class="line">do</span><br><span class="line"> sed -i &#x27;/NUCLEARMODEL gaussian/arelativistic scalar zora&#x27; $i</span><br><span class="line">done</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="mv"><a href="#mv" class="headerlink" title="mv"></a>mv</h2><p>move file用来为文件或目录改名、或将文件或目录移入其它位置。</p>
<h3 id="语法-5"><a href="#语法-5" class="headerlink" title="语法"></a>语法</h3><figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="title">mv</span><span class="params">(选项)</span><span class="params">(参数)</span></span></span><br></pre></td></tr></table></figure>
<p>三种模式</p>
<ul>
<li><p>将源文件名 source_file 改为目标文件名 dest_file</p>
<figure class="highlight isbl"><table><tr><td class="code"><pre><span class="line"><span class="variable">mv</span> <span class="function"><span class="title">source_file</span>(文件) <span class="title">dest_file</span>(文件)</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>将文件 source_file 移动到目标目录 dest_directory 中</p>
<figure class="highlight gcode"><table><tr><td class="code"><pre><span class="line">mv source_file<span class="comment">(文件)</span> dest_directory<span class="comment">(目录)</span>	</span><br></pre></td></tr></table></figure>
</li>
<li><p>目录名 dest_directory 已存在，将 source_directory 移动到目录名 dest_directory 中；目录名 dest_directory 不存在则 source_directory 改名为目录名 dest_directory</p>
<figure class="highlight isbl"><table><tr><td class="code"><pre><span class="line"><span class="variable">mv</span> <span class="function"><span class="title">source_directory</span>(目录) <span class="title">dest_directory</span>(目录)</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>选项：</p>
<ul>
<li><code>-i</code>：交互式操作，覆盖前先行询问用户，如果源文件与目标文件或目标目录中的文件同名，则询问用户是否覆盖目标文件。</li>
<li><code>-f</code>：若目标文件或目录与现有的文件或目录重复，则直接覆盖现有的文件或目录，不给任何指示</li>
</ul>
<p>批量重命名：</p>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="variable">$</span>(<span class="built_in">ls</span>); <span class="keyword">do</span> <span class="built_in">mv</span> <span class="variable">$</span>&#123;i&#125; <span class="number">0</span><span class="variable">$</span>&#123;i&#125;; done</span><br></pre></td></tr></table></figure>
<h2 id="rename"><a href="#rename" class="headerlink" title="rename"></a>rename</h2><h3 id="语法-6"><a href="#语法-6" class="headerlink" title="语法"></a>语法</h3><p>不同Liunx下的语法不同，CentOS下的是：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">rename [options] expression replacement file</span><br></pre></td></tr></table></figure>
<ul>
<li><code>-v</code>显示哪些文件被修改了</li>
<li>通配符：<ul>
<li><code>?</code> 可替代单个字符</li>
<li><code>*</code>可替代多个字符</li>
<li><code>[]</code>可替代[]中的任意单个字符</li>
</ul>
</li>
</ul>
<h3 id="例子-3"><a href="#例子-3" class="headerlink" title="例子"></a>例子</h3><ul>
<li>将所有htm文件改成html文件<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">rename .htm .html *.htm</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="rm"><a href="#rm" class="headerlink" title="rm"></a>rm</h2><p>Remove，用于删除一个文件或者目录。</p>
<h3 id="语法-7"><a href="#语法-7" class="headerlink" title="语法"></a>语法</h3><figure class="highlight prolog"><table><tr><td class="code"><pre><span class="line">rm [options] name...</span><br></pre></td></tr></table></figure>
<p>选项：</p>
<ul>
<li><code>-i</code> 删除前逐一询问确认。</li>
<li><code>-f</code> 即使原档案属性设为唯读，亦直接删除，无需逐一确认。</li>
<li><code>-r</code> 将目录及以下之档案亦逐一删除。</li>
</ul>
<h3 id="例子-4"><a href="#例子-4" class="headerlink" title="例子"></a>例子</h3><ul>
<li><p>删除目录</p>
<figure class="highlight ebnf"><table><tr><td class="code"><pre><span class="line"><span class="attribute">rm  -r  homework</span>  </span><br></pre></td></tr></table></figure>
</li>
<li><p>删除“路径”下名为“文件（夹）名”的文件（夹）。不需要确认</p>
<figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="attribute">rm</span> -rf 路径/文件（夹）名</span><br></pre></td></tr></table></figure>
</li>
<li><p>除了某个文件外的其他文件全部删除的命令：</p>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">rm</span> -rf !(keep) #删除keep文件之外的所有文件</span><br><span class="line"><span class="attribute">rm</span> -rf !(keep<span class="number">1</span>| keep<span class="number">2</span>) #删除keep<span class="number">1</span>和keep<span class="number">2</span>文件之外的所有文件</span><br></pre></td></tr></table></figure>
</li>
<li><p>删除前先询问，-i选项在使用文件扩展名字符删除多个文件时特别有用。使用这个选项，系统会要求你逐一确定是否要删除。这时，必须输入y并按Enter键，才能删除文件。如果仅按Enter键或其他字符，文件不会被删除。</p>
<figure class="highlight stata"><table><tr><td class="code"><pre><span class="line"><span class="keyword">rm</span> -i <span class="keyword">test</span> example</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="scp"><a href="#scp" class="headerlink" title="scp"></a>scp</h2><p>用于 Linux 之间复制文件和目录。</p>
<h3 id="语法-8"><a href="#语法-8" class="headerlink" title="语法"></a>语法</h3><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">scp</span> <span class="selector-attr">[可选参数]</span> <span class="selector-tag">file_source</span> <span class="selector-tag">file_target</span> </span><br></pre></td></tr></table></figure>
<ul>
<li><code>-P port</code>：注意是大写的P, port是指定数据传输用到的端口号</li>
<li><code>-r</code>：以递归方式复制。</li>
</ul>
<h3 id="例子-5"><a href="#例子-5" class="headerlink" title="例子"></a>例子</h3><ul>
<li><p>从远处复制文件到本地目录</p>
<figure class="highlight elixir"><table><tr><td class="code"><pre><span class="line">scp root<span class="variable">@10</span>.<span class="number">10.10</span>.<span class="number">10</span><span class="symbol">:/opt/soft/nginx-</span>0.<span class="number">5.38</span>.tar.gz /opt/soft/</span><br></pre></td></tr></table></figure>
</li>
<li><p>上传本地文件到远程机器指定目录</p>
<figure class="highlight gradle"><table><tr><td class="code"><pre><span class="line">scp -r（文件夹/）文件名 （用户名@）节点名:目录</span><br><span class="line">scp <span class="regexp">/opt/</span>soft<span class="regexp">/nginx-0.5.38.tar.gz root@10.10.10.10:/</span>opt<span class="regexp">/soft/</span>scptest</span><br><span class="line"></span><br><span class="line">#表示将<span class="regexp">/home/</span>Fermi/Test.xyz拷贝到Fermi2用户在node124节点的home目录下面</span><br><span class="line">scp -r <span class="regexp">/home/</span>Fermi/Test.xyz Fermi2@node124</span><br></pre></td></tr></table></figure>
</li>
<li><p>如果远程服务器防火墙有为scp命令设置了指定的端口，我们需要使用 -P 参数来设置命令的端口号:</p>
<figure class="highlight awk"><table><tr><td class="code"><pre><span class="line">scp -P <span class="number">4588</span> remote@www.runoob.com:<span class="regexp">/usr/</span>local<span class="regexp">/sin.sh /</span>home/administrator</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h1 id="文档编辑"><a href="#文档编辑" class="headerlink" title="文档编辑"></a>文档编辑</h1><h2 id="grep"><a href="#grep" class="headerlink" title="grep"></a>grep</h2><p>用于查找文件里符合条件的字符串。</p>
<h3 id="语法-9"><a href="#语法-9" class="headerlink" title="语法"></a>语法</h3><ul>
<li><code>-A&lt;显示行数&gt;</code> 或 <code>--after-context=&lt;显示行数&gt;</code> : 除了显示符合范本样式的那一列之外，并显示该行之后的内容。 </li>
<li><code>-B&lt;显示行数&gt;</code> 或 <code>--before-context=&lt;显示行数&gt;</code> : 除了显示符合样式的那一行之外，并显示该行之前的内容。 </li>
<li><code>-C&lt;显示行数&gt;</code> 或 <code>--context=&lt;显示行数&gt;或-&lt;显示行数&gt;</code> : 除了显示符合样式的那一行之外，并显示该行之前后的内容。 </li>
<li><code>-d &lt;动作&gt;</code> 或 <code>--directories=&lt;动作&gt;</code> : 当指定要查找的是目录而非文件时，必须使用这项参数，否则grep指令将回报信息并停止动作。</li>
<li><code>-i</code> 或 <code>--ignore-case</code> : 忽略字符大小写的差别。 同<code>-y</code> 。</li>
<li><code>-n</code> 或 <code>--line-number</code> : 在显示符合样式的那一行之前，标示出该行的列数编号。 </li>
<li><code>-o</code> 或 <code>--only-matching</code> : 只显示匹配PATTERN 部分。 </li>
<li><code>-r/R</code> 或 <code>--recursive</code> : 此参数的效果和指定”-d recurse”参数相同。 </li>
<li><code>-v</code> 或 <code>--revert-match</code> : 显示不包含匹配文本的所有行。 </li>
<li><code>-E</code> 或 <code>--extended-regexp</code> : 将样式为延伸的正则表达式来使用。 </li>
<li><code>-c</code> 或 <code>--count</code> : 计算符合样式的列数。</li>
<li><code>-b</code> 或 <code>--byte-offset</code> : 在显示符合样式的那一行之前，标示出该行第一个字符的编号。  </li>
<li><code>-l</code> 或 <code>--file-with-matches</code> : 列出文件内容符合指定的样式的文件名称。 </li>
<li><code>-L</code> 或 <code>--files-without-match</code> : 列出文件内容不符合指定的样式的文件名称。 </li>
<li><code>-e&lt;范本样式&gt;</code> 或 <code>--regexp=&lt;范本样式&gt;</code> : 指定字符串做为查找文件内容的样式。 </li>
</ul>
<h3 id="例子-6"><a href="#例子-6" class="headerlink" title="例子"></a>例子</h3><ul>
<li><p>在“路径”下，查找包含“xyz123”字段的文件，其中<code>-r</code>表示子文件夹也要搜索，<code>-i</code>表示不区分xyz的大小写</p>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">grep</span> -Ri xyz<span class="number">123</span> 路径</span><br></pre></td></tr></table></figure>
</li>
<li><p>输出包含匹配字符串的行数 -n 选项</p>
<figure class="highlight excel"><table><tr><td class="code"><pre><span class="line">grep <span class="string">&quot;text&quot;</span> -<span class="built_in">n</span> file_name</span><br></pre></td></tr></table></figure>
</li>
<li><p>显示匹配某个结果之后、之前、前后的3行</p>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">grep</span> <span class="string">&quot;5&quot;</span> -A <span class="number">3</span></span><br><span class="line"><span class="attribute">grep</span> <span class="string">&quot;5&quot;</span> -B <span class="number">3</span></span><br><span class="line"><span class="attribute">grep</span> <span class="string">&quot;5&quot;</span> -C <span class="number">3</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>输出除之外的所有行 -v 选项：</p>
<figure class="highlight gradle"><table><tr><td class="code"><pre><span class="line"><span class="keyword">grep</span> -v <span class="string">&quot;match_pattern&quot;</span> file_name</span><br></pre></td></tr></table></figure>
</li>
<li><p>使用正则表达式：或者直接用<code>egrep</code></p>
<figure class="highlight gradle"><table><tr><td class="code"><pre><span class="line"><span class="keyword">grep</span> -E <span class="string">&quot;[1-9]+&quot;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>只输出文件中匹配到的部分：</p>
<figure class="highlight gradle"><table><tr><td class="code"><pre><span class="line"><span class="keyword">grep</span> -o -E <span class="string">&quot;[a-z]+\.&quot;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>统计文件或者文本中包含匹配字符串的行数</p>
<figure class="highlight gradle"><table><tr><td class="code"><pre><span class="line"><span class="keyword">grep</span> -c <span class="string">&quot;text&quot;</span> file_name</span><br></pre></td></tr></table></figure>
</li>
<li><p>打印样式匹配所位于的字符或字节偏移（一行中字符串的字符便宜是从该行的第一个字符开始计算，起始值为0。选项 <code>-b -o</code> 一般总是配合使用。）：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">echo</span> gun is not unix | grep -b -o <span class="string">&quot;not&quot;</span></span></span><br><span class="line">7:not</span><br></pre></td></tr></table></figure>
</li>
<li><p>搜索多个文件并查找匹配文本在哪些文件中：</p>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">grep</span> -l <span class="string">&quot;text&quot;</span> file<span class="number">1</span> file<span class="number">2</span> file<span class="number">3</span>...</span><br></pre></td></tr></table></figure>
</li>
<li><p>选项 -e 制动多个匹配样式：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">echo</span> this is a text line | grep -e <span class="string">&quot;is&quot;</span> -e <span class="string">&quot;line&quot;</span> -o</span></span><br><span class="line">is</span><br><span class="line">line</span><br></pre></td></tr></table></figure>
</li>
<li><p>在grep搜索结果中包括或者排除指定文件：</p>
<figure class="highlight gradle"><table><tr><td class="code"><pre><span class="line"><span class="keyword">grep</span> <span class="string">&quot;main()&quot;</span> . -r --<span class="keyword">include</span> *.&#123;php,html&#125;</span><br><span class="line"><span class="keyword">grep</span> <span class="string">&quot;main()&quot;</span> . -r --<span class="keyword">exclude</span> <span class="string">&quot;README&quot;</span></span><br><span class="line">#在搜索结果中排除filelist文件列表里的文件</span><br><span class="line"><span class="keyword">grep</span> <span class="string">&quot;main()&quot;</span> . -r --<span class="keyword">exclude</span>-<span class="keyword">from</span> filelist</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="sed"><a href="#sed" class="headerlink" title="sed"></a>sed</h2><p>Stream Editor利用脚本来处理文本文件。主要用来自动编辑一个或多个文件、简化对文件的反复操作、编写转换程序等。</p>
<h3 id="语法-10"><a href="#语法-10" class="headerlink" title="语法"></a>语法</h3><figure class="highlight gams"><table><tr><td class="code"><pre><span class="line">sed [<span class="keyword">options</span>] <span class="string">&#x27;command&#x27;</span> <span class="keyword">file</span>(s)</span><br><span class="line">sed [<span class="keyword">options</span>] -f scriptfile <span class="keyword">file</span>(s)</span><br></pre></td></tr></table></figure>
<ul>
<li><p>sed表达式可以使用单引号来引用，但是如果表达式内部包含变量字符串，就需要使用双引号。</p>
</li>
<li><p>/ 在sed中作为定界符使用，也可以使用任意的定界符：但是定界符出现在样式内部时，需要进行转义</p>
<figure class="highlight sml"><table><tr><td class="code"><pre><span class="line">sed <span class="symbol">&#x27;s</span>:test:<span class="type">TEXT</span>:g&#x27;</span><br><span class="line">sed <span class="symbol">&#x27;s</span>|test|<span class="type">TEXT</span>|g&#x27;</span><br><span class="line">sed <span class="symbol">&#x27;s</span>/\/bin/\/usr\/<span class="keyword">local</span>\/bin/g&#x27;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="选项"><a href="#选项" class="headerlink" title="选项"></a>选项</h4><ul>
<li><code>-e&lt;script&gt;</code>或<code>--expression=&lt;script&gt;</code> ：以选项中指定的script来处理输入的文本文件。允许在同一行里执行多条命令：</li>
<li><code>-f&lt;script文件&gt;</code>或<code>--file=&lt;script文件&gt;</code> ：直接将 sed 的动作写在一个文件内， -f filename 则可以运行 filename 内的 sed 动作</li>
<li><code>-h</code>或<code>--help</code> 显示帮助。</li>
<li><code>-n</code>或<code>--quiet</code>或<code>--silent</code> 仅显示script处理后的结果。</li>
<li><code>-V</code>或<code>--version</code> 显示版本信息。</li>
<li><code>-i</code>：直接编辑文件选项</li>
</ul>
<h4 id="sed元字符集"><a href="#sed元字符集" class="headerlink" title="sed元字符集"></a>sed元字符集</h4><ul>
<li><code>^</code> 匹配行开始。如：<code>/^sed/</code>匹配所有以sed开头的行。</li>
<li><code>$</code> 匹配行结束。如：<code>/sed$/</code>匹配所有以sed结尾的行。</li>
<li><code>.</code> 匹配一个非换行符的任意字符。如：<code>/s.d/</code>匹配s后接一个任意字符，最后是d。</li>
<li><code>*</code> 前面的字符重复0到多次，如：<code>/*sed/</code>匹配所有模板是一个或多个空格后紧跟sed的行。</li>
<li><code>[]</code> 匹配一个指定范围内的字符，如<code>/[ss]ed/</code>匹配sed和Sed。  </li>
<li><code>[^]</code> 匹配一个不在指定范围内的字符，如：<code>/[^A-RT-Z]ed/</code>匹配不包含A-R和T-Z的一个字母开头，紧跟ed的行。</li>
<li><code>\(..\)</code> 匹配子串，保存匹配的字符，如<code>s/\(love\)able/\1rs</code>，loveable被替换成lovers。</li>
<li><code>&amp;</code> 保存搜索字符用来替换其他字符，如<code>s/love/**&amp;**/</code>，love这成<code>**love**</code>。</li>
<li><code>\&lt;</code> 匹配单词的开始，如<code>/\&lt;love/</code>匹配包含以love开头的单词的行。</li>
<li><code>\&gt;</code>  匹配单词的结束，如<code>/love\&gt;/</code>匹配包含以love结尾的单词的行。</li>
<li><code>x\&#123;m\&#125;</code> 重复字符x，m次，如：<code>/0\&#123;5\&#125;/</code>匹配包含5个0的行。</li>
<li><code>x\&#123;m,\&#125;</code> 重复字符x，至少m次，如：<code>/0\&#123;5,\&#125;/</code>匹配至少有5个0的行。</li>
<li><code>x\&#123;m,n\&#125;</code> 重复字符x，至少m次，不多于n次，如：<code>/0\&#123;5,10\&#125;/</code>匹配5~10个0的行。</li>
</ul>
<h4 id="动作"><a href="#动作" class="headerlink" title="动作"></a>动作</h4><ul>
<li><code>a</code> ：在当前行下面插入文本。后面可以直接接字符串。</li>
<li><code>i</code>： 在当前行上面插入文本。</li>
<li><code>c</code> ：把选定的行改为新的文本</li>
<li><code>p</code>：打印模板块的行。通常会与参数 <code>sed -n</code> 一起</li>
<li><code>s</code>：替换指定字符 ，标记有：<ul>
<li><code>g</code> ：表示行内全面替换。 </li>
<li><code>\1</code>：子串匹配标记</li>
<li><code>&amp;</code> ：已匹配字符串标记</li>
<li><code>y</code> ：表示把一个字符翻译为另外的字符（但是不用于正则表达式）</li>
<li><code>i·</code>：查找不区分大小写的</li>
</ul>
</li>
<li><code>d</code>：删除，删除选择的行</li>
<li><code>r file</code>：从file中读行。</li>
<li><code>w file</code>：写并追加模板块到file末尾。  </li>
<li><code>n</code> ：读取下一个输入行，用下一个命令处理新的行而不是用第一个命令。</li>
</ul>
<h3 id="例子-7"><a href="#例子-7" class="headerlink" title="例子"></a>例子</h3><h4 id="替换操作"><a href="#替换操作" class="headerlink" title="替换操作"></a>替换操作</h4><ul>
<li><p>替换：</p>
<figure class="highlight delphi"><table><tr><td class="code"><pre><span class="line">sed <span class="string">&#x27;s/book/books/&#x27;</span> <span class="keyword">file</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>打印那些发生替换的行：</p>
<figure class="highlight cmake"><table><tr><td class="code"><pre><span class="line">sed -n &#x27;s/<span class="keyword">test</span>/<span class="keyword">TEST</span>/p&#x27; <span class="keyword">file</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>直接编辑文件，当需要<strong>从第N处匹配开始替换时</strong>，可以使用 <code>/Ng</code>：</p>
<ul>
<li>省略g则默认是第一个</li>
</ul>
<figure class="highlight delphi"><table><tr><td class="code"><pre><span class="line">sed -i <span class="string">&#x27;s/book/books/g&#x27;</span> <span class="keyword">file</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>将第2-5行的内容取代成为『No 2-5 number』</p>
<figure class="highlight lsl"><table><tr><td class="code"><pre><span class="line">#将第<span class="number">2</span><span class="number">-5</span>行的内容取代成为『No <span class="number">2</span><span class="number">-5</span> number』</span><br><span class="line">sed &#x27;<span class="number">2</span>,<span class="number">5</span>c No <span class="number">2</span><span class="number">-5</span> number&#x27; file</span><br></pre></td></tr></table></figure>
</li>
<li><p>所有以192.168.0.1开头的行都会被替换成它自已加localhost：</p>
<figure class="highlight lsl"><table><tr><td class="code"><pre><span class="line">sed &#x27;s/^<span class="number">192.168</span><span class="number">.0</span><span class="number">.1</span>/&amp;localhost/&#x27; file</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>\n</code>表示匹配到的第几个</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">echo</span> aaa BBB | sed <span class="string">&#x27;s/\([a-z]\+\) \([A-Z]\+\)/\2 \1/&#x27;</span></span></span><br><span class="line">BBB aaa</span><br><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">echo</span> this is digit 7 <span class="keyword">in</span> a number | sed <span class="string">&#x27;s/digit \([0-9]\)/\1/&#x27;</span></span></span><br><span class="line">this is 7 in a number</span><br></pre></td></tr></table></figure>
</li>
<li><p>把1~10行内所有abcde转变为大写，注意，正则表达式元字符不能使用这个命令：</p>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">sed</span> &#x27;<span class="number">1</span>,<span class="number">10</span>y/abcde/ABCDE/&#x27; file</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="删除操作"><a href="#删除操作" class="headerlink" title="删除操作"></a>删除操作</h4><ul>
<li><p>删除空白行：</p>
<figure class="highlight delphi"><table><tr><td class="code"><pre><span class="line">sed <span class="string">&#x27;/^$/d&#x27;</span> <span class="keyword">file</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>删除文件的第2行：</p>
<figure class="highlight delphi"><table><tr><td class="code"><pre><span class="line">sed <span class="string">&#x27;2d&#x27;</span> <span class="keyword">file</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>删除文件的第2行到末尾所有行：</p>
<figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="attribute">sed</span> <span class="string">&#x27;2,<span class="variable">$d</span>&#x27;</span> file</span><br></pre></td></tr></table></figure>
</li>
<li><p>删除文件最后一行：</p>
<figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="attribute">sed</span> <span class="string">&#x27;<span class="variable">$d</span>&#x27;</span> file</span><br></pre></td></tr></table></figure>
</li>
<li><p>删除文件中所有开头是test的行：</p>
<figure class="highlight cmake"><table><tr><td class="code"><pre><span class="line">sed &#x27;/^<span class="keyword">test</span>/&#x27;d <span class="keyword">file</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>删除包含root的行：</p>
<figure class="highlight delphi"><table><tr><td class="code"><pre><span class="line">sed  <span class="string">&#x27;/root/d&#x27;</span> <span class="keyword">file</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="行"><a href="#行" class="headerlink" title="行"></a>行</h4><ul>
<li><p>所有在模板test和check所确定的范围内的行都被打印：</p>
<figure class="highlight cmake"><table><tr><td class="code"><pre><span class="line">sed -n &#x27;/<span class="keyword">test</span>/,/check/p&#x27; <span class="keyword">file</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>打印从第5行开始到第一个包含以test开始的行之间的所有行：</p>
<figure class="highlight cmake"><table><tr><td class="code"><pre><span class="line">sed -n &#x27;<span class="number">5</span>,/^<span class="keyword">test</span>/p&#x27; <span class="keyword">file</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>对于模板test和west之间的行，每行的末尾用字符串aaa bbb替换：</p>
<figure class="highlight jboss-cli"><table><tr><td class="code"><pre><span class="line">sed &#x27;<span class="string">/test/</span>,<span class="string">/west/s/</span>$<span class="string">/aaa</span> bbb/&#x27; file</span><br></pre></td></tr></table></figure>
</li>
<li><p>删除两个模式匹配行之间的内容</p>
<figure class="highlight jboss-cli"><table><tr><td class="code"><pre><span class="line">sed -i  &#x27;<span class="string">/aaa/</span>,<span class="string">/bbb/</span>&#123;<span class="string">/aaa/</span>!&#123;<span class="string">/bbb/</span>!d&#125;&#125;&#x27;   file</span><br></pre></td></tr></table></figure>
</li>
<li><p>如果test被匹配，则移动到匹配行的下一行，替换这一行的aa，变为bb，并打印该行，然后继续：</p>
<figure class="highlight gradle"><table><tr><td class="code"><pre><span class="line"><span class="keyword">grep</span> -A <span class="number">1</span> SCC URFILE </span><br><span class="line">sed <span class="string">&#x27;/test/&#123; n; s/aa/bb/; &#125;&#x27;</span> <span class="keyword">file</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>打印匹配字符串的下一行</p>
<figure class="highlight excel"><table><tr><td class="code"><pre><span class="line">sed -<span class="built_in">n</span> &#x27;/SCC/&#123;<span class="built_in">n</span>;p&#125;&#x27; URFILE</span><br></pre></td></tr></table></figure>
</li>
<li><p>打印奇数行或偶数行</p>
<figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="attribute">sed</span> -n <span class="string">&#x27;p;n&#x27;</span> test.txt  <span class="comment">#奇数行</span></span><br><span class="line">sed -n <span class="string">&#x27;n;p&#x27;</span> test.txt  <span class="comment">#偶数行</span></span><br><span class="line"></span><br><span class="line">sed -n <span class="string">&#x27;1~2p&#x27;</span> test.txt  <span class="comment">#奇数行</span></span><br><span class="line">sed -n <span class="string">&#x27;2~2p&#x27;</span> test.txt  <span class="comment">#偶数行</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="添加"><a href="#添加" class="headerlink" title="添加"></a>添加</h4><ul>
<li><p>添加到行后或者行前：如果增加的内容有好几行，则在行末加转移符号\n。</p>
<figure class="highlight stata"><table><tr><td class="code"><pre><span class="line">sed &#x27;/^<span class="keyword">test</span>/a\this is a <span class="keyword">test</span> <span class="keyword">line</span>&#x27; <span class="keyword">file</span></span><br><span class="line">sed &#x27;/^<span class="keyword">test</span>/i\this is a <span class="keyword">test</span> <span class="keyword">line</span>&#x27; <span class="keyword">file</span></span><br></pre></td></tr></table></figure>
<p>匹配不区分大小写添加时，在最后直接加<code>i</code>不可行，可以使用</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">sed -<span class="built_in">i</span> <span class="string">&#x27;s/aaa/bbb\n&amp;/i&#x27;</span> filename</span><br></pre></td></tr></table></figure>
</li>
<li><p>在 test.conf 文件第2行之后或第5行之前插入 this is a test line：</p>
<figure class="highlight stata"><table><tr><td class="code"><pre><span class="line">sed -i &#x27;2a\this is a <span class="keyword">test</span> <span class="keyword">line</span>&#x27; <span class="keyword">test</span>.<span class="keyword">conf</span></span><br><span class="line">sed -i &#x27;5i\this is a <span class="keyword">test</span> <span class="keyword">line</span>&#x27; <span class="keyword">test</span>.<span class="keyword">conf</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>在testfile文件的第四行后添加一行，并将结果输出到标准输出：</p>
<figure class="highlight haxe"><table><tr><td class="code"><pre><span class="line">sed -e <span class="number">4</span>a\<span class="keyword">new</span><span class="type">Line</span> testfile </span><br></pre></td></tr></table></figure>
</li>
<li><p><code>r</code>命令会把其后面的任何字符判读为文件名，直到回车符或是单引号，因此在某行后面添加文件是</p>
<figure class="highlight gradle"><table><tr><td class="code"><pre><span class="line">sed -i ‘<span class="regexp">/regex/</span>r b.txt’ <span class="keyword">file</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>在a.txt的第88行插入文件b.txt</p>
<figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line">sed -<span class="selector-tag">i</span> <span class="string">&#x27;88 r b.txt&#x27;</span> <span class="selector-tag">a</span>.txt</span><br></pre></td></tr></table></figure>
</li>
<li><p>在example中所有包含test的行都被写入file里：</p>
<figure class="highlight cmake"><table><tr><td class="code"><pre><span class="line">sed -n &#x27;/<span class="keyword">test</span>/w <span class="keyword">file</span>&#x27; example</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="打印，搜索显示"><a href="#打印，搜索显示" class="headerlink" title="打印，搜索显示"></a>打印，搜索显示</h4><ul>
<li><p>列出文件内的第 5-7 行</p>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">sed</span> -n &#x27;<span class="number">5</span>,<span class="number">7</span>p&#x27; file</span><br></pre></td></tr></table></figure>
</li>
<li><p>搜索有root关键字的行</p>
<figure class="highlight delphi"><table><tr><td class="code"><pre><span class="line">sed <span class="string">&#x27;/root/p&#x27;</span> <span class="keyword">file</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="多点编辑：e命令"><a href="#多点编辑：e命令" class="headerlink" title="多点编辑：e命令"></a>多点编辑：e命令</h4><ul>
<li><p>执行多条命令：</p>
<figure class="highlight delphi"><table><tr><td class="code"><pre><span class="line">sed -e <span class="string">&#x27;1,5d&#x27;</span> -e <span class="string">&#x27;s/test/check/&#x27;</span> <span class="keyword">file</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>组合多个表达式</p>
<figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="attribute">sed</span> <span class="string">&#x27;表达式&#x27;</span> | sed <span class="string">&#x27;表达式&#x27;</span></span><br><span class="line">或</span><br><span class="line">sed <span class="string">&#x27;表达式; 表达式&#x27;</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="perl-i"><a href="#perl-i" class="headerlink" title="perl -i"></a>perl -i</h2><p>在命令行中修改文件内容</p>
<ul>
<li><code>-w</code>  ：打开警告。</li>
<li><code>-i</code>  ：在原文件中编辑（就地编辑）。</li>
<li><code>-i.bak</code> 就地编辑，但是会备份原文件，并且以.bak为后缀，这个.bak可以修改成自己想要的任何符号。</li>
<li><code>-n</code>：使用&lt;&gt;将所有@ARGV参数当作文件来逐行运行,会将读入的内容隐式的逐一按行来遍历文件，每一行将缺省保存在 <code>$_</code>；意即会把输入的文件逐行的读取并保存在<code>$_</code>这个变量中，我们修改​<code>$_</code>相当于间接影响文件中的内容，这个工作其实是perl封装好了的，直接使用就好了；这个参数不会自动打印​<code>$_</code>。</li>
<li><code>-p</code>：这个和-n类似，但是会打印<code>$_</code>。</li>
<li><code>-e</code>：指定字符串用作脚本执行；通常后跟单引号，把需要执行的语句封装在其中。</li>
</ul>
<h3 id="例子-8"><a href="#例子-8" class="headerlink" title="例子"></a>例子</h3><ul>
<li><p>替换A为B</p>
<figure class="highlight vim"><table><tr><td class="code"><pre><span class="line"><span class="keyword">perl</span>  -i  -<span class="keyword">pe</span> ‘s/old_str/new_str/g’  <span class="keyword">files</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>替换A为B并备份</p>
<figure class="highlight vim"><table><tr><td class="code"><pre><span class="line"><span class="keyword">perl</span>  -i.bak -<span class="keyword">pe</span>  ‘s/old_str/new_str/g’ <span class="keyword">files</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>修改并输出到屏幕 此处修改后输出到屏幕，但并不会改变原文件。</p>
<figure class="highlight gradle"><table><tr><td class="code"><pre><span class="line">perl  -ne ‘s<span class="regexp">/old_str/</span>new_str/g;<span class="keyword">print</span>;’  files</span><br></pre></td></tr></table></figure>
</li>
<li><p>搜索满足条件的行</p>
<figure class="highlight gradle"><table><tr><td class="code"><pre><span class="line">perl  -i  -ne ‘<span class="keyword">print</span>  <span class="keyword">if</span> <span class="regexp">/condition/</span>’  files</span><br></pre></td></tr></table></figure>
</li>
<li><p>在文件中插入行号</p>
<figure class="highlight gams"><table><tr><td class="code"><pre><span class="line">perl  -i  -pe ‘<span class="symbol">$</span>_ = sprintf “d %s”, <span class="symbol">$</span>. , <span class="symbol">$</span>_’  <span class="keyword">files</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>在匹配的某行行首添加字串</p>
<figure class="highlight vim"><table><tr><td class="code"><pre><span class="line"><span class="keyword">perl</span>  -i  -<span class="keyword">pe</span> ‘<span class="keyword">print</span>  “<span class="built_in">string</span>” <span class="keyword">if</span>  /condition/’  <span class="keyword">files</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>在匹配的某行行尾添加字串</p>
<figure class="highlight awk"><table><tr><td class="code"><pre><span class="line">perl  -i  -pe ‘chomp; <span class="variable">$_</span> = <span class="variable">$_</span> . “string\n”  <span class="keyword">if</span> <span class="regexp">/condition/</span>’  files</span><br></pre></td></tr></table></figure>
</li>
<li><p>在匹配的某行前增加一行</p>
<figure class="highlight vim"><table><tr><td class="code"><pre><span class="line"><span class="keyword">perl</span>  -i  -<span class="keyword">pe</span> ‘<span class="keyword">print</span>  “<span class="built_in">string</span>\n” <span class="keyword">if</span>  /condition/’  <span class="keyword">files</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>在匹配的某行后增加一行</p>
<figure class="highlight awk"><table><tr><td class="code"><pre><span class="line">perl  -i  -pe ‘<span class="variable">$_</span> = <span class="variable">$_</span> . “string\n”  <span class="keyword">if</span> <span class="regexp">/condition/</span>’  files</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h1 id="文件传输"><a href="#文件传输" class="headerlink" title="文件传输"></a>文件传输</h1><h1 id="磁盘管理"><a href="#磁盘管理" class="headerlink" title="磁盘管理"></a>磁盘管理</h1><h2 id="cd"><a href="#cd" class="headerlink" title="cd"></a>cd</h2><p>Change directory，用于切换当前工作目录至</p>
<h3 id="语法-11"><a href="#语法-11" class="headerlink" title="语法"></a>语法</h3><figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">cd</span><span class="meta"> [dirName]</span></span><br></pre></td></tr></table></figure>
<p>dirName：</p>
<ul>
<li>可为绝对路径或相对路径。</li>
<li>若目录名称省略，则变换至使用者的home directory。<code>~</code>也表示为home directory的意思</li>
<li><code>.</code>则是表示目前所在的目录</li>
<li><code>..</code>则表示目前目录位置的上一层目录。</li>
<li><code>-</code>表示上一次打开的目录，并且会附带<code>pwd</code>。</li>
</ul>
<h2 id="df"><a href="#df" class="headerlink" title="df"></a>df</h2><p>检查磁盘空间占用情况(并不能查看某个目录占用的磁盘大小)。</p>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">df</span><span class="meta"> [option]</span></span><br></pre></td></tr></table></figure>
<ul>
<li><code>-h</code>：以容易理解的格式(给人看的格式)输出文件系统分区使用情况，例如 10kB、10MB、10GB 等。</li>
<li><code>-k</code>，<code>-m</code>： 以 kB、 mB 为单位输出文件系统分区使用情况。</li>
<li><code>-a</code>：列出所有的文件系统分区，包含大小为 0 的文件系统分区。</li>
<li><code>-i</code>：列出文件系统分区的 inodes 信息。</li>
<li><code>-T</code>：显示磁盘分区的文件系统类型。</li>
</ul>
<h2 id="du"><a href="#du" class="headerlink" title="du"></a>du</h2><p>用于显示目录或文件的大小。</p>
<h3 id="语法-12"><a href="#语法-12" class="headerlink" title="语法"></a>语法</h3><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">du [<span class="string">-abcDhHklmsSx</span>][<span class="symbol">-L &lt;符号连接&gt;</span>][<span class="string">-X &lt;文件&gt;</span>][<span class="symbol">--block-size</span>][<span class="string">--exclude=&lt;目录或文件&gt;</span>][<span class="symbol">--max-depth=&lt;目录层数&gt;</span>][<span class="string">--help</span>][<span class="symbol">--version</span>][<span class="string">目录或文件</span>]</span><br></pre></td></tr></table></figure>
<ul>
<li><code>--max-depth=&lt;目录层数&gt;</code>： 超过指定层数的目录后，予以忽略。</li>
<li><code>-h</code>或<code>--human-readable</code>：以K，M，G为单位，提高信息的可读性。</li>
<li><code>-s</code>或<code>--summarize</code>：显示文件或整个目录的大小，默认单位为 kB。</li>
<li><code>--block-size=k</code>：以K，M或者G为单位</li>
</ul>
<h3 id="例子-9"><a href="#例子-9" class="headerlink" title="例子"></a>例子</h3><ul>
<li><p>显示当前目录的大小：</p>
<figure class="highlight ebnf"><table><tr><td class="code"><pre><span class="line"><span class="attribute">du -hs</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>显示某个目录或文件的大小：</p>
<figure class="highlight properties"><table><tr><td class="code"><pre><span class="line"><span class="attr">du</span> <span class="string">-hs nodedemo/</span></span><br><span class="line"><span class="attr">du</span> <span class="string">-hs ./*</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="ll"><a href="#ll" class="headerlink" title="ll"></a>ll</h2><p>用法与ls相同，但列出信息更详细，包括文件的创建时间、所属对象、权限等等信息</p>
<h2 id="ls"><a href="#ls" class="headerlink" title="ls"></a>ls</h2><p>List files 于显示指定工作目录下之内容（列出目前工作目录所含之文件及子目录)。</p>
<h3 id="语法-13"><a href="#语法-13" class="headerlink" title="语法"></a>语法</h3><figure class="highlight jboss-cli"><table><tr><td class="code"><pre><span class="line"><span class="keyword">ls</span>（选项）（参数）</span><br></pre></td></tr></table></figure>
<p>选项：</p>
<ul>
<li><code>-l</code>：以长格式显示目录下的内容列表。输出的信息从左到右依次包括文件名，文件类型、权限模式、硬连接数、所有者、组、文件大小和文件的最后修改时间等；</li>
<li><code>-t</code>：用文件和目录的更改时间排序；</li>
<li><code>-r</code>：以文件名反序排列并输出目录内容列表；</li>
<li><code>-R</code>：递归处理，将指定目录下的所有文件及子目录一并处理；</li>
<li><code>-a</code>：显示所有档案及目录，包括隐藏文件；</li>
<li><code>-A</code>：显示除影藏文件“.”和“..”以外的所有文件列表；</li>
<li><code>-F</code>：在每个输出项后追加文件的类型标识符，具体含义：“*”表示具有可执行权限的普通文件，“/”表示目录，“@”表示符号链接，“|”表示命令管道FIFO，“=”表示sockets套接字。当文件为普通文件时，不输出任何标识符；</li>
<li><code>-m</code>：用“,”号区隔每个文件和目录的名称；</li>
</ul>
<h3 id="例子-10"><a href="#例子-10" class="headerlink" title="例子"></a>例子</h3><ul>
<li><p>列出目前工作目录下所有名称是 s 开头的文件，越新的排越后面 :</p>
<figure class="highlight jboss-cli"><table><tr><td class="code"><pre><span class="line"><span class="keyword">ls</span> -ltr s*</span><br></pre></td></tr></table></figure>
</li>
<li><p>将 /bin 目录以下所有目录及文件详细资料列出 :</p>
<figure class="highlight jboss-cli"><table><tr><td class="code"><pre><span class="line"><span class="keyword">ls</span> -lR <span class="string">/bin</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>列出目前工作目录下所有文件及目录；目录于名称后加 “/“, 可执行档于名称后加 “*” :</p>
<figure class="highlight ebnf"><table><tr><td class="code"><pre><span class="line"><span class="attribute">ls -AF</span>   </span><br></pre></td></tr></table></figure>
</li>
<li><p>水平输出文件列表</p>
<figure class="highlight crystal"><table><tr><td class="code"><pre><span class="line">$ ls -m</span><br><span class="line">bin, boot, data, dev, etc, home, <span class="class"><span class="keyword">lib</span>, <span class="title">lost</span>+<span class="title">found</span>, <span class="title">media</span>, <span class="title">misc</span>, <span class="title">mnt</span>, <span class="title">opt</span>, <span class="title">proc</span>, <span class="title">root</span>, <span class="title">sbin</span>, <span class="title">selinux</span>, <span class="title">srv</span>, <span class="title">sys</span>, <span class="title">tmp</span>, <span class="title">usr</span>, <span class="title">vark</span></span></span><br></pre></td></tr></table></figure>
</li>
<li><p>只列出文件夹</p>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="built_in">ls</span> <span class="operator">-F</span> | grep <span class="string">&#x27;/$&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">ls</span> <span class="literal">-d</span> */</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="mkdir"><a href="#mkdir" class="headerlink" title="mkdir"></a>mkdir</h2><p>make directory用于创建目录。</p>
<h3 id="语法-14"><a href="#语法-14" class="headerlink" title="语法"></a>语法</h3><figure class="highlight erlang"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="title">mkdir</span> <span class="params">(选项)</span><span class="params">(参数)</span></span></span><br></pre></td></tr></table></figure>
<p>选项：</p>
<ul>
<li><p><code>-p</code>：确保目录名称存在，不存在的就建一个。</p>
</li>
<li><p><code>-m&lt;目标属性&gt;</code>或<code>--mode&lt;目标属性&gt;</code>建立目录的同时设置目录的权限；</p>
</li>
</ul>
<h3 id="例子-11"><a href="#例子-11" class="headerlink" title="例子"></a>例子</h3><p>在目录<code>/usr/meng</code>下建立子目录<a href="http://man.linuxde.net/test">test</a>，并且只有文件主有读、写和执行权限，其他人无权访问：</p>
<figure class="highlight awk"><table><tr><td class="code"><pre><span class="line">mkdir -m <span class="number">700</span> <span class="regexp">/usr/m</span>eng/test</span><br></pre></td></tr></table></figure>
<h2 id="pwd"><a href="#pwd" class="headerlink" title="pwd"></a>pwd</h2><p>print work directory 显示出当前工作目录的绝对路径</p>
<h3 id="语法-15"><a href="#语法-15" class="headerlink" title="语法"></a>语法</h3><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">pwd [<span class="string">--help</span>][<span class="symbol">--version</span>]</span><br></pre></td></tr></table></figure>
<p>选项：</p>
<ul>
<li><code>--help</code> 在线帮助。</li>
<li><code>--version</code> 显示版本信息。</li>
</ul>
<h2 id="rmdir"><a href="#rmdir" class="headerlink" title="rmdir"></a>rmdir</h2><p>Remove Directory从一个目录中删除一个或多个空的子目录</p>
<h3 id="语法-16"><a href="#语法-16" class="headerlink" title="语法"></a>语法</h3><figure class="highlight arduino"><table><tr><td class="code"><pre><span class="line"><span class="built_in">rmdir</span> [-p] dirName</span><br></pre></td></tr></table></figure>
<p>选项：</p>
<ul>
<li><code>-p</code> ：当子目录被删除后使它也成为空目录的话，则顺便一并删除。</li>
<li><code>-rf</code> ：强制删除</li>
</ul>
<h3 id="例子-12"><a href="#例子-12" class="headerlink" title="例子"></a>例子</h3><p>在工作目录下的 BBB 目录中，删除名为 Test 的子目录。若 Test 删除后，BBB 目录成为空目录，则 BBB 亦予删除。</p>
<figure class="highlight stata"><table><tr><td class="code"><pre><span class="line"><span class="keyword">rmdir</span> -p BBB/<span class="keyword">Test</span></span><br></pre></td></tr></table></figure>
<h1 id="磁盘维护"><a href="#磁盘维护" class="headerlink" title="磁盘维护"></a>磁盘维护</h1><h1 id="网络通讯"><a href="#网络通讯" class="headerlink" title="网络通讯"></a>网络通讯</h1><h1 id="系统管理"><a href="#系统管理" class="headerlink" title="系统管理"></a>系统管理</h1><h2 id="top"><a href="#top" class="headerlink" title="top"></a>top</h2><p>用于实时显示 process 的动态。更强大的是htop命令。</p>
<h3 id="语法-17"><a href="#语法-17" class="headerlink" title="语法"></a>语法</h3><figure class="highlight scss"><table><tr><td class="code"><pre><span class="line"><span class="attribute">top</span> <span class="selector-attr">[-]</span> <span class="selector-attr">[d delay]</span> <span class="selector-attr">[q]</span> <span class="selector-attr">[c]</span> <span class="selector-attr">[S]</span> <span class="selector-attr">[s]</span> <span class="selector-attr">[i]</span> <span class="selector-attr">[n]</span> <span class="selector-attr">[b]</span></span><br></pre></td></tr></table></figure>
<p>选项：</p>
<ul>
<li><code>-n</code> : 更新的次数，完成后将会退出 top</li>
<li><code>-d</code>：改变显示的更新速度</li>
<li><code>-p&lt;进程号&gt;</code>：指定进程；</li>
<li><code>-u&lt;用户名&gt;</code>：指定用户名；</li>
</ul>
<p>交互命令：</p>
<ul>
<li><p><code>q</code> ：退出程序</p>
</li>
<li><p><code>1</code>：可监控每个逻辑CPU的状况</p>
</li>
<li><code>b</code>：高亮显示当前运行进程</li>
</ul>
<h3 id="例子-13"><a href="#例子-13" class="headerlink" title="例子"></a>例子</h3><ul>
<li><p>显示进程信息，查看该服务器当前有哪些计算进程，CPU占用率多大等等，按ctrl c退出。</p>
<figure class="highlight coq"><table><tr><td class="code"><pre><span class="line"><span class="built_in">top</span></span><br></pre></td></tr></table></figure>
<ul>
<li>会显示：<ul>
<li><code>top - 13:54:36</code>：当前时间；<code>363 days</code>：系统运行时间；<code>13 users</code>：登陆的用户数目；<code>load average:1.89, 2.12, 2.57</code>：系统负载，即任务队列的平均长度</li>
<li><code>Tasks: 528 total</code>：总进程数；<code>1 running</code>：正在运行的进程数；<code>507 sleeping</code>：睡眠的进程数；<code>20 stopped</code>：停止的进程数；<code>0 zombie</code>：冻结进程数</li>
<li><code>%Cpu(s):  0.5 us</code>：用户空间占用CPU百分比；<code>1.2 sy</code>  ：内核空间占用CPU百分比<code>0.0 ni</code>：用户进程空间内改变过优先级的进程占用CPU百分比；<code>94.4 id</code>：空闲CPU百分比；<code>3.9 wa</code>：等待输入输出的CPU时间百分比</li>
<li><code>KiB Mem : 19649531+total</code>：物理内存总量；<code>2547788 free</code>：空闲内存总量；<code>9682144 used</code>：使用的物理内存总量；<code>18426537+buff/cache</code>：用作内核缓存的内存量；<code>KiB Swap: 32767996 total</code>：交换区总量<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="string">top</span> <span class="bullet">-</span> <span class="number">13</span><span class="string">:54:36</span> <span class="string">up</span> <span class="number">363</span> <span class="string">days,</span>  <span class="number">1</span><span class="string">:51,</span> <span class="number">13</span> <span class="string">users,</span>  <span class="attr">load average:</span> <span class="number">1.89</span><span class="string">,</span> <span class="number">2.12</span><span class="string">,</span> <span class="number">2.57</span></span><br><span class="line"><span class="attr">Tasks:</span> <span class="number">528</span> <span class="string">total,</span>   <span class="number">1</span> <span class="string">running,</span> <span class="number">507</span> <span class="string">sleeping,</span>  <span class="number">20</span> <span class="string">stopped,</span>   <span class="number">0</span> <span class="string">zombie</span></span><br><span class="line"><span class="string">%Cpu(s):</span>  <span class="number">0.5</span> <span class="string">us,</span>  <span class="number">1.2</span> <span class="string">sy,</span>  <span class="number">0.0</span> <span class="string">ni,</span> <span class="number">94.4</span> <span class="string">id,</span>  <span class="number">3.9</span> <span class="string">wa,</span>  <span class="number">0.0</span> <span class="string">hi,</span>  <span class="number">0.1</span> <span class="string">si,</span>  <span class="number">0.0</span> <span class="string">st</span></span><br><span class="line"><span class="attr">KiB Mem :</span> <span class="number">19649531</span><span class="string">+total,</span>  <span class="number">2547788</span> <span class="string">free,</span>  <span class="number">9682144</span> <span class="string">used,</span> <span class="number">18426537</span><span class="string">+buff/cache</span></span><br><span class="line"><span class="attr">KiB Swap:</span> <span class="number">32767996</span> <span class="string">total,</span> <span class="number">28063200</span> <span class="string">free,</span>  <span class="number">4704796</span> <span class="string">used.</span> <span class="number">18375868</span><span class="string">+avail</span> <span class="string">Mem</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li><p>更新两次后终止更新显示</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">top -n <span class="number">2</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>更新周期为3秒</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">top -d <span class="number">3</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>显示进程号为139的进程信息，CPU、内存占用率等</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">top -p <span class="number">139</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h1 id="系统设置"><a href="#系统设置" class="headerlink" title="系统设置"></a>系统设置</h1><h1 id="备份压缩"><a href="#备份压缩" class="headerlink" title="备份压缩"></a>备份压缩</h1><h2 id="tar"><a href="#tar" class="headerlink" title="tar"></a>tar</h2><p>Tape archive （磁带档案）。tar是用来建立，还原备份文件的工具程序，它可以加入，解开备份文件内的文件。</p>
<ul>
<li>打包是指将一大堆文件或目录变成一个总的文件；压缩则是将一个大的文件通过一些压缩算法变成一个小文件。</li>
<li>利用tar命令，可以把一大堆的文件和目录全部打包成一个文件，这对于备份文件或将几个文件组合成为一个文件以便于网络传输是非常有用的。</li>
<li>打包成一个包后，再用压缩程序进行压缩（gzip bzip2命令）等。</li>
</ul>
<h3 id="语法-18"><a href="#语法-18" class="headerlink" title="语法"></a>语法</h3><figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="title">tar</span><span class="params">(选项)</span><span class="params">(参数)</span></span></span><br></pre></td></tr></table></figure>
<p>选项：</p>
<ul>
<li><code>-c</code>或<code>--create</code>：建立新的备份文件；</li>
<li><code>-f</code>：&lt;备份文件&gt;或—file=&lt;备份文件&gt; 指定备份文件。</li>
<li><code>-j</code>：支持bzip2解压文件；</li>
<li><code>-N&lt;日期格式&gt;</code>或<code>--newer=&lt;日期时间&gt;</code>：只将较指定日期更新的文件保存到备份文件里。</li>
<li><code>-p</code>或<code>--same-permissions</code>：用原来的文件权限还原文件；</li>
<li><code>-t</code>或<code>--list</code>：列出备份文件的内容。</li>
<li><code>-v</code>或<code>--verbose</code>：显示指令执行过程。</li>
<li><code>-x</code>或<code>--extract</code>或<code>--get</code>：从备份文件中还原文件；</li>
<li><code>-z</code>或<code>--gzip</code>或<code>--ungzip</code> ：通过gzip指令处理备份文件。</li>
<li><code>--exclude=&lt;范本样式&gt;</code>：排除符合范本样式的文件。</li>
</ul>
<h3 id="例子-14"><a href="#例子-14" class="headerlink" title="例子"></a>例子</h3><h4 id="将文件全部打包成tar包"><a href="#将文件全部打包成tar包" class="headerlink" title="将文件全部打包成tar包"></a>将文件全部打包成tar包</h4><ul>
<li><p>仅打包，不压缩。在选项<code>f</code>之后的文件档名是自己取的，习惯上都用 .tar 来作为辨识。 </p>
<figure class="highlight 1c"><table><tr><td class="code"><pre><span class="line">tar -cvf <span class="built_in">log</span>.tar log2012.<span class="built_in">log</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><font color=red>打包后，以 gzip 压缩 </font>。如果加<code>z</code>选项，则以.tar.gz或.tgz来代表gzip压缩过的tar包</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">tar</span> <span class="selector-tag">-czvf</span> <span class="selector-tag">log</span><span class="selector-class">.tar</span><span class="selector-class">.gz</span> <span class="selector-tag">log2012</span><span class="selector-class">.log</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>打包后，以 bzip2 压缩 ，如果加<code>j</code>选项，则以.tar.bz2来作为tar包名。</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">tar</span> <span class="selector-tag">-jcvf</span> <span class="selector-tag">log</span><span class="selector-class">.tar</span><span class="selector-class">.bz2</span> <span class="selector-tag">log2012</span><span class="selector-class">.log</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>文件备份下来，并且保存其权限：当要保留原本文件的属性，需要用<code>-P</code></p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">tar</span> <span class="selector-tag">-zcvpf</span> <span class="selector-tag">log31</span><span class="selector-class">.tar</span><span class="selector-class">.gz</span> <span class="selector-tag">log2014</span><span class="selector-class">.log</span> <span class="selector-tag">log2015</span><span class="selector-class">.log</span> <span class="selector-tag">log2016</span><span class="selector-class">.log</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>在文件夹当中，比某个日期新的文件才备份</p>
<figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line">tar -N <span class="string">&quot;2012/11/13&quot;</span> -zcvf log17<span class="selector-class">.tar</span><span class="selector-class">.gz</span> test</span><br></pre></td></tr></table></figure>
</li>
<li><p>备份文件夹内容是排除部分文件</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">tar --exclude scf<span class="built_in">/service </span>-zcvf scf.tar.gz scf/*</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="查阅tar包内有哪些文件"><a href="#查阅tar包内有哪些文件" class="headerlink" title="查阅tar包内有哪些文件"></a>查阅tar包内有哪些文件</h4><ul>
<li><p><font color=red>查询</font>：使用gzip压缩的log.tar.gz，在查阅log.tar.gz包内的文件时，要加上<code>z</code>这个选项</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">tar</span> <span class="selector-tag">-tzvf</span> <span class="selector-tag">log</span><span class="selector-class">.tar</span><span class="selector-class">.gz</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="将tar包解压缩"><a href="#将tar包解压缩" class="headerlink" title="将tar包解压缩"></a>将tar包解压缩</h4><ul>
<li><font color=red>全部解压</font>

<figure class="highlight awk"><table><tr><td class="code"><pre><span class="line">tar -xzvf <span class="regexp">/opt/</span>soft<span class="regexp">/test/</span>log.tar.gz</span><br></pre></td></tr></table></figure>
</li>
<li><p>只将tar内的部分文件解压出来</p>
<figure class="highlight awk"><table><tr><td class="code"><pre><span class="line">tar -xzvf <span class="regexp">/opt/</span>soft<span class="regexp">/test/</span>log30.tar.gz log2013.log</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h1 id="设备管理"><a href="#设备管理" class="headerlink" title="设备管理"></a>设备管理</h1><h1 id="其他命令"><a href="#其他命令" class="headerlink" title="其他命令"></a>其他命令</h1><h2 id="bc"><a href="#bc" class="headerlink" title="bc"></a>bc</h2><p>任意精度计算器语言。bash内置了对整数四则运算的支持，但是并不支持浮点运算，而bc可以。</p>
<h3 id="语法-19"><a href="#语法-19" class="headerlink" title="语法"></a>语法</h3><figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="title">bc</span><span class="params">(选项)</span><span class="params">(参数)</span></span></span><br></pre></td></tr></table></figure>
<p>通常和管道符一起使用</p>
<h3 id="例子-15"><a href="#例子-15" class="headerlink" title="例子"></a>例子</h3><h4 id="运算"><a href="#运算" class="headerlink" title="运算"></a>运算</h4><p>常用的运算</p>
<ul>
<li><code>+</code>加法</li>
<li><code>-</code> 减法</li>
<li><code>*</code> 乘法</li>
<li><code>/</code> 除法</li>
<li><code>^</code> 指数</li>
<li><code>%</code> 余数</li>
</ul>
<p>乘法：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">echo</span> <span class="string">&quot;1.212*3&quot;</span> | bc </span></span><br><span class="line">3.636</span><br></pre></td></tr></table></figure>
<p>计算平方和平方根：</p>
<figure class="highlight 1c"><table><tr><td class="code"><pre><span class="line">echo <span class="string">&quot;10^10&quot;</span> <span class="string">| bc</span></span><br><span class="line">echo <span class="string">&quot;sqrt(100)&quot;</span> <span class="string">| bc</span></span><br></pre></td></tr></table></figure>
<h4 id="设定小数精度（数值范围）"><a href="#设定小数精度（数值范围）" class="headerlink" title="设定小数精度（数值范围）"></a>设定小数精度（数值范围）</h4><p>参数<code>scale=2</code>是将bc输出结果的小数位设置为2位。</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">echo</span> <span class="string">&quot;scale=2;3/8&quot;</span> | bc</span></span><br><span class="line">0.37</span><br></pre></td></tr></table></figure>
<h4 id="进制转换："><a href="#进制转换：" class="headerlink" title="进制转换："></a>进制转换：</h4><ul>
<li><p>将十进制转换成二进制：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line">abc=192</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;obase=2;<span class="variable">$abc</span>&quot;</span> | bc</span><br></pre></td></tr></table></figure>
</li>
<li><p>将二进制转换为十进制：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line">abc=11000000</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;obase=10;ibase=2;<span class="variable">$abc</span>&quot;</span> | bc</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="tail"><a href="#tail" class="headerlink" title="tail"></a>tail</h2><p>用于查看输入文件中的尾部内容。tail命令默认在屏幕上显示指定文件的末尾10行。</p>
<h3 id="语法-20"><a href="#语法-20" class="headerlink" title="语法"></a>语法</h3><figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="title">tail</span><span class="params">(选项)</span><span class="params">(参数)</span></span></span><br></pre></td></tr></table></figure>
<p>参数：</p>
<ul>
<li><code>-f</code> ：循环读取</li>
<li><code>-q</code> ：不显示处理信息</li>
<li><code>-v</code> ：显示详细的处理信息，当有多个文件参数时，总是输出各个文件名。</li>
<li><code>-q</code>或<code>--quiet</code>或<code>--silent</code>：当有多个文件参数时，不输出各个文件名；</li>
<li><code>-c&lt;数目&gt;</code> ：显示的字节数</li>
<li><code>-n&lt;行数&gt;</code> 或<code>——line=&lt;N&gt;</code>：显示文件的尾部 n 行内容</li>
<li><code>-s&lt;秒数&gt;</code>, <code>——sleep-interal=&lt;秒数&gt;</code> 与<code>-f</code>合用，指定监视文件变化时间隔的秒数。</li>
</ul>
<h3 id="例子-16"><a href="#例子-16" class="headerlink" title="例子"></a>例子</h3><ul>
<li><p>显示 notes.log 文件的最后 10 行：</p>
<figure class="highlight stan"><table><tr><td class="code"><pre><span class="line"><span class="built_in">tail</span> notes.<span class="built_in">log</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>跟踪名为 notes.log 的文件的增长情况，直到按下Ctrl+C组合键停止显示：</p>
<figure class="highlight stan"><table><tr><td class="code"><pre><span class="line"><span class="built_in">tail</span> -f notes.<span class="built_in">log</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>显示文件 notes.log 的内容，从第 20 行至文件末尾:</p>
<figure class="highlight stan"><table><tr><td class="code"><pre><span class="line"><span class="built_in">tail</span> +<span class="number">20</span> notes.<span class="built_in">log</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>显示文件 notes.log 的最后 10 个字符:</p>
<figure class="highlight llvm"><table><tr><td class="code"><pre><span class="line"><span class="keyword">tail</span> -<span class="keyword">c</span> <span class="number">10</span> notes.log</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="xargs"><a href="#xargs" class="headerlink" title="xargs"></a>xargs</h2><ul>
<li>eXtended ARGuments，是给命令传递参数的一个过滤器，也是组合多个命令的一个工具。</li>
<li>它能够捕获一个命令的输出，然后传递给另外一个命令。</li>
</ul>
<h3 id="语法-21"><a href="#语法-21" class="headerlink" title="语法"></a>语法</h3><ul>
<li>一般是和管道一起使用。</li>
</ul>
<figure class="highlight livecodeserver"><table><tr><td class="code"><pre><span class="line">somecommand |xargs -<span class="keyword">item</span>  <span class="keyword">command</span></span><br></pre></td></tr></table></figure>
<ul>
<li>xargs的默认命令是<code>echo</code>，空格是默认定界符。</li>
</ul>
<h3 id="例子-17"><a href="#例子-17" class="headerlink" title="例子"></a>例子</h3><h4 id="格式化输入"><a href="#格式化输入" class="headerlink" title="格式化输入"></a>格式化输入</h4><ul>
<li><p>将test文件中的多行变成一行：</p>
<figure class="highlight stata"><table><tr><td class="code"><pre><span class="line"><span class="keyword">cat</span> <span class="keyword">test</span>.txt | xargs</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>-n</code> 选项多行输出，将test文件中的三个一行输出多</p>
<figure class="highlight stata"><table><tr><td class="code"><pre><span class="line"><span class="keyword">cat</span> <span class="keyword">test</span>.txt | xargs -n3</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>-d</code> 选项可以自定义一个定界符：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">echo</span> <span class="string">&quot;nameXnameXnameXname&quot;</span> | xargs -dX</span></span><br><span class="line">name name name name</span><br><span class="line"></span><br><span class="line"><span class="meta">$</span><span class="bash">  <span class="built_in">echo</span> <span class="string">&quot;nameXnameXnameXname&quot;</span> | xargs -dX -n2</span></span><br><span class="line">name name</span><br><span class="line">name name</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="替换字符串"><a href="#替换字符串" class="headerlink" title="替换字符串{}"></a>替换字符串{}</h4><ul>
<li><p>复制所有图片文件到 /data/images 目录下：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ls *.jpg | xargs -n1 -I cp &#123;&#125; /data/images</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="结合find使用"><a href="#结合find使用" class="headerlink" title="结合find使用"></a>结合find使用</h4><ul>
<li><p>删除文件</p>
<figure class="highlight sqf"><table><tr><td class="code"><pre><span class="line"><span class="built_in">find</span> . -<span class="built_in">type</span> f -<span class="built_in">name</span> <span class="string">&quot;*.log&quot;</span> -print0 | xargs -<span class="number">0</span> rm -f</span><br></pre></td></tr></table></figure>
</li>
<li><p>统计一个源代码目录中所有 php 文件的行数：</p>
<figure class="highlight sqf"><table><tr><td class="code"><pre><span class="line"><span class="built_in">find</span> . -<span class="built_in">type</span> f -<span class="built_in">name</span> <span class="string">&quot;*.php&quot;</span> -print0 | xargs -<span class="number">0</span> wc -l</span><br></pre></td></tr></table></figure>
</li>
<li><p>查找所有的 jpg 文件，并且压缩它们</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line"><span class="builtin-name">find</span> . -type f -name <span class="string">&quot;*.jpg&quot;</span> -<span class="builtin-name">print</span> | xargs tar -czvf images.tar.gz</span><br></pre></td></tr></table></figure>
</li>
<li><p>替换文件内容</p>
<figure class="highlight coq"><table><tr><td class="code"><pre><span class="line">find . -type f | <span class="type">xargs</span> perl -pi -e &#x27;s|<span class="type">_NR</span>|<span class="type">_SR</span>|<span class="type">g</span>&#x27;</span><br></pre></td></tr></table></figure>
</li>
</ul>
]]></content>
      <categories>
        <category>系统</category>
      </categories>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title>基组</title>
    <url>/2019/09/01/%E5%9F%BA%E7%BB%84/</url>
    <content><![CDATA[<ul>
<li>从头算中，采取了LCAO-MO近似，即通过对原子轨道进行线性叠加来构造分子轨道：<script type="math/tex">\left|\psi_{\mu}\right\rangle=\sum_{i=1}^{n}\left|\varphi_{i}\right\rangle a_{i \mu}</script></li>
<li>由原子的Hatree-Fock方程得到的原子轨道AO为数值解析的函数，因此需要通过解析函数来拟合：<script type="math/tex">\left|\varphi_{i}\right\rangle=\sum_{k=1}^{m}\left|\chi_{k}\right\rangle b_{k i}</script></li>
<li>以基函数为基的Roothaan方程：<script type="math/tex">\left|\psi_{\mu}\right\rangle=\sum_{=1}^{n} \sum_{k=1}^{m}\left|\chi_{k}\right\rangle b_{k i} a_{i \mu}=\sum_{k=1}^{m}\left|\chi_{k}\right\rangle\left[\sum_{i=1}^{n} b_{k} a_{i \mu}\right]=\sum_{i=1}^{m}\left|\chi_{k}\right\rangle c_{k \mu}</script></li>
<li>基函数集基本要求：<ul>
<li>分子积分容易计算，且速度快；</li>
<li>在较小的基组维界下即可逼近数学完备集的理论极限精度（MO的展开具有高的收敛性）</li>
</ul>
</li>
<li>做SCF时，每迭代一次就系数就会改变一次，不断调整求解。</li>
<li>基函数只有数学意义，函数越多结果越精确，但也取决于怎么合理地设基函数。（基函数数学形式很好，几个就行，基函数数学很烂，很多展开也不好）。</li>
<li>当基函数无穷多，成为完备集，就达到了完备基组极限(Complete basis set limmit,CBS)，能够完美展开分子轨道。从基组角度来说没有误差，误差来源于理论方法。</li>
<li>实际用的基组尺寸是有限的而达不到CBS，由此导致的计算结果的误差称为基组不完备性误差。</li>
</ul>
<h1 id="Y-l-m-部分"><a href="#Y-l-m-部分" class="headerlink" title="Y_{l m}部分"></a><script type="math/tex">Y_{l m}</script>部分</h1><h2 id="中心势场型AO基组"><a href="#中心势场型AO基组" class="headerlink" title="中心势场型AO基组"></a>中心势场型AO基组</h2><ul>
<li>对单电子原子的薛定谔方程进行求解，通过球坐标的变换和使用变量分离法，得到<script type="math/tex">\varphi(r, \theta, \phi)=R_{n l}(r) Y_{l m}(\theta, \phi)</script>，其中球谐部分<script type="math/tex">Y_{l m}(\theta, \phi)</script>与势能无关。</li>
<li>对于多电子体系，其他电子对第i个电子的排斥看为对核电荷的屏蔽，即引入屏蔽常数σ。与势能的径向部分写为<script type="math/tex">R_{n l}(r, \sigma)</script>，即得到<script type="math/tex">\varphi(r, \theta, \phi)=R_{n l}(r, \sigma) Y_{l m}(\theta, \phi)</script><ul>
<li>n主量子数：1, 2, …</li>
<li>l角量子数：0, 1, 2, …, n-1（s、p、d、f……）</li>
<li>m磁量子数：0,±1, …,±l</li>
</ul>
</li>
</ul>
<h2 id="复AO和实AO"><a href="#复AO和实AO" class="headerlink" title="复AO和实AO"></a>复AO和实AO</h2><ul>
<li><script type="math/tex">Y_{l m}(\theta, \phi)</script>分为复型（连属Legendre多项式）和实型。</li>
</ul>
<p>例子：</p>
<ul>
<li><p><script type="math/tex">\text { Complex }\left\{\begin{array}{l}
Y_{11}=\sqrt{\frac{3}{8 \pi}} \sin \theta e^{i \varphi} \\
Y_{10}=\sqrt{\frac{3}{4 \pi}} \cos \theta \\
Y_{1 \overline{1}}=\sqrt{\frac{3}{8 \pi}} \sin \theta e^{-i \varphi}
\end{array}\right.</script>具有球对称性<script type="math/tex">K_h</script>，无方向性，物理学家更关心。</p>
</li>
<li><p><script type="math/tex">\text { Real }\left\{\begin{array}{l}
Y_{p x}=\sqrt{\frac{3}{4 \pi}} \sin \theta \cos \varphi=\sqrt{\frac{3}{4 \pi}} \frac{x}{r} \\
Y_{p y}=\sqrt{\frac{3}{4 \pi}} \sin \theta \sin \varphi=\sqrt{\frac{3}{4 \pi}} \frac{y}{r} \\
Y_{p z}=\sqrt{\frac{3}{4 \pi}} \cos \theta=\sqrt{\frac{3}{4 \pi}} \frac{z}{r}
\end{array}\right.</script>具有立方对称性<script type="math/tex">O_h</script>，化学家更关心化学键中原子的位置和方向，所以降低其对称性，引入了x，y，z方向。</p>
</li>
</ul>
<p><img src="p型复AO和实AO的角度分布比较.png" alt=""></p>
<p>特点：</p>
<ul>
<li>复AO无方向性；AO与共价键方向性相联系</li>
<li>原子计算用复AO基，分子计算用实AO基</li>
<li>复AO基与实AO基可以通过欧拉公式<script type="math/tex">e^{i x}=\cos x+i \sin x</script>，线性组合相互转换：<script type="math/tex">Y_{p x}=\frac{1}{\sqrt{2}}\left(Y_{11}+Y_{1 \overline{1}}\right) ; \quad Y_{p y}=\frac{1}{\sqrt{2} i}\left(Y_{11}-Y_{1 \overline{1}}\right)</script></li>
<li>不同AO基的角度部分<script type="math/tex">Y_{l m}</script>均固定不变，基函数的选择实际上是选取<script type="math/tex">R_{n l}</script>合适的形式</li>
</ul>
<h1 id="R-n-l-部分"><a href="#R-n-l-部分" class="headerlink" title="R_{n l}部分"></a><script type="math/tex">R_{n l}</script>部分</h1><p>类氢原子轨道的径向函数为连属Laguerre多项式的形式：<script type="math/tex">R_{n l}(r)=N_{n} e^{-\rho / 2} \rho^{l} L_{n+l}^{2 l+1}(\rho) ; \quad \rho=\frac{2 Z}{n} \frac{r}{a_{0}}</script>，展开为：</p>
<script type="math/tex; mode=display">
R_{n l}(r)=\sum_{k=0}^{n-l-1} c_{k}\left(\frac{r}{a_{0}}\right)^{k}\left(\frac{r}{a_{0}}\right)^{l} e^{-\frac{Z r}{n a_{0}}}=\left[c_{0}+c_{1} \frac{r}{a_{0}}+\cdots+c_{n-l-1}\left(\frac{r}{a_{0}}\right)^{n-l-1}\right]\left(\frac{r}{a_{0}}\right)^{l} e^{-\frac{Z r}{n a_{0}}}</script><ul>
<li>最高次项取到n-l-1，这样符合解薛定谔方程的量子数。</li>
<li>函数中，n-l-1次多项式有n-l个极值点和n-l-1个节点，积分非常困难（时正时负），不便用于分子积分计算。</li>
</ul>
<p>例子：氢原子的2s和sp连属Laguerre多项式</p>
<script type="math/tex; mode=display">R_{2 s}(r)=\left[c_{0}+c_{1} \frac{r}{a_{0}}\right] e^{-\frac{Z r}{n a_{0}}}$$$$\quad R_{2 p}(r)=\left[c_{0}\right]\left(\frac{r}{a_{0}}\right) e^{-\frac{Z r}{n a_{0}}}</script><p>径向分布函数：<script type="math/tex">D(r)=r^{2} R(r)^{2}</script></p>
<p><img src="image-20210618172635946.png" alt="" style="zoom: 40%;" /></p>
<h1 id="Slater-Type-Orbital（STO）"><a href="#Slater-Type-Orbital（STO）" class="headerlink" title="Slater-Type Orbital（STO）"></a>Slater-Type Orbital（STO）</h1><p>Slater提出一种无节点型的简化径向函数</p>
<script type="math/tex; mode=display">
R_{n}(r ; \zeta)=N_{n, \zeta} r^{n-1} e^{-\varsigma r},\zeta=(Z-\sigma) / n</script><ul>
<li>实际上是截取了类氢AO的最高次项，<script type="math/tex">\left(\cdots r^{n-l-1}\right) r^{l} e^{\cdots} \Rightarrow \cdots r^{n-1} e^{. \cdots}</script></li>
<li>数值仅仅与<script type="math/tex">n</script>和<script type="math/tex">\sigma</script>（Slater screening constant）有关，即<script type="math/tex">\zeta</script>，而与<script type="math/tex">l</script>无关，取决于屏蔽效应</li>
<li>R<sub>n</sub>无节点，因此函数集归一化但相互不正交：<script type="math/tex">\left\langle R_{n} \mid R_{n^{\prime}}\right\rangle=\int R_{n}^{*}(r ; \varsigma) R_{n^{\prime}}(r ; \varsigma) r^{2} d \tau \neq \delta_{n n^{\prime}}</script></li>
<li><script type="math/tex">R_{n}(r ; \zeta)</script>和<script type="math/tex">Y_{l m}</script>组合构成的基函数集通称“Slater型轨道”（STO），属于非正交的AO基集。但是其实严格来说不是一个轨道，只是一个函数拟合的轨道，严格的简称STF。</li>
</ul>
<h2 id="zeta的优化"><a href="#zeta的优化" class="headerlink" title="\zeta的优化"></a><script type="math/tex">\zeta</script>的优化</h2><ul>
<li>这一方法取决于<script type="math/tex">\zeta</script>的精度。但是<script type="math/tex">\zeta</script>与分子有关，即随体系变化。</li>
<li>先通过对个元素原子的SCF计算，对<script type="math/tex">\zeta</script>初步优化，再在分子环境下进行<script type="math/tex">\zeta</script>的再优化。</li>
<li>对大量的中、小分子的“最优<script type="math/tex">\zeta</script>“进行平均，定义出“标准<script type="math/tex">\zeta</script>”，Gaussain和大多数软件的默认值都是标准<script type="math/tex">\zeta</script></li>
</ul>
<p><img src="image-20210618190026149.png" alt="" style="zoom:33%;" /></p>
<h2 id="AO基组的大小等级"><a href="#AO基组的大小等级" class="headerlink" title="AO基组的大小等级"></a>AO基组的大小等级</h2><h3 id="极小基Minimal-basis-sets（MBS）"><a href="#极小基Minimal-basis-sets（MBS）" class="headerlink" title="极小基Minimal basis sets（MBS）"></a>极小基Minimal basis sets（MBS）</h3><ul>
<li>原子的每个AO只对应一个基函数。也称为“单<script type="math/tex">\zeta</script>基组”，即<span id="单zeta">SZ</span>。因为基函数太少，不足以充分表现价层原子轨道在实际分子环境中的变形，如今已基本无人使用。</li>
<li><script type="math/tex">\left\{\phi_{i}\right\}=\text { Core AO's }+\text { Valence AO's }</script>，包含芯基组和价基组</li>
<li>精度比较低。</li>
</ul>
<h3 id="价基组Valence-basis-sets（VBS）"><a href="#价基组Valence-basis-sets（VBS）" class="headerlink" title="价基组Valence basis sets（VBS）"></a>价基组Valence basis sets（VBS）</h3><ul>
<li>去除极小基中的“芯基组”，只留下价基组</li>
<li>用于半经验和低级的价电子从头算</li>
</ul>
<h3 id="扩展基组（EBS）"><a href="#扩展基组（EBS）" class="headerlink" title="扩展基组（EBS）"></a>扩展基组（EBS）</h3><ul>
<li>原子轨道由多个基函数描述，向极小基中增加基函数，进一步逼近完备集。<script type="math/tex">\left\{\phi_{i}\right\}=\text { Minimal BS }+\text {Additional BS }</script></li>
<li>增大变分空间，计算精度得以改善</li>
</ul>
<h2 id="常见的STO扩展基组形式"><a href="#常见的STO扩展基组形式" class="headerlink" title="常见的STO扩展基组形式"></a>常见的STO扩展基组形式</h2><p><img src="clipboard.png" alt="img" style="zoom: 33%;" /></p>
<h3 id="nζ基组"><a href="#nζ基组" class="headerlink" title="nζ基组"></a>nζ基组</h3><ul>
<li><span id="双zeta">双ζ基组</span>，DZ：每个AO对应2个n相同，但ζ不同的STO（ζ’&lt;ζ’）</li>
<li>也有TZ，QZ等。</li>
</ul>
<h3 id="含极化函数的基组"><a href="#含极化函数的基组" class="headerlink" title="含极化函数的基组"></a><span id="极化">含极化函数的基组</span></h3><script type="math/tex; mode=display">\left\{\phi_{i}\right\}=\text { DZ }+\text { Polarization function }</script><ul>
<li>向DZ基加入比价AO角量子数<script type="math/tex">l</script>更高的基函数以利于描述原子成键后的电子云极化变形。（ADF中描述位nZ2P，2P表示两个极化函数。）</li>
<li>例子：比如为了描述H原子1s轨道成键的方向性，加入2p型极化函数。2p轨道就加入3d轨道，3d加入f轨道。</li>
</ul>
<p><img src="image-20210618194650821.png" alt="" style="zoom:50%;" /></p>
<h3 id="含弥散函数的基组"><a href="#含弥散函数的基组" class="headerlink" title="含弥散函数的基组"></a><span id="弥散">含弥散函数的基组</span></h3><ul>
<li>分子的负离子因电子过量使电子云弥散度增加，向极化基组中添加<strong>小的ζ</strong>弥散函数使物理图像能正确反映。比如分子间弱相互作用（范德华力、氢键）体系或过渡态、激发态的计算通常也需要添加弥散函数。</li>
<li>ζ越小，r增大时，<script type="math/tex">R_{n}(r ; \zeta)=N_{n, \zeta} r^{n-1} e^{-\varsigma r}</script>衰减的速度越慢，因此加入小ζ的STO有利于对原子核区域的电子运动的描述。</li>
</ul>
<p><img src="image-20210618200107486.png" alt="" style="zoom:50%;" /></p>
<h2 id="STO基组的优缺点和用途"><a href="#STO基组的优缺点和用途" class="headerlink" title="STO基组的优缺点和用途"></a>STO基组的优缺点和用途</h2><ul>
<li>优点：与真实原子分子轨道的径向电子分布特性确实比较靠近，因为是从类氢原子推出来的。</li>
<li>缺点：计算三、四中心双电子积分困难。<ul>
<li>因为在球坐标下<script type="math/tex">\frac{1}{r_{12}}</script>的展开为<script type="math/tex">\frac{1}{r_{12}}=\sum_{l=0}^{\infty} \frac{r_{<}^{l}}{r_{>}^{l+1}} P_{l}(\cos \theta)</script>，是收敛很慢的无穷级数。（<script type="math/tex">P_{l}(\cos \theta)</script>为l阶Legendre多项式）</li>
<li>另外，<script type="math/tex">e^{-\varsigma r}</script>中的<script type="math/tex">r=(x^2+y^2+z^2)^{1/2}</script>，积分困难，变量难以分离</li>
</ul>
</li>
<li>用途：<ul>
<li>主要用于半经验 MO 计算，因为把很多积分都忽略了。</li>
<li>在从头计算中可用于原子和双原子分子的计算，很少用于比 CH4 更大的分子。</li>
<li>近年来在密度泛函理论（DFT）中使用逐渐增多。DFT 中很多矩阵元都无法用解析函数表达，只能用数值积分，所以就不需要更复杂的基函数，直接用 Slater 基函数或者数值基组。比如ADF程序。</li>
</ul>
</li>
</ul>
<h1 id="高斯型基函数（GTO）"><a href="#高斯型基函数（GTO）" class="headerlink" title="高斯型基函数（GTO）"></a>高斯型基函数（GTO）</h1><ul>
<li>Boys于1950年提出用归一化 Gaussian 函数作为径向函数：</li>
</ul>
<script type="math/tex; mode=display">
R_{n}(r, \alpha)=c_{n} r^{n-1} e^{-\alpha r^{2}}，
{c_{n}=2^{n+1}[(2 n-1) ! !]^{-1 / 2} 2 \pi^{-1 / 4}}</script><ul>
<li><script type="math/tex">R_n</script>与<script type="math/tex">Y_{lm}</script>组合称为Gaussian-type atomic orbitals，简称GTO。<ul>
<li>球极坐标：<script type="math/tex">\chi_{n l m}(\alpha ; r, \theta, \varphi)=c_{n} r^{n-1} e^{-\alpha r^{2}} Y_{l m}(\theta, \varphi)</script>，球谐型高斯函数与实型原子轨道角度部分行为一致，通过调整收缩系数调整径向行为，就可以一一对应地近似描述实型原子轨道。</li>
<li>直角坐标/笛卡尔型：<script type="math/tex">\chi_{L M N}(\alpha ; x, y, z)=N_{\alpha} x^{L} y^{M} z^{N} e^{-\alpha r^{2}}</script>，<ul>
<li><script type="math/tex">N_{\alpha}</script>：归一化系数</li>
<li>α：高斯函数指数（决定收敛快慢，越大收敛越快）</li>
<li>r：距离原子核的距离，x，y，z也是r的笛卡尔分量</li>
<li>L、M、N：决定了GTO的类型，<script type="math/tex">L+M+N=l</script>是AO的角量子数。</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="GTO的标记"><a href="#GTO的标记" class="headerlink" title="GTO的标记"></a>GTO的标记</h2><p><img src="image-20210618234317761.png" alt="" style="zoom:50%;" /></p>
<ul>
<li>O是原点，A、B为原子，原子A的坐标为：<script type="math/tex">\vec{R}_{A}=\vec{i} A_{x}+\vec{j} A_{y}+\vec{k} A_{z}</script></li>
<li>电子的坐标为<script type="math/tex">e(x,y,z)</script>，<script type="math/tex">\vec{r}=\vec{i} x+\vec{j} y+\vec{k} z</script></li>
<li>原子A上的GTO为：<script type="math/tex">\chi(A, \alpha, L, M, N)=N x_{A}^{L} y_{A}^{M} z_{A}^{N} e^{-r_{A}^{2}}</script><ul>
<li><script type="math/tex; mode=display">r_{A}=\mid \vec{r}-\vec{R}_{A} \mid</script></li>
<li><script type="math/tex; mode=display">x_{A}=x-A_{x}, y_{A}=y-A_{y}, \quad z_{A}=z-A_{z}</script></li>
<li><script type="math/tex; mode=display">r_{A}=\sqrt{x_{A}^{2}+y_{A}^{2}+z_{A}^{2}}, \quad L+M+N=l</script></li>
</ul>
</li>
</ul>
<h2 id="GTO的特点"><a href="#GTO的特点" class="headerlink" title="GTO的特点"></a>GTO的特点</h2><ul>
<li>中心位于各个原子核，径向无节点</li>
<li>函数值的指数衰减比STO快得多，两者的指数上面分别是<script type="math/tex">-\alpha r^2</script>和<script type="math/tex">-\zeta r</script></li>
<li>变量可分离：<script type="math/tex">x^{L} y^{M} z^{N} e^{-\alpha r^{2}}=x^{L} e^{-c x^{2}} \cdot y^{M} e^{-\alpha y^{2}} \cdot z^{N} e^{-\alpha z^{2}}</script></li>
<li><p>位于 A、B 两中心上的两个 GTO 乘积可向广义质心作单中心展开：</p>
<script type="math/tex; mode=display">
\chi\left(A, \alpha_{1}, L_{1}, M_{1}, N_{1}\right) \cdot \chi\left(B, \alpha_{2}, L_{2}, M_{2}, N_{2}\right)=\sum_{L=0}^{L_{1}+L_{2}} \sum_{M=0}^{M_{1}+M_{2}} \sum_{n=0}^{N_{1}+N_{2}} C_{L M N} \chi(P, \alpha, L, M, N)</script><blockquote>
<p><img src="./image-20210618235810647.png" alt="" style="zoom:50%;" /></p>
<p>其中<script type="math/tex">|\overrightarrow{A P}|=\frac{\alpha_{2}}{\alpha_{1}+\alpha_{2}}|\overrightarrow{A B}| ;|\overrightarrow{B P}|=\frac{\alpha_{1}}{\alpha_{1}+\alpha_{2}}|\overrightarrow{A B}|</script>，即杠杆定理。比如4)（杠杆定理），两个高斯函数的乘积可转化为另一个中心上的高斯函数的加和，因此四中心积分可转化为双中心积分，进而转化为单中心积分。使积分的计算加快。而各种积分都是两个函数的乘积的形式，从而大大简化各种积分运算。</p>
</blockquote>
</li>
<li><p>GTO径向函数相比于STO，除了e指数上的变化以外，<script type="math/tex">r^{n-1}</script>变成了<script type="math/tex">r^l</script>。<strong>则GTO不含主量子数n。</strong>n对各壳层的影响仅体现在α的大小上，即n越大，α越小。</p>
</li>
</ul>
<blockquote>
<p>由<script type="math/tex">L+M+N=l</script>，则：</p>
<script type="math/tex; mode=display">
\begin{aligned}\chi_{L M N} &=N x^{L} y^{M} z^{N} e^{-\alpha r^{2}}=N r^{l}\left(\frac{x}{r}\right)^{L}\left(\frac{y}{r}\right)^{M}\left(\frac{z}{r}\right)^{N} e^{-\alpha r^{2}} \\&=N r^{l} e^{-\alpha r^{2}} \cos ^{L} \theta \sin ^{L+M} \phi \sin ^{M} \theta \cos ^{N} \phi \\&=N r^l e^{-\alpha r^{2}} \cdot \tilde{Y}_{L M N}(\theta, \phi)\end{aligned}</script></blockquote>
<h2 id="从头算中使用的高斯型函数"><a href="#从头算中使用的高斯型函数" class="headerlink" title="从头算中使用的高斯型函数"></a>从头算中使用的高斯型函数</h2><p>因为没有主量子数n，而每个壳层中的基函数的收缩系数、GTF指数都是相同的，故实际基组在定义的时候都是按壳层来定义的。即角动量l相同的为一个壳层。直接分为：</p>
<ul>
<li>s型基函数：<script type="math/tex">e^{-\alpha r^{2}}</script></li>
<li>p型基函数：<script type="math/tex">xe^{-\alpha r^{2}}</script>，<script type="math/tex">ye^{-\alpha r^{2}}</script>，<script type="math/tex">ze^{-\alpha r^{2}}</script></li>
<li>d型基函数：<script type="math/tex">x^2e^{-\alpha r^{2}}</script>，<script type="math/tex">y^2 e^{-\alpha r^{2}}</script>，<script type="math/tex">z^2e^{-\alpha r^{2}}</script>，<script type="math/tex">xye^{-\alpha r^{2}}</script>，<script type="math/tex">xze^{-\alpha r^{2}}</script>，<script type="math/tex">yze^{-\alpha r^{2}}</script><ul>
<li>但是这6个并不是完全独立的，因为<script type="math/tex">x^2+y^2+z^2=r^2</script></li>
<li>这些笛卡尔型GTF可以线性组合，使角度部分行为与球谐型GTF一致（尽管组合后的函数形式与球谐型仍不同），以用于合理描述原子轨道。前三个可以写成为：<script type="math/tex">3z^2-r^2</script>，<script type="math/tex">x^2-y^2</script>，<script type="math/tex">x^2+y^2+z^2</script>。而其中最后一项<script type="math/tex">r^2</script>基函数,一般不用，它是一个特殊的球型GTF轨道，在某个径向距离（取决于指数）附近函数值较大，而接近GTF的中心和远离GTF时都很小。</li>
<li>因此<script type="math/tex">3z^2-r^2</script>，<script type="math/tex">x^2-y^2</script>，<script type="math/tex">x^2+y^2+z^2</script>，<script type="math/tex">xy</script>，<script type="math/tex">xz</script>，<script type="math/tex">yz</script>构成了5个d型球谐基函数。</li>
</ul>
</li>
<li>对于笛卡尔型GTO：</li>
</ul>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">l</th>
<th style="text-align:center">Type</th>
<th style="text-align:center">L</th>
<th style="text-align:center">M</th>
<th style="text-align:center">N</th>
<th style="text-align:center">l</th>
<th style="text-align:center">Type</th>
<th style="text-align:center">L</th>
<th style="text-align:center">M</th>
<th style="text-align:center">N</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">0(S)</td>
<td style="text-align:center">S</td>
<td style="text-align:center">0</td>
<td style="text-align:center">0</td>
<td style="text-align:center">0</td>
<td style="text-align:center">3(F)</td>
<td style="text-align:center">XXX</td>
<td style="text-align:center">3</td>
<td style="text-align:center">0</td>
<td style="text-align:center">0</td>
</tr>
<tr>
<td style="text-align:center">1(P)</td>
<td style="text-align:center">X</td>
<td style="text-align:center">1</td>
<td style="text-align:center">0</td>
<td style="text-align:center">0</td>
<td style="text-align:center">3(F)</td>
<td style="text-align:center">YYY</td>
<td style="text-align:center">0</td>
<td style="text-align:center">3</td>
<td style="text-align:center">0</td>
</tr>
<tr>
<td style="text-align:center">1(P)</td>
<td style="text-align:center">Y</td>
<td style="text-align:center">0</td>
<td style="text-align:center">1</td>
<td style="text-align:center">0</td>
<td style="text-align:center">3(F)</td>
<td style="text-align:center">ZZZ</td>
<td style="text-align:center">0</td>
<td style="text-align:center">0</td>
<td style="text-align:center">3</td>
</tr>
<tr>
<td style="text-align:center">1(P)</td>
<td style="text-align:center">Z</td>
<td style="text-align:center">0</td>
<td style="text-align:center">0</td>
<td style="text-align:center">1</td>
<td style="text-align:center">3(F)</td>
<td style="text-align:center">XXY</td>
<td style="text-align:center">2</td>
<td style="text-align:center">1</td>
<td style="text-align:center">0</td>
</tr>
<tr>
<td style="text-align:center">2(D)</td>
<td style="text-align:center">XX</td>
<td style="text-align:center">2</td>
<td style="text-align:center">0</td>
<td style="text-align:center">0</td>
<td style="text-align:center">3(F)</td>
<td style="text-align:center">XXZ</td>
<td style="text-align:center">2</td>
<td style="text-align:center">0</td>
<td style="text-align:center">1</td>
</tr>
<tr>
<td style="text-align:center">2(D)</td>
<td style="text-align:center">YY</td>
<td style="text-align:center">0</td>
<td style="text-align:center">2</td>
<td style="text-align:center">0</td>
<td style="text-align:center">3(F)</td>
<td style="text-align:center">YYZ</td>
<td style="text-align:center">0</td>
<td style="text-align:center">2</td>
<td style="text-align:center">1</td>
</tr>
<tr>
<td style="text-align:center">2(D)</td>
<td style="text-align:center">ZZ</td>
<td style="text-align:center">0</td>
<td style="text-align:center">0</td>
<td style="text-align:center">2</td>
<td style="text-align:center">3(F)</td>
<td style="text-align:center">XYY</td>
<td style="text-align:center">1</td>
<td style="text-align:center">2</td>
<td style="text-align:center">0</td>
</tr>
<tr>
<td style="text-align:center">2(D)</td>
<td style="text-align:center">XY</td>
<td style="text-align:center">1</td>
<td style="text-align:center">1</td>
<td style="text-align:center">0</td>
<td style="text-align:center">3(F)</td>
<td style="text-align:center">XZZ</td>
<td style="text-align:center">1</td>
<td style="text-align:center">0</td>
<td style="text-align:center">2</td>
</tr>
<tr>
<td style="text-align:center">2(D)</td>
<td style="text-align:center">XZ</td>
<td style="text-align:center">1</td>
<td style="text-align:center">0</td>
<td style="text-align:center">1</td>
<td style="text-align:center">3(F)</td>
<td style="text-align:center">YZZ</td>
<td style="text-align:center">0</td>
<td style="text-align:center">1</td>
<td style="text-align:center">2</td>
</tr>
<tr>
<td style="text-align:center">2(D)</td>
<td style="text-align:center">YZ</td>
<td style="text-align:center">0</td>
<td style="text-align:center">1</td>
<td style="text-align:center">1</td>
<td style="text-align:center">3(F)</td>
<td style="text-align:center">XYZ</td>
<td style="text-align:center">1</td>
<td style="text-align:center">1</td>
<td style="text-align:center">1</td>
</tr>
</tbody>
</table>
</div>
<ul>
<li>G壳层【15种】：ZZZZ YZZZ YYZZ YYYZ YYYY XZZZ XYZZ XYYZ XYYY XXZZ XXYZ XXYY XXXZ XXXY XXXX<br>…</li>
<li>实际计算时，对于角动量高于D的笛卡尔型基函数，一般把它们转化成球谐型高斯基函数再用，比如10个f也可以转换为7个f球谐型高斯基函数。这可以节约耗时和避免数值问题。并且与原子轨道特点相同。</li>
</ul>
<h2 id="GTO和STO的比较"><a href="#GTO和STO的比较" class="headerlink" title="GTO和STO的比较"></a>GTO和STO的比较</h2><p><img src="./image-20210620132337991.png" alt=""></p>
<ul>
<li>电子运动图像描述，STO更好。（GTO在原子核处抹去了尖峰，在离核远处衰减得太快）</li>
<li>分子积分计算处理，GTO更好。STO双电子积分计算困难，不好直接去用它作为量子化学计算用的基函数。</li>
<li>为了弥补GTO物理图像的缺陷，可以增大基函数的数目。<ul>
<li>例子：10s6p-GTO用于B~Ne的计算，与双ζ-STO精度相似。<ul>
<li>而GTO中的基函数总数为：10+6×3=28。STO中的基函数总数为：2+(1+3)×2=10</li>
<li>(ij|kl)积分∝n<sup>4</sup>，因此采用GTO使得积分总数增大了2.8<sup>4</sup>=62倍，但是计算一个GTO积分比STO快3-4个数量级。</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="高斯基组的分类"><a href="#高斯基组的分类" class="headerlink" title="高斯基组的分类"></a>高斯基组的分类</h2><h3 id="原始GTO（PGTO）"><a href="#原始GTO（PGTO）" class="headerlink" title="原始GTO（PGTO）"></a>原始GTO（PGTO）</h3><p>Primitive GTO直接采用单个归一化GTO作为基函数：<script type="math/tex">\chi_{L M N}(\alpha ; x, y, z)=N_{\alpha} x^{L} y^{M} z^{N} e^{-\alpha r^{2}}</script></p>
<ul>
<li>积分计算可行，GTF如果用得很少结果比较差，如果直接用大量的GTF作为基函数，（ij|kl）总数和<strong>F</strong>、<strong>H</strong>、<strong>S</strong>、<strong>D</strong>等矩阵维数，需要求解的系数太多，计算量太大，乃至内、外存占用剧烈增大。SCF计算时间随基函数数量n的增大而呈n<sup>3</sup>量级增加。</li>
<li>因此PGTO一般只用于原子及仅含3~5个原子的小分子计算。</li>
</ul>
<h3 id="收缩GTO（CGTO）"><a href="#收缩GTO（CGTO）" class="headerlink" title="收缩GTO（CGTO）"></a>收缩GTO（CGTO）</h3><script type="math/tex; mode=display">
\left|\chi_{\mu}(C G T O)\right\rangle=\sum_{i=1}^{k_{\mu}} d_{i \mu}\left|\chi_{i}(P G T O)\right\rangle</script><ul>
<li>每个CGTO是若干个原始GTO固定比例的线性组合，其合适比例由原子从头计算确定。<ul>
<li>GTO set：<script type="math/tex">\left\{\chi_{1}, \chi_{2}, \ldots, \chi_{n}\right\}</script>，CGTO set：<script type="math/tex">\left\{\eta_{1}, \eta_{2}, \ldots, \eta_{m}\right\}</script>，<script type="math/tex">\eta_{\mu}=\sum_{i=1}^{k_{\mu}} d_{i \mu} \chi_{i}</script></li>
</ul>
</li>
</ul>
<script type="math/tex; mode=display">
\underbrace{\chi_{1}, \chi_{2}, \ldots, \chi_{k}}_{\eta_{1}} ; \underbrace{\chi_{k+1}, \chi_{k+2}, \ldots, \chi_{l}}_{\eta_{2}} ; \ldots ; \underbrace{\chi_{t+1}, \chi_{t+2}, \ldots, \chi_{n}}_{\eta_{m}}</script><ul>
<li>收缩使MO变分线性空间维数减小，视收缩度不同而计算精度略有下降。若收缩方案合理则影响不大。</li>
</ul>
<p>例子：</p>
<ul>
<li>()表示原始GTF，[]表示收缩GTF。但是(9d5p)/[3s2p]上有表达不清楚的地方，所以也有612，41的写法。</li>
</ul>
<p><img src="image-20210619175521235.png" alt="" style="zoom:50%;" /></p>
<p><img src="image-20210619175540777.png" alt="" style="zoom:50%;" /></p>
<p><img src="image-20210619175553336.png" alt="" style="zoom:50%;" /></p>
<h4 id="收缩方式"><a href="#收缩方式" class="headerlink" title="收缩方式"></a>收缩方式</h4><p><img src="image-20210620141915170.png" alt="" style="zoom:50%;" /></p>
<h5 id="Segemented-Contracted"><a href="#Segemented-Contracted" class="headerlink" title="Segemented Contracted"></a>Segemented Contracted</h5><ul>
<li>给定的PGTO只出现在一个CGTO中，比如STO-ng、6-31G*、Dunning DZ等基组。每个原子轨道用单独一组函数来拟合，1s, 2s, 2p等轨道的各自的基函数都是完全分开的（有更好的物理图像） ，没有关联，每一个 shell 各自用不同 的 GTO 来表示。不共享任何指数。 程序简单，浪费计算量。</li>
</ul>
<script type="math/tex; mode=display">\left|\chi_{1}(\mathrm{CGTO})\right\rangle=\sum_{i=1}^{6} a_{i}\left|\chi_{i}(\mathrm{PGTO})\right\rangle，\left|\chi_{2}(\mathrm{CGTO})\right\rangle =\sum_{i=7}^{9} a_{i}\left|\chi_{i}(\mathrm{PGTO})\right\rangle，\left|\chi_{3}(\mathrm{CGTO})\right\rangle =\left|\chi_{10}(\mathrm{PGTO})\right\rangle</script><ul>
<li><p>例子：</p>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="comment"># O的SV基组：(7s,4p)/[3s,2p]或(511/31)</span></span><br><span class="line"><span class="attribute">O</span>	S</span><br><span class="line"><span class="attribute">2266</span>.<span class="number">1767785</span>             -<span class="number">0</span>.<span class="number">53431809926</span>D-<span class="number">02</span></span><br><span class="line"> <span class="attribute">340</span>.<span class="number">87010191</span>            -<span class="number">0</span>.<span class="number">39890039230</span>D-<span class="number">01</span></span><br><span class="line">  <span class="attribute">77</span>.<span class="number">363135167</span>           -<span class="number">0</span>.<span class="number">17853911985</span></span><br><span class="line">  <span class="attribute">21</span>.<span class="number">479644940</span>           -<span class="number">0</span>.<span class="number">46427684959</span></span><br><span class="line">   <span class="attribute">6</span>.<span class="number">6589433124</span>          -<span class="number">0</span>.<span class="number">44309745172</span></span><br><span class="line"><span class="attribute">O</span>	S</span><br><span class="line">   <span class="attribute">0</span>.<span class="number">80975975668</span>          <span class="number">1</span>.<span class="number">0000000</span></span><br><span class="line"><span class="attribute">O</span>	S</span><br><span class="line">   <span class="attribute">0</span>.<span class="number">25530772234</span>          <span class="number">1</span>.<span class="number">0000000</span></span><br><span class="line"><span class="attribute">O</span>	P</span><br><span class="line">  <span class="attribute">17</span>.<span class="number">721504317</span>            <span class="number">0</span>.<span class="number">43394573193</span>D-<span class="number">01</span></span><br><span class="line">   <span class="attribute">3</span>.<span class="number">8635505440</span>           <span class="number">0</span>.<span class="number">23094120765</span></span><br><span class="line">   <span class="attribute">1</span>.<span class="number">0480920883</span>           <span class="number">0</span>.<span class="number">51375311064</span></span><br><span class="line"><span class="attribute">O</span>	P</span><br><span class="line">   <span class="attribute">0</span>.<span class="number">27641544411</span>          <span class="number">1</span>.<span class="number">0000000</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h5 id="General-Contacted"><a href="#General-Contacted" class="headerlink" title="General Contacted"></a>General Contacted</h5><ul>
<li>给定的PGTO可以出现在多个CGTO中，比如ANO等。1s, 2s, 3s 等用同一组幂指数 α 只是组合系数在变。 效率高，但基组复杂，写程序困难。</li>
</ul>
<script type="math/tex; mode=display">\left|\chi_{1}(\mathrm{CGTO})\right\rangle=\sum_{i=1}^{10} a_{i}\left|\chi_{i}(\mathrm{PGTO})\right\rangle，\left|\chi_{2}(\mathrm{CGTO})\right\rangle =\sum_{i=1}^{10} a_{i}\left|\chi_{i}(\mathrm{PGTO})\right\rangle，\left|\chi_{3}(\mathrm{CGTO})\right\rangle =\sum_{i=1}^{10} c_{i}\left|\chi_{i}(\mathrm{PGTO})\right\rangle</script><ul>
<li><p>例子：</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">#H的ANO-RCC-VTZP： (<span class="number">8</span>s,<span class="number">4</span>p)/[<span class="number">3</span>s,<span class="number">2</span>p]</span><br><span class="line">H    S</span><br><span class="line"><span class="number">188.61445</span>   	<span class="number">.00096385</span>	 <span class="number">-.0013119</span> 		 <span class="number">.00242240</span></span><br><span class="line"> <span class="number">28.276596</span>  	<span class="number">.00749196</span>	 <span class="number">-.0103451</span> 		 <span class="number">.02033817</span></span><br><span class="line">  <span class="number">6.4248300</span> 	<span class="number">.03759541</span>	 <span class="number">-.0504953</span> 		 <span class="number">.08963935</span></span><br><span class="line">  <span class="number">1.8150410</span> 	<span class="number">.14339498</span>	 <span class="number">-.2073855</span> 		 <span class="number">.44229071</span></span><br><span class="line">   <span class="number">.59106300</span>	<span class="number">.34863630</span>	 <span class="number">-.4350885</span> 		 <span class="number">.57571439</span></span><br><span class="line">   <span class="number">.21214900</span>	<span class="number">.43829736</span>	 <span class="number">-.0247297</span> 		<span class="number">-.9802890</span></span><br><span class="line">   <span class="number">.07989100</span>	<span class="number">.16510661</span>	  <span class="number">.32252599</span>		<span class="number">-.6721538</span></span><br><span class="line">   <span class="number">.02796200</span>	<span class="number">.02102287</span>	  <span class="number">.70727538</span>		<span class="number">1.1417685</span></span><br><span class="line">H    P				</span><br><span class="line">  <span class="number">2.3050000</span> 	<span class="number">.11279019</span>	 <span class="number">-.2108688</span>		</span><br><span class="line">   <span class="number">.80675000</span>	<span class="number">.41850753</span>	 <span class="number">-.5943796</span>		</span><br><span class="line">   <span class="number">.28236200</span>	<span class="number">.47000773</span>	  <span class="number">.08968888</span>		</span><br><span class="line">   <span class="number">.09882700</span>	<span class="number">.18262603</span>	  <span class="number">.86116340</span>		</span><br><span class="line"></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h5 id="Hybrid-Contracted"><a href="#Hybrid-Contracted" class="headerlink" title="Hybrid Contracted"></a>Hybrid Contracted</h5><ul>
<li><p>以上两种都有，比如cc-pVDZ。结合上述二者优缺点，内层用广义收缩， 价电子 价轨道用segmented ，解释起来更便利。</p>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="comment"># O的cc-pVDZ基组：(9s,4p,1d)/[3s,2p,1d]</span></span><br><span class="line"><span class="attribute">O</span>	s</span><br><span class="line"><span class="attribute">1</span>.<span class="number">172000</span>D+<span class="number">04</span>	 <span class="number">7</span>.<span class="number">100000</span>D-<span class="number">04</span>	-<span class="number">1</span>.<span class="number">600000</span>D-<span class="number">04</span></span><br><span class="line"><span class="attribute">1</span>.<span class="number">759000</span>D+<span class="number">03</span>	 <span class="number">5</span>.<span class="number">470000</span>D-<span class="number">03</span>	-<span class="number">1</span>.<span class="number">263000</span>D-<span class="number">03</span></span><br><span class="line"><span class="attribute">4</span>.<span class="number">008000</span>D+<span class="number">02</span>	 <span class="number">2</span>.<span class="number">783700</span>D-<span class="number">02</span>	-<span class="number">6</span>.<span class="number">267000</span>D-<span class="number">03</span></span><br><span class="line"><span class="attribute">1</span>.<span class="number">137000</span>D+<span class="number">02</span>	 <span class="number">1</span>.<span class="number">048000</span>D-<span class="number">01</span>	-<span class="number">2</span>.<span class="number">571600</span>D-<span class="number">02</span></span><br><span class="line"><span class="attribute">3</span>.<span class="number">703000</span>D+<span class="number">01</span>	 <span class="number">2</span>.<span class="number">830620</span>D-<span class="number">01</span>	-<span class="number">7</span>.<span class="number">092400</span>D-<span class="number">02</span></span><br><span class="line"><span class="attribute">1</span>.<span class="number">327000</span>D+<span class="number">01</span>	 <span class="number">4</span>.<span class="number">487190</span>D-<span class="number">01</span>	-<span class="number">1</span>.<span class="number">654110</span>D-<span class="number">01</span></span><br><span class="line"><span class="attribute">5</span>.<span class="number">025000</span>D+<span class="number">00</span>	 <span class="number">2</span>.<span class="number">709520</span>D-<span class="number">01</span>	-<span class="number">1</span>.<span class="number">169550</span>D-<span class="number">01</span></span><br><span class="line"><span class="attribute">1</span>.<span class="number">013000</span>D+<span class="number">00</span>	 <span class="number">1</span>.<span class="number">545800</span>D-<span class="number">02</span>	 <span class="number">5</span>.<span class="number">573680</span>D-<span class="number">01</span></span><br><span class="line"><span class="attribute">3</span>.<span class="number">023000</span>D-<span class="number">01</span>	-<span class="number">2</span>.<span class="number">585000</span>D-<span class="number">03</span>	 <span class="number">5</span>.<span class="number">727590</span>D-<span class="number">01</span></span><br><span class="line"><span class="attribute">O</span>	s</span><br><span class="line"><span class="attribute">3</span>.<span class="number">023000</span>D-<span class="number">01</span>	 <span class="number">1</span>.<span class="number">000000</span>D+<span class="number">00</span></span><br><span class="line"><span class="attribute">O</span>	p</span><br><span class="line"><span class="attribute">1</span>.<span class="number">770000</span>D+<span class="number">01</span>	 <span class="number">4</span>.<span class="number">301800</span>D-<span class="number">02</span></span><br><span class="line"><span class="attribute">3</span>.<span class="number">854000</span>D+<span class="number">00</span>	 <span class="number">2</span>.<span class="number">289130</span>D-<span class="number">01</span></span><br><span class="line"><span class="attribute">1</span>.<span class="number">046000</span>D+<span class="number">00</span>	 <span class="number">5</span>.<span class="number">087280</span>D-<span class="number">01</span></span><br><span class="line"><span class="attribute">2</span>.<span class="number">753000</span>D-<span class="number">01</span>	 <span class="number">4</span>.<span class="number">605310</span>D-<span class="number">01</span></span><br><span class="line"><span class="attribute">O</span>	p	         </span><br><span class="line"><span class="attribute">2</span>.<span class="number">753000</span>D-<span class="number">01</span>	 <span class="number">1</span>.<span class="number">000000</span>D+<span class="number">00</span></span><br><span class="line"><span class="attribute">O</span>	d</span><br><span class="line"><span class="attribute">1</span>.<span class="number">185000</span>D+<span class="number">00</span>	<span class="number">1</span>.<span class="number">0000000</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>幂指数较大的对应较内层的轨道，幂指数较小的对应较外层的轨道。通常外层的轨道，α 越小的基函数的贡献 即前面的组合系数绝对值越大，如 2s，3s 轨道相较于 1s 轨道而言， α 值小的 GTO 前的系数会较大，这可以帮助我们区分1s，2s 等不同的轨道。</p>
</li>
<li>GTO 与轨道之间只是定性的对应，没有严格的区分。有时算出 1s 轨道上有 2.1 个电子。有些基函数可能既对 1s 轨道有贡献，又对 2s 轨道有贡献。</li>
</ul>
<h1 id="STO基组用GTO展开"><a href="#STO基组用GTO展开" class="headerlink" title="STO基组用GTO展开"></a>STO基组用GTO展开</h1><ul>
<li>用若干个GTO线性组合来近似1个STO 函数，这种收缩方案使得两类基组<a href="#GTO和STO的比较">取长补短</a>。<ul>
<li><script type="math/tex">\phi_{n l}^{(L M N)}(\varsigma ; \vec{r}) \approx \phi^{\prime}(\vec{r})=\sum_{i=1}^{K} d_{i} \chi_{l}^{(L M N)}\left(\alpha_{i} ; \vec{r}\right)</script>，其中<script type="math/tex">\phi_{n l}^{(L M N)}(\varsigma ; \vec{r})</script>=STO的径向部分+GTO的角度分布</li>
<li><script type="math/tex; mode=display">\varphi_{n l}^{(L M N)}(\varsigma ; \vec{r})=R_{n}(\varsigma ; r) \cdot \tilde{Y}_{l}^{L M N}(\theta, \phi)=N_{n l}^{\prime} r^{n-1} e^{-\alpha r} \sin ^{L+M} \phi \cos ^{L} \theta \sin ^{M} \theta \cos ^{N} \phi</script></li>
</ul>
</li>
</ul>
<p>角度部分可以从展开式中消去，仅需要展开径向函数：<script type="math/tex">R_{n}(\varsigma ; r) \approx R_{n}^{\prime}(r)=\sum_{i=1}^{K} d_{i} \widetilde{R}_{l}\left(\alpha_{i} ; r\right)</script></p>
<p>通过最小二乘法确定系数<script type="math/tex">\{d_i\}</script>，使积分误差<script type="math/tex">\Delta=\int_{\infty}\left|R_{n}(\varsigma ; r)-R_{n}^{\prime}(r)\right|^{2} d \tau</script>最小，并满足归一化条件<script type="math/tex">\int\left|R_{n}^{\prime}(\vec{r})\right|^{2} d \tau=1</script></p>
<p>例子：用3个GTO组合近似一个STO</p>
<p><img src="./image-20210620142911231.png" alt="" style="zoom:50%;" /></p>
<ul>
<li>组合GTO能较好地描述电子在AO重叠成键区域的行为</li>
<li>描述远核和极近核区的电子运动不理想</li>
</ul>
<h2 id="刻度定理Scaling-Theorem"><a href="#刻度定理Scaling-Theorem" class="headerlink" title="刻度定理Scaling Theorem"></a>刻度定理Scaling Theorem</h2><ul>
<li>当主量子数为n的STO在指数ζ=1时，GTO的展开式为：<script type="math/tex">\phi(1 ; \vec{r})=\sum_{i=1}^{k} d_{i} \chi_{i}\left(\alpha_{i} ; \vec{r}\right)</script></li>
<li>当指数为任意ζ时：<script type="math/tex">\phi(\zeta ; \vec{r})=\sum_{i=1}^{k} d_{i} \chi_{i}\left(\zeta^2\alpha_{i} ; \vec{r}\right)</script></li>
</ul>
<p>真正拟合时，把ζ先当做1，拟合再乘以ζ<sup>2</sup></p>
<h2 id="常见的STO-GTO基组"><a href="#常见的STO-GTO基组" class="headerlink" title="常见的STO-GTO基组"></a>常见的STO-GTO基组</h2><h3 id="STO-nG-n-2-6"><a href="#STO-nG-n-2-6" class="headerlink" title="STO-nG(n=2~6)"></a>STO-nG(n=2~6)</h3><p><img src="./image-20210620151348582.png" alt=""></p>
<p>STO中的极小基（MBS）中的每个STO用n个GTO的线性组合拟合。</p>
<ul>
<li>用于共价型分子几何优化计算结果不错，但能量和电子分布精度较差。实际上还是<a href="#单zeta">SZ基组</a>。</li>
<li>STO-6G与直接采用STO的精度相当，但和STO-3G、STO-4G相比并没有根本改善。</li>
<li>主要用于大分子的几何优化计算，STO-3G、STO-4G过去较为常用，随着计算机性能改善，它们已被3-21G等基组取代。</li>
</ul>
<h3 id="价层劈裂基组"><a href="#价层劈裂基组" class="headerlink" title="价层劈裂基组"></a>价层劈裂基组</h3><ul>
<li>虽然价层区域变化比较平滑，收缩系数α没必要很大，但是需要描述柔性，需要用多个基函数描述价层。又称价层劈裂基组。</li>
<li>一个价层原子轨道若n个基函数描述，则此基组叫n分裂价(n-zeta)基组。</li>
<li>常用4-31G、6-31G、4-311G、6-311G等是是由Pople等人从上世纪70年代初开始开发的基组，是所有基组中最知名的，即便如今也是很多人默认使用的基组。对前四周期原子有定义（Au、镧系、锕系没法算）。优点是可以根据计算精度要求比较自由的自定义等。</li>
</ul>
<h4 id="含义"><a href="#含义" class="headerlink" title="含义"></a>含义</h4><p><strong>双分裂价(double- zeta, DZ)基组：n-31G=SZ core+<a href="#双zeta">DZ valence</a></strong></p>
<ul>
<li>核AO对应于一个STO-nG，由n个Gaussian type function （GTF）收缩成的基函数去描述每个内层原子轨道</li>
<li>价层AO劈裂成为两个ζ值不同的基函数，用一个收缩度为3的和一个未收缩的基函数描述每个价层原子轨道<ul>
<li>inner basis：STO-3G（ζ）</li>
<li>outer basis：STO-1G（ζ’&lt;ζ）</li>
</ul>
</li>
</ul>
<p><strong>三分裂价(triple-zeta, TZ)基组：n-311G=SZ core+TZ valence</strong></p>
<ul>
<li>核AO对应于一个STO-nG</li>
<li>价层AO劈裂成为三个ζ值不同的基函数，用一个收缩度为3的和两个未收缩的基函数描述每个价层轨道。里中外分别是STO-3G、STO-1G、STO-1G（ζ&gt;ζ’&gt;ζ’’）</li>
</ul>
<h3 id="极化函数"><a href="#极化函数" class="headerlink" title="极化函数"></a><a href="#极化">极化函数</a></h3><ul>
<li>极化函数是指角动量比最高占据原子轨道还要高的基函数。比如对于氧，角动量≥d的都是极化函数：对于Fe，角动量≥f的都是极化函数。</li>
<li>极化函数一般是非收缩的。</li>
<li><strong>极化函数总是要加</strong>，有极化函数时才能充分表现原子轨道在分子环境中的变形，对得到可靠的结果有极为重要的意义。后HF方法也要靠较充分的极化函数才能准确计算电子相关能。</li>
</ul>
<h4 id="含义-1"><a href="#含义-1" class="headerlink" title="含义"></a>含义</h4><ul>
<li>n-31G*或者n-311G*即在n-31G与n-311G基础上向Li~Ar 原子（除了H、He，价电子为nsnp）加入6个d型的STO-1G 极化函数（<script type="math/tex">d_{x^2}</script>，<script type="math/tex">d_{y^2}</script>，<script type="math/tex">d_{z^2}</script>，<script type="math/tex">d_{xy}</script>，<script type="math/tex">d_{xz}</script>，<script type="math/tex">d_{yz}</script>）</li>
<li>如果给H、He也加入3个p型的STO-1G极化函数（<script type="math/tex">p_x，p_y，p_z</script>），则为n-31G**和n-311G**。对于共价化合物的基态分子，可以给出接近HF极限的计算精度。</li>
<li>还有n-31G(d,p)的写法，<em>和*</em>分别等价于(d)和(d,p)<ul>
<li>d：给重元素加的极化函数，可以用d、2d、2df、3df、3d2f等，表示加几个d，几个f。</li>
<li>p：给H、He加的极化函数，可以用p、2p、2pd、3pd等</li>
</ul>
</li>
</ul>
<p>例子：</p>
<p><img src="image-20210620145811319.png" alt="" style="zoom: 50%;" /></p>
<p><img src="image-20210620145819965.png" alt="" style="zoom: 50%;" /></p>
<p><img src="image-20210620145826955.png" alt="" style="zoom: 50%;" /></p>
<h3 id="弥散函数"><a href="#弥散函数" class="headerlink" title="弥散函数"></a><a href="#弥散">弥散函数</a></h3><ul>
<li><p>弥散函数是指数非常小的基函数，因此能够延展到非常广的空间区域。</p>
</li>
<li><p>弥散函数都是非收缩的。极化函数和弥散函数的特征完全不同，没有任何可以相互代替的关系。</p>
</li>
<li><p>6-31+G*和6-31++G**就是在6-31G*或6-31G**基础上加入若干特小ζ值的弥散函数构成，用于计算阴离子、较高激发态分子、分子极化率（极化时电子已经比较远了）和分子间弱作用力</p>
</li>
<li>弥散函数的加入对中性基态分子的能量精度影响很少。</li>
</ul>
<h4 id="含义-2"><a href="#含义-2" class="headerlink" title="含义"></a>含义</h4><ul>
<li>一个“+”表示对重原子（除了H、He）加一个s和一层p的弥散函数</li>
<li>两个“++”除了给重原子加，也给H、He加一个s弥散函数</li>
</ul>
<h2 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h2><ul>
<li>在大分子几何优化时为了减小计算量，可采用规模较小价层劈裂基组3-21G或加极化函数的3-21G*。</li>
<li>还可以定义3-21G**、3-21+G**和3-21++G**基组，适用于较大分子激发态、阴离子和分子间作用能计算（用于密度泛函效果很好）</li>
<li>在文献上见到例如6-311G**//3-21G*的符号就表示用低级基组进行几何优化，然后用高级基组计算能量和分子性质。</li>
</ul>
<h1 id="相关一致性基组"><a href="#相关一致性基组" class="headerlink" title="相关一致性基组"></a>相关一致性基组</h1><ul>
<li>是专门给后HF计算而构建的一类基组，有很多子系列，最早从1988年开始提出，现在仍在发展，而pople系列没有发展了。</li>
<li>包含大量高角动量函数。由于包含的GTF数目较多，用于HF/DFT时计算量较大而不划算。</li>
<li>只定义了前四周期且缺少K钾。</li>
</ul>
<h2 id="cc-pVnZ含义"><a href="#cc-pVnZ含义" class="headerlink" title="cc-pVnZ含义"></a>cc-pVnZ含义</h2><ul>
<li>cc表示correlation consistent，p表示polarized，V表示valence，nZ表示n-Zeta，n=D、T、Q、5……9</li>
</ul>
<div class="table-container">
<table>
<thead>
<tr>
<th>Atoms</th>
<th>cc-pVDZ</th>
<th>cc-pVTZ</th>
<th>cc-pVQZ</th>
<th><strong>cc-pV5Z</strong></th>
<th><strong>cc-pV6Z</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>H</td>
<td>2s,1p</td>
<td>3s,2p,1d</td>
<td>4s,3p,2d,1f</td>
<td>5s,4p,3d,2f,1g</td>
<td>6s,5p,4d,3f,2g,1h</td>
</tr>
<tr>
<td>He</td>
<td>2s,1p</td>
<td>3s,2p,1d</td>
<td>4s,3p,2d,1f</td>
<td>5s,4p,3d,2f,1g</td>
<td><em>not available</em></td>
</tr>
<tr>
<td>Li-Be</td>
<td>3s,2p,1d</td>
<td>4s,3p,2d,1f</td>
<td>5s,4p,3d,2f,1g</td>
<td>6s,5p,4d,3f,2g,1h</td>
<td><em>not available</em></td>
</tr>
<tr>
<td>B-Ne</td>
<td>3s,2p,1d</td>
<td>4s,3p,2d,1f</td>
<td>5s,4p,3d,2f,1g</td>
<td>6s,5p,4d,3f,2g,1h</td>
<td>7s,6p,5d,4f,3g,2h,1i</td>
</tr>
<tr>
<td>Na-Ar</td>
<td>4s,3p,1d</td>
<td>5s,4p,2d,1f</td>
<td>6s,5p,3d,2f,1g</td>
<td>7s,6p,4d,3f,2g,1h</td>
<td><em>not available</em></td>
</tr>
<tr>
<td>Ca</td>
<td>5s,4p,2d</td>
<td>6s,5p,3d,1f</td>
<td>7s,6p,4d,2f,1g</td>
<td>8s,7p,5d,3f,2g,1h</td>
<td><em>not available</em></td>
</tr>
<tr>
<td>Sc-Zn</td>
<td>6s,5p,3d, 1f</td>
<td>7s,6p,4d,2f,1g</td>
<td>8s,7p,5d,3f,2g,1h</td>
<td>9s,8p,6d,4f,3g,2h,1i</td>
<td><em>not available</em></td>
</tr>
<tr>
<td>Ga-Kr</td>
<td>5s,4p,2d</td>
<td>6s,5p,3d,1f</td>
<td>7s,6p,4d,2f,1g</td>
<td>8s,7p,5d,3f,2g,1h</td>
<td><em>not available</em></td>
</tr>
</tbody>
</table>
</div>
<p>aug-cc-pVnZ:</p>
<ul>
<li>aug=augmented，是cc-pVnZ带弥散函数的版本，每个角动量都有对应的弥散函数，比不带弥散的版本昂贵甚巨。（pople系列对重原子只是加s、p的弥散，而对C，原本4s3p2d1f，改成aug就是5s4p3d2f）</li>
</ul>
<p>d、t-aug-cc-pVnZ</p>
<ul>
<li>加弥散更多的情况，对cc-pVnZ每个角动量加两层、三层弥散函数，用于精确描述里德堡激发、精确计算超极化率等目的，而aug-则只是加一层弥散</li>
</ul>
<p>cc-pVnZ-PP：</p>
<ul>
<li>是对于K以及从Cu开始的很多元素可以用的赝势基组</li>
</ul>
<p>月份基组：</p>
<ul>
<li>如jun-cc-pVTZ。是aug-cc-pVnZ系列的简化版最高档对应aug（八月），月份依次往下先砍掉最不重要的氢的弥散函数（成为jul），再依次砍掉重原子的最高角动量的弥散函数（成为jun, may…）直到只剩s和p弥散函数。</li>
</ul>
<h2 id="基函数的数目"><a href="#基函数的数目" class="headerlink" title="基函数的数目"></a>基函数的数目</h2><div class="table-container">
<table>
<thead>
<tr>
<th></th>
<th>H-He</th>
<th>Li-Ne</th>
<th>Na-Ar</th>
</tr>
</thead>
<tbody>
<tr>
<td>cc-pVDZ</td>
<td>[2<em>s</em>1<em>p</em>] → 5 func.</td>
<td>[3<em>s</em>2<em>p</em>1<em>d</em>] → 14 func.</td>
<td>[4<em>s</em>3<em>p</em>1<em>d</em>] → 18 func.</td>
</tr>
<tr>
<td>cc-pVTZ</td>
<td>[3<em>s</em>2<em>p</em>1<em>d</em>] → 14 func.</td>
<td>[4<em>s</em>3<em>p</em>2<em>d</em>1<em>f</em>] → 30 func.</td>
<td>[5<em>s</em>4<em>p</em>2<em>d</em>1<em>f</em>] → 34 func.</td>
</tr>
<tr>
<td>cc-pVQZ</td>
<td>[4<em>s</em>3<em>p</em>2<em>d</em>1<em>f</em>] → 30 func.</td>
<td>[5<em>s</em>4<em>p</em>3<em>d</em>2<em>f</em>1<em>g</em>] → 55 func.</td>
<td>[6<em>s</em>5<em>p</em>3<em>d</em>2<em>f</em>1<em>g</em>] → 59 func.</td>
</tr>
<tr>
<td>aug-cc-pVDZ</td>
<td>[3<em>s</em>2<em>p</em>] → 9 func.</td>
<td>[4<em>s</em>3<em>p</em>2<em>d</em>] → 23 func.</td>
<td>[5<em>s</em>4<em>p</em>2<em>d</em>] → 27 func.</td>
</tr>
<tr>
<td>aug-cc-pVTZ</td>
<td>[4<em>s</em>3<em>p</em>2<em>d</em>] → 23 func.</td>
<td>[5<em>s</em>4<em>p</em>3<em>d</em>2<em>f</em>] → 46 func.</td>
<td>[6<em>s</em>5<em>p</em>3<em>d</em>2<em>f</em>] → 50 func.</td>
</tr>
</tbody>
</table>
</div>
<ul>
<li>H的cc-pVDZ：2s+1p*3=5</li>
<li>Ar本身有 [1s, 2s, 2p, 3s, 3p]轨道，在cc-pVDZ中，[4<em>s</em>3<em>p</em>1<em>d</em>] 表示轨道为[1s, 2s, 2p, <strong>3s, 3s, 3p, 3p</strong>, 3d’]（其中’代表加入极化轨道），基函数数目为4s+3p*3+1d*5=18个。</li>
</ul>
<h1 id="Ahlrichs-def2系列基组"><a href="#Ahlrichs-def2系列基组" class="headerlink" title="Ahlrichs def2系列基组"></a><strong>Ahlrichs def2系列基组</strong></h1><ul>
<li>非常适合DFT计算，也同样适合后HF计算。比同级别的cc-pVnZ便宜一些， 同样计算量下结果比Pople基组好。</li>
<li>def代表default，是Turbomole程序里默认的基组。def2-系列之前有def-系列基组，def-TZVP比def2-TZVP便宜很多，适合替代6-311G**。</li>
</ul>
<h2 id="含义-3"><a href="#含义-3" class="headerlink" title="含义"></a>含义</h2><ul>
<li><p>def2-SV(P)/SVP：Split Valence Polarized【(P)是对H没有加极化函数】。</p>
</li>
<li><p>def2-TZVP：Triple Zeta Valence Polarized【3分裂】</p>
</li>
<li><p>def2-TZVPP：相比def2-TZVP，对某些元素带更多极化函数，尤其是对H增加了d极化函数，对过渡金属增加了g极化函数【对于C、O、S等，一个P和两个P没有差别】</p>
</li>
<li>def2-QZVP/def2-QZVPP: Quadruple Zeta Valence Polarized【4分裂】【跟cc-pVQZ同档次】</li>
</ul>
<p>部分元素的不同级别的def2、def基组的尺寸对比（321代表3个s、2个p、1个d的基函数壳层）<img src="image-20210620162559498.png" alt=""></p>
<p>def系列与Pople系列基组的尺寸对应关系：</p>
<ul>
<li>def-SV(P)/SVP≈6-31G*/6-31G**：用于DFT粗略计算【定性正确】*</li>
<li>def-TZVP&gt;6-311G(d,p)：用于DFT较好精度计算</li>
<li>def-TZVPP≈6-311G(2df,2pd)：用于DFT精确计算，后HF较好精度计算</li>
<li><em>def2 SV(P)/SVP≈6-31G\</em>/6-31G**：用于DFT粗略计算。</li>
<li>def2-TZVP26-311G(2df,p)：用于DF T精确计算</li>
<li>def2-TZVPP26-31YG(2df,2pd)：用于后HF较好精度计算</li>
</ul>
<p>大多数常用的全电子基组【内核价层电子全都描述】只对于前几周期有定义，例如6-31G、6-311G 系列只定义了前四周期，cc-pVnZ (n=D,T, Q, 5)也只定义了前四周期且缺少K钾。若体系还有其它元素，则不得不和其它基组混用(通常是面向较重原子的赝势基组)。<br>def2系列基组的一大优点是对于除了锕系以及最后一个周期外所有元素都有定义(def比def2还多 支持锕系元素)【普适】。对于大多数体系，可以直接用def2基组，不需要多个基组混用。<br>对于前四周期，def/def2基组是全电 子基组，对于之后的元素，def/def2基组是赝势基组【对内核不直接描述】【缺点是官方版本没有加弥散函数】。<br>给ahlrichs的def2系列基组加弥散的方法：<a href="http://sobereva.com/340">http://sobereva.com/340</a></p>
<h1 id="基组的选择"><a href="#基组的选择" class="headerlink" title="基组的选择"></a>基组的选择</h1><p>量子化学培训自测题-基组部分</p>
<p><a href="http://bbs.keinsci.com/thread-5426-1-1.html">http://bbs.keinsci.com/thread-5426-1-1.html</a></p>
<p>谈谈量子化学中基组的选择</p>
<p><a href="http://sobereva.com/336">http://sobereva.com/336</a></p>
<p>谈谈赝势基组的选用</p>
<p><a href="http://sobereva.com/373">http://sobereva.com/373</a></p>
<p>详解Gaussian中混合基组、自定义基组和赝势基组的输入</p>
<p><a href="http://sobereva.com/60">http://sobereva.com/60</a></p>
<p>赝势的函数形式以及在量子化学程序中定义的方式</p>
<p><a href="http://sobereva.com/188">http://sobereva.com/188</a></p>
<p>写计算化学文章时引用理论方法、基组、程序时应注意的问题</p>
<p><a href="http://sobereva.com/370">http://sobereva.com/370</a></p>
<ul>
<li>氢的极化函数比起弥散函数的意义大得多得多，但必须给氢加极化的场合仅限于研究的问题和氢有直接关系，如氢转移反应、氢键、二氢键、和氢有关的键的性质（键长、键能、振动频率）等，其余情况给氢加极化并没什么用。</li>
</ul>
<ul>
<li>弥散函数不是必须要加：<ul>
<li>缺点：显著增加计算量；使得SCF收敛困难许多；使得一些波函数分析方法无法使用（如Mayer键级、Mulliken分析等，如果在计算时用了弥散函数，分析时把弥散去掉再产生一次波函数再分析）；破坏非占据分子轨道的化学意义；有时带来数值不稳定；可能因数值问题导致体系结构和波函数对称性下降</li>
<li>不加弥散结果一定没法用：计算偶极矩、多极矩（因分子边缘地区比较敏感）；计算极化率、超极化率（不加会定性错误）；计算里德堡激发态（因价层电子可以激发到很弥散的轨道）；计算阴离子体系能量、电子亲和能（因为阴离子带负电荷，对额外电子束缚比较弱），计算色散主导的分子间相互作用</li>
<li>加弥散很重要：计算弱相互作用能；计算Raman、ROA强度</li>
<li>加弥散对改进结果有益：计算反应势垒；优化阴离子体系或弱相互作用体系的结构、对其进行振动分析</li>
</ul>
</li>
<li>给氢加你散函数并无什么意义（加弥散一般是因为原子周围电子太多）。因为氢本身只有一个电子，电负性又小，在分子环境中一般都会被吸走不少电子，因此给它加弥散函数起不到什么效果，却会令计算量增加不少。因此需要弥散函数时，不建议用诸如6-311++G<strong>，而建议用6-311+G</strong>。即便研究氢键也不需要给氢加弥散函数（对结果没有明显影响）（但对于计算超极化率、氢带明显负电的情况则需要给氢加弥散）。</li>
</ul>
<p>一般问题的基组选择建议<br>(HF、普通泛函计算)<br>HF和普通泛函【双杂化以外的泛函】对高角动量极化函数要求低，计算量和GTF数目直接相关，因此不适合GTF多且极化函数多的cc-pVnZ系列。将计算量用在增大zeta数上明显更合适。<br>最低可接受级别：def2-SV(P)≈6-31G<em> &lt; def2-SVP≈6-31G<strong> 2-zeta基组<br>不错级别：6-311G</strong> &lt; def-TZVP 一般3-zeta基组<br>理想级别：def2-TZVP &lt; def2-TZVPP 高档3-zeta基组【普通泛函计算，基组不完备性误差已经很小了，再提升没有必要，普通泛函精度有限】<br>极限：def2-QZVP 4-zeta基组<br>同等基组尺寸下使用def/def2系列基组代替Pople基组可以获得明显更高精度!<br>对于需要弥散函数的情况勿忘加弥散函数!<br>(后HF、双杂化泛函计算)<br>后HF以及双杂化泛函【引入了一部分类似于MP2，因此对基组要求基本和后HF一样】需要角动量极化的数来表现电子相关效应，而且计算量主要取决于函数而非GTF数，故不怕收缩度高。cc-pVnZ系列是理想的选择，def2系列亦可，强烈不建议用Pople系列。<br>粗糙级别：6-311G*</em> &lt; def-TZVP    一般3-zeta基组<br>较好级别：cc-pVTZ，def2-TZVPP    优质3-zeta基组<br>理想级别：cc-pVQZ，def2-QZVPP    4-zeta基组【完全发挥后HF】<br>极限：cc-pV5Z        5-zeta基组【后HF想达到完备基组】<br>高档次后HF方法应该结合高质量的基组，方可充分发挥能力。诸如 CCSD(T)/CC-pVDZ这样的组合十分荒诞，没有CC-pVTZ就绝对甭用CCSD(T)!<br>对于需要弥散函数的情况勿忘加弥散函数!</p>
<p><img src="clipboard-1624181630439.png" alt=""></p>
<p>基组越大越好么?<br>原则上来说基组越大结果精度越好，但是盲目用大基组只会白费时间，应注意以下问题：【理论方法的误差和基组的误差有相互抵消关系，如果很烂的方法用很大的基组没有必要】<br>要搞清楚到底自己对精度的要求有多高。理论化学研究应着眼于解决要解决的问题，基组及理论方法的选用够用即可，盲目计算高精度的数据没意义，如今算一个月的数据可能几十年后的人算几分钟就能得到，现在好不容易算出来的高精度的数据在以后可能都不值得一提<br>要弄清楚计算精度的瓶颈在哪里，是理论方法还是基组。从极小基提升至2-zeta结果准确度提升甚巨，提升至3-zeta也肯定有改进，但提升至4-zeta已经改进很小了，此时的瓶颈一般在于理论方法上而不在于基组了<br>普通DFT泛函结合4-zeta基组( 如cc-pVQZ)是没意义的，这样的基组是给高精度计算用的，因此理论方法也应该是高精度级别，否则鲜花插在了牛粪上。结合4-zeta基组时应该用高档次方法如CCSD(T),否则高质量基组体现不出价值。<br>有些问题对基组本身就不敏感，比如几何优化【对基组要求不高，中小基组，而能量、超极化率等要求比较高】，2-zeta-般够用，3-zeta已足矣， 继续提升无益：再比如振动频率计算用631G*并考虑校正因子足以得到可靠结果，用3-zeta会导致计算量提升甚巨，对结果也无明显改进</p>
<p>混合基组<br>混合基组是指计算时有的原子用某种基组，而有的原子用另一种基组。<br>适当使用混合基组可以令计算耗时大为降低，而精度损失不多。例如，计算一个大体系的化学反应过程，反应部分只涉及其中一个区域，那么可以只给这个区域的原子用大基组( 如def2-TZVP)而其余部分用中、小基组(如6-31G*)。再比如，若体系有的地方局部带大量的负电荷，那么没必要对整个体系都加弥散函数，只给那部分的原子加上弥散函数就足够了。</p>
<p><img src="clipboard-1624181668873.png" alt=""></p>
<p>相对论效应</p>
<p><img src="clipboard-1624181675490.png" alt=""></p>
<h1 id="赝势和赝势基组"><a href="#赝势和赝势基组" class="headerlink" title="赝势和赝势基组"></a>赝势和赝势基组</h1><p>内核电子不是化学上感兴趣的。化学问题一般只关心价层电子。赝势(Pseudopotential，PP)将内核电子对价层电子的影响通过事先拟合好的势场来表达【全电子内核电子也会用基组描述，不能直接省，内核电子与价层电子有相互作用】。<br>基于赝势计算时需要使用专为其优化的赝势基组描述价电子。同一种赝势可以有多种与之匹配的赝势基组，精度有所不同。<br>有效核势(Effective core potential, ECP)【与PP并不等同】多数情况就是指赝势。<br>用赝势的好处<br>计算时不需要直接考虑内层电子，计算量相对于用全电子基组时大幅降低，原子所属周期越靠后节约时间越显著<br>相对论效应主要来自于内层电子。拟合赝势的时候如果考虑了相对论效应，则基于赝势计算的时候就可以把内层电子对价层电子的相对论的影响近似体现出来【对重元素一般用赝势】<br>对第四周期，特别是第五周期开始的原子强烈建议使用赝势，又省时间又能等效地体现出相对论效应<br>赝势的坏处<br>由于内层电子没有精确表达。导致对价层电子的影响描述得不够严格准确、内核电子的可极化效果和电子相关效应没有得到体现，一定程度会影响计算精度<br>必须依赖内核电子的性质无法计算，如NMR、X光光谱【NMR就是算核化学位移，X光光谱是激发内核电子】<br>大核与小核赝势<br>如果被赝势代替的内核电子(赝化的电子)较少就叫小核赝势。用这样的赝势计算时，价层、亚价层的电子都<br>需要明确计算。<br>如果赝化的电子数较多，就叫大核赝势，用这类赝势时只有价层电子是要明确地计算的。<br>小核赝势计算耗时比大核赝势更多，但由于考虑了亚价层电子，结果通常来说也更好，而且可移植性好，可以<br>适应不同化学环境的情况(如不同氧化态)。【普适性更好，实在算不动的时候再用大核】</p>
<h2 id="常见的赝势和赝势基组"><a href="#常见的赝势和赝势基组" class="headerlink" title="常见的赝势和赝势基组"></a>常见的赝势和赝势基组</h2><h3 id="Lanl赝势-Los-Alamos-National-Laboratory"><a href="#Lanl赝势-Los-Alamos-National-Laboratory" class="headerlink" title="Lanl赝势(Los Alamos National Laboratory)"></a>Lanl赝势(Los Alamos National Laboratory)</h3><p>Hay和Wadt在上世纪80年代提出的很常用的一种赝势，对第四周期元素未考虑相对论效应，对更重的元素都考虑了相对论效应。<br>对过渡金属，Lanl1 是大核赝势【现在精度很糙，一般不用】，Lanl2是小核赝势。对主族二者一样，都是大核赝势。【有标配基组，作者顺带提的】二者都有MB（极小基）和DZ （双分裂价基）两个档次的标配赝势基组，最常用的是Lanl2DZ。<br>2008年又提出了Lanl2TZ，【不是严格的3-zeta基组】是对Lanl2DZ重新进行收缩得到，计算量有所增加但精度也有所提高。Lanl2TZ+是对第一周期过渡金属增加一层d弥散。Lanl2TZ(f)是对过渡金属增加一层f极化。<br>Lanl08【主要给主族用】是对于过渡金属和主族元素在Lanl2DZ基础上都彻底去收缩化。Lanl08+ 是在Lanl08基础上对于第一周期过渡金属加上弥散。Lanl08(d)和Lanl08(f)分别是在Lanl08基础上对主族和过渡金属加上d和f极化。<br>Lanl系列目前包含前六个周期绝大部分元素，不支持镧系锕系（仅Lanl2DZ支持极个别锕系)</p>
<h3 id="Stuttgart赝势"><a href="#Stuttgart赝势" class="headerlink" title="Stuttgart赝势"></a>Stuttgart赝势</h3><p>也称SDD (Stuttgart/Dresden)赝势，对于过渡金属和主族都是大核和小核版本都有，且有考虑和不考虑相对论效应的版本，几乎涵盖整个周期表【甚至110多的元素】，精度较好，可靠度高，特别是计算镧系、锕系的首选。其标配的赝势基组适合用于DFT计算，后HF计算也基本能用</p>
<h3 id="def-def2系列赝势基组"><a href="#def-def2系列赝势基组" class="headerlink" title="def/def2系列赝势基组"></a>def/def2系列赝势基组</h3><p>def/def2系列基组对前四周期是全电子基组，从第五周期开始是赝势基组【比如XeF4，Gaussian自动就知道F是全电子，Xe是赝势】，搭配Stuttgart小核赝势</p>
<h3 id="aug-cc-pVnZ-PP-n-D-T-Q-5-系列赝势基组"><a href="#aug-cc-pVnZ-PP-n-D-T-Q-5-系列赝势基组" class="headerlink" title="(aug-)cc-pVnZ-PP (n=D,T,Q,5)系列赝势基组"></a>(aug-)cc-pVnZ-PP (n=D,T,Q,5)系列赝势基组</h3><p>是2003年开始陆续提出的最适合后HF计算的赝势基组，搭配Stuttgart小核赝势。很适合对轻原子结合(aug-)cc-pVnZ使用。特征和构建思想类似(aug-)cc-pVnZ系列，由于高角动量函数多，收缩度高，用在DFT计算上比较亏</p>
<h2 id="赝势基组的选用"><a href="#赝势基组的选用" class="headerlink" title="赝势基组的选用"></a>赝势基组的选用</h2><p>使用的前提是对要算的元素有定义。镧系可以用Stuttgart赝势+标配基组或档次合适的def2系列赝势基组【对锕系没有定义】。锕系可以用Stuttgart赝势+标配基组或def-TZVP赝势基组。<br>DFT计算<br>计算条件差：Lanl2DZ【6-31G*】<br>计算条件一般：过渡金属用Lanl2TZ，主族用Lanl08或SDD<br>计算条件不错：过渡金属用Lanl2TZ(f)或SDD，主族用Lanl08(d)<br>计算条件很好：def2-TZVB<br>计算条件无限好：def2-QZVP（DFT计算用QZ级别其实很浪费）<br>后HF<br>计算条件奇差无比：cc-pVDZ-PP或def2-SVP<br>计算条件一般：过渡金属用SDD，主族用Lanl08(d)<br>计算条件不错：cc-pVTZ-PP或def2-TZVPP<br>计算条件很好：cc-pVQZ-PP或def2-QZVPP<br>def2对第四周期还是全电子基组，cc-pVnZ-PP对K以及从Cu开始的元素才有定义【Fe、Co、Ni等就用不了】。因此后HF计算时非要对除K以外的Cu之前的元素用赝势基组的话就只能靠Lanl或SDD了。</p>
<p>赝势基组使用的注意事项<br>对于前三周期都不要用赝势基组，一方面没必要(内层电子不多，相对论效应不明显)，另一方面比起用恰当的全电子基组会损失精度<br>赝势下计算时程序输出的能量只是价电子能量<br>涉及到内核电子的研究时，如NMR，对被研究的原子切不可用赝势。但可以给其它原子用赝势【比如计算过渡金属配合物，算配体的核化学位移，过渡金属可以用赝势】</p>
<ul>
<li></li>
</ul>
]]></content>
      <categories>
        <category>计算化学</category>
        <category>原理</category>
      </categories>
      <tags>
        <tag>基组</tag>
      </tags>
  </entry>
  <entry>
    <title>搭建个人网站</title>
    <url>/2020/11/06/%E6%90%AD%E5%BB%BA%E7%BD%91%E7%AB%99%E6%95%99%E7%A8%8B/</url>
    <content><![CDATA[<h1 id="搭建"><a href="#搭建" class="headerlink" title="搭建"></a>搭建</h1><h2 id="下载Git和Node-js"><a href="#下载Git和Node-js" class="headerlink" title="下载Git和Node.js"></a>下载Git和Node.js</h2><ol>
<li><a href="https://git-scm.com/">Git</a>：安装完成后在Windows PowerShell中输入<code>git --version</code>验证是否安装成功。</li>
<li><a href="https://nodejs.org/en/">Node.js</a>：安装好后在Windows PowerShell输入<code>node -v</code>和<code>npm -v</code>验证是否安装成功。</li>
</ol>
<h2 id="配置Git"><a href="#配置Git" class="headerlink" title="配置Git"></a>配置Git</h2><ol>
<li>在windows菜单中，打开<code>Git Bash</code></li>
<li>输入用户名和邮箱<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> git config --global user.name <span class="string">&quot;username&quot;</span></span></span><br><span class="line"><span class="meta">$</span><span class="bash"> git config --global user.email <span class="string">&quot;邮件地址@youremail.com&quot;</span></span></span><br></pre></td></tr></table></figure></li>
<li>生成新的SSH Key<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> ssh-keygen -t rsa -C <span class="string">&quot;邮件地址@youremail.com&quot;</span></span></span><br></pre></td></tr></table></figure>
一直回车直到出现：<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">The key&#x27;s randomart image is:</span><br><span class="line">  +---[RSA 3072]----+</span><br><span class="line">  |          oo     |</span><br><span class="line">  |         . .E    |</span><br><span class="line">  |          + o    |</span><br><span class="line">  |         * + +   |</span><br><span class="line">  |        S B + o  |</span><br><span class="line">  |         = + o.O.|</span><br><span class="line">  |        + = . OoX|</span><br><span class="line">  |       . . +.BoO=|</span><br><span class="line">  |        ....+=*=*|</span><br><span class="line">  +----[SHA256]-----+</span><br></pre></td></tr></table></figure></li>
<li>打开github，点击头像→<code>setting</code>→<code>SSH and GPG keys</code>→<code>New SSH key</code><ul>
<li>输入<code>Title</code></li>
<li>在Git Bash中输入<code>cat ~/.ssh/id_rsa.pub</code>后，复制出现的内容到<code>Key</code>里</li>
<li>点击<code>Add SSH key</code></li>
</ul>
</li>
<li>在Git Bash中输入<code>ssh -T git@github.com</code>,再输入<code>yes</code>，出现自己的用户名，表示配置成功</li>
</ol>
<h2 id="安装Hexo"><a href="#安装Hexo" class="headerlink" title="安装Hexo"></a>安装Hexo</h2><ol>
<li>在命令行里利用npm命令安装hexo，最后通过 <code>hexo -v</code>验证是否安装成功。<figure class="highlight cmake"><table><tr><td class="code"><pre><span class="line">$ npm <span class="keyword">install</span> -g hexo</span><br></pre></td></tr></table></figure></li>
<li>在Github上创建Repository，Repository  name 中填入<code>username.github.io</code>，点击Create repository<blockquote>
<p>有很多教程中，在此处可以接着：<br>在Repository的<code>Setting</code>中的<code>GitHub Pages</code>部分，<code>Choose a theme</code>先选择一个主题，直接可以生成Github主题的网站，再进行后续操作。<br>但在<a href="https://www.jiqizhixin.com/articles/2020-09-21-10">2020-10-01后，github新建的默认的库是main而不是master</a>，会导致在<code>hexo g -d</code>后，网页一直不更新，此时就需要在<code>GitHub Pages</code>部分的<code>Source</code>中把分支切换为<code>master</code>。<br>为了避免这个问题，可以跳过这一步；也可以在<code>deploy:</code>中把<code>branch: master</code>改成<code>branch: main</code>。<br><img src="1.png" style="zoom: 50%;" /></p>
</blockquote>
</li>
<li>在本地创建一个与 Repository 中博客项目同名的文件夹<code>username.github.io</code>后，进入文件夹，右键 <code>Git bash here</code>，输入<code>hexo init</code>初始化文件夹，接着输入<code>npm install</code>安装必备的组件</li>
<li>确保git部署：<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">npm <span class="keyword">install</span> hexo-deployer-git <span class="comment">--save</span></span><br></pre></td></tr></table></figure></li>
<li>输入<code>hexo g</code>生成静态网页，再输入<code>hexo s</code>打开本地服务器，然后打开浏览器预览：<a href="http://localhost:4000">http://localhost:4000</a> ，按<code>ctrl+c</code>关闭本地服务器。</li>
</ol>
<h2 id="将博客部署到username-github-io"><a href="#将博客部署到username-github-io" class="headerlink" title="将博客部署到username.github.io"></a>将博客部署到username.github.io</h2><ol>
<li>进入 Github 的网站 Repository，点击<code>code</code>→<code>SSH</code>，复制</li>
<li>打开网站文件夹根目录中的~/_config.yml<code>站点配置文件</code>，将<code>deploy</code>部分修改为：<figure class="highlight less"><table><tr><td class="code"><pre><span class="line"><span class="attribute">deploy</span>:</span><br><span class="line">  <span class="attribute">type</span>: git</span><br><span class="line">  <span class="attribute">repository</span>: git<span class="variable">@github</span>.<span class="attribute">com</span>:username/username.github.io.git</span><br><span class="line">  <span class="attribute">branch</span>: master</span><br></pre></td></tr></table></figure>
同时可以顺便修改<code>site</code>部分:<figure class="highlight groovy"><table><tr><td class="code"><pre><span class="line"><span class="attr">title:</span> Hexo</span><br><span class="line"><span class="attr">subtitle:</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="attr">description:</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="attr">keywords:</span></span><br><span class="line"><span class="attr">author:</span> John Doe</span><br><span class="line"><span class="attr">email:</span></span><br><span class="line"><span class="attr">language:</span> en</span><br><span class="line"><span class="attr">timezone:</span> <span class="string">&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<ul>
<li><code>title</code>博客名</li>
<li><code>subtitle</code>副标题</li>
<li><code>description</code>对网站的描述，可以自定义，给搜索引擎看</li>
<li><code>author</code>作者，在博客底部可以看到</li>
<li><code>email</code>联系邮箱</li>
<li><code>language</code>默认英文，中文为<code>zh-CN</code></li>
</ul>
</li>
<li><u><strong>以后每次修改本地文件后，都需要输入：</strong></u><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">hexo g</span><br><span class="line">hexo s	#预览</span><br><span class="line">hexo d</span><br></pre></td></tr></table></figure>
也可以不预览，直接<code>hexo g -d</code>来更新网站。再打开网站就可以了。如果修改了内容，<code>hexo g -d</code>后原网页没有反应，可以用<code>ctrl+F5</code>强制刷新</li>
</ol>
<h2 id="在多台电脑上操作"><a href="#在多台电脑上操作" class="headerlink" title="在多台电脑上操作"></a>在多台电脑上操作</h2><p>原理：<br><code>hexo g -d</code>完成的是将在~/public文件夹下生成静态的网页文件，然后将其复制到~/.deploy_git文件夹里，再通过Github push到创建的网页分支<code>master</code>上。<br>其他文件夹hexo的模块<code>node_modules</code>，文章文件<code>source</code>，主题文件<code>themes</code>等等都没有上传到<code>master</code>上，因此可以通过再创建一个分支来进行同步。</p>
<h3 id="方法1"><a href="#方法1" class="headerlink" title="方法1"></a>方法1</h3><ol>
<li><p>首先在Github的 <code>username.github.io</code> Repository中点击<code>master</code>按钮，输入<code>source</code>并回车，新建一个同步所有文件的分支<code>source</code></p>
</li>
<li><p>再通过<code>branches</code>→<code>All branches</code>→<code>change default branch</code>，切换为source后<code>updata</code>，回到 <code>username.github.io</code> Repository中，在<code>code</code>中复制<code>SSH</code></p>
</li>
<li><p>新建一个空文件夹XXXX，在此文件夹下右键 <code>Git bash here</code>，输入：</p>
<figure class="highlight crmsh"><table><tr><td class="code"><pre><span class="line">$ git <span class="keyword">clone</span> <span class="title">复制的ssh</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>进入XXXX/username.github.io文件夹，将该文件夹下除了.git（默认是隐藏文件）的文件夹全部删除</p>
</li>
<li><p>将本来网站的目录下username.github.io除了.deploy_git的文件全部复制到XXXX/username.github.io文件夹，其中有一个<code>.gitignore</code>文件，表示其中的文件不需要上传。另外，因为一个git仓库中不能包含另一个git仓库，如果在theme下git clone了主题文件，需要把相应目录下的.git文件夹删除。</p>
</li>
<li><p>在命令行下，<code>cd username.github.io</code>进入该文件夹下，可以看到最后有个<code>(source)</code>表明当前在source分支下：</p>
<figure class="highlight armasm"><table><tr><td class="code"><pre><span class="line"><span class="symbol">git</span> <span class="keyword">add</span> .</span><br><span class="line"><span class="symbol">git</span> commit –m <span class="string">&quot;add branch&quot;</span></span><br><span class="line"><span class="symbol">git</span> <span class="keyword">push</span> </span><br></pre></td></tr></table></figure>
<ul>
<li><code>git add .</code>告诉Git，把文件添加到仓库</li>
<li><code>git commit</code>告诉Git，把文件提交到仓库，-m后面是修改的说明</li>
<li><code>git push</code> 将本地分支的更新，推送到远程</li>
</ul>
</li>
<li><p>在其他电脑上的操作如下：</p>
<ol>
<li><p>准备工作：在该电脑上需要准备好Git和Node等，配置好<code>SSH key</code>，安装hexo等等</p>
</li>
<li><p>新建文件夹YYYYYYY，然后再该文件夹下 <code>git clone 复制的ssh</code>，cd 进入<code>username.github.io</code> 文件夹下，执行<code>npm install</code>下载必要的组件，也会有一个<code>.gitignore</code>文件</p>
</li>
<li><p>在该文件夹下修改后，<code>hexo g -d</code>更新网站。</p>
</li>
<li><p>然后将更新推送到<code>source</code>分支</p>
<figure class="highlight armasm"><table><tr><td class="code"><pre><span class="line"><span class="symbol">git</span> <span class="keyword">add</span> .</span><br><span class="line"><span class="symbol">git</span> commit –m <span class="string">&quot;add branch&quot;</span></span><br><span class="line"><span class="symbol">git</span> <span class="keyword">push</span> </span><br></pre></td></tr></table></figure>
</li>
<li><p>以后不管在原本电脑还是其他电脑上，首先<code>git pull</code> 获取更新，然后再进行修改，再推送到<code>source</code>分支。</p>
</li>
</ol>
</li>
</ol>
<h3 id="方法2"><a href="#方法2" class="headerlink" title="方法2"></a>方法2</h3><ol>
<li><p>方法1中第四步中，直接将<code>git clone</code>后其中的.git文件移动到username.github.io下</p>
</li>
<li><p>修改<code>.gitignore</code>文件，比如取消node_modules文件夹，这样在其他电脑上就不需要重新下载组件了。</p>
</li>
<li><p>将该目录下的所有.git文件修改成.git1，上传</p>
<figure class="highlight armasm"><table><tr><td class="code"><pre><span class="line"><span class="symbol">git</span> <span class="keyword">add</span> .</span><br><span class="line"><span class="symbol">git</span> commit –m <span class="string">&quot;add branch&quot;</span></span><br><span class="line"><span class="symbol">git</span> <span class="keyword">push</span> origin source</span><br></pre></td></tr></table></figure>
</li>
<li><p>完成上传后，再将.deploy中的.git1修改回来成.git，就可以对网站进行<code>hexo g -d</code>等操作，操作完成后，重复3~4，即：</p>
<figure class="highlight gradle"><table><tr><td class="code"><pre><span class="line">mv .deploy_git<span class="regexp">/.git1/</span> .deploy_git/.git</span><br><span class="line"></span><br><span class="line">hexo g -d</span><br><span class="line"></span><br><span class="line">mv .deploy_git<span class="regexp">/.git/</span> .deploy_git/.git1</span><br><span class="line"></span><br><span class="line">git add .</span><br><span class="line">git commit –m <span class="string">&quot;add branch&quot;</span></span><br><span class="line">git <span class="keyword">push</span> origin <span class="keyword">source</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<h1 id="文章相关"><a href="#文章相关" class="headerlink" title="文章相关"></a>文章相关</h1><h2 id="新建文章"><a href="#新建文章" class="headerlink" title="新建文章"></a>新建文章</h2><ol>
<li>在根目录下右键并GIt Bash here，然后输入<code>hexo new post &quot;article title&quot;</code>，新建一篇文章，此时在~/source_posts下就出现了<code>article title.md</code>文件，进行编辑即可。</li>
<li>为了新建文章方便，可以将~/scaffolds/post.md的Front-matter部分修改为自己默认需要的：<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">title:</span> &#123;&#123; <span class="string">title</span> &#125;&#125; </span><br><span class="line"><span class="attr">date:</span> &#123;&#123; <span class="string">date</span> &#125;&#125; </span><br><span class="line"><span class="attr">updated:</span> </span><br><span class="line"><span class="attr">tags:</span> </span><br><span class="line"><span class="attr">categories:</span> </span><br><span class="line"><span class="attr">typora-root-url:</span> &#123;&#123; <span class="string">title</span> &#125;&#125; </span><br><span class="line"><span class="meta">---</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="添加文章时自动打开编辑器"><a href="#添加文章时自动打开编辑器" class="headerlink" title="添加文章时自动打开编辑器"></a>添加文章时自动打开编辑器</h2><p>在~/scripts下新建一个脚本，任意命名即可，输入<br><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> spawn = <span class="built_in">require</span>(<span class="string">&#x27;child_process&#x27;</span>).exec;</span><br><span class="line">hexo.on(<span class="string">&#x27;new&#x27;</span>, <span class="function"><span class="keyword">function</span>(<span class="params">data</span>)</span>&#123;</span><br><span class="line">  spawn(<span class="string">&#x27;start  &quot;markdown编辑器绝对路径.exe&quot; &#x27;</span> + data.path);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<h2 id="在文章中插入图片"><a href="#在文章中插入图片" class="headerlink" title="在文章中插入图片"></a>在文章中插入图片</h2><ol>
<li>如果只有少量图片，可以在~/source目录下新建images文件夹，通过<code>![](/images/xxx.png)</code>来引用。</li>
<li>如果图片比较多，可以建立文章自己的目录，在<code>站点配置文件</code>中，将<code>post_asset_folder</code>关键词改成<code>true</code>。之后通过<code>hexo new post &quot;article title&quot;</code>在新建文章时，就会出现与文章名相同的文件夹<code>article title</code>，将图片放入其中后，通过<code>![](XXXX.jpg)</code>直接引用。</li>
<li>基于md编辑器Typora编辑：<ul>
<li>以上在Typora中无法显示图片，可以在md文件的Front-matter部分，根据文章所有图片存在的位置，添加<code>typora-root-url: ..</code>或者<code>typora-root-url: article title</code>，即可在编辑器中也正常显示图片。</li>
<li>在Typora的偏好设置→图像部分→选择复制到指定路径， <code>./$&#123;filename&#125;</code>，之后可以直接在编辑md文件的时候复制图片，文章中会显示图像，并且已经在<code>article title</code>的文件夹下复制了该图片，可以用第二种方法引用。</li>
<li>Typora编辑器可以直接在图片上的代码右键缩放图片，此时代码会相应的更改为<code>&lt;img src=&quot;1.png&quot; style=&quot;zoom: 50%;&quot; /&gt;</code>，网页上也能成功缩小。</li>
</ul>
</li>
</ol>
<h2 id="在文章中页内跳转"><a href="#在文章中页内跳转" class="headerlink" title="在文章中页内跳转"></a>在文章中页内跳转</h2><ul>
<li>如果想要跳转的地方是标题，则直接使用<code>[描述](#id)</code>即可，<code>id</code>为目录名称</li>
<li>如果想自定义跳转的地方，则可以在需要跳转的地方，通过html语法定义一个锚，比如<code>&lt;span id=”表1”&gt;描述&lt;/span&gt;</code>，然后<code>[描述](#表1)</code></li>
</ul>
<h2 id="创建分类页面"><a href="#创建分类页面" class="headerlink" title="创建分类页面"></a>创建分类页面</h2><ol>
<li>在根目录下右键并GIt Bash here，然后输入<code>hexo new page categories</code>，在<code>~/source/categories/</code>出现了<code>index.md</code>，打开在Front-matter部分增加<code>type: &quot;categories&quot;</code><br>可以通过修改<code>Title</code>来修改页面中显示的标题。</li>
<li>在文章中的ront-matter中的categories后增加相应分类即可<ol>
<li>如果同一篇文章需要放到子分类下，可以用两种方法放到<code>AAA/BBB</code>分类下：<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">categories:</span><br><span class="line">  - AAA</span><br><span class="line">  - BBB</span><br></pre></td></tr></table></figure>
或<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">categories</span>:<span class="meta"> [AAA,BBB]</span></span><br></pre></td></tr></table></figure></li>
<li>如果同一篇文章需要放到两个分类下：<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">categories</span>:</span><br><span class="line">  <span class="selector-tag">-</span> <span class="selector-attr">[AAA]</span></span><br><span class="line">  <span class="selector-tag">-</span> <span class="selector-attr">[BBB]</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
</li>
</ol>
<h2 id="创建标签页面"><a href="#创建标签页面" class="headerlink" title="创建标签页面"></a>创建标签页面</h2><ol>
<li>在根目录下右键并GIt Bash here，然后输入<code>hexo new page tags</code>，在<code>~/source/tags/</code>出现了<code>index.md</code>，打开在Front-matter部分增加<code>type: &quot;tags&quot;</code><br>可以通过修改<code>Title</code>来修改页面中显示的标题。</li>
<li>在文章中的tags后增加相应分类即可<ul>
<li>如果同一篇文章需要多个标签，可以使用<code>tags: [标签1,标签2,标签3]</code></li>
</ul>
</li>
</ol>
<h2 id="设置页面文章篇数"><a href="#设置页面文章篇数" class="headerlink" title="设置页面文章篇数"></a>设置页面文章篇数</h2><ol>
<li>使用 <code>npm install --save</code> 命令来安装需要的 Hexo 插件。<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">npm <span class="keyword">install</span> <span class="comment">--save hexo-generator-index</span></span><br><span class="line">npm <span class="keyword">install</span> <span class="comment">--save hexo-generator-archive</span></span><br><span class="line">npm <span class="keyword">install</span> <span class="comment">--save hexo-generator-tag</span></span><br></pre></td></tr></table></figure></li>
<li>在 <code>站点配置文件</code> 中<code>index_generator</code>部分修改增添：<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">index_generator:</span></span><br><span class="line">  <span class="attr">per_page:</span> <span class="number">5</span>  </span><br><span class="line"><span class="attr">archive_generator:</span></span><br><span class="line">  <span class="attr">per_page:</span> <span class="number">20</span></span><br><span class="line">  <span class="attr">yearly:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">monthly:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">tag_generator:</span></span><br><span class="line">  <span class="attr">per_page:</span> <span class="number">10</span></span><br></pre></td></tr></table></figure>
<ul>
<li><code>per_page</code> 即文章的数量</li>
</ul>
</li>
</ol>
<h1 id="基于Next-v7-8-0的构建"><a href="#基于Next-v7-8-0的构建" class="headerlink" title="基于Next v7.8.0的构建"></a>基于<a href="https://github.com/theme-next/hexo-theme-next">Next v7.8.0</a>的构建</h1><h2 id="修改主题"><a href="#修改主题" class="headerlink" title="修改主题"></a>修改主题</h2><ol>
<li>选择主题的github项目，然后点击Cod→SSH，复制后，在~/themes文件夹下右键，GIt Bash here，然后输入：<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">git clone git@github.com:theme-next/hexo-theme-next.git</span><br></pre></td></tr></table></figure></li>
<li>打开<code>站点配置文件</code>，将theme后面修改为该主题的名字<figure class="highlight xl"><table><tr><td class="code"><pre><span class="line"><span class="built_in">theme</span>: hexo-<span class="built_in">theme</span>-next</span><br></pre></td></tr></table></figure></li>
<li>在<code>主题配置文件</code>~/themes/hexo-theme-next/_config.yml中，在<code>Schemes</code>部分可以选择不同的风格。还可以通过<code>darkmode</code>开启黑暗模式<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment">#scheme: Muse</span></span><br><span class="line"><span class="comment">#scheme: Mist</span></span><br><span class="line"><span class="comment">#scheme: Pisces</span></span><br><span class="line"><span class="attr">scheme:</span> <span class="string">Gemini</span></span><br><span class="line"></span><br><span class="line"><span class="attr">darkmode:</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="修改菜单"><a href="#修改菜单" class="headerlink" title="修改菜单"></a>修改菜单</h2><p>在<code>主题配置文件</code>的<code>Menu Settings</code>部分：</p>
<ul>
<li>设定菜单的内容，格式为<code>Key: /link/ || icon</code><ul>
<li><code>key</code>如果如果有默认翻译，会自动加载翻译，如果不存在就不会加载。翻译可以在<code>\themes\hexo-theme-next\languages</code>的<code>.yml</code>文件中修改。</li>
<li><code>||</code>前面是菜单的链接，后面是菜单的Font Awesome图标。</li>
</ul>
</li>
<li>可以通过修改<code>icons</code>是否显示菜单的图标</li>
</ul>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">menu:</span></span><br><span class="line">  <span class="attr">home:</span> <span class="string">/</span> <span class="string">||</span> <span class="string">fa</span> <span class="string">fa-home</span></span><br><span class="line">  <span class="comment">#about: /about/ || fa fa-user</span></span><br><span class="line">  <span class="comment">#tags: /tags/ || fa fa-tags</span></span><br><span class="line">  <span class="comment">#categories: /categories/ || fa fa-th</span></span><br><span class="line">  <span class="attr">archives:</span> <span class="string">/archives/</span> <span class="string">||</span> <span class="string">fa</span> <span class="string">fa-archive</span></span><br><span class="line">  <span class="comment">#schedule: /schedule/ || fa fa-calendar</span></span><br><span class="line">  <span class="comment">#sitemap: /sitemap.xml || fa fa-sitemap</span></span><br><span class="line">  <span class="comment">#commonweal: /404/ || fa fa-heartbeat</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Enable / Disable menu icons / item badges.</span></span><br><span class="line"><span class="attr">menu_settings:</span></span><br><span class="line">  <span class="attr">icons:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">badges:</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure>
<h2 id="设置字体及其大小等"><a href="#设置字体及其大小等" class="headerlink" title="设置字体及其大小等"></a>设置字体及其大小等</h2><h3 id="修改英文字体"><a href="#修改英文字体" class="headerlink" title="修改英文字体"></a>修改英文字体</h3><p>在<code>主题配置文件</code>中的<code>font</code>部分，有以下几种：</p>
<ul>
<li><code>global</code>全局字体：定义的字体将在全站范围使用</li>
<li><code>title</code>网站标题字体</li>
<li><code>headings</code>标题字体：文章内标题的字体（h1, h2, h3, h4, h5, h6）</li>
<li><code>posts</code>文章字体</li>
<li><code>codes</code>代码字体</li>
</ul>
<ol>
<li>每一项都有一个额外的 <code>external</code> 属性，此属性用来控制是否使用外链字体库。 </li>
<li>通过<code>family</code>设置字体，直接填写外链字体库的名字即可使用，但是Pisces / Gemini两种主题的<code>global</code>和<code>title</code>只能选择给定的字体。</li>
<li><code>size</code>设置字体大小，默认是<code>1</code>em(16px)。在此处的设置最好只设置英文字体，如果设置了中文字体，则会导致英文使用的是中文自带的字体。</li>
</ol>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">font:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># Uri of fonts host, e.g. https://fonts.googleapis.com (Default).</span></span><br><span class="line">  <span class="attr">host:</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">global:</span></span><br><span class="line">    <span class="attr">external:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">family:</span> <span class="string">Lato</span></span><br><span class="line">    <span class="attr">size:</span></span><br><span class="line">  <span class="attr">title:</span></span><br><span class="line">    <span class="attr">external:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">family:</span></span><br><span class="line">    <span class="attr">size:</span></span><br><span class="line">  <span class="attr">headings:</span></span><br><span class="line">    <span class="attr">external:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">family:</span></span><br><span class="line">    <span class="attr">size:</span></span><br><span class="line">  <span class="attr">posts:</span></span><br><span class="line">    <span class="attr">external:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">family:</span></span><br><span class="line">  <span class="attr">codes:</span></span><br><span class="line">    <span class="attr">external:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">family:</span></span><br></pre></td></tr></table></figure>
<h3 id="修改中文字体"><a href="#修改中文字体" class="headerlink" title="修改中文字体"></a>修改中文字体</h3><ol>
<li>修改中文字体，以思源宋体为例，首先打开<code>~\themes\hexo-theme-next\source\css\_variables\base.styl</code>，找到<code>// Font families.</code>模块，修改变量<code>$font-family-chinese</code>的值：<figure class="highlight awk"><table><tr><td class="code"><pre><span class="line"><span class="regexp">//</span> Font families.</span><br><span class="line"><span class="variable">$font</span>-family-chinese      = <span class="string">&quot;Noto Serif SC&quot;</span>;</span><br></pre></td></tr></table></figure>
同时也可以在<code>// Font size</code>部分修改字体大小，行高<figure class="highlight awk"><table><tr><td class="code"><pre><span class="line"><span class="regexp">//</span> Font size</span><br><span class="line"><span class="variable">$font</span>-size-base           = (hexo-config(<span class="string">&#x27;font.enable&#x27;</span>) and hexo-config(<span class="string">&#x27;font.global.size&#x27;</span>) is a <span class="string">&#x27;unit&#x27;</span>) ? unit(hexo-config(<span class="string">&#x27;font.global.size&#x27;</span>), em) : <span class="number">1</span>em;</span><br><span class="line"></span><br><span class="line"><span class="regexp">//</span> Global line height</span><br><span class="line"><span class="variable">$line</span>-height-base         = <span class="number">2</span>;</span><br><span class="line"><span class="variable">$line</span>-height-code-block   = <span class="number">1.6</span>; <span class="regexp">//</span> Can<span class="string">&#x27;t be less than 1.3;</span></span><br></pre></td></tr></table></figure></li>
<li>在<a href="https://fonts.google.com/">Google外链字体库</a>中，搜索并打开Noto Serif SC的页面，通过<code>Select this style</code>选择想要的样式，再点击右上角<code>View your selected families</code>，复制生成的 <code>&lt;link&gt;</code> 代码到 ~/source/_data/head.swig 文件中，并将<code>主题配置文件</code>中<code>custom_file_path:</code>部分的#去掉。<figure class="highlight gradle"><table><tr><td class="code"><pre><span class="line">custom_file_path:</span><br><span class="line">  head: <span class="keyword">source</span><span class="regexp">/_data/</span>head.swig</span><br><span class="line">  #header: <span class="keyword">source</span><span class="regexp">/_data/</span>header.swig</span><br><span class="line">  sidebar: <span class="keyword">source</span><span class="regexp">/_data/</span>sidebar.swig</span><br><span class="line">  #postMeta: <span class="keyword">source</span><span class="regexp">/_data/</span>post-meta.swig</span><br><span class="line">  #postBodyEnd: <span class="keyword">source</span><span class="regexp">/_data/</span>post-body-end.swig</span><br><span class="line">  #footer: <span class="keyword">source</span><span class="regexp">/_data/</span>footer.swig</span><br><span class="line">  #bodyEnd: <span class="keyword">source</span><span class="regexp">/_data/</span>body-end.swig</span><br><span class="line">  #variable: <span class="keyword">source</span><span class="regexp">/_data/</span>variables.styl</span><br><span class="line">  #mixin: <span class="keyword">source</span><span class="regexp">/_data/mi</span>xins.styl</span><br><span class="line">  style: <span class="keyword">source</span><span class="regexp">/_data/</span>styles.styl</span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>Next自定义样式放在了 ~/source/_data/目录下，在自定义样式之后，需要在<code>custom_file_path:</code>中启用相应的路径。</strong></p>
</blockquote>
</li>
</ol>
<h3 id="修改行间代码字体的大小"><a href="#修改行间代码字体的大小" class="headerlink" title="修改行间代码字体的大小"></a>修改行间代码字体的大小</h3><p>在~/source/_data/styles.styl文件中增加：</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">code</span> &#123;</span><br><span class="line">	<span class="attribute">margin</span>: <span class="number">0px</span> <span class="number">4px</span>;</span><br><span class="line">	<span class="attribute">font-size</span>: <span class="number">80%</span>;                                                        </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="侧栏"><a href="#侧栏" class="headerlink" title="侧栏"></a>侧栏</h2><h3 id="修改侧边栏的位置和出现时机"><a href="#修改侧边栏的位置和出现时机" class="headerlink" title="修改侧边栏的位置和出现时机"></a>修改侧边栏的位置和出现时机</h3><p>在<code>主题配置文件</code>的修改<code>sidebar</code>：</p>
<ul>
<li><code>position</code>设置侧边栏在左边<code>left</code>还是右边<code>right</code></li>
<li><code>width</code>设置侧边栏的宽度，默认Muse和Mist是320,Pisces和Gemini是240，可以不设置。</li>
<li><code>display</code>用于设置侧边栏的显示方式：<ul>
<li><code>post</code> 在文章页面（拥有目录列表）时显示</li>
<li><code>always</code>  在所有页面中都显示</li>
<li><code>hide</code> 在所有页面中都隐藏（可以手动展开）</li>
<li><code>remove</code> 完全移除</li>
</ul>
</li>
<li><code>offset</code>设置侧边栏距离顶部介绍的距离，只对<code>Muse</code>和<code>Mist</code>两个主题起作用</li>
<li><code>onmobile</code>设置是否在手机等宽度较小的设备上显示侧边栏，只对<code>Muse</code>和<code>Mist</code>两个主题起作用</li>
</ul>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">sidebar:</span></span><br><span class="line">  <span class="attr">position:</span> <span class="string">left</span></span><br><span class="line">  <span class="comment">#width: 300</span></span><br><span class="line">  <span class="attr">display:</span> <span class="string">post</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># Sidebar padding in pixels.</span></span><br><span class="line">  <span class="attr">padding:</span> <span class="number">18</span></span><br><span class="line">  </span><br><span class="line">  <span class="attr">offset:</span> <span class="number">12</span></span><br><span class="line">  <span class="attr">onmobile:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>
<h3 id="设置头像"><a href="#设置头像" class="headerlink" title="设置头像"></a>设置头像</h3><p>修改<code>主题配置文件</code>中的<code>avatar</code>部分：</p>
<ul>
<li><code>url</code>中可以是完整的互联网 URI，也可以将头像放置在<code>source/images/</code> 目录下</li>
<li>修改<code>rounded</code>，头像可以为圆的</li>
<li>修改<code>rotated</code>，鼠标移动到头像上头像会旋转</li>
</ul>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">avatar:</span></span><br><span class="line">  <span class="attr">url:</span> <span class="comment">#/images/avatar.gif</span></span><br><span class="line">  <span class="attr">rounded:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">rotated:</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure>
<h3 id="社交链接"><a href="#社交链接" class="headerlink" title="社交链接"></a>社交链接</h3><p>修改<code>主题配置文件</code>中的<code>social</code>部分：</p>
<ul>
<li><code>||</code>前输入你社交主页的链接即可，后面用于设置图标</li>
<li>email中的mailto注意不要删去，这样在win10系统可以调用系统邮件服务自动填写收件人</li>
<li><code>social_icons</code>中设置的是是否显示图标和文字</li>
</ul>
<figure class="highlight less"><table><tr><td class="code"><pre><span class="line"><span class="attribute">social</span>:</span><br><span class="line">  #<span class="attribute">GitHub</span>: <span class="attribute">https</span>:<span class="comment">//github.com/yourname || fab fa-github</span></span><br><span class="line">  <span class="number">#E</span><span class="attribute">-Mail</span>: <span class="attribute">mailto</span>:yourname<span class="variable">@gmail</span>.com || fa fa-envelope</span><br><span class="line">  #<span class="attribute">Weibo</span>: <span class="attribute">https</span>:<span class="comment">//weibo.com/yourname || fab fa-weibo</span></span><br><span class="line">  #<span class="attribute">Google</span>: <span class="attribute">https</span>:<span class="comment">//plus.google.com/yourname || fab fa-google</span></span><br><span class="line">  #<span class="attribute">Twitter</span>: <span class="attribute">https</span>:<span class="comment">//twitter.com/yourname || fab fa-twitter</span></span><br><span class="line">  <span class="number">#FB</span> <span class="attribute">Page</span>: <span class="attribute">https</span>:<span class="comment">//www.facebook.com/yourname || fab fa-facebook</span></span><br><span class="line">  #<span class="attribute">StackOverflow</span>: <span class="attribute">https</span>:<span class="comment">//stackoverflow.com/yourname || fab fa-stack-overflow</span></span><br><span class="line">  #<span class="attribute">YouTube</span>: <span class="attribute">https</span>:<span class="comment">//youtube.com/yourname || fab fa-youtube</span></span><br><span class="line">  #<span class="attribute">Instagram</span>: <span class="attribute">https</span>:<span class="comment">//instagram.com/yourname || fab fa-instagram</span></span><br><span class="line">  #<span class="attribute">Skype</span>: <span class="attribute">skype</span>:yourname?call|chat || fab fa-skype</span><br><span class="line"><span class="attribute">social_icons</span>:</span><br><span class="line">  <span class="attribute">enable</span>: true</span><br><span class="line">  <span class="attribute">icons_only</span>: false</span><br><span class="line">  <span class="attribute">transition</span>: false</span><br></pre></td></tr></table></figure>
<h3 id="侧边栏目录"><a href="#侧边栏目录" class="headerlink" title="侧边栏目录"></a>侧边栏目录</h3><p>修改<code>主题配置文件</code>中的<code>toc</code>部分：</p>
<ul>
<li><code>enable</code>用于设置是否开启侧边栏目录</li>
<li><code>number</code>用于设置自动编号</li>
<li><code>wrap</code>用于设置当标题长度超过侧边栏长度时是否自动换行</li>
<li><code>expand_all</code>用于设置是否自动展开全部目录</li>
<li><code>max_depth</code>用于设置自动生成目录的最大深度</li>
</ul>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">toc:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">number:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">wrap:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">expand_all:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">max_depth:</span> <span class="number">6</span></span><br></pre></td></tr></table></figure>
<h3 id="标签云"><a href="#标签云" class="headerlink" title="标签云"></a>标签云</h3><ol>
<li>安装插件<code>npm install hexo-tag-cloud@^2.0.* --save</code></li>
<li>在 <code>hexo/source/_data</code> 目录下新建 <code>sidebar.swig</code> 文件，输入<figure class="highlight django"><table><tr><td class="code"><pre><span class="line"><span class="template-tag">&#123;% <span class="name"><span class="name">if</span></span> site.tags.length &gt; 1 %&#125;</span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span> <span class="attr">src</span>=<span class="string">&quot;/js/tagcloud.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span> <span class="attr">src</span>=<span class="string">&quot;/js/tagcanvas.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;widget-wrap&quot;</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">h3</span> <span class="attr">class</span>=<span class="string">&quot;widget-title&quot;</span>&gt;</span>标签云<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;myCanvasContainer&quot;</span> <span class="attr">class</span>=<span class="string">&quot;widget tagcloud&quot;</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">canvas</span> <span class="attr">width</span>=<span class="string">&quot;250&quot;</span> <span class="attr">height</span>=<span class="string">&quot;250&quot;</span> <span class="attr">id</span>=<span class="string">&quot;resCanvas&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width=100%&quot;</span>&gt;</span></span></span><br><span class="line"><span class="xml">            </span><span class="template-variable">&#123;&#123; list_tags() &#125;&#125;</span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">canvas</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="template-tag">&#123;% <span class="name"><span class="name">endif</span></span> %&#125;</span></span><br></pre></td></tr></table></figure></li>
<li>在<code>主题配置文件</code>中的<code>custom_file_path</code>部分，增加<figure class="highlight gradle"><table><tr><td class="code"><pre><span class="line">sidebar: <span class="keyword">source</span><span class="regexp">/_data/</span>sidebar.swig</span><br></pre></td></tr></table></figure>
并在<code>站点配置文件</code>中其中添加<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 标签云</span></span><br><span class="line"><span class="attr">tag_cloud:</span></span><br><span class="line">    <span class="attr">textFont:</span> <span class="string">Trebuchet</span> <span class="string">MS,</span> <span class="string">Helvetica</span></span><br><span class="line">    <span class="attr">textColor:</span> <span class="string">&#x27;#333&#x27;</span></span><br><span class="line">    <span class="attr">textHeight:</span> <span class="number">25</span></span><br><span class="line">    <span class="attr">outlineColor:</span> <span class="string">&#x27;#E2E1D1&#x27;</span></span><br><span class="line">    <span class="attr">maxSpeed:</span> <span class="number">0.1</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="分类"><a href="#分类" class="headerlink" title="分类"></a>分类</h3><p>在~\source\_data\sidebar.swig中添加：<br><figure class="highlight django"><table><tr><td class="code"><pre><span class="line"><span class="template-tag">&#123;%- <span class="name"><span class="name">if</span></span> site.categories.length &gt; 0 %&#125;</span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;sidebar-categories&quot;</span> <span class="attr">p</span> <span class="attr">align</span>=<span class="string">&quot;left&quot;</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">font</span> <span class="attr">size</span>=<span class="string">&quot;2&quot;</span>&gt;</span></span></span><br><span class="line"><span class="xml">  </span><span class="template-variable">&#123;&#123; list_categories(&#123;show_count:false&#125;) &#125;&#125;</span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">font</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">p</span> /<span class="attr">div</span>&gt;</span></span></span><br><span class="line"><span class="template-tag">&#123;%- <span class="name"><span class="name">endif</span></span> %&#125;</span></span><br></pre></td></tr></table></figure></p>
<ul>
<li>hexo介绍<code>&lt;%- list_categories([options]) %&gt;</code>中的选项有：<ul>
<li><code>orderby</code>：分类排列方式，默认是<code>name</code></li>
<li><code>order</code>：分类排列顺序。<code>1</code>, asc 升序；<code>-1</code>, desc 降序。默认是<code>1</code></li>
<li><code>show_count</code>：显示每个分类的文章总数，默认是<code>true</code></li>
<li><code>style</code>：分类列表的显示方式。默认使用 <code>list</code> 以无序列表方式显示，<code>false</code>是以分割符号。</li>
<li><code>separator</code>：分类间的分隔符号。只有在 <code>style</code> 不是 <code>list</code> 时有用。默认是<code>,</code></li>
<li><code>depth</code>：要显示的分类层级。默认是<code>0</code> 显示所有层级的分类；<code>-1</code> 和 <code>0</code> 很类似，但是显示不分层级；<code>1</code> 只显示第一层的分类。</li>
<li><code>class</code>：分类列表的 class 名称。默认是<code>category</code></li>
<li><code>transform</code>：改变分类名称显示方法的函数</li>
<li><code>suffix</code>：为链接添加前缀，默认是<code>None</code></li>
</ul>
</li>
</ul>
<h2 id="设置网站访问量"><a href="#设置网站访问量" class="headerlink" title="设置网站访问量"></a>设置网站访问量</h2><ol>
<li>登陆<a href="https://tongji.baidu.com/web/welcome/login">百度统计</a>，<code>新增网站</code>，<code>网站域名</code>和<code>网站首页</code>都填网站的地址即可。</li>
<li>在 <code>hm.src</code>中，复制 <code>hm.js?</code> 后面那串统计脚本 id到<code>主题配置文件</code>中<code>baidu_analytics</code>后面<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript"><span class="keyword">var</span> _hmt = _hmt || [];</span></span><br><span class="line"><span class="javascript">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">var</span> hm = <span class="built_in">document</span>.createElement(<span class="string">&quot;script&quot;</span>);</span></span><br><span class="line"><span class="javascript">  hm.src = <span class="string">&quot;//hm.baidu.com/hm.js?xxxxxxxxxxxxxxxxxxx&quot;</span>;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">var</span> s = <span class="built_in">document</span>.getElementsByTagName(<span class="string">&quot;script&quot;</span>)[<span class="number">0</span>]; </span></span><br><span class="line">  s.parentNode.insertBefore(hm, s);</span><br><span class="line">&#125;)();</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li>修改完参数后执行 <code>hexo g</code> 和 <code>hexo d</code> 命令部署博客。在百度统计页面，点击<code>代码检查</code>，当出现”页面代码安装状态：代码安装正确“时，表示配置成功。</li>
<li>在<code>主题配置文件</code>中，将<code>busuanzi_count</code>的<code>enable</code>修改为<code>true</code>，就可以在页面添加统计模块。<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">busuanzi_count:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">total_visitors:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">total_visitors_icon:</span> <span class="string">fa</span> <span class="string">fa-user</span></span><br><span class="line">  <span class="attr">total_views:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">total_views_icon:</span> <span class="string">fa</span> <span class="string">fa-eye</span></span><br><span class="line">  <span class="attr">post_views:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">post_views_icon:</span> <span class="string">fa</span> <span class="string">fa-eye</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="增加搜索功能"><a href="#增加搜索功能" class="headerlink" title="增加搜索功能"></a>增加搜索功能</h2><ol>
<li>在根目录下右键并Git Bash here，然后输入<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">npm install hexo-generator-searchdb --save</span><br></pre></td></tr></table></figure></li>
<li>在<code>站点配置</code>文件中添加搜索设置<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">search:</span></span><br><span class="line">  <span class="attr">path:</span> <span class="string">search.xml</span></span><br><span class="line">  <span class="attr">field:</span> <span class="string">post</span></span><br><span class="line">  <span class="attr">format:</span> <span class="string">html</span></span><br><span class="line">  <span class="attr">limit:</span> <span class="number">10000</span></span><br></pre></td></tr></table></figure></li>
<li>将<code>主题配置文件</code>中的<code>Local Search</code>的<code>enable</code>修改为<code>true</code><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">local_search:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="string">ture</span></span><br><span class="line">  <span class="attr">trigger:</span> <span class="string">auto</span></span><br><span class="line">  <span class="attr">top_n_per_article:</span> <span class="number">1</span></span><br><span class="line">  <span class="attr">unescape:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">preload:</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure>
<ul>
<li><code>top_n_per_article</code>表示每篇文章出现几条匹配，<code>-1</code>代表全部</li>
</ul>
</li>
</ol>
<h2 id="文章相关-1"><a href="#文章相关-1" class="headerlink" title="文章相关"></a>文章相关</h2><h3 id="增加字数统计"><a href="#增加字数统计" class="headerlink" title="增加字数统计"></a>增加字数统计</h3><ol>
<li>安装插件<code>npm install hexo-symbols-count-time --save</code></li>
<li>在<code>站点配置文件</code>中增加：<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">symbols_count_time:</span></span><br><span class="line">  <span class="attr">symbols:</span> <span class="literal">true</span> </span><br><span class="line">  <span class="attr">time:</span> <span class="literal">true</span> </span><br><span class="line">  <span class="attr">total_symbols:</span> <span class="literal">true</span> </span><br><span class="line">  <span class="attr">total_time:</span> <span class="literal">true</span> </span><br></pre></td></tr></table></figure>
<ul>
<li><code>symbols</code>：文章字数</li>
<li><code>time</code>：阅读时长</li>
<li><code>total_symbols</code>：网页底部是否显示所有文章总字数</li>
<li><code>total_time</code>：网页底部所有文章阅读中时长</li>
</ul>
</li>
<li>修改<code>主题配置文件</code>中的 <code>symbols_count_time</code> 部分：<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">symbols_count_time:</span></span><br><span class="line">  <span class="attr">separated_meta:</span> <span class="literal">true</span> </span><br><span class="line">  <span class="attr">item_text_post:</span> <span class="literal">true</span> </span><br><span class="line">  <span class="attr">item_text_total:</span> <span class="literal">true</span> </span><br><span class="line">  <span class="attr">awl:</span> <span class="number">4</span> </span><br><span class="line">  <span class="attr">wpm:</span> <span class="number">275</span> </span><br></pre></td></tr></table></figure>
<ul>
<li><code>separated_meta</code>：统计信息不换行显示</li>
<li><code>item_text_post</code>：文章统计信息中是否显示“本文字数/阅读时长”等描述文字</li>
<li><code>item_text_total</code>：底部footer站点统计信息中是否显示“本文字数/阅读时长”等描述文字</li>
<li><code>awl</code>：平均字符长度</li>
<li><code>wpm</code>： 阅读速度, 一分钟阅读的字数</li>
</ul>
</li>
<li>网页中显示的本文字数和阅读时长是分行了的，如果不想分行，打开~\themes\hexo-theme-next\layout\_macro\post.swig，将下面一行删去即可：<figure class="highlight django"><table><tr><td class="code"><pre><span class="line"><span class="template-tag">&#123;%- <span class="name"><span class="name">if</span></span> theme.symbols_count_time.separated_meta %&#125;</span><span class="xml"><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><span class="template-tag">&#123;%- <span class="name"><span class="name">endif</span></span> %&#125;</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="图片的放大功能"><a href="#图片的放大功能" class="headerlink" title="图片的放大功能"></a>图片的放大功能</h3><p>将<code>主题配置文件</code>中的<code>fancybox</code>关键词为<code>true</code>即可，此时点击图片会有浮动的放大功能。</p>
<h3 id="显示公式"><a href="#显示公式" class="headerlink" title="显示公式"></a>显示公式</h3><ol>
<li>首先卸载默认的渲染引擎，安装next所需要的：<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">npm <span class="keyword">uninstall</span> hexo-renderer-marked <span class="comment">--save</span></span><br><span class="line">npm <span class="keyword">install</span> hexo-renderer-kramed <span class="comment">--save</span></span><br></pre></td></tr></table></figure></li>
<li>在<code>主题配置文件</code>中的<code>math</code>部分：   <figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">math:</span></span><br><span class="line">  <span class="attr">per_page:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">mathjax:</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">mhchem:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">katex:</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">false</span></span><br><span class="line">    <span class="attr">copy_tex:</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure>
<ul>
<li><code>per_pag</code>中，<code>true</code>代表按需要加载公式，在.md文件Front-matter添加<code>mathjax: true</code>才会加载公式。否则在所有页面都加载</li>
<li><code>mathjax</code>的enable改为<code>true</code></li>
</ul>
</li>
<li>行内的公式左右各一个$即可。</li>
</ol>
<h3 id="主页不显示全文"><a href="#主页不显示全文" class="headerlink" title="主页不显示全文"></a>主页不显示全文</h3><ol>
<li>在文章中使用 <code>&lt;!-- more --&gt;</code> 手动进行截断</li>
<li>在文章的 front-matter 中添加 description，并提供文章摘录<br>如果希望摘录在首页是居中的，则将~\themes\hexo-theme-next\layout_macro\post.swig中的<code>&lt;p&gt;&#123;&#123; post.description &#125;&#125;&lt;/p&gt;</code>改为如下即可：<figure class="highlight handlebars"><table><tr><td class="code"><pre><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">p</span> <span class="attr">align</span>=<span class="string">&quot;center&quot;</span>&gt;</span></span><span class="template-variable">&#123;&#123; <span class="name">post.description</span> &#125;&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="打赏功能"><a href="#打赏功能" class="headerlink" title="打赏功能"></a>打赏功能</h3><ol>
<li>将支付二维码放置在<code>source/images/</code> 目录下</li>
<li>修改<code>主题配置文件</code>中的<code>reward_settings</code>部分<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">reward_settings:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">animation:</span> <span class="literal">false</span></span><br><span class="line">  <span class="comment">#comment: Donate comment here.</span></span><br><span class="line"><span class="attr">reward:</span></span><br><span class="line">  <span class="attr">wechatpay:</span> <span class="string">/images/wechatpay.png</span></span><br><span class="line">  <span class="comment">#alipay: /images/alipay.png</span></span><br><span class="line">  <span class="comment">#paypal: /images/paypal.png</span></span><br><span class="line">  <span class="comment">#bitcoin: /images/bitcoin.png</span></span><br></pre></td></tr></table></figure>
<ul>
<li><code>enable</code>用于设置是否在文章末尾显示打赏按钮</li>
<li><code>animation</code>开启动画后，XX支付的字会抖动</li>
<li><code>comment</code>在打赏按钮的上方出现的字</li>
<li><code>reward</code>放置二维码的路径</li>
</ul>
</li>
</ol>
<h3 id="评论"><a href="#评论" class="headerlink" title="评论"></a>评论</h3><ol>
<li>注册并登陆<a href="https://www.leancloud.cn/">LeanCloud</a>，<code>创建应用</code>，输入应用名称后创建</li>
<li>点击<code>齿轮图标</code>→<code>应用Key</code>，复制<code>AppID</code>，<code>AppKey</code>，在<code>主题配置文件</code>的<code>valine</code>部分修改：<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">valine:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">appid:</span> <span class="string">XXXXXXXXX</span></span><br><span class="line">  <span class="attr">appkey:</span> <span class="string">XXXXXXXX</span></span><br><span class="line">  <span class="attr">notify:</span> <span class="literal">false</span> </span><br><span class="line">  <span class="attr">verify:</span> <span class="literal">false</span> </span><br><span class="line">  <span class="attr">placeholder:</span> <span class="string">Just</span> <span class="string">go</span> <span class="string">go</span> </span><br><span class="line">  <span class="attr">avatar:</span> <span class="string">mm</span> <span class="comment"># Gravatar style</span></span><br><span class="line">  <span class="attr">guest_info:</span> <span class="string">nick,mail,link</span> </span><br><span class="line">  <span class="attr">pageSize:</span> <span class="number">10</span> </span><br><span class="line">  <span class="attr">language:</span> </span><br><span class="line">  <span class="attr">visitor:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">comment_count:</span> <span class="literal">true</span> </span><br><span class="line">  <span class="attr">recordIP:</span> <span class="literal">false</span> <span class="comment"># Whether to record the commenter IP</span></span><br><span class="line">  <span class="attr">serverURLs:</span> <span class="comment"># When the custom domain name is enabled, fill it in here (it will be detected automatically by default, no need to fill in)</span></span><br><span class="line">  <span class="comment">#post_meta_order: 0</span></span><br></pre></td></tr></table></figure>
<ul>
<li><code>enable</code>改为 <code>true</code></li>
<li><code>appid</code>和 <code>appkey</code>粘贴在lean复制的App ID和App Key</li>
<li><code>notify</code>新留言是否需要通知</li>
<li><code>verify</code>验证码</li>
<li><code>placeholder</code>默认留言框内的文字</li>
<li><code>avatar</code>默认头像</li>
<li><code>guest_info</code>默认留言框的头部需要访问者输入的信息</li>
<li><code>pageSize</code>默认单页的留言条数</li>
<li><code>language</code>语言，可改为<code>en</code>, <code>zh-cn</code></li>
<li><code>visitor</code>开启后可能会与百度网站访问量的模块冲突，显示出两个阅读次数，因此可以关闭。</li>
<li><code>comment_count</code>评论次数</li>
</ul>
</li>
<li>可以在LeanCloud中的<code>储存</code>→<code>结构化数据</code>→<code>Comment</code>中管理评论</li>
<li>开启后，<code>tag</code>、<code>categories</code>页面也会带有评论， 若需要关闭的话，可以在不想要评论页面下相应的md文件的Front-matter部分添加字段 <code>comments: false</code> 。</li>
</ol>
<h3 id="设置代码相关"><a href="#设置代码相关" class="headerlink" title="设置代码相关"></a>设置代码相关</h3><p>在<code>主题配置文件</code>的<code>codeblock</code>部分修改：</p>
<ul>
<li><code>highlight_theme</code>设置代码高亮格式，有<code>normal</code>| <code>night</code> | <code>night eighties</code> | <code>night blue</code> | <code>night bright</code> | <code>solarized</code> | <code>solarized dark</code> | <code>galactic</code>可选</li>
<li><code>copy_button</code>开启代码块右上角的复制按钮，<code>show_result</code>设置是否显示复制成功提示</li>
</ul>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">codeblock:</span><br><span class="line">  highlight_theme: normal</span><br><span class="line">  copy_button:</span><br><span class="line">    enable: <span class="literal">true</span></span><br><span class="line">    show_result: <span class="literal">false</span></span><br><span class="line">    # Available values:<span class="built_in"> default </span>| flat | mac</span><br><span class="line">    style:</span><br></pre></td></tr></table></figure>
<p>在站点配置文件中的<code>highlight</code>部分中也可以修改：</p>
<ul>
<li><code>enable</code>中是否开启代码高亮</li>
<li><code>line_number</code>是否增加代码行号</li>
<li><code>auto_detect</code>自动判断代码语言</li>
</ul>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">highlight:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">line_number:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">auto_detect:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">tab_replace:</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line">  <span class="attr">wrap:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">hljs:</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure>
<h3 id="页面加载进度和阅读进度"><a href="#页面加载进度和阅读进度" class="headerlink" title="页面加载进度和阅读进度"></a>页面加载进度和阅读进度</h3><p><code>主题配置文件</code>中<code>reading_progress</code>：</p>
<ul>
<li><code>position</code>位置是top还是bottom</li>
</ul>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">reading_progress:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">position:</span> <span class="string">top</span></span><br><span class="line">  <span class="attr">color:</span> <span class="string">&quot;#37c6c0&quot;</span></span><br><span class="line">  <span class="attr">height:</span> <span class="string">3px</span></span><br></pre></td></tr></table></figure>
<h3 id="通过一个按钮回到网页顶部"><a href="#通过一个按钮回到网页顶部" class="headerlink" title="通过一个按钮回到网页顶部"></a>通过一个按钮回到网页顶部</h3><p><code>主题配置文件</code>中的<code>back2top</code>部分：</p>
<ul>
<li><code>enable</code>设置是否开启回到顶部按钮</li>
<li><code>sidebar</code> 按钮会出现在侧栏下方</li>
<li><code>scrollpercent</code> 显示阅读百分比</li>
</ul>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">back2top:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">sidebar:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">scrollpercent:</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure>
<h3 id="书签：定位到上次阅读的地方"><a href="#书签：定位到上次阅读的地方" class="headerlink" title="书签：定位到上次阅读的地方"></a>书签：定位到上次阅读的地方</h3><p><code>主题配置文件</code>中的<code>bookmark</code>部分：</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">bookmark:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="comment"># Customize the color of the bookmark.</span></span><br><span class="line">  <span class="attr">color:</span> <span class="string">&quot;#222&quot;</span></span><br><span class="line">  <span class="comment"># If auto, save the reading progress when closing the page or clicking the bookmark-icon.</span></span><br><span class="line">  <span class="comment"># If manual, only save it by clicking the bookmark-icon.</span></span><br><span class="line">  <span class="attr">save:</span> <span class="string">auto</span></span><br></pre></td></tr></table></figure>
<h3 id="版权信息"><a href="#版权信息" class="headerlink" title="版权信息"></a>版权信息</h3><p><code>主题配置文件</code>中的<code>bookmark</code>部分：</p>
<ul>
<li><code>license:</code>设置版权标准</li>
<li><code>sidebar:</code>设置是否在侧边栏显示版权标准</li>
<li><code>post:</code>设置是否在文章底部显示版权信息</li>
<li><code>language:</code>设置语言</li>
</ul>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">creative_commons:</span></span><br><span class="line">  <span class="attr">license:</span> <span class="string">by-nc-sa</span></span><br><span class="line">  <span class="attr">sidebar:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">post:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">language:</span></span><br></pre></td></tr></table></figure>
<h3 id="修改文章内链接文本样式"><a href="#修改文章内链接文本样式" class="headerlink" title="修改文章内链接文本样式"></a>修改文章内链接文本样式</h3><p>将链接文本设置为 <code>蓝色</code>，鼠标划过时文字 <code>颜色加亮</code>，并显示下划线，在~\source\_data\styles.styl文件中，增加：</p>
<figure class="highlight scss"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.post-body</span> <span class="selector-tag">p</span> <span class="selector-tag">a</span>&#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#0593d3</span>;</span><br><span class="line">  <span class="attribute">border-bottom</span>: none;</span><br><span class="line">  <span class="attribute">border-bottom</span>: <span class="number">1px</span> solid <span class="number">#0593d3</span>;</span><br><span class="line">  &amp;<span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#fc6423</span>;</span><br><span class="line">    <span class="attribute">border-bottom</span>: none;</span><br><span class="line">    <span class="attribute">border-bottom</span>: <span class="number">1px</span> solid <span class="number">#fc6423</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.post-body</span> <span class="selector-tag">li</span> <span class="selector-tag">a</span>&#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#0593d3</span>;</span><br><span class="line">  <span class="attribute">border-bottom</span>: none;</span><br><span class="line">  <span class="attribute">border-bottom</span>: <span class="number">1px</span> solid <span class="number">#0593d3</span>;</span><br><span class="line">  &amp;<span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#fc6423</span>;</span><br><span class="line">    <span class="attribute">border-bottom</span>: none;</span><br><span class="line">    <span class="attribute">border-bottom</span>: <span class="number">1px</span> solid <span class="number">#fc6423</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h2><h3 id="设置「背景动画」"><a href="#设置「背景动画」" class="headerlink" title="设置「背景动画」"></a>设置「背景动画」</h3><ol>
<li><p>首先在<code>~\themes\hexo-theme-next\source\lib</code>下载</p>
<figure class="highlight awk"><table><tr><td class="code"><pre><span class="line">git clone https:<span class="regexp">//gi</span>thub.com<span class="regexp">/theme-next/</span>theme-<span class="keyword">next</span>-three three</span><br><span class="line">git clone https:<span class="regexp">//gi</span>thub.com<span class="regexp">/theme-next/</span>theme-<span class="keyword">next</span>-canvas-ribbon canvas-ribbon</span><br></pre></td></tr></table></figure></li>
<li>更改<code>主题配置文件</code>中开启一种即可<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">three:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">three_waves:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">canvas_lines:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">canvas_sphere:</span> <span class="literal">false</span></span><br><span class="line"><span class="comment">#在背景随机出现彩带，鼠标点击后更换</span></span><br><span class="line"><span class="attr">canvas_ribbon:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="string">ture</span></span><br><span class="line">  <span class="attr">size:</span> <span class="number">300</span> <span class="comment"># The width of the ribbon</span></span><br><span class="line">  <span class="attr">alpha:</span> <span class="number">0.6</span> <span class="comment"># The transparency of the ribbon</span></span><br><span class="line">  <span class="attr">zIndex:</span> <span class="number">-1</span> <span class="comment"># The display level of the ribbon</span></span><br></pre></td></tr></table></figure></li>
<li>如果是使用CDN而不是第二种，则在<code>vendors</code>模块中添加<figure class="highlight awk"><table><tr><td class="code"><pre><span class="line">three: <span class="regexp">//</span>cdn.jsdelivr.net<span class="regexp">/gh/</span>theme-<span class="keyword">next</span><span class="regexp">/theme-next-three@1/</span>three.min.js</span><br><span class="line">three_waves: <span class="regexp">//</span>cdn.jsdelivr.net<span class="regexp">/gh/</span>theme-<span class="keyword">next</span><span class="regexp">/theme-next-three@latest/</span>three-waves.min.js</span><br><span class="line">canvas_lines: <span class="regexp">//</span>cdn.jsdelivr.net<span class="regexp">/gh/</span>theme-<span class="keyword">next</span><span class="regexp">/theme-next-three@latest/</span>canvas_lines.min.js</span><br><span class="line">canvas_sphere: <span class="regexp">//</span>cdn.jsdelivr.net<span class="regexp">/gh/</span>theme-<span class="keyword">next</span><span class="regexp">/theme-next-three@latest/</span>canvas_sphere.min.js</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>其他动画的设置：<a href="https://github.com/hustcc/canvas-nest.js/blob/master/README-zh.md">canvas-nest</a>：</p>
<ol>
<li>在~\themes\hexo-theme-next\source\lib目录下：<figure class="highlight crmsh"><table><tr><td class="code"><pre><span class="line">git <span class="keyword">clone</span> <span class="title">git</span>@github.com:hustcc/canvas-nest.js.git canvas-nest</span><br></pre></td></tr></table></figure></li>
<li>在<code>主题配置文件</code>中增加：<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Canvas-nest</span></span><br><span class="line"><span class="comment"># Dependencies: https://github.com/theme-next/theme-next-canvas-nest</span></span><br><span class="line"><span class="comment"># For more information: https://github.com/hustcc/canvas-nest.js</span></span><br><span class="line"><span class="attr">canvas_nest:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">onmobile:</span> <span class="literal">true</span> <span class="comment"># Display on mobile or not</span></span><br><span class="line">  <span class="attr">color:</span> <span class="string">&quot;0,0,255&quot;</span> </span><br><span class="line">  <span class="attr">opacity:</span> <span class="number">0.5</span> </span><br><span class="line">  <span class="attr">zIndex:</span> <span class="number">-1</span> <span class="comment"># z-index property of the background</span></span><br><span class="line">  <span class="attr">count:</span> <span class="number">99</span> <span class="comment"># The number of lines</span></span><br></pre></td></tr></table></figure>
<ul>
<li><code>color</code>： 线条颜色</li>
<li><code>opacity</code>：透明度（0-1）</li>
<li><code>count</code>：线条总数目</li>
</ul>
</li>
</ol>
<h3 id="右上角出现Github角标"><a href="#右上角出现Github角标" class="headerlink" title="右上角出现Github角标"></a>右上角出现Github角标</h3><p>点击之后可以跳转到其源码页面，修改<code>主题配置文件</code>中<code>github_banner</code>：</p>
<ul>
<li><code>enable</code>设置是否在页面右上角显示Github三角标</li>
<li><code>permalink:</code>填写跳转到的Github地址</li>
<li><code>title:</code>设置鼠标移动到图标后显示的文字</li>
</ul>
<figure class="highlight less"><table><tr><td class="code"><pre><span class="line"><span class="attribute">github_banner</span>:</span><br><span class="line">  <span class="attribute">enable</span>: false</span><br><span class="line">  <span class="attribute">permalink</span>: <span class="attribute">https</span>:<span class="comment">//github.com/yourname</span></span><br><span class="line">  <span class="attribute">title</span>: Follow me on GitHub</span><br></pre></td></tr></table></figure>
<h3 id="页脚"><a href="#页脚" class="headerlink" title="页脚"></a>页脚</h3><p>修改<code>主题配置文件</code>中<code>footer</code>：</p>
<ul>
<li><code>since</code>表示网站成立的年份，不设置的话默认是当前年份</li>
<li><code>icon</code>设置年份后面的图标<ul>
<li><code>name</code>默认是心形</li>
<li><code>animated</code>用于设置心形是否跳动</li>
<li><code>color</code>设置图标颜色</li>
</ul>
</li>
<li><code>copyright</code>显示图标后面的版权所属，也就是作者名，不设置的话默认显示根目录配置文件中的作者名</li>
<li><code>powered</code>设定是否显示Powered by Hexo以及当前主题的版本信息</li>
</ul>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">footer:</span></span><br><span class="line">  <span class="comment">#since: 2015</span></span><br><span class="line">  <span class="attr">icon:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">fa</span> <span class="string">fa-heart</span></span><br><span class="line">    <span class="attr">animated:</span> <span class="literal">false</span></span><br><span class="line">    <span class="attr">color:</span> <span class="string">&quot;#ff0000&quot;</span></span><br><span class="line">  <span class="attr">copyright:</span></span><br><span class="line">  <span class="attr">powered:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># Beian ICP and gongan information for Chinese users. See: https://beian.miit.gov.cn, http://www.beian.gov.cn</span></span><br><span class="line">  <span class="attr">beian:</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">false</span></span><br><span class="line">    <span class="attr">icp:</span></span><br><span class="line">    <span class="comment"># The digit in the num of gongan beian.</span></span><br><span class="line">    <span class="attr">gongan_id:</span></span><br><span class="line">    <span class="comment"># The full num of gongan beian.</span></span><br><span class="line">    <span class="attr">gongan_num:</span></span><br><span class="line">    <span class="comment"># The icon for gongan beian. See: http://www.beian.gov.cn/portal/download</span></span><br><span class="line">    <span class="attr">gongan_icon_url:</span></span><br></pre></td></tr></table></figure>
<h3 id="标签的-改成图标"><a href="#标签的-改成图标" class="headerlink" title="标签的#改成图标"></a>标签的#改成图标</h3><p>将在<code>主题配置文件</code>中的<code>tag_icon</code>改为<code>true</code>即可</p>
<h3 id="归档页面年份后增加十二生肖"><a href="#归档页面年份后增加十二生肖" class="headerlink" title="归档页面年份后增加十二生肖"></a>归档页面年份后增加十二生肖</h3><ol>
<li><a href="https://oss.chenjunxin.com/files/blogfiles/9ec4151c_chinese-zodiac.zip">下载十二生肖字体</a>，将解压的三个字体文件全部放在根目录 ~/source/fonts/ 下，在~\themes\hexo-theme-next\layout\_macro\post-collapse.swig文件中，修改 <code>&#123;%- if year !== current_year %&#125;</code>部分为<figure class="highlight django"><table><tr><td class="code"><pre><span class="line"><span class="template-tag">&#123;%- <span class="name"><span class="name">if</span></span> year !== current_year %&#125;</span></span><br><span class="line"><span class="xml">  </span><span class="template-tag">&#123;%- <span class="name">set</span> current_year = year %&#125;</span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;collection-year&quot;</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;</span></span><span class="template-tag">&#123;%- <span class="name"><span class="name">if</span></span> theme.seo %&#125;</span><span class="xml"><span class="tag"><span class="attr">h2</span></span></span><span class="template-tag">&#123;% <span class="name"><span class="name">else</span></span> %&#125;</span><span class="xml"><span class="tag"><span class="attr">h1</span></span></span><span class="template-tag">&#123;%- <span class="name"><span class="name">endif</span></span> %&#125;</span><span class="xml"><span class="tag"> <span class="attr">class</span>=<span class="string">&quot;collection-header&quot;</span>&gt;</span></span><span class="template-variable">&#123;&#123; current_year &#125;&#125;</span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;chinese-zodiac&quot;</span>&gt;</span></span></span><br><span class="line"><span class="xml">        </span><span class="template-tag">&#123;%- <span class="name"><span class="name">if</span></span> current_year % 12 == 0 %&#125;</span></span><br><span class="line"><span class="xml">          <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;symbolic-animals icon-monkey&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span></span><br><span class="line"><span class="xml">        </span><span class="template-tag">&#123;%- <span class="name"><span class="name">endif</span></span> %&#125;</span></span><br><span class="line"><span class="xml">        </span><span class="template-tag">&#123;%- <span class="name"><span class="name">if</span></span> current_year % 12 == 1 %&#125;</span></span><br><span class="line"><span class="xml">          <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;symbolic-animals icon-rooster&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span></span><br><span class="line"><span class="xml">        </span><span class="template-tag">&#123;%- <span class="name"><span class="name">endif</span></span> %&#125;</span></span><br><span class="line"><span class="xml">        </span><span class="template-tag">&#123;%- <span class="name"><span class="name">if</span></span> current_year % 12 == 2 %&#125;</span></span><br><span class="line"><span class="xml">          <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;symbolic-animals icon-dog&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span></span><br><span class="line"><span class="xml">        </span><span class="template-tag">&#123;%- <span class="name"><span class="name">endif</span></span> %&#125;</span></span><br><span class="line"><span class="xml">        </span><span class="template-tag">&#123;%- <span class="name"><span class="name">if</span></span> current_year % 12 == 3 %&#125;</span></span><br><span class="line"><span class="xml">          <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;symbolic-animals icon-pig&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span></span><br><span class="line"><span class="xml">        </span><span class="template-tag">&#123;%- <span class="name"><span class="name">endif</span></span> %&#125;</span></span><br><span class="line"><span class="xml">        </span><span class="template-tag">&#123;%- <span class="name"><span class="name">if</span></span> current_year % 12 == 4 %&#125;</span></span><br><span class="line"><span class="xml">          <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;symbolic-animals icon-rat&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span></span><br><span class="line"><span class="xml">        </span><span class="template-tag">&#123;%- <span class="name"><span class="name">endif</span></span> %&#125;</span></span><br><span class="line"><span class="xml">        </span><span class="template-tag">&#123;%- <span class="name"><span class="name">if</span></span> current_year % 12 == 5 %&#125;</span></span><br><span class="line"><span class="xml">          <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;symbolic-animals icon-ox&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span></span><br><span class="line"><span class="xml">        </span><span class="template-tag">&#123;%- <span class="name"><span class="name">endif</span></span> %&#125;</span></span><br><span class="line"><span class="xml">        </span><span class="template-tag">&#123;%- <span class="name"><span class="name">if</span></span> current_year % 12 == 6 %&#125;</span></span><br><span class="line"><span class="xml">          <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;symbolic-animals icon-tiger&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span></span><br><span class="line"><span class="xml">        </span><span class="template-tag">&#123;%- <span class="name"><span class="name">endif</span></span> %&#125;</span></span><br><span class="line"><span class="xml">        </span><span class="template-tag">&#123;%- <span class="name"><span class="name">if</span></span> current_year % 12 == 7 %&#125;</span></span><br><span class="line"><span class="xml">          <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;symbolic-animals icon-rabbit&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span></span><br><span class="line"><span class="xml">        </span><span class="template-tag">&#123;%- <span class="name"><span class="name">endif</span></span> %&#125;</span></span><br><span class="line"><span class="xml">        </span><span class="template-tag">&#123;%- <span class="name"><span class="name">if</span></span> current_year % 12 == 8 %&#125;</span></span><br><span class="line"><span class="xml">          <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;symbolic-animals icon-dragon&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span></span><br><span class="line"><span class="xml">        </span><span class="template-tag">&#123;%- <span class="name"><span class="name">endif</span></span> %&#125;</span></span><br><span class="line"><span class="xml">        </span><span class="template-tag">&#123;%- <span class="name"><span class="name">if</span></span> current_year % 12 == 9 %&#125;</span></span><br><span class="line"><span class="xml">          <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;symbolic-animals icon-snake&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span></span><br><span class="line"><span class="xml">        </span><span class="template-tag">&#123;%- <span class="name"><span class="name">endif</span></span> %&#125;</span></span><br><span class="line"><span class="xml">        </span><span class="template-tag">&#123;%- <span class="name"><span class="name">if</span></span> current_year % 12 == 10 %&#125;</span></span><br><span class="line"><span class="xml">          <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;symbolic-animals icon-horse&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span></span><br><span class="line"><span class="xml">        </span><span class="template-tag">&#123;%- <span class="name"><span class="name">endif</span></span> %&#125;</span></span><br><span class="line"><span class="xml">        </span><span class="template-tag">&#123;%- <span class="name"><span class="name">if</span></span> current_year % 12 == 11 %&#125;</span></span><br><span class="line"><span class="xml">          <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;symbolic-animals icon-goat&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span></span><br><span class="line"><span class="xml">        </span><span class="template-tag">&#123;%- <span class="name"><span class="name">endif</span></span> %&#125;</span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/</span></span><span class="template-tag">&#123;%- <span class="name"><span class="name">if</span></span> theme.seo %&#125;</span><span class="xml"><span class="tag"><span class="attr">h2</span></span></span><span class="template-tag">&#123;% <span class="name"><span class="name">else</span></span> %&#125;</span><span class="xml"><span class="tag"><span class="attr">h1</span></span></span><span class="template-tag">&#123;%- <span class="name"><span class="name">endif</span></span> %&#125;</span><span class="xml"><span class="tag">&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="template-tag">&#123;%- <span class="name"><span class="name">endif</span></span> %&#125;</span></span><br></pre></td></tr></table></figure></li>
<li>在~/source/_data/styles.styl中，增加<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.chinese-zodiac</span> &#123;</span><br><span class="line">    <span class="attribute">float</span>: right;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@font-face</span> &#123;</span><br><span class="line">  <span class="attribute">font-family</span>: <span class="string">&#x27;chinese-zodiac&#x27;</span>;</span><br><span class="line">  <span class="attribute">font-display</span>: swap;</span><br><span class="line">  <span class="attribute">src</span>: <span class="built_in">url</span>(<span class="string">&#x27;/fonts/chinese-zodiac.eot&#x27;</span>);</span><br><span class="line">  <span class="attribute">src</span>: <span class="built_in">url</span>(<span class="string">&#x27;/fonts/chinese-zodiac.eot&#x27;</span>) <span class="built_in">format</span>(<span class="string">&#x27;embedded-opentype&#x27;</span>),</span><br><span class="line">       <span class="built_in">url</span>(<span class="string">&#x27;/fonts/chinese-zodiac.woff2&#x27;</span>) <span class="built_in">format</span>(<span class="string">&#x27;woff2&#x27;</span>),</span><br><span class="line">       <span class="built_in">url</span>(<span class="string">&#x27;/fonts/chinese-zodiac.woff&#x27;</span>) <span class="built_in">format</span>(<span class="string">&#x27;woff&#x27;</span>);</span><br><span class="line">  <span class="attribute">font-weight</span>: normal;</span><br><span class="line">  <span class="attribute">font-style</span>: normal;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.symbolic-animals</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: inline-block;</span><br><span class="line">  <span class="attribute">font</span>: normal normal normal <span class="number">14px</span>/<span class="number">1</span> chinese-zodiac;</span><br><span class="line">  <span class="attribute">font-size</span>: inherit;</span><br><span class="line">  <span class="attribute">text-rendering</span>: auto;</span><br><span class="line">  <span class="attribute">-webkit-font-smoothing</span>: antialiased;</span><br><span class="line">  <span class="attribute">-moz-osx-font-smoothing</span>: grayscale;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.icon-dragon</span><span class="selector-pseudo">:before</span> &#123; <span class="attribute">content</span>: <span class="string">&#x27;\e806&#x27;</span>; &#125;</span><br><span class="line"><span class="selector-class">.icon-tiger</span><span class="selector-pseudo">:before</span> &#123; <span class="attribute">content</span>: <span class="string">&#x27;\e809&#x27;</span>; &#125;</span><br><span class="line"><span class="selector-class">.icon-pig</span><span class="selector-pseudo">:before</span> &#123; <span class="attribute">content</span>: <span class="string">&#x27;\e810&#x27;</span>; &#125;</span><br><span class="line"><span class="selector-class">.icon-horse</span><span class="selector-pseudo">:before</span> &#123; <span class="attribute">content</span>: <span class="string">&#x27;\e813&#x27;</span>; &#125;</span><br><span class="line"><span class="selector-class">.icon-rat</span><span class="selector-pseudo">:before</span> &#123; <span class="attribute">content</span>: <span class="string">&#x27;\e816&#x27;</span>; &#125;</span><br><span class="line"><span class="selector-class">.icon-goat</span><span class="selector-pseudo">:before</span> &#123; <span class="attribute">content</span>: <span class="string">&#x27;\e818&#x27;</span>; &#125;</span><br><span class="line"><span class="selector-class">.icon-snake</span><span class="selector-pseudo">:before</span> &#123; <span class="attribute">content</span>: <span class="string">&#x27;\e820&#x27;</span>; &#125;</span><br><span class="line"><span class="selector-class">.icon-ox</span><span class="selector-pseudo">:before</span> &#123; <span class="attribute">content</span>: <span class="string">&#x27;\e822&#x27;</span>; &#125;</span><br><span class="line"><span class="selector-class">.icon-dog</span><span class="selector-pseudo">:before</span> &#123; <span class="attribute">content</span>: <span class="string">&#x27;\e825&#x27;</span>; &#125;</span><br><span class="line"><span class="selector-class">.icon-rabbit</span><span class="selector-pseudo">:before</span> &#123; <span class="attribute">content</span>: <span class="string">&#x27;\e826&#x27;</span>; &#125;</span><br><span class="line"><span class="selector-class">.icon-monkey</span><span class="selector-pseudo">:before</span> &#123; <span class="attribute">content</span>: <span class="string">&#x27;\e829&#x27;</span>; &#125;</span><br><span class="line"><span class="selector-class">.icon-rooster</span><span class="selector-pseudo">:before</span> &#123; <span class="attribute">content</span>: <span class="string">&#x27;\e82f&#x27;</span>; &#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="增加看板动画"><a href="#增加看板动画" class="headerlink" title="增加看板动画"></a>增加看板动画</h3><ol>
<li><p>在~下<code>npm install -save hexo-helper-live2d</code>，并在<code>站点配置文件</code>中输入：</p>
<ul>
<li><code>NAME</code>可选：<code>chitose</code>、<code>epsilon2_1</code>、<code>haru/01</code>、<code>haru/02</code>、<code>haruto</code>、<code>hibiki</code>、<code>hijiki</code>、<code>izumi</code>、<code>koharu</code>、<code>miku</code>、<code>ni-j</code>、<code>nico</code>、<code>nietzsche</code>、<code>nipsilon</code>、<code>nito</code>、<code>shizuku</code>、<code>tororo</code>、<code>tsumiki</code>、<code>unitychan</code>、<code>wanko</code>、<code>z16</code></li>
<li><code>display</code>中：<code>width</code>和<code>height</code>分别控制宽度和高度，<code>position</code>控制位置，<code>hOffset</code>和<code>vOffset</code>分别控制水平和垂直的偏移</li>
<li><code>mobile</code>中，<code>show</code>控制是否在移动设备上显示，<code>scale</code>控制在移动设备上的缩放</li>
<li><code>react</code>中<code>opacity</code>控制透明度</li>
<li><code>dialog</code>中，<code>enable</code>表示是否显示对话框，<code>hitokoto</code>表示启用的语料库是使用一言API</li>
</ul>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">live2d:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">scriptFrom:</span> <span class="string">local</span></span><br><span class="line">  <span class="attr">pluginRootPath:</span> <span class="string">live2dw/</span></span><br><span class="line">  <span class="attr">pluginJsPath:</span> <span class="string">lib/</span></span><br><span class="line">  <span class="attr">pluginModelPath:</span> <span class="string">assets/</span></span><br><span class="line">  <span class="attr">tagMode:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">log:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">model:</span></span><br><span class="line">    <span class="attr">use:</span> <span class="string">live2d-widget-model-NAME</span></span><br><span class="line">  <span class="attr">display:</span></span><br><span class="line">    <span class="attr">hOffset:</span> <span class="number">0</span></span><br><span class="line">    <span class="attr">vOffset:</span> <span class="number">-20</span></span><br><span class="line">    <span class="attr">position:</span> <span class="string">right</span></span><br><span class="line">    <span class="attr">width:</span> <span class="number">150</span></span><br><span class="line">    <span class="attr">height:</span> <span class="number">300</span></span><br><span class="line">  <span class="attr">mobile:</span></span><br><span class="line">    <span class="attr">show:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">scale:</span> <span class="number">0.5</span></span><br><span class="line">  <span class="attr">react:</span></span><br><span class="line">    <span class="attr">opacity:</span> <span class="number">1.0</span></span><br><span class="line">  <span class="attr">dialog:</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">false</span></span><br><span class="line">    <span class="attr">hitokoto:</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>在~新建文件夹/live2d_models/NAME，在NAME文件夹下，新建文件NAME.model.json，然后安装模型<code>npm install --save live2d-widget-model-NAME</code></p>
</li>
<li>增加看板动画会导致网站底部和访问量消失，解决办法：<a href="https://www.zywvvd.com/2020/03/09/next/13_busuanzi_fix_for_live2d/next-busuanzi-fix-live2d/">https://www.zywvvd.com/2020/03/09/next/13_busuanzi_fix_for_live2d/next-busuanzi-fix-live2d/</a></li>
</ol>
<h3 id="Mist主题首页两篇文章之间间距缩小和分割线"><a href="#Mist主题首页两篇文章之间间距缩小和分割线" class="headerlink" title="Mist主题首页两篇文章之间间距缩小和分割线"></a>Mist主题首页两篇文章之间间距缩小和分割线</h3><p>在~\themes\hexo-theme-next\source\css_schemes\Mist_posts-expand.styl文件中，修改该数值即可：</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.post-block</span><span class="selector-pseudo">:not(</span><span class="selector-pseudo">:first-child)</span> &#123;</span><br><span class="line">  <span class="attribute">margin-top</span>: <span class="number">120px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>将 <code>.post-eof</code>部分修改为</p>
<figure class="highlight scss"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.post-eof</span> &#123;</span><br><span class="line">   <span class="attribute">display</span>: block;</span><br><span class="line"> <span class="comment">//  margin: $post-eof-margin-top auto $post-eof-margin-bottom;  </span></span><br><span class="line">   <span class="attribute">width</span>: <span class="number">100%</span>; <span class="comment">//分割线长度</span></span><br><span class="line">   <span class="attribute">height</span>: <span class="number">1px</span>; <span class="comment">// 分割线高度</span></span><br><span class="line">   <span class="attribute">background</span>: <span class="variable">$grey-light</span>;</span><br><span class="line">   <span class="attribute">text-align</span>: center;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>网站</category>
      </categories>
      <tags>
        <tag>hexo</tag>
        <tag>git</tag>
      </tags>
  </entry>
  <entry>
    <title>【Multiwfn】CDA分析</title>
    <url>/2022/08/22/%E3%80%90Multiwfn%E3%80%91CDA%E5%88%86%E6%9E%90/</url>
    <content><![CDATA[<p><a href="http://sobereva.com/166">http://sobereva.com/166</a></p>
<p><a href="https://pdf.hanspub.org/JAPC20150400000_68741604.pdf">广义化的电荷分解分析(GCDA)方法 (hanspub.org)</a></p>
<p>电荷分解分析(Charge decomposition analysis, CDA)是基于片段轨道的概念提出的一种将分子片段之间电荷转移分解为轨道的贡献，从而能更深入了解电荷转移本质的方法。</p>
<h1 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h1><ul>
<li>d (Donation)表现的是片段 A 向片段 B 贡献的电子量。它体现的是片段 A 的占据轨道与片段 B 的空轨道的混合。</li>
<li>b (Back-donation)表现的是片段 B 向片段 A 反馈的电子量。它由片段 B 的占据轨道与片段 A 的空轨道混合而产生。</li>
<li>d-b可以认为是经由复合物轨道两个片段间的净转移量。</li>
<li>b+d ，其数值越大说明两个片段间相互作用程度越大，轨道混合越显著。</li>
<li>r (Charge polarization)表现的是占据轨道的电荷极化，称为电荷极化项。<ul>
<li>r&gt;0，说明由于第 i 个复合物轨道，两个片段的电子在片段重叠区域的分布量增加，此时两个片段的占据轨道以相位相同方式混合，起到成键效应；</li>
<li>r&lt;0，表明两个片段的电子在重叠区域分布量减少，此时两个片段的占据轨道间必以相位相反方式混合，对片段间成键起到破坏作用，即反键效应。</li>
<li>总和值 r 一般为负值，因为占据轨道间的总相互作用是以交换互斥为主导的，是不利于成键的。</li>
</ul>
</li>
</ul>
<h1 id="步骤"><a href="#步骤" class="headerlink" title="步骤"></a>步骤</h1><h2 id="准备文件"><a href="#准备文件" class="headerlink" title="准备文件"></a>准备文件</h2><p>Gaussian提供复合物和各个片段的单点任务的fch文件。注意事项：</p>
<ul>
<li>坐标必须都用笛卡尔坐标，而且片段的定义顺序，片段内原子顺序、原子坐标必须和复合物中的完全一致。</li>
<li>片段不需要单独优化。</li>
<li>为了避免Gaussian自动将坐标调整到标准朝向而使得坐标无法相互对应，要使用<code>nosymm</code>关键词</li>
<li>不要用弥散函数</li>
<li>重原子使用赝势基组可能会出现基函数数目不符的问题，可以使用<code>5d</code>关键词。</li>
<li>如果用后HF方法计算，应当再加上density关键词，并且此时只能用Gaussian输出文件作为输入。对于闭壳层，pop=full应当改为pop=NO；对于开壳层，应改为pop=NOAB。这样才能让自然轨道信息代替HF轨道信息出现在Gaussian输出文件中。</li>
<li>以开壳层方式做 CDA/GCDA 计算时需要考虑自旋翻转问题。</li>
<li>片段的参考状态的选择应当尽量接近复合物状态的电子结构。</li>
</ul>
<h2 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h2><h3 id="总体步骤"><a href="#总体步骤" class="headerlink" title="总体步骤"></a>总体步骤</h3><figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">examples\CDA\COBH3\<span class="module-access"><span class="module"><span class="identifier">COBH3</span>.</span></span>fch  <span class="comment">//复合物的Gaussian输出文件</span></span><br><span class="line"><span class="number">16</span>   <span class="comment">//进入CDA模块</span></span><br><span class="line"><span class="number">2</span>  <span class="comment">//定义两个片段</span></span><br><span class="line">examples\CDA\COBH3\<span class="module-access"><span class="module"><span class="identifier">CO</span>.</span></span>fch  <span class="comment">//片段1的Gaussian输出文件</span></span><br><span class="line">examples\CDA\COBH3\<span class="module-access"><span class="module"><span class="identifier">BH3</span>.</span></span>fch  <span class="comment">//片段2的Gaussian输出文件</span></span><br></pre></td></tr></table></figure>
<h3 id="结果分析"><a href="#结果分析" class="headerlink" title="结果分析"></a>结果分析</h3><p><strong>CDA数据：</strong></p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line">   <span class="string">Orb.</span>      <span class="string">Occ.</span>          <span class="string">d</span>           <span class="string">b</span>        <span class="string">d</span> <span class="bullet">-</span> <span class="string">b</span>          <span class="string">r</span></span><br><span class="line">      <span class="number">1</span>    <span class="number">2.000000</span>   <span class="number">-0.000004</span>   <span class="number">-0.000000</span>   <span class="number">-0.000004</span>   <span class="number">-0.000001</span></span><br><span class="line">      <span class="number">2</span>    <span class="number">2.000000</span>    <span class="number">0.001119</span>   <span class="number">-0.000023</span>    <span class="number">0.001141</span>    <span class="number">0.000326</span></span><br><span class="line">      <span class="number">3</span>    <span class="number">2.000000</span>   <span class="number">-0.000002</span>   <span class="number">-0.000471</span>    <span class="number">0.000469</span>    <span class="number">0.000313</span></span><br><span class="line">      <span class="number">4</span>    <span class="number">2.000000</span>   <span class="number">-0.013250</span>   <span class="number">-0.000704</span>   <span class="number">-0.012546</span>   <span class="number">-0.005676</span></span><br><span class="line">      <span class="number">5</span>    <span class="number">2.000000</span>    <span class="number">0.041648</span>   <span class="number">-0.003309</span>    <span class="number">0.044957</span>    <span class="number">0.232262</span></span><br><span class="line">      <span class="number">6</span>    <span class="number">2.000000</span>    <span class="number">0.037385</span>   <span class="number">-0.020136</span>    <span class="number">0.057521</span>    <span class="number">0.212422</span></span><br><span class="line">      <span class="number">7</span>    <span class="number">2.000000</span>   <span class="number">-0.000543</span>    <span class="number">0.000647</span>   <span class="number">-0.001190</span>    <span class="number">0.022166</span></span><br><span class="line">      <span class="number">8</span>    <span class="number">2.000000</span>   <span class="number">-0.000543</span>    <span class="number">0.000647</span>   <span class="number">-0.001190</span>    <span class="number">0.022166</span></span><br><span class="line">      <span class="number">9</span>    <span class="number">2.000000</span>    <span class="number">0.171353</span>    <span class="number">0.026952</span>    <span class="number">0.144401</span>   <span class="number">-0.741381</span></span><br><span class="line">     <span class="number">10</span>    <span class="number">2.000000</span>   <span class="number">-0.000569</span>    <span class="number">0.043713</span>   <span class="number">-0.044281</span>   <span class="number">-0.038916</span></span><br><span class="line">     <span class="number">11</span>    <span class="number">2.000000</span>   <span class="number">-0.000569</span>    <span class="number">0.043713</span>   <span class="number">-0.044282</span>   <span class="number">-0.038916</span></span><br><span class="line">     <span class="number">12</span>    <span class="number">0.000000</span>    <span class="number">0.000000</span>    <span class="number">0.000000</span>    <span class="number">0.000000</span>    <span class="number">0.000000</span></span><br><span class="line">     <span class="number">13</span>    <span class="number">0.000000</span>    <span class="number">0.000000</span>    <span class="number">0.000000</span>    <span class="number">0.000000</span>    <span class="number">0.000000</span></span><br><span class="line">     <span class="number">14</span>    <span class="number">0.000000</span>    <span class="number">0.000000</span>    <span class="number">0.000000</span>    <span class="number">0.000000</span>    <span class="number">0.000000</span></span><br><span class="line">     <span class="number">15</span>    <span class="number">0.000000</span>    <span class="number">0.000000</span>    <span class="number">0.000000</span>    <span class="number">0.000000</span>    <span class="number">0.000000</span></span><br><span class="line"> <span class="string">......</span></span><br><span class="line"><span class="string">-------------------------------------------------------------------</span></span><br><span class="line"><span class="attr">Sum:</span>      <span class="number">22.000000</span>    <span class="number">0.236023</span>    <span class="number">0.091027</span>    <span class="number">0.144996</span>   <span class="number">-0.335233</span></span><br></pre></td></tr></table></figure>
<ul>
<li>Orb.就是复合物轨道的编号，Occ.是其占据数。</li>
<li>前三个复合物轨道的d、b、r项都接近于0，表明它们对于片段间的相互作用没什么用处，这是因为它们分别是O、C、B的<strong>内核轨道</strong>，基本不会参与成键。</li>
<li><p>所有的<strong>虚轨道</strong>的d、b、r项都为，因为它们的占据数都为0。</p>
<ul>
<li>只有对于自然轨道，对应于LUMO及更高阶的复合物轨道由于仍有少量电子占据，其d、b、r项才不是精确为0，但由于自然轨道序号是按照占据数由高到低排的，超过LUMO+5的话由于占据数往往已经很低了，d、b、r项已很小，所以Multiwfn中LUMO+5以上的轨道都不会输出。</li>
</ul>
</li>
<li><p>复合物轨道9的d是最大的，因此表明这个轨道对于CO向BH3的电子转移有最主要的贡献。通过形成这个复合物轨道，CO向BH3贡献了0.171个电子，而BH3向CO反馈了0.0269个电子，故净转移可以估算为0.144（即d-b项）。</p>
</li>
<li>BH3对CO反馈电子主要是来自于复合物轨道10和11，它们是简并的轨道，b的数值一致，为0.0437。</li>
<li>r(9)非常负，这说明复合物轨道9的形成使得CO和BH3的占据的片段轨道的电子很大程度上从二者的交叠区域移走，从而降低了电子互斥，从下面的它的轨道波函数图形中也可见在交叠区域有个明显的节点。</li>
<li>r(5)和r(6)都是不小的正值，因此它们的形成导致占据片段轨道的电子向交叠区域转移了不少，可以认为体现了片段间成键轨道的特征，从下面的等值面图形中也可看到这两个复合物轨道都较好地覆盖了片段间成键区域，故有利于成键。</li>
</ul>
<p><img src="http://sobereva.com/usr/uploads/image/20150610/20150610061643_74552.png" alt="img"></p>
<hr>
<p><strong>ECDA数据：</strong></p>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line">   <span class="attribute">Contribution</span> to <span class="literal">all</span> occupied complex orbital:</span><br><span class="line"><span class="attribute">Occupied</span>, virtual orbitals of fragment  <span class="number">1</span>:     <span class="number">680</span>.<span class="number">4194</span>%         <span class="number">8</span>.<span class="number">0593</span>%</span><br><span class="line"><span class="attribute">Occupied</span>, virtual orbitals of fragment  <span class="number">2</span>:     <span class="number">390</span>.<span class="number">3988</span>%        <span class="number">21</span>.<span class="number">1226</span>%</span><br><span class="line">  <span class="attribute">Contribution</span> to <span class="literal">all</span> virtual complex orbital:</span><br><span class="line"><span class="attribute">Occupied</span>, virtual orbitals of fragment  <span class="number">1</span>:      <span class="number">19</span>.<span class="number">5806</span>%      <span class="number">2291</span>.<span class="number">9407</span>%</span><br><span class="line"><span class="attribute">Occupied</span>, virtual orbitals of fragment  <span class="number">2</span>:       <span class="number">9</span>.<span class="number">6012</span>%      <span class="number">1678</span>.<span class="number">8774</span>%</span><br><span class="line"><span class="attribute">PL</span>( <span class="number">1</span>) + CT( <span class="number">1</span>-&gt; <span class="number">2</span>) =    <span class="number">0</span>.<span class="number">3916</span>      PL( <span class="number">1</span>) + CT( <span class="number">2</span>-&gt; <span class="number">1</span>) =    <span class="number">0</span>.<span class="number">1612</span></span><br><span class="line"><span class="attribute">PL</span>( <span class="number">2</span>) + CT( <span class="number">1</span>-&gt; <span class="number">2</span>) =    <span class="number">0</span>.<span class="number">4225</span>      PL( <span class="number">2</span>) + CT( <span class="number">2</span>-&gt; <span class="number">1</span>) =    <span class="number">0</span>.<span class="number">1920</span></span><br><span class="line"><span class="attribute">The</span> net electrons obtained by frag. <span class="number">2</span> = CT( <span class="number">1</span>-&gt; <span class="number">2</span>) - CT( <span class="number">2</span>-&gt; <span class="number">1</span>) =    <span class="number">0</span>.<span class="number">2304</span></span><br></pre></td></tr></table></figure>
<ul>
<li>一般来说只需要关注最后一行数据，它表明了从片段1向片段2总共净转移了多少电子，此例即0.2304。<ul>
<li>这个数据和CDA的d-b项会有一定出入，因为二者计算方法没有明显关联。ECDA给出的总的净转移量更可靠。</li>
</ul>
</li>
</ul>
<hr>
<p>通过<strong>菜单</strong>可以进一步观看复合物轨道的具体成分，比如选<code>2</code>再输入9。</p>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"> <span class="attribute">Occupation</span> number of orbital     <span class="number">9</span> of the complex:  <span class="number">2</span>.<span class="number">00000000</span></span><br><span class="line"><span class="attribute">Orbital</span>     <span class="number">7</span> of fragment  <span class="number">1</span>, Occ: <span class="number">2</span>.<span class="number">00000</span>    Contribution:   <span class="number">25</span>.<span class="number">8560</span>%</span><br><span class="line"><span class="attribute">Orbital</span>    <span class="number">13</span> of fragment  <span class="number">1</span>, Occ: <span class="number">0</span>.<span class="number">00000</span>    Contribution:    <span class="number">1</span>.<span class="number">0798</span>%</span><br><span class="line"><span class="attribute">Orbital</span>     <span class="number">2</span> of fragment  <span class="number">2</span>, Occ: <span class="number">2</span>.<span class="number">00000</span>    Contribution:   <span class="number">57</span>.<span class="number">2921</span>%</span><br><span class="line"><span class="attribute">Orbital</span>     <span class="number">5</span> of fragment  <span class="number">2</span>, Occ: <span class="number">0</span>.<span class="number">00000</span>    Contribution:   <span class="number">14</span>.<span class="number">5640</span>%</span><br></pre></td></tr></table></figure>
<ul>
<li>从数据中可见，复合物轨道9主体是BH3的轨道2，达57.3%。</li>
<li>之所以此复合物轨道会导致CO向BH3转移那么多电子，显然是因为CO的占据轨道7与BH3的虚轨道5相混合。</li>
<li>r(9)很负，是因为CO的占据轨道7与BH3的占据轨道2间的互斥作用所致。</li>
<li>可以进一步结合轨道图形来看：<ul>
<li>左边是CO的占据轨道7（展现较明显C的孤对电子特征），右边是BH3的虚轨道5，从形状上看二者比较匹配，因此容易混合，并且混合后会导致不少电子转移。<br><img src="http://sobereva.com/usr/uploads/image/20150610/20150610061657_41127.png" alt="img"></li>
</ul>
</li>
</ul>
<hr>
<p><strong>将某个复合物轨道的d,b,r值分解为片段轨道对的贡献：</strong></p>
<ul>
<li><p>对复合物轨道9进行分解。输入<code>0</code>返回上一级菜单，选选项<code>6</code>，然后输入<code>9</code>，然后输入0.005，这样对复合物轨道9的d,b,r项任意之一贡献大于0.005的片段轨道对就会被输出出来。</p>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">FragA</span> Orb(Occ.)  FragB Orb(Occ.)      d           b        d - b          r</span><br><span class="line">    <span class="attribute">4</span>( <span class="number">2</span>.<span class="number">0000</span>)       <span class="number">2</span>( <span class="number">2</span>.<span class="number">0000</span>)    <span class="number">0</span>.<span class="number">000000</span>    <span class="number">0</span>.<span class="number">000000</span>    <span class="number">0</span>.<span class="number">000000</span>   -<span class="number">0</span>.<span class="number">009969</span></span><br><span class="line">    <span class="attribute">7</span>( <span class="number">2</span>.<span class="number">0000</span>)       <span class="number">1</span>( <span class="number">2</span>.<span class="number">0000</span>)    <span class="number">0</span>.<span class="number">000000</span>    <span class="number">0</span>.<span class="number">000000</span>    <span class="number">0</span>.<span class="number">000000</span>   -<span class="number">0</span>.<span class="number">005759</span></span><br><span class="line">    <span class="attribute">7</span>( <span class="number">2</span>.<span class="number">0000</span>)       <span class="number">2</span>( <span class="number">2</span>.<span class="number">0000</span>)    <span class="number">0</span>.<span class="number">000000</span>    <span class="number">0</span>.<span class="number">000000</span>    <span class="number">0</span>.<span class="number">000000</span>   -<span class="number">0</span>.<span class="number">723845</span></span><br><span class="line">    <span class="attribute">7</span>( <span class="number">2</span>.<span class="number">0000</span>)       <span class="number">5</span>( <span class="number">0</span>.<span class="number">0000</span>)    <span class="number">0</span>.<span class="number">176503</span>    <span class="number">0</span>.<span class="number">000000</span>    <span class="number">0</span>.<span class="number">176503</span>    <span class="number">0</span>.<span class="number">000000</span></span><br><span class="line">    <span class="attribute">7</span>( <span class="number">2</span>.<span class="number">0000</span>)       <span class="number">8</span>( <span class="number">0</span>.<span class="number">0000</span>)    <span class="number">0</span>.<span class="number">006221</span>    <span class="number">0</span>.<span class="number">000000</span>    <span class="number">0</span>.<span class="number">006221</span>    <span class="number">0</span>.<span class="number">000000</span></span><br><span class="line">    <span class="attribute">7</span>( <span class="number">2</span>.<span class="number">0000</span>)      <span class="number">11</span>( <span class="number">0</span>.<span class="number">0000</span>)    <span class="number">0</span>.<span class="number">005846</span>    <span class="number">0</span>.<span class="number">000000</span>    <span class="number">0</span>.<span class="number">005846</span>    <span class="number">0</span>.<span class="number">000000</span></span><br><span class="line">    <span class="attribute">7</span>( <span class="number">2</span>.<span class="number">0000</span>)      <span class="number">12</span>( <span class="number">0</span>.<span class="number">0000</span>)   -<span class="number">0</span>.<span class="number">023941</span>    <span class="number">0</span>.<span class="number">000000</span>   -<span class="number">0</span>.<span class="number">023941</span>    <span class="number">0</span>.<span class="number">000000</span></span><br><span class="line">   <span class="attribute">13</span>( <span class="number">0</span>.<span class="number">0000</span>)       <span class="number">2</span>( <span class="number">2</span>.<span class="number">0000</span>)    <span class="number">0</span>.<span class="number">000000</span>    <span class="number">0</span>.<span class="number">021958</span>   -<span class="number">0</span>.<span class="number">021958</span>    <span class="number">0</span>.<span class="number">000000</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>很清晰地可以看到CO的7号轨道与BH3的5号轨道相互作用导致电子向BH3转移了0.176，这正是9号复合物轨道d项达到0.171的主要因素。</p>
</li>
</ul>
<hr>
<p><strong>绘制轨道相互作用图</strong></p>
<ul>
<li><p>输入<code>0</code>回到上一级菜单，然后选<code>5</code>进入绘制轨道相互作用图的菜单中。</p>
</li>
<li><p>选<code>3</code>，输入-30,10把相互作用图能量下限和上限分别设为-30和10eV。</p>
</li>
<li>选<code>1</code>，轨道相互作用图立刻会显示。</li>
</ul>
]]></content>
      <categories>
        <category>计算化学</category>
        <category>软件</category>
      </categories>
      <tags>
        <tag>Multiwfn</tag>
        <tag>CDA</tag>
        <tag>CT</tag>
      </tags>
  </entry>
  <entry>
    <title>【【草稿】】价键理论（VB）</title>
    <url>/2021/04/16/%E3%80%90%E3%80%90%E8%8D%89%E7%A8%BF%E3%80%91%E3%80%91%E4%BB%B7%E9%94%AE%E7%90%86%E8%AE%BA%EF%BC%88VB%EF%BC%89/</url>
    <content><![CDATA[<p>价键理论是多电子波函数</p>
<p>分子轨道不区分电子在哪个原子核上</p>
<h1 id="价键理论（VB）"><a href="#价键理论（VB）" class="headerlink" title="价键理论（VB）"></a>价键理论（VB）</h1><h2 id="Heitler-London价键理论对H2的求解"><a href="#Heitler-London价键理论对H2的求解" class="headerlink" title="Heitler-London价键理论对H2的求解"></a>Heitler-London价键理论对H<sub>2</sub>的求解</h2><ol>
<li>首先假定1号电子与2号原子核之间的吸引可以省略</li>
<li>其次电子是不可区分的</li>
<li>加上自旋的反对称</li>
</ol>
<script type="math/tex; mode=display">\Psi_{VB}=[\phi_a(1)\phi_b(2)+\phi_a(2)\phi_b(1)][\alpha(1)\beta(2)-\alpha(2)\beta(1)]\\=\\=|a\bar{b}|+|b\bar{a}|</script><script type="math/tex; mode=display">E=<\Psi_{VB}|\hat{H}|\Psi_{VB}>=<|a\bar{b}|+|b\bar{a}||\hat{H}||a\bar{b}|+|b\bar{a}|></script><h3 id="离子项"><a href="#离子项" class="headerlink" title="离子项"></a>离子项</h3><h3 id="三重态"><a href="#三重态" class="headerlink" title="三重态"></a>三重态</h3><h2 id="现代VB理论"><a href="#现代VB理论" class="headerlink" title="现代VB理论"></a>现代VB理论</h2><h3 id="Coulson-Fischer-VB-Model-1949"><a href="#Coulson-Fischer-VB-Model-1949" class="headerlink" title="Coulson-Fischer VB Model (1949)"></a>Coulson-Fischer VB Model (1949)</h3><h3 id="Goddard-GVB-model-1973"><a href="#Goddard-GVB-model-1973" class="headerlink" title="Goddard GVB model (1973)"></a>Goddard GVB model (1973)</h3><h3 id="Spin-Coupled-VB-Model"><a href="#Spin-Coupled-VB-Model" class="headerlink" title="Spin-Coupled VB Model"></a>Spin-Coupled VB Model</h3><h1 id="分子轨道理论（MO）"><a href="#分子轨道理论（MO）" class="headerlink" title="分子轨道理论（MO）"></a>分子轨道理论（MO）</h1>]]></content>
      <categories>
        <category>计算化学</category>
        <category>原理</category>
      </categories>
      <tags>
        <tag>变分法</tag>
      </tags>
  </entry>
  <entry>
    <title>【【草稿】】热力学相关</title>
    <url>/2022/06/28/%E3%80%90%E3%80%90%E8%8D%89%E7%A8%BF%E3%80%91%E3%80%91%E7%83%AD%E5%8A%9B%E5%AD%A6%E7%9B%B8%E5%85%B3/</url>
    <content><![CDATA[<ul>
<li>热力学常数：<script type="math/tex">R=8.314J/(mol*K)</script></li>
</ul>
<h1 id="常见热力学量"><a href="#常见热力学量" class="headerlink" title="常见热力学量"></a>常见热力学量</h1><ul>
<li>内能（Internal energy）：<script type="math/tex">U</script><ul>
<li>内能不是电子能量，还包括核运动的能量</li>
</ul>
</li>
<li>熵（Entropy）：<script type="math/tex">S</script><ul>
<li>熵体现粒子的扩散度</li>
</ul>
</li>
<li>亥姆霍兹自由能（Helmholtz free eneryg）：<script type="math/tex">A=U-TS</script><ul>
<li>A用于等容过程</li>
</ul>
</li>
<li>焓（Enthalpy）：<script type="math/tex">H=U+PV</script></li>
<li>吉布斯自由能（Gibbs free energy）：<script type="math/tex">G=H-TS=A+PV</script><ul>
<li>G用于等压过程</li>
</ul>
</li>
</ul>
<hr>
<ul>
<li>等容热容：<script type="math/tex">C_{V}=\left(\frac{\partial U}{\partial T}\right)_{V}</script></li>
<li>等压热容：<script type="math/tex">C_{P}=\left(\frac{\partial H}{\partial T}\right)_{P}</script></li>
<li>升温造成的内能增加：<script type="math/tex">\Delta U_{0 \rightarrow T}=U(T)-U(0)=\int_{0}^{T} C_{V} d T</script></li>
<li>升温造成的焓增加：<script type="math/tex">\Delta H_{0 \rightarrow T}=H(T)-H(0)=\int_{0}^{T} C_{P} d T</script></li>
</ul>
<h1 id="理想气体假设"><a href="#理想气体假设" class="headerlink" title="理想气体假设"></a>理想气体假设</h1><ul>
<li>理想气体状态下系综内的分子之间不存在任何相互作用，此时满足：<script type="math/tex">PV=nRT</script></li>
<li><p>Gaussian等量化程序对分子做振动分折时给出热力学数据的时候<strong>都是把体系当成理想气体对待的</strong>。给出每mol的热力学量，此时<script type="math/tex">PV=RT</script>，可明确写为:</p>
<ul>
<li><script type="math/tex; mode=display">G=A+RT</script></li>
<li><script type="math/tex; mode=display">H=U+RT</script></li>
<li><script type="math/tex; mode=display">C_{P}=C_V+R</script></li>
</ul>
</li>
<li><p>热力学性质由体系的平动、转动、振动、电子一起贡献：</p>
<ul>
<li><script type="math/tex; mode=display">U_{\text {tot }}=U_{\text {trans }}+U_{\text {rot }}+U_{\text {vib }}+U_{\text {ele }}</script></li>
<li><script type="math/tex; mode=display">S_{\text {tot }}=S_{\text {trans }}+S_{\text {rot }}+S_{\text {vib }}+S_{\text {ele }}</script></li>
<li><script type="math/tex; mode=display">C_{\mathrm{v}, \text { tot }}=C_{\mathrm{V}, \text { trans }}+C_{\mathrm{V}, \text { rot }}+C_{\mathrm{V}, \mathrm{vib}}+C_{\mathrm{V}, \mathrm{de}}</script></li>
</ul>
</li>
<li><p>H的RT和C的R项是由平动贡献的：</p>
<ul>
<li><script type="math/tex; mode=display">H_{\text {trans }}=U_{\text {trans }}+R T</script></li>
<li><script type="math/tex; mode=display">C_{\mathrm{P}, \text { trans }}=C_{\mathrm{V}, \text { trans }}+R</script></li>
</ul>
</li>
</ul>
<h1 id="0K时的热力学数据"><a href="#0K时的热力学数据" class="headerlink" title="0K时的热力学数据"></a>0K时的热力学数据</h1><ul>
<li>0K时平动和转动能量都为零。但是分子振动有零点振动能（ZPE或ZPVE），对应0K下（振动基态）时核振动的能量。</li>
<li>在谐振近似下考察分子振动时（每个振动的能量的加合）：<script type="math/tex">\mathrm{ZPE}=\frac{1}{2} \sum_{i} h v_{i}</script></li>
<li>几何优化得到的不是0K下的结构，而是虚构的没有核振动时的能重极小结构。哪怕是0K时核也在动，只要考虑核运动，就没有确切的核坐标，至多只能说振动平均结构。即：几何优化是忽略了核运动得到的势能曲线。</li>
<li>电子基态能量（单点能）加上ZPE就是0K下体系的内能：<script type="math/tex">U(0)=\varepsilon_{\mathrm{ele}}+\mathrm{ZPE}</script><ul>
<li>由<script type="math/tex">H=U+PV</script>，<script type="math/tex">G=H-TS</script>，当T=0时，<script type="math/tex">H(0)= G(0)= U(0)</script></li>
</ul>
</li>
</ul>
<h1 id="gt-0K时的热力学数据"><a href="#gt-0K时的热力学数据" class="headerlink" title="&gt;0K时的热力学数据"></a>&gt;0K时的热力学数据</h1><ul>
<li><p>由于自由能、内能、 熵、焓等热力学量都是温度的函数，因此温度设定会影响它们的数值。另外压力设定也会产生影响，但影响的仅是平动贡献。</p>
</li>
<li><p>有限温度时，比如般计算的标况 (298.15K、1atm)，热力学数据写为电子基态能量与热贡献的加和。</p>
<ul>
<li><script type="math/tex; mode=display">U(T)=U(0)+[U(T)-U(0)]=\varepsilon_{\text {ele }}+\mathrm{ZPE}+\Delta U_{0 \rightarrow T}=\varepsilon_{\text {ele }}+U_{corr}(T)</script></li>
<li><script type="math/tex; mode=display">H(T)=H(0)+[H(T)-H(0)]=\varepsilon_{\text {ele }}+\mathrm{ZPE}+\Delta H_{0 \rightarrow T}= \varepsilon_{\text {ele }}+H_{corr}(T)</script></li>
<li><script type="math/tex; mode=display">G(T)=G(0)+[G(T)-G(0)]=\varepsilon_{\text {ele }}+\mathrm{ZPE}+\Delta G_{0 \rightarrow T}=\varepsilon_{\text {ele }}+G_{corr}(T)</script><ul>
<li><script type="math/tex">\Delta U_{0 \rightarrow T}</script>，<script type="math/tex">\Delta H_{0 \rightarrow T}</script>，<script type="math/tex">\Delta G_{0 \rightarrow T}</script>是指从0K升温对热力学量产生的贡献，</li>
<li><script type="math/tex">U/H/G_{corr}(T)</script>是对电子能量的热力学校正量，Gaussian会输出，热力学校正量加到电子能量上<script type="math/tex">\varepsilon_{\text {ele }}</script>就得到了体系的各种能量</li>
</ul>
</li>
</ul>
</li>
<li><p>单个原子的热力学校正量<script type="math/tex">H_{corr}(T)=\frac{5}{2}RT</script></p>
</li>
</ul>
<h1 id="量化计算过程注意事项"><a href="#量化计算过程注意事项" class="headerlink" title="量化计算过程注意事项"></a>量化计算过程注意事项</h1><ul>
<li>量化程序计算热力学数据的时候都是把体系当成理想气体分子来考虑的：<ul>
<li>不要误认为在量子化学程序中不同温度、压力设定下得到的就是物质在相应状态下的实际性质。</li>
<li>量化程序在计算平动、转动贡献时，并没有考虑凝聚相（或非理想气体）状况下分子间相互作用，分子是当成能够自由地平动和转动的。</li>
</ul>
</li>
<li>由于自由能、内能、 熵、焓等热力学量都是温度的函数，因此<strong>温度设定</strong>会影响它们的数值。</li>
<li><strong>压力设定</strong>也会产生影响，但影响的仅是平动贡献。</li>
<li><strong>不同位素设定</strong>下由于原子质量不同热力学量计算结果也有所不同。（依赖于原子质量）</li>
<li><p>在给定结构下，由于计算平动、转动不需要任何耗时。耗时都在频率计算上，所以一般量子化学程序做振动分析任务时就会顺便给出热力学数据。</p>
</li>
<li><p>由于热力学量涉及电子能量，振动频率，几何结构（影响转转动贡献)，所以热力学数据计算<strong>精度</strong>依赖于计算级别。</p>
<ul>
<li>热力学校正量的数量级远远低于电子能量。对两个体系进行比较时(如计算化学反应能)，热力学校正量的计算误差一般也明显低于电子能量计算误差，所以算准热力学数据最重要的是算准电子能量，所用计算级别应该尽可能高。而热力学校正量在廉价计算级别如B3LYP/6-31G<em>下就足矣算将很好，且频率计算耗时量远大于单点，因此计算<em>*热力学校正量时不需要也不宜用太高级别</em></em>。</li>
<li>注意做振动分析计算热力学数据时坐标一定要在同级别优化过，而振动分析结来和几何优化对计算级别的敏感度又都显著低于能量，因此计算热力学数据的合理略是先用中成低级别优化结构并计算热力学校正量，然后再用高级别方法在此结构下算一次单点并和热力学校正相加。</li>
</ul>
</li>
</ul>
<h1 id="用哪种热力学量"><a href="#用哪种热力学量" class="headerlink" title="用哪种热力学量"></a>用哪种热力学量</h1><p>0K下内能、焓、自由能相同。有限温度下用哪种热力学量讨论问题分情况：</p>
<ul>
<li>化学平衡【求平衡常数，用自由能差】、构象分布【不同构象出现比例，玻尔兹曼分布】、反应快慢【过渡态理论，自由能垒】、稳定性【可能分很多稳定性】：自由能</li>
<li>吸热/放热量：焓(如果化学过程前后气态分子摩尔数没有变化，【等容过程】亦可用内能变讨论，此时与始变相同)</li>
<li>键能、电离能、电子亲和能：焓</li>
<li>其它情况、纯理论研究问题或只需简单粗略讨论上述问题：电子能量</li>
</ul>
<h2 id="得到H-T-G-T-的步骤"><a href="#得到H-T-G-T-的步骤" class="headerlink" title="得到H(T)/G(T)的步骤"></a>得到H(T)/G(T)的步骤</h2><p>对于Gaussian：</p>
<ul>
<li>粗糙做法：直接用中低级别诸如B3LYP16-31G*做opt req任务，取输出的<code>Sum of electronic and themal Enthalples=</code>后面的值H(T)或<code>Sum of electronic and thermal Free Enerpies=后面的值</code>G(T)</li>
<li><p>一般做法：用中低级别诸如B3LYP/6-31G*做opt freq任务，取焓的热校正量（<code>Thermal correction to Enthalpy=</code>后面的值）或自由能的热校正量（<code>Thermal correction to Gibbs Free Energy=</code>后面的值）。然后在这优化得到的结构下用诸如B2PLYP-D3/def2-TZVPP等较高级别计算单点能。最后把二者相加</p>
</li>
<li><p>对于小体系，直接用恰当的热力学组合方法，从输出文件末尾读取焓</p>
</li>
</ul>
<h1 id="不同量化软件输出"><a href="#不同量化软件输出" class="headerlink" title="不同量化软件输出"></a>不同量化软件输出</h1><h2 id="Gaussian"><a href="#Gaussian" class="headerlink" title="Gaussian"></a>Gaussian</h2><ul>
<li>两种单位的<script type="math/tex">\mathrm{ZPE}</script></li>
</ul>
<figure class="highlight lisp"><table><tr><td class="code"><pre><span class="line">Zero-point vibrational energy     <span class="number">210889.5</span> (<span class="name">Joules/Mol</span>)</span><br><span class="line">                                   <span class="number">50.40379</span> (<span class="name">Kcal/Mol</span>)</span><br></pre></td></tr></table></figure>
<ul>
<li>Zero-point correction：零点能，<script type="math/tex">\mathrm{ZPE}</script>，单位应该是hartree，而不是Hartree/Particle</li>
<li>Thermal correction to Energy：内能的热力学校正量<script type="math/tex">U_{corr}(T)</script></li>
<li>Thermal correction to Enthalpy：焓热校正量<script type="math/tex">H_{corr}(T)</script></li>
<li>Thermal correction to Gibbs Free Energy：吉布斯自由能校正量<script type="math/tex">G_{corr}(T)</script></li>
</ul>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">Zero</span>-point correction=                           <span class="number">0</span>.<span class="number">080324</span> (Hartree/Particle)</span><br><span class="line"> <span class="attribute">Thermal</span> correction to Energy=                    <span class="number">0</span>.<span class="number">084586</span></span><br><span class="line"> <span class="attribute">Thermal</span> correction to Enthalpy=                  <span class="number">0</span>.<span class="number">085530</span></span><br><span class="line"> <span class="attribute">Thermal</span> correction to Gibbs Free Energy=         <span class="number">0</span>.<span class="number">054960</span></span><br></pre></td></tr></table></figure>
<ul>
<li>上面四项加到电子能量上后就得到了其他能量。Gaussian也会自动加和输出当前级别下的其他能量，但是电子能量并不准确，要得到比较准确的，应当手动把校正量加到（更高级别）单点能上：</li>
</ul>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">Sum</span> of electronic and zero-point Energies=           -<span class="number">154</span>.<span class="number">953482</span></span><br><span class="line"> <span class="attribute">Sum</span> of electronic and thermal Energies=              -<span class="number">154</span>.<span class="number">949219</span></span><br><span class="line"> <span class="attribute">Sum</span> of electronic and thermal Enthalpies=            -<span class="number">154</span>.<span class="number">948275</span></span><br><span class="line"> <span class="attribute">Sum</span> of electronic and thermal Free Energies=         -<span class="number">154</span>.<span class="number">978845</span></span><br></pre></td></tr></table></figure>
<ul>
<li>其他输出：<ul>
<li>E (Thermal)表示内能热校正量，电子、平动、转动、振动的贡献etc，振动占大部分</li>
<li>G(T)还可以通过<script type="math/tex">G=H-TS</script>得到，通过温度和输出的熵变计算。</li>
</ul>
</li>
</ul>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line">                    <span class="attribute">E</span> (Thermal)             CV                S</span><br><span class="line">                     <span class="attribute">KCal</span>/Mol        Cal/Mol-Kelvin    Cal/Mol-Kelvin</span><br><span class="line"><span class="attribute">Total</span>                   <span class="number">53</span>.<span class="number">079</span>             <span class="number">13</span>.<span class="number">372</span>             <span class="number">64</span>.<span class="number">340</span></span><br><span class="line"><span class="attribute">Electronic</span>               <span class="number">0</span>.<span class="number">000</span>              <span class="number">0</span>.<span class="number">000</span>              <span class="number">0</span>.<span class="number">000</span></span><br><span class="line"><span class="attribute">Translational</span>            <span class="number">0</span>.<span class="number">889</span>              <span class="number">2</span>.<span class="number">981</span>             <span class="number">37</span>.<span class="number">406</span></span><br><span class="line"><span class="attribute">Rotational</span>               <span class="number">0</span>.<span class="number">889</span>              <span class="number">2</span>.<span class="number">981</span>             <span class="number">22</span>.<span class="number">318</span></span><br><span class="line"><span class="attribute">Vibrational</span>             <span class="number">51</span>.<span class="number">301</span>              <span class="number">7</span>.<span class="number">410</span>              <span class="number">4</span>.<span class="number">616</span></span><br><span class="line"><span class="attribute">Vibration</span>     <span class="number">1</span>          <span class="number">0</span>.<span class="number">664</span>              <span class="number">1</span>.<span class="number">758</span>              <span class="number">1</span>.<span class="number">711</span></span><br><span class="line"><span class="attribute">Vibration</span>     <span class="number">2</span>          <span class="number">0</span>.<span class="number">694</span>              <span class="number">1</span>.<span class="number">668</span>              <span class="number">1</span>.<span class="number">400</span></span><br><span class="line"><span class="attribute">Vibration</span>     <span class="number">3</span>          <span class="number">0</span>.<span class="number">781</span>              <span class="number">1</span>.<span class="number">430</span>              <span class="number">0</span>.<span class="number">897</span></span><br></pre></td></tr></table></figure>
<ul>
<li><p>Q配分函数，各种热力学量都可以通过配分函数得到</p>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line">                      <span class="attribute">Q</span>            Log<span class="number">10</span>(Q)             Ln(Q)</span><br><span class="line"><span class="attribute">Total</span> Bot       <span class="number">0</span>.<span class="number">524878</span>D-<span class="number">25</span>        -<span class="number">25</span>.<span class="number">279942</span>        -<span class="number">58</span>.<span class="number">209218</span></span><br><span class="line"><span class="attribute">Total</span> V=<span class="number">0</span>       <span class="number">0</span>.<span class="number">463716</span>D+<span class="number">12</span>         <span class="number">11</span>.<span class="number">666252</span>         <span class="number">26</span>.<span class="number">862537</span></span><br><span class="line"><span class="attribute">Vib</span> (Bot)       <span class="number">0</span>.<span class="number">253966</span>D-<span class="number">36</span>        -<span class="number">36</span>.<span class="number">595224</span>        -<span class="number">84</span>.<span class="number">263617</span></span><br><span class="line"><span class="attribute">Vib</span> (Bot)    <span class="number">1</span>  <span class="number">0</span>.<span class="number">771265</span>D+<span class="number">00</span>         -<span class="number">0</span>.<span class="number">112796</span>         -<span class="number">0</span>.<span class="number">259723</span></span><br><span class="line"><span class="attribute">Vib</span> (Bot)    <span class="number">2</span>  <span class="number">0</span>.<span class="number">626499</span>D+<span class="number">00</span>         -<span class="number">0</span>.<span class="number">203080</span>         -<span class="number">0</span>.<span class="number">467609</span></span><br><span class="line"><span class="attribute">Vib</span> (Bot)    <span class="number">3</span>  <span class="number">0</span>.<span class="number">420158</span>D+<span class="number">00</span>         -<span class="number">0</span>.<span class="number">376588</span>         -<span class="number">0</span>.<span class="number">867125</span></span><br><span class="line"><span class="attribute">Vib</span> (V=<span class="number">0</span>)       <span class="number">0</span>.<span class="number">224373</span>D+<span class="number">01</span>          <span class="number">0</span>.<span class="number">350970</span>          <span class="number">0</span>.<span class="number">808138</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="例子1：计算0K和298-15K下HF生成焓"><a href="#例子1：计算0K和298-15K下HF生成焓" class="headerlink" title="例子1：计算0K和298.15K下HF生成焓"></a>例子1：计算0K和298.15K下HF生成焓</h3><ul>
<li><script type="math/tex; mode=display">\frac{1}{2} \mathrm{H}_{2}(\mathrm{~g})+\frac{1}{2}\mathrm{~F}_{2}(\mathrm{~g}) \rightarrow \mathrm{HF}(\mathrm{g})</script></li>
<li>0K下实验生成焓变-272.5±0.8kJ/mol，298.15K下为-273.3kJ/mol。</li>
<li>先通过B3LYP/6-31G*优化和振动分析得到ZPE和298.15K时的焓的热校正量，加到CCSDT/cc-pVQZ得到的单点能上来分别获得0K和298.15K时的焓值，并计算生成焓。</li>
</ul>
<p><img src="/image-20220628202457869.png" alt="image-20220628202457869"></p>
<h2 id="ADF"><a href="#ADF" class="headerlink" title="ADF"></a>ADF</h2><ul>
<li><p>零点能：</p>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">Zero</span>-point energy (Hartree):     <span class="number">0</span>.<span class="number">0032</span></span><br></pre></td></tr></table></figure>
</li>
<li></li>
</ul>
]]></content>
      <categories>
        <category>计算化学</category>
        <category>原理</category>
      </categories>
      <tags>
        <tag>熵</tag>
        <tag>焓</tag>
        <tag>内能</tag>
        <tag>零点能</tag>
      </tags>
  </entry>
</search>
